(self.webpackChunkmm_front_v3=self.webpackChunkmm_front_v3||[]).push([[792],{4709:(Nn,Ct,R)=>{"use strict";R.d(Ct,{H:()=>fe,K6:()=>de,Me:()=>ve,Ob:()=>ee,YL:()=>se,_:()=>C,g8:()=>mt,n6:()=>at,oS:()=>$e,wE:()=>Fe});var M=R(9785);function C(ze,bt,xt){return{r:255*(0,M.Cg)(ze,255),g:255*(0,M.Cg)(bt,255),b:255*(0,M.Cg)(xt,255)}}function de(ze,bt,xt){ze=(0,M.Cg)(ze,255),bt=(0,M.Cg)(bt,255),xt=(0,M.Cg)(xt,255);var Qt=Math.max(ze,bt,xt),sn=Math.min(ze,bt,xt),Yt=0,Ut=0,et=(Qt+sn)/2;if(Qt===sn)Ut=0,Yt=0;else{var It=Qt-sn;switch(Ut=et>.5?It/(2-Qt-sn):It/(Qt+sn),Qt){case ze:Yt=(bt-xt)/It+(bt<xt?6:0);break;case bt:Yt=(xt-ze)/It+2;break;case xt:Yt=(ze-bt)/It+4}Yt/=6}return{h:Yt,s:Ut,l:et}}function a(ze,bt,xt){return xt<0&&(xt+=1),xt>1&&(xt-=1),xt<1/6?ze+6*xt*(bt-ze):xt<.5?bt:xt<2/3?ze+(bt-ze)*(2/3-xt)*6:ze}function se(ze,bt,xt){var Qt,sn,Yt;if(ze=(0,M.Cg)(ze,360),bt=(0,M.Cg)(bt,100),xt=(0,M.Cg)(xt,100),0===bt)sn=xt,Yt=xt,Qt=xt;else{var Ut=xt<.5?xt*(1+bt):xt+bt-xt*bt,et=2*xt-Ut;Qt=a(et,Ut,ze+1/3),sn=a(et,Ut,ze),Yt=a(et,Ut,ze-1/3)}return{r:255*Qt,g:255*sn,b:255*Yt}}function Fe(ze,bt,xt){ze=(0,M.Cg)(ze,255),bt=(0,M.Cg)(bt,255),xt=(0,M.Cg)(xt,255);var Qt=Math.max(ze,bt,xt),sn=Math.min(ze,bt,xt),Yt=0,Ut=Qt,et=Qt-sn,It=0===Qt?0:et/Qt;if(Qt===sn)Yt=0;else{switch(Qt){case ze:Yt=(bt-xt)/et+(bt<xt?6:0);break;case bt:Yt=(xt-ze)/et+2;break;case xt:Yt=(ze-bt)/et+4}Yt/=6}return{h:Yt,s:It,v:Ut}}function ve(ze,bt,xt){ze=6*(0,M.Cg)(ze,360),bt=(0,M.Cg)(bt,100),xt=(0,M.Cg)(xt,100);var Qt=Math.floor(ze),sn=ze-Qt,Yt=xt*(1-bt),Ut=xt*(1-sn*bt),et=xt*(1-(1-sn)*bt),It=Qt%6;return{r:255*[xt,Ut,Yt,Yt,et,xt][It],g:255*[et,xt,xt,Ut,Yt,Yt][It],b:255*[Yt,Yt,et,xt,xt,Ut][It]}}function ee(ze,bt,xt,Qt){var sn=[(0,M.wl)(Math.round(ze).toString(16)),(0,M.wl)(Math.round(bt).toString(16)),(0,M.wl)(Math.round(xt).toString(16))];return Qt&&sn[0].startsWith(sn[0].charAt(1))&&sn[1].startsWith(sn[1].charAt(1))&&sn[2].startsWith(sn[2].charAt(1))?sn[0].charAt(0)+sn[1].charAt(0)+sn[2].charAt(0):sn.join("")}function fe(ze,bt,xt,Qt,sn){var Yt=[(0,M.wl)(Math.round(ze).toString(16)),(0,M.wl)(Math.round(bt).toString(16)),(0,M.wl)(Math.round(xt).toString(16)),(0,M.wl)(ge(Qt))];return sn&&Yt[0].startsWith(Yt[0].charAt(1))&&Yt[1].startsWith(Yt[1].charAt(1))&&Yt[2].startsWith(Yt[2].charAt(1))&&Yt[3].startsWith(Yt[3].charAt(1))?Yt[0].charAt(0)+Yt[1].charAt(0)+Yt[2].charAt(0)+Yt[3].charAt(0):Yt.join("")}function ge(ze){return Math.round(255*parseFloat(ze)).toString(16)}function at(ze){return mt(ze)/255}function mt(ze){return parseInt(ze,16)}function $e(ze){return{r:ze>>16,g:(65280&ze)>>8,b:255&ze}}},6681:(Nn,Ct,R)=>{"use strict";R.d(Ct,{D:()=>M});var M={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},4215:(Nn,Ct,R)=>{"use strict";R.d(Ct,{RO:()=>a});var M=R(4709),C=R(6681),de=R(9785);function a(mt){var $e={r:0,g:0,b:0},ze=1,bt=null,xt=null,Qt=null,sn=!1,Yt=!1;return"string"==typeof mt&&(mt=function ge(mt){if(0===(mt=mt.trim().toLowerCase()).length)return!1;var $e=!1;if(C.D[mt])mt=C.D[mt],$e=!0;else if("transparent"===mt)return{r:0,g:0,b:0,a:0,format:"name"};var ze=he.rgb.exec(mt);return ze?{r:ze[1],g:ze[2],b:ze[3]}:(ze=he.rgba.exec(mt))?{r:ze[1],g:ze[2],b:ze[3],a:ze[4]}:(ze=he.hsl.exec(mt))?{h:ze[1],s:ze[2],l:ze[3]}:(ze=he.hsla.exec(mt))?{h:ze[1],s:ze[2],l:ze[3],a:ze[4]}:(ze=he.hsv.exec(mt))?{h:ze[1],s:ze[2],v:ze[3]}:(ze=he.hsva.exec(mt))?{h:ze[1],s:ze[2],v:ze[3],a:ze[4]}:(ze=he.hex8.exec(mt))?{r:(0,M.g8)(ze[1]),g:(0,M.g8)(ze[2]),b:(0,M.g8)(ze[3]),a:(0,M.n6)(ze[4]),format:$e?"name":"hex8"}:(ze=he.hex6.exec(mt))?{r:(0,M.g8)(ze[1]),g:(0,M.g8)(ze[2]),b:(0,M.g8)(ze[3]),format:$e?"name":"hex"}:(ze=he.hex4.exec(mt))?{r:(0,M.g8)(ze[1]+ze[1]),g:(0,M.g8)(ze[2]+ze[2]),b:(0,M.g8)(ze[3]+ze[3]),a:(0,M.n6)(ze[4]+ze[4]),format:$e?"name":"hex8"}:!!(ze=he.hex3.exec(mt))&&{r:(0,M.g8)(ze[1]+ze[1]),g:(0,M.g8)(ze[2]+ze[2]),b:(0,M.g8)(ze[3]+ze[3]),format:$e?"name":"hex"}}(mt)),"object"==typeof mt&&(at(mt.r)&&at(mt.g)&&at(mt.b)?($e=(0,M._)(mt.r,mt.g,mt.b),sn=!0,Yt="%"===String(mt.r).substr(-1)?"prgb":"rgb"):at(mt.h)&&at(mt.s)&&at(mt.v)?(bt=(0,de.Px)(mt.s),xt=(0,de.Px)(mt.v),$e=(0,M.Me)(mt.h,bt,xt),sn=!0,Yt="hsv"):at(mt.h)&&at(mt.s)&&at(mt.l)&&(bt=(0,de.Px)(mt.s),Qt=(0,de.Px)(mt.l),$e=(0,M.YL)(mt.h,bt,Qt),sn=!0,Yt="hsl"),Object.prototype.hasOwnProperty.call(mt,"a")&&(ze=mt.a)),ze=(0,de.TV)(ze),{ok:sn,format:mt.format||Yt,r:Math.min(255,Math.max($e.r,0)),g:Math.min(255,Math.max($e.g,0)),b:Math.min(255,Math.max($e.b,0)),a:ze}}var ve="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),ee="[\\s|\\(]+(".concat(ve,")[,|\\s]+(").concat(ve,")[,|\\s]+(").concat(ve,")\\s*\\)?"),fe="[\\s|\\(]+(".concat(ve,")[,|\\s]+(").concat(ve,")[,|\\s]+(").concat(ve,")[,|\\s]+(").concat(ve,")\\s*\\)?"),he={CSS_UNIT:new RegExp(ve),rgb:new RegExp("rgb"+ee),rgba:new RegExp("rgba"+fe),hsl:new RegExp("hsl"+ee),hsla:new RegExp("hsla"+fe),hsv:new RegExp("hsv"+ee),hsva:new RegExp("hsva"+fe),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function at(mt){return!!he.CSS_UNIT.exec(String(mt))}},4369:(Nn,Ct,R)=>{"use strict";R.d(Ct,{q:()=>se});var M=R(4709),C=R(6681),de=R(4215),a=R(9785),se=function(){function ve(ee,fe){var he;if(void 0===ee&&(ee=""),void 0===fe&&(fe={}),ee instanceof ve)return ee;"number"==typeof ee&&(ee=(0,M.oS)(ee)),this.originalInput=ee;var ge=(0,de.RO)(ee);this.originalInput=ee,this.r=ge.r,this.g=ge.g,this.b=ge.b,this.a=ge.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(he=fe.format)&&void 0!==he?he:ge.format,this.gradientType=fe.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=ge.ok}return ve.prototype.isDark=function(){return this.getBrightness()<128},ve.prototype.isLight=function(){return!this.isDark()},ve.prototype.getBrightness=function(){var ee=this.toRgb();return(299*ee.r+587*ee.g+114*ee.b)/1e3},ve.prototype.getLuminance=function(){var ee=this.toRgb(),at=ee.r/255,mt=ee.g/255,$e=ee.b/255;return.2126*(at<=.03928?at/12.92:Math.pow((at+.055)/1.055,2.4))+.7152*(mt<=.03928?mt/12.92:Math.pow((mt+.055)/1.055,2.4))+.0722*($e<=.03928?$e/12.92:Math.pow(($e+.055)/1.055,2.4))},ve.prototype.getAlpha=function(){return this.a},ve.prototype.setAlpha=function(ee){return this.a=(0,a.TV)(ee),this.roundA=Math.round(100*this.a)/100,this},ve.prototype.isMonochrome=function(){return 0===this.toHsl().s},ve.prototype.toHsv=function(){var ee=(0,M.wE)(this.r,this.g,this.b);return{h:360*ee.h,s:ee.s,v:ee.v,a:this.a}},ve.prototype.toHsvString=function(){var ee=(0,M.wE)(this.r,this.g,this.b),fe=Math.round(360*ee.h),he=Math.round(100*ee.s),ge=Math.round(100*ee.v);return 1===this.a?"hsv(".concat(fe,", ").concat(he,"%, ").concat(ge,"%)"):"hsva(".concat(fe,", ").concat(he,"%, ").concat(ge,"%, ").concat(this.roundA,")")},ve.prototype.toHsl=function(){var ee=(0,M.K6)(this.r,this.g,this.b);return{h:360*ee.h,s:ee.s,l:ee.l,a:this.a}},ve.prototype.toHslString=function(){var ee=(0,M.K6)(this.r,this.g,this.b),fe=Math.round(360*ee.h),he=Math.round(100*ee.s),ge=Math.round(100*ee.l);return 1===this.a?"hsl(".concat(fe,", ").concat(he,"%, ").concat(ge,"%)"):"hsla(".concat(fe,", ").concat(he,"%, ").concat(ge,"%, ").concat(this.roundA,")")},ve.prototype.toHex=function(ee){return void 0===ee&&(ee=!1),(0,M.Ob)(this.r,this.g,this.b,ee)},ve.prototype.toHexString=function(ee){return void 0===ee&&(ee=!1),"#"+this.toHex(ee)},ve.prototype.toHex8=function(ee){return void 0===ee&&(ee=!1),(0,M.H)(this.r,this.g,this.b,this.a,ee)},ve.prototype.toHex8String=function(ee){return void 0===ee&&(ee=!1),"#"+this.toHex8(ee)},ve.prototype.toHexShortString=function(ee){return void 0===ee&&(ee=!1),1===this.a?this.toHexString(ee):this.toHex8String(ee)},ve.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},ve.prototype.toRgbString=function(){var ee=Math.round(this.r),fe=Math.round(this.g),he=Math.round(this.b);return 1===this.a?"rgb(".concat(ee,", ").concat(fe,", ").concat(he,")"):"rgba(".concat(ee,", ").concat(fe,", ").concat(he,", ").concat(this.roundA,")")},ve.prototype.toPercentageRgb=function(){var ee=function(fe){return"".concat(Math.round(100*(0,a.Cg)(fe,255)),"%")};return{r:ee(this.r),g:ee(this.g),b:ee(this.b),a:this.a}},ve.prototype.toPercentageRgbString=function(){var ee=function(fe){return Math.round(100*(0,a.Cg)(fe,255))};return 1===this.a?"rgb(".concat(ee(this.r),"%, ").concat(ee(this.g),"%, ").concat(ee(this.b),"%)"):"rgba(".concat(ee(this.r),"%, ").concat(ee(this.g),"%, ").concat(ee(this.b),"%, ").concat(this.roundA,")")},ve.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var ee="#"+(0,M.Ob)(this.r,this.g,this.b,!1),fe=0,he=Object.entries(C.D);fe<he.length;fe++){var ge=he[fe];if(ee===ge[1])return ge[0]}return!1},ve.prototype.toString=function(ee){var fe=!!ee;ee=ee??this.format;var he=!1;return!fe&&this.a<1&&this.a>=0&&(ee.startsWith("hex")||"name"===ee)?"name"===ee&&0===this.a?this.toName():this.toRgbString():("rgb"===ee&&(he=this.toRgbString()),"prgb"===ee&&(he=this.toPercentageRgbString()),("hex"===ee||"hex6"===ee)&&(he=this.toHexString()),"hex3"===ee&&(he=this.toHexString(!0)),"hex4"===ee&&(he=this.toHex8String(!0)),"hex8"===ee&&(he=this.toHex8String()),"name"===ee&&(he=this.toName()),"hsl"===ee&&(he=this.toHslString()),"hsv"===ee&&(he=this.toHsvString()),he||this.toHexString())},ve.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},ve.prototype.clone=function(){return new ve(this.toString())},ve.prototype.lighten=function(ee){void 0===ee&&(ee=10);var fe=this.toHsl();return fe.l+=ee/100,fe.l=(0,a.J$)(fe.l),new ve(fe)},ve.prototype.brighten=function(ee){void 0===ee&&(ee=10);var fe=this.toRgb();return fe.r=Math.max(0,Math.min(255,fe.r-Math.round(-ee/100*255))),fe.g=Math.max(0,Math.min(255,fe.g-Math.round(-ee/100*255))),fe.b=Math.max(0,Math.min(255,fe.b-Math.round(-ee/100*255))),new ve(fe)},ve.prototype.darken=function(ee){void 0===ee&&(ee=10);var fe=this.toHsl();return fe.l-=ee/100,fe.l=(0,a.J$)(fe.l),new ve(fe)},ve.prototype.tint=function(ee){return void 0===ee&&(ee=10),this.mix("white",ee)},ve.prototype.shade=function(ee){return void 0===ee&&(ee=10),this.mix("black",ee)},ve.prototype.desaturate=function(ee){void 0===ee&&(ee=10);var fe=this.toHsl();return fe.s-=ee/100,fe.s=(0,a.J$)(fe.s),new ve(fe)},ve.prototype.saturate=function(ee){void 0===ee&&(ee=10);var fe=this.toHsl();return fe.s+=ee/100,fe.s=(0,a.J$)(fe.s),new ve(fe)},ve.prototype.greyscale=function(){return this.desaturate(100)},ve.prototype.spin=function(ee){var fe=this.toHsl(),he=(fe.h+ee)%360;return fe.h=he<0?360+he:he,new ve(fe)},ve.prototype.mix=function(ee,fe){void 0===fe&&(fe=50);var he=this.toRgb(),ge=new ve(ee).toRgb(),at=fe/100;return new ve({r:(ge.r-he.r)*at+he.r,g:(ge.g-he.g)*at+he.g,b:(ge.b-he.b)*at+he.b,a:(ge.a-he.a)*at+he.a})},ve.prototype.analogous=function(ee,fe){void 0===ee&&(ee=6),void 0===fe&&(fe=30);var he=this.toHsl(),ge=360/fe,at=[this];for(he.h=(he.h-(ge*ee>>1)+720)%360;--ee;)he.h=(he.h+ge)%360,at.push(new ve(he));return at},ve.prototype.complement=function(){var ee=this.toHsl();return ee.h=(ee.h+180)%360,new ve(ee)},ve.prototype.monochromatic=function(ee){void 0===ee&&(ee=6);for(var fe=this.toHsv(),he=fe.h,ge=fe.s,at=fe.v,mt=[],$e=1/ee;ee--;)mt.push(new ve({h:he,s:ge,v:at})),at=(at+$e)%1;return mt},ve.prototype.splitcomplement=function(){var ee=this.toHsl(),fe=ee.h;return[this,new ve({h:(fe+72)%360,s:ee.s,l:ee.l}),new ve({h:(fe+216)%360,s:ee.s,l:ee.l})]},ve.prototype.onBackground=function(ee){var fe=this.toRgb(),he=new ve(ee).toRgb(),ge=fe.a+he.a*(1-fe.a);return new ve({r:(fe.r*fe.a+he.r*he.a*(1-fe.a))/ge,g:(fe.g*fe.a+he.g*he.a*(1-fe.a))/ge,b:(fe.b*fe.a+he.b*he.a*(1-fe.a))/ge,a:ge})},ve.prototype.triad=function(){return this.polyad(3)},ve.prototype.tetrad=function(){return this.polyad(4)},ve.prototype.polyad=function(ee){for(var fe=this.toHsl(),he=fe.h,ge=[this],at=360/ee,mt=1;mt<ee;mt++)ge.push(new ve({h:(he+mt*at)%360,s:fe.s,l:fe.l}));return ge},ve.prototype.equals=function(ee){return this.toRgbString()===new ve(ee).toRgbString()},ve}()},9785:(Nn,Ct,R)=>{"use strict";function M(ee,fe){(function de(ee){return"string"==typeof ee&&-1!==ee.indexOf(".")&&1===parseFloat(ee)})(ee)&&(ee="100%");var he=function a(ee){return"string"==typeof ee&&-1!==ee.indexOf("%")}(ee);return ee=360===fe?ee:Math.min(fe,Math.max(0,parseFloat(ee))),he&&(ee=parseInt(String(ee*fe),10)/100),Math.abs(ee-fe)<1e-6?1:ee=360===fe?(ee<0?ee%fe+fe:ee%fe)/parseFloat(String(fe)):ee%fe/parseFloat(String(fe))}function C(ee){return Math.min(1,Math.max(0,ee))}function se(ee){return ee=parseFloat(ee),(isNaN(ee)||ee<0||ee>1)&&(ee=1),ee}function Fe(ee){return ee<=1?"".concat(100*Number(ee),"%"):ee}function ve(ee){return 1===ee.length?"0"+ee:String(ee)}R.d(Ct,{Cg:()=>M,J$:()=>C,Px:()=>Fe,TV:()=>se,wl:()=>ve})},8771:(Nn,Ct,R)=>{"use strict";R.d(Ct,{n:()=>C});var M=R(467);class C{constructor(a,se,Fe){this.apiBase=a,this.httpClient=se,this.cookieService=Fe}get(a,se,Fe=!0){if(se)for(const ee of Object.keys(se))null==se[ee]&&delete se[ee];const ve=this.httpClient.get(this.apiBase+a,{params:se});return!1!==Fe?ve.toPromise():ve}getFile(a,se){var Fe=this;return(0,M.A)(function*(){return Fe.httpClient.get(Fe.apiBase+a,{params:se,responseType:"blob"}).toPromise()})()}getImageFile(a,se){var Fe=this;return(0,M.A)(function*(){return Fe.httpClient.get(Fe.apiBase+a,{params:se,responseType:"arraybuffer"}).toPromise()})()}getCsv(a,se){var Fe=this;return(0,M.A)(function*(){return se?Fe.httpClient.get(Fe.apiBase+a,{responseType:"text",params:se}).toPromise():Fe.httpClient.get(Fe.apiBase+a,{responseType:"text"}).toPromise()})()}post(a,se){var Fe=this;return(0,M.A)(function*(){return Fe.httpClient.post(Fe.apiBase+a,se).toPromise()})()}patch(a,se){var Fe=this;return(0,M.A)(function*(){return Fe.httpClient.patch(Fe.apiBase+a,se).toPromise()})()}put(a,se,Fe){var ve=this;return(0,M.A)(function*(){return ve.httpClient.put(ve.apiBase+a,se,{params:Fe}).toPromise()})()}delete(a,se){var Fe=this;return(0,M.A)(function*(){return Fe.httpClient.delete(Fe.apiBase+a,{params:se}).toPromise()})()}postFile(a,se,Fe){const ve=new FormData;if(ve.append("file",se),Fe)for(const ee of Object.keys(Fe))ve.append(ee,Fe[ee]);return this.httpClient.put(this.apiBase+a,ve,{reportProgress:!0,observe:"events"})}}},3366:(Nn,Ct,R)=>{"use strict";R.d(Ct,{G:()=>Fe});var M=R(5312),C=R(8771),de=R(4438),a=R(1626),se=R(2490);let Fe=(()=>{class ve extends C.n{constructor(fe,he){super(M.c.apiUrl,fe,he),this.httpClient=fe,this.cookieService=he}static{this.\u0275fac=function(he){return new(he||ve)(de.KVO(a.Qq),de.KVO(se.O))}}static{this.\u0275prov=de.jDH({token:ve,factory:ve.\u0275fac,providedIn:"root"})}}return ve})()},2956:(Nn,Ct,R)=>{"use strict";R.d(Ct,{u:()=>ge});var M=R(467),C=R(5312),de=R(4412),a=R(4438),se=R(8771),Fe=R(1626),ve=R(2490);let ee=(()=>{class at extends se.n{constructor($e,ze){super(C.c.authUrl,$e,ze),this.httpClient=$e,this.cookieService=ze}static{this.\u0275fac=function(ze){return new(ze||at)(a.KVO(Fe.Qq),a.KVO(ve.O))}}static{this.\u0275prov=a.jDH({token:at,factory:at.\u0275fac,providedIn:"root"})}}return at})();var fe=R(3366),he=R(7094);let ge=(()=>{class at{set user($e){this.userSubject.next($e)}get user(){return this.userSubject.value}constructor($e,ze,bt,xt){this.authApi=$e,this.apiService=ze,this.cookieService=bt,this.message=xt,this.userSubject=new de.t(null)}login($e,ze,bt){var xt=this;return(0,M.A)(function*(){return xt.authApi.post("/login",{email:$e,password:ze,recaptcha_token:bt})})()}setAccessToken($e,ze="/"){this.cookieService.set(C.c.acTokenCookieKey,$e,120,ze)}logout(){var $e=this;return(0,M.A)(function*(){yield $e.authApi.delete("/logout"),$e.cookieService.delete(C.c.acTokenCookieKey)})()}me($e=!1){var ze=this;return(0,M.A)(function*(){try{ze.cookieService.get(C.c.acTokenCookieKey)?($e||!ze.user)&&(ze.user=yield ze.apiService.get("/user/me")):ze.user=null}catch(bt){ze.user=null,ze.message.error(bt?.error?.detail?bt.error.detail:C.c.genericErrorMessage)}return ze.user})()}forgotPassword($e,ze=null){var bt=this;return(0,M.A)(function*(){return bt.apiService.post("/users/forgot-password",{email:$e,recaptcha_token:ze})})()}resetPassword($e,ze){var bt=this;return(0,M.A)(function*(){return bt.apiService.post("/users/reset-password",{token:$e,password:ze})})()}getSignOnUrl($e){var ze=this;return(0,M.A)(function*(){return ze.authApi.get("/azure-sso-url",{base_uri:$e})})()}aadLogin($e,ze){return this.authApi.get("/azure_AD_login",{token:$e,base_uri:ze})}publicCustomSignupPage($e){return this.apiService.get(`/signup-pages/${$e}`)}static{this.\u0275fac=function(ze){return new(ze||at)(a.KVO(ee),a.KVO(fe.G),a.KVO(ve.O),a.KVO(he.xh))}}static{this.\u0275prov=a.jDH({token:at,factory:at.\u0275fac,providedIn:"root"})}}return at})()},4077:(Nn,Ct,R)=>{"use strict";R.d(Ct,{R:()=>So});var C=1,de=2,a=3,Fe=5,ve=6378137,ee=6356752.314,fe=.0066943799901413165,he=484813681109536e-20,ge=Math.PI/2,ze=1e-10,bt=.017453292519943295,xt=57.29577951308232,Qt=Math.PI/4,sn=2*Math.PI,Yt=3.14159265359,Ut={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const et={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.01},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var It=/[\s_\-\/\(\)]/g;function zt(v,D){if(v[D])return v[D];for(var Te,F=Object.keys(v),oe=D.toLowerCase().replace(It,""),ne=-1;++ne<F.length;)if((Te=F[ne]).toLowerCase().replace(It,"")===oe)return v[Te]}function je(v){var oe,ne,Te,D={},F=v.split("+").map(function(ke){return ke.trim()}).filter(function(ke){return ke}).reduce(function(ke,pt){var Gt=pt.split("=");return Gt.push(!0),ke[Gt[0].toLowerCase()]=Gt[1],ke},{}),He={proj:"projName",datum:"datumCode",rf:function(ke){D.rf=parseFloat(ke)},lat_0:function(ke){D.lat0=ke*bt},lat_1:function(ke){D.lat1=ke*bt},lat_2:function(ke){D.lat2=ke*bt},lat_ts:function(ke){D.lat_ts=ke*bt},lon_0:function(ke){D.long0=ke*bt},lon_1:function(ke){D.long1=ke*bt},lon_2:function(ke){D.long2=ke*bt},alpha:function(ke){D.alpha=parseFloat(ke)*bt},gamma:function(ke){D.rectified_grid_angle=parseFloat(ke)},lonc:function(ke){D.longc=ke*bt},x_0:function(ke){D.x0=parseFloat(ke)},y_0:function(ke){D.y0=parseFloat(ke)},k_0:function(ke){D.k0=parseFloat(ke)},k:function(ke){D.k0=parseFloat(ke)},a:function(ke){D.a=parseFloat(ke)},b:function(ke){D.b=parseFloat(ke)},r:function(ke){D.a=D.b=parseFloat(ke)},r_a:function(){D.R_A=!0},zone:function(ke){D.zone=parseInt(ke,10)},south:function(){D.utmSouth=!0},towgs84:function(ke){D.datum_params=ke.split(",").map(function(pt){return parseFloat(pt)})},to_meter:function(ke){D.to_meter=parseFloat(ke)},units:function(ke){D.units=ke;var pt=zt(et,ke);pt&&(D.to_meter=pt.to_meter)},from_greenwich:function(ke){D.from_greenwich=ke*bt},pm:function(ke){var pt=zt(Ut,ke);D.from_greenwich=(pt||parseFloat(ke))*bt},nadgrids:function(ke){"@null"===ke?D.datumCode="none":D.nadgrids=ke},axis:function(ke){var pt="ewnsud";3===ke.length&&-1!==pt.indexOf(ke.substr(0,1))&&-1!==pt.indexOf(ke.substr(1,1))&&-1!==pt.indexOf(ke.substr(2,1))&&(D.axis=ke)},approx:function(){D.approx=!0}};for(oe in F)ne=F[oe],oe in He?"function"==typeof(Te=He[oe])?Te(ne):D[Te]=ne:D[oe]=ne;return"string"==typeof D.datumCode&&"WGS84"!==D.datumCode&&(D.datumCode=D.datumCode.toLowerCase()),D}const At=function un(v){return new Jt(v).output()};var Ze=1,nn=/\s/,di=/[A-Za-z]/,Wn=/[A-Za-z84_]/,$n=/[,\]]/,ki=/[\d\.E\-\+]/;function Jt(v){if("string"!=typeof v)throw new Error("not a string");this.text=v.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Ze}function pn(v,D,F){Array.isArray(D)&&(F.unshift(D),D=null);var ne=F.reduce(function(Te,He){return dn(He,Te),Te},D?{}:v);D&&(v[D]=ne)}function dn(v,D){if(Array.isArray(v)){var F=v.shift();if("PARAMETER"===F&&(F=v.shift()),1===v.length)return Array.isArray(v[0])?(D[F]={},void dn(v[0],D[F])):void(D[F]=v[0]);if(v.length)if("TOWGS84"!==F){if("AXIS"===F)return F in D||(D[F]=[]),void D[F].push(v);var oe;switch(Array.isArray(F)||(D[F]={}),F){case"UNIT":case"PRIMEM":case"VERT_DATUM":return D[F]={name:v[0].toLowerCase(),convert:v[1]},void(3===v.length&&dn(v[2],D[F]));case"SPHEROID":case"ELLIPSOID":return D[F]={name:v[0],a:v[1],rf:v[2]},void(4===v.length&&dn(v[3],D[F]));case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":return v[0]=["name",v[0]],void pn(D,F,v);case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":return v[0]=["name",v[0]],pn(D,F,v),void(D[F].type=F);default:for(oe=-1;++oe<v.length;)if(!Array.isArray(v[oe]))return dn(v,D[F]);return pn(D,F,v)}}else D[F]=v;else D[F]=!0}else D[v]=!0}Jt.prototype.readCharicter=function(){var v=this.text[this.place++];if(4!==this.state)for(;nn.test(v);){if(this.place>=this.text.length)return;v=this.text[this.place++]}switch(this.state){case Ze:return this.neutral(v);case 2:return this.keyword(v);case 4:return this.quoted(v);case 5:return this.afterquote(v);case 3:return this.number(v);case-1:return}},Jt.prototype.afterquote=function(v){if('"'===v)return this.word+='"',void(this.state=4);if($n.test(v))return this.word=this.word.trim(),void this.afterItem(v);throw new Error("havn't handled \""+v+'" in afterquote yet, index '+this.place)},Jt.prototype.afterItem=function(v){return","===v?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=Ze)):"]"===v?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=Ze,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Jt.prototype.number=function(v){if(!ki.test(v)){if($n.test(v))return this.word=parseFloat(this.word),void this.afterItem(v);throw new Error("havn't handled \""+v+'" in number yet, index '+this.place)}this.word+=v},Jt.prototype.quoted=function(v){'"'!==v?this.word+=v:this.state=5},Jt.prototype.keyword=function(v){if(Wn.test(v))this.word+=v;else{if("["===v){var D=[];return D.push(this.word),this.level++,null===this.root?this.root=D:this.currentObject.push(D),this.stack.push(this.currentObject),this.currentObject=D,void(this.state=Ze)}if(!$n.test(v))throw new Error("havn't handled \""+v+'" in keyword yet, index '+this.place);this.afterItem(v)}},Jt.prototype.neutral=function(v){if(di.test(v))return this.word=v,void(this.state=2);if('"'===v)return this.word="",void(this.state=4);if(ki.test(v))return this.word=v,void(this.state=3);if(!$n.test(v))throw new Error("havn't handled \""+v+'" in neutral yet, index '+this.place);this.afterItem(v)},Jt.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var jn=.017453292519943295,Yn=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function qn(v){return v*jn}function ar(v){for(var D=Object.keys(v),F=0,oe=D.length;F<oe;++F){var ne=D[F];-1!==Yn.indexOf(ne)&&Gi(v[ne]),"object"==typeof v[ne]&&ar(v[ne])}}function Gi(v){if(v.AUTHORITY){var D=Object.keys(v.AUTHORITY)[0];D&&D in v.AUTHORITY&&(v.title=D+":"+v.AUTHORITY[D])}if("GEOGCS"===v.type?v.projName="longlat":"LOCAL_CS"===v.type?(v.projName="identity",v.local=!0):v.projName="object"==typeof v.PROJECTION?Object.keys(v.PROJECTION)[0]:v.PROJECTION,v.AXIS){for(var F="",oe=0,ne=v.AXIS.length;oe<ne;++oe){var Te=[v.AXIS[oe][0].toLowerCase(),v.AXIS[oe][1].toLowerCase()];-1!==Te[0].indexOf("north")||("y"===Te[0]||"lat"===Te[0])&&"north"===Te[1]?F+="n":-1!==Te[0].indexOf("south")||("y"===Te[0]||"lat"===Te[0])&&"south"===Te[1]?F+="s":-1!==Te[0].indexOf("east")||("x"===Te[0]||"lon"===Te[0])&&"east"===Te[1]?F+="e":(-1!==Te[0].indexOf("west")||("x"===Te[0]||"lon"===Te[0])&&"west"===Te[1])&&(F+="w")}2===F.length&&(F+="u"),3===F.length&&(v.axis=F)}v.UNIT&&(v.units=v.UNIT.name.toLowerCase(),"metre"===v.units&&(v.units="meter"),v.UNIT.convert&&("GEOGCS"===v.type?v.DATUM&&v.DATUM.SPHEROID&&(v.to_meter=v.UNIT.convert*v.DATUM.SPHEROID.a):v.to_meter=v.UNIT.convert));var He=v.GEOGCS;function ke(Tn){return Tn*(v.to_meter||1)}"GEOGCS"===v.type&&(He=v),He&&(v.datumCode=He.DATUM?He.DATUM.name.toLowerCase():He.name.toLowerCase(),"d_"===v.datumCode.slice(0,2)&&(v.datumCode=v.datumCode.slice(2)),"new_zealand_1949"===v.datumCode&&(v.datumCode="nzgd49"),("wgs_1984"===v.datumCode||"world_geodetic_system_1984"===v.datumCode)&&("Mercator_Auxiliary_Sphere"===v.PROJECTION&&(v.sphere=!0),v.datumCode="wgs84"),"belge_1972"===v.datumCode&&(v.datumCode="rnb72"),He.DATUM&&He.DATUM.SPHEROID&&(v.ellps=He.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===v.ellps.toLowerCase().slice(0,13)&&(v.ellps="intl"),v.a=He.DATUM.SPHEROID.a,v.rf=parseFloat(He.DATUM.SPHEROID.rf,10)),He.DATUM&&He.DATUM.TOWGS84&&(v.datum_params=He.DATUM.TOWGS84),~v.datumCode.indexOf("osgb_1936")&&(v.datumCode="osgb36"),~v.datumCode.indexOf("osni_1952")&&(v.datumCode="osni52"),(~v.datumCode.indexOf("tm65")||~v.datumCode.indexOf("geodetic_datum_of_1965"))&&(v.datumCode="ire65"),"ch1903+"===v.datumCode&&(v.datumCode="ch1903"),~v.datumCode.indexOf("israel")&&(v.datumCode="isr93")),v.b&&!isFinite(v.b)&&(v.b=v.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",qn],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",qn],["x0","false_easting",ke],["y0","false_northing",ke],["long0","central_meridian",qn],["lat0","latitude_of_origin",qn],["lat0","standard_parallel_1",qn],["lat1","standard_parallel_1",qn],["lat2","standard_parallel_2",qn],["azimuth","Azimuth"],["alpha","azimuth",qn],["srsCode","name"]].forEach(function(Tn){return function zn(v,D){var F=D[0],oe=D[1];!(F in v)&&oe in v&&(v[F]=v[oe],3===D.length&&(v[F]=D[2](v[F])))}(v,Tn)}),!v.long0&&v.longc&&("Albers_Conic_Equal_Area"===v.projName||"Lambert_Azimuthal_Equal_Area"===v.projName)&&(v.long0=v.longc),v.lat_ts||!v.lat1||"Stereographic_South_Pole"!==v.projName&&"Polar Stereographic (variant B)"!==v.projName?!v.lat_ts&&v.lat0&&"Polar_Stereographic"===v.projName&&(v.lat_ts=v.lat0,v.lat0=qn(v.lat0>0?90:-90)):(v.lat0=qn(v.lat1>0?90:-90),v.lat_ts=v.lat1)}function Si(v){var D=At(v),F=D[0],oe={};return dn(D,oe),ar(oe),oe[F]}function Mi(v){var D=this;if(2===arguments.length){var F=arguments[1];Mi[v]="string"==typeof F?"+"===F.charAt(0)?je(arguments[1]):Si(arguments[1]):F}else if(1===arguments.length){if(Array.isArray(v))return v.map(function(oe){Array.isArray(oe)?Mi.apply(D,oe):Mi(oe)});if("string"==typeof v){if(v in Mi)return Mi[v]}else"EPSG"in v?Mi["EPSG:"+v.EPSG]=v:"ESRI"in v?Mi["ESRI:"+v.ESRI]=v:"IAU2000"in v?Mi["IAU2000:"+v.IAU2000]=v:console.log(v);return}}!function M(v){v("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),v("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),v("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var D=1;D<=60;++D)v("EPSG:"+(32600+D),"+proj=utm +zone="+D+" +datum=WGS84 +units=m"),v("EPSG:"+(32700+D),"+proj=utm +zone="+D+" +south +datum=WGS84 +units=m");v.WGS84=v["EPSG:4326"],v["EPSG:3785"]=v["EPSG:3857"],v.GOOGLE=v["EPSG:3857"],v["EPSG:900913"]=v["EPSG:3857"],v["EPSG:102113"]=v["EPSG:3857"]}(Mi);const Br=Mi;var Bt=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],Dn=["3857","900913","3785","102113"];function ye(v,D){var F,oe;if(v=v||{},!D)return v;for(oe in D)void 0!==(F=D[oe])&&(v[oe]=F);return v}function Ve(v,D,F){var oe=v*D;return F/Math.sqrt(1-oe*oe)}function gt(v){return v<0?-1:1}function wt(v){return Math.abs(v)<=Yt?v:v-gt(v)*sn}function en(v,D,F){var oe=v*F;return oe=Math.pow((1-oe)/(1+oe),.5*v),Math.tan(.5*(ge-D))/oe}function hn(v,D){for(var oe,ne,F=.5*v,Te=ge-2*Math.atan(D),He=0;He<=15;He++)if(oe=v*Math.sin(Te),Te+=ne=ge-2*Math.atan(D*Math.pow((1-oe)/(1+oe),F))-Te,Math.abs(ne)<=1e-10)return Te;return-9999}function Pe(v){return v}var Oe=[{init:function si(){var v=this.b/this.a;this.es=1-v*v,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):Ve(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},forward:function Hi(v){var oe,ne,D=v.x,F=v.y;if(F*xt>90&&F*xt<-90&&D*xt>180&&D*xt<-180)return null;if(Math.abs(Math.abs(F)-ge)<=ze)return null;if(this.sphere)oe=this.x0+this.a*this.k0*wt(D-this.long0),ne=this.y0+this.a*this.k0*Math.log(Math.tan(Qt+.5*F));else{var Te=Math.sin(F),He=en(this.e,F,Te);oe=this.x0+this.a*this.k0*wt(D-this.long0),ne=this.y0-this.a*this.k0*Math.log(He)}return v.x=oe,v.y=ne,v},inverse:function ti(v){var oe,ne,D=v.x-this.x0,F=v.y-this.y0;if(this.sphere)ne=ge-2*Math.atan(Math.exp(-F/(this.a*this.k0)));else{var Te=Math.exp(-F/(this.a*this.k0));if(-9999===(ne=hn(this.e,Te)))return null}return oe=wt(this.long0+D/(this.a*this.k0)),v.x=oe,v.y=ne,v},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function lt(){},forward:Pe,inverse:Pe,names:["longlat","identity"]}],Ke={},Et=[];function Ie(v,D){var F=Et.length;return v.names?(Et[F]=v,v.names.forEach(function(oe){Ke[oe.toLowerCase()]=F}),this):(console.log(D),!0)}const Y={start:function Z(){Oe.forEach(Ie)},add:Ie,get:function ae(v){if(!v)return!1;var D=v.toLowerCase();return typeof Ke[D]<"u"&&Et[Ke[D]]?Et[Ke[D]]:void 0}};var _e={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},re=_e.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};_e.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Cn={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};for(var ni in Cn){var xi=Cn[ni];Cn[xi.datumName]=xi}const sr=Cn;var eo={};function Do(v){if(0===v.length)return null;var D="@"===v[0];return D&&(v=v.slice(1)),"null"===v?{name:"null",mandatory:!D,grid:null,isNull:!0}:{name:v,mandatory:!D,grid:eo[v]||null,isNull:!1}}function Or(v){return v/3600*Math.PI/180}function fr(v,D,F){return String.fromCharCode.apply(null,new Uint8Array(v.buffer.slice(D,F)))}function fo(v){return v.map(function(D){return[Or(D.longitudeShift),Or(D.latitudeShift)]})}function oo(v,D,F){return{name:fr(v,D+8,D+16).trim(),parent:fr(v,D+24,D+24+8).trim(),lowerLatitude:v.getFloat64(D+72,F),upperLatitude:v.getFloat64(D+88,F),lowerLongitude:v.getFloat64(D+104,F),upperLongitude:v.getFloat64(D+120,F),latitudeInterval:v.getFloat64(D+136,F),longitudeInterval:v.getFloat64(D+152,F),gridNodeCount:v.getInt32(D+168,F)}}function so(v,D,F,oe){for(var ne=D+176,He=[],ke=0;ke<F.gridNodeCount;ke++){var pt={latitudeShift:v.getFloat32(ne+16*ke,oe),longitudeShift:v.getFloat32(ne+16*ke+4,oe),latitudeAccuracy:v.getFloat32(ne+16*ke+8,oe),longitudeAccuracy:v.getFloat32(ne+16*ke+12,oe)};He.push(pt)}return He}function ci(v,D){if(!(this instanceof ci))return new ci(v);D=D||function(Gt){if(Gt)throw Gt};var F=function st(v){if(!function ji(v){return"string"==typeof v}(v))return v;if(function Ln(v){return v in Br}(v))return Br[v];if(function jt(v){return Bt.some(function(D){return v.indexOf(D)>-1})}(v)){var D=Si(v);if(function Ai(v){var D=zt(v,"authority");if(D){var F=zt(D,"epsg");return F&&Dn.indexOf(F)>-1}}(D))return Br["EPSG:3857"];var F=function Sn(v){var D=zt(v,"extension");if(D)return zt(D,"proj4")}(D);return F?je(F):D}return function On(v){return"+"===v[0]}(v)?je(v):void 0}(v);if("object"==typeof F){var oe=ci.projections.get(F.projName);if(oe){if(F.datumCode&&"none"!==F.datumCode){var ne=zt(sr,F.datumCode);ne&&(F.datum_params=F.datum_params||(ne.towgs84?ne.towgs84.split(","):null),F.ellps=ne.ellipse,F.datumName=ne.datumName?ne.datumName:F.datumCode)}F.k0=F.k0||1,F.axis=F.axis||"enu",F.ellps=F.ellps||"wgs84",F.lat1=F.lat1||F.lat0;var Te=function Pt(v,D,F,oe,ne){if(!v){var Te=zt(_e,oe);Te||(Te=re),v=Te.a,D=Te.b,F=Te.rf}return F&&!D&&(D=(1-1/F)*v),(0===F||Math.abs(v-D)<ze)&&(ne=!0,D=v),{a:v,b:D,rf:F,sphere:ne}}(F.a,F.b,F.rf,F.ellps,F.sphere),He=function Je(v,D,F,oe){var ne=v*v,Te=D*D,He=(ne-Te)/ne,ke=0;return oe?(ne=(v*=1-He*(.16666666666666666+He*(.04722222222222222+.022156084656084655*He)))*v,He=0):ke=Math.sqrt(He),{es:He,e:ke,ep2:(ne-Te)/Te}}(Te.a,Te.b,0,F.R_A),ke=function Ci(v){return void 0===v?null:v.split(",").map(Do)}(F.nadgrids),pt=F.datum||function Cr(v,D,F,oe,ne,Te,He){var ke={};return ke.datum_type=void 0===v||"none"===v?Fe:4,D&&(ke.datum_params=D.map(parseFloat),(0!==ke.datum_params[0]||0!==ke.datum_params[1]||0!==ke.datum_params[2])&&(ke.datum_type=C),ke.datum_params.length>3&&(0!==ke.datum_params[3]||0!==ke.datum_params[4]||0!==ke.datum_params[5]||0!==ke.datum_params[6])&&(ke.datum_type=de,ke.datum_params[3]*=he,ke.datum_params[4]*=he,ke.datum_params[5]*=he,ke.datum_params[6]=ke.datum_params[6]/1e6+1)),He&&(ke.datum_type=a,ke.grids=He),ke.a=F,ke.b=oe,ke.es=ne,ke.ep2=Te,ke}(F.datumCode,F.datum_params,Te.a,Te.b,He.es,He.ep2,ke);ye(this,F),ye(this,oe),this.a=Te.a,this.b=Te.b,this.rf=Te.rf,this.sphere=Te.sphere,this.es=He.es,this.e=He.e,this.ep2=He.ep2,this.datum=pt,this.init(),D(null,this)}else D("Could not get projection name from: "+v)}else D("Could not parse to valid json: "+v)}(ci.projections=Y).start();const mo=ci;function Uo(v,D,F){var He,ke,Gt,oe=v.x,ne=v.y,Te=v.z?v.z:0;if(ne<-ge&&ne>-1.001*ge)ne=-ge;else if(ne>ge&&ne<1.001*ge)ne=ge;else{if(ne<-ge)return{x:-1/0,y:-1/0,z:v.z};if(ne>ge)return{x:1/0,y:1/0,z:v.z}}return oe>Math.PI&&(oe-=2*Math.PI),ke=Math.sin(ne),Gt=Math.cos(ne),{x:((He=F/Math.sqrt(1-D*(ke*ke)))+Te)*Gt*Math.cos(oe),y:(He+Te)*Gt*Math.sin(oe),z:(He*(1-D)+Te)*ke}}function nt(v,D,F,oe){var ke,pt,Gt,Tn,ln,Bn,_i,ui,Di,Bi,Er,lo,go,$s,fa,Bo=v.x,To=v.y,Ao=v.z?v.z:0;if(ke=Math.sqrt(Bo*Bo+To*To),pt=Math.sqrt(Bo*Bo+To*To+Ao*Ao),ke/F<1e-12){if($s=0,pt/F<1e-12)return fa=-oe,{x:v.x,y:v.y,z:v.z}}else $s=Math.atan2(To,Bo);Gt=Ao/pt,ui=(Tn=ke/pt)*(1-D)*(ln=1/Math.sqrt(1-D*(2-D)*Tn*Tn)),Di=Gt*ln,go=0;do{go++,Bn=D*(_i=F/Math.sqrt(1-D*Di*Di))/(_i+(fa=ke*ui+Ao*Di-_i*(1-D*Di*Di))),lo=(Er=Gt*(ln=1/Math.sqrt(1-Bn*(2-Bn)*Tn*Tn)))*ui-(Bi=Tn*(1-Bn)*ln)*Di,ui=Bi,Di=Er}while(lo*lo>1e-24&&go<30);return{x:$s,y:Math.atan(Er/Math.abs(Bi)),z:fa}}function ht(v){return v===C||v===de}function Xn(v,D,F){if(null===v.grids||0===v.grids.length)return console.log("Grid shift grids not found"),-1;var oe={x:-F.x,y:F.y},ne={x:Number.NaN,y:Number.NaN},He=[];e:for(var ke=0;ke<v.grids.length;ke++){var pt=v.grids[ke];if(He.push(pt.name),pt.isNull){ne=oe;break}if(null!==pt.grid)for(var Gt=pt.grid.subgrids,Tn=0,ln=Gt.length;Tn<ln;Tn++){var Bn=Gt[Tn],_i=(Math.abs(Bn.del[1])+Math.abs(Bn.del[0]))/1e4;if(!(Bn.ll[1]-_i>oe.y||Bn.ll[0]-_i>oe.x||Bn.ll[1]+(Bn.lim[1]-1)*Bn.del[1]+_i<oe.y||Bn.ll[0]+(Bn.lim[0]-1)*Bn.del[0]+_i<oe.x||(ne=Zn(oe,D,Bn),isNaN(ne.x))))break e}else if(pt.mandatory)return console.log("Unable to find mandatory grid '"+pt.name+"'"),-1}return isNaN(ne.x)?(console.log("Failed to find a grid shift table for location '"+-oe.x*xt+" "+oe.y*xt+" tried: '"+He+"'"),-1):(F.x=-ne.x,F.y=ne.y,0)}function Zn(v,D,F){var oe={x:Number.NaN,y:Number.NaN};if(isNaN(v.x))return oe;var ne={x:v.x,y:v.y};ne.x-=F.ll[0],ne.y-=F.ll[1],ne.x=wt(ne.x-Math.PI)+Math.PI;var Te=Ei(ne,F);if(D){if(isNaN(Te.x))return oe;Te.x=ne.x-Te.x,Te.y=ne.y-Te.y;var pt,Gt,He=9;do{if(Gt=Ei(Te,F),isNaN(Gt.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}Te.x+=(pt={x:ne.x-(Gt.x+Te.x),y:ne.y-(Gt.y+Te.y)}).x,Te.y+=pt.y}while(He--&&Math.abs(pt.x)>1e-12&&Math.abs(pt.y)>1e-12);if(He<0)return console.log("Inverse grid shift iterator failed to converge."),oe;oe.x=wt(Te.x+F.ll[0]),oe.y=Te.y+F.ll[1]}else isNaN(Te.x)||(oe.x=v.x+Te.x,oe.y=v.y+Te.y);return oe}function Ei(v,D){var He,F={x:v.x/D.del[0],y:v.y/D.del[1]},oe_x=Math.floor(F.x),oe_y=Math.floor(F.y),ne_x=F.x-1*oe_x,ne_y=F.y-1*oe_y,Te={x:Number.NaN,y:Number.NaN};if(oe_x<0||oe_x>=D.lim[0]||oe_y<0||oe_y>=D.lim[1])return Te;var ke_x=D.cvs[He=oe_y*D.lim[0]+oe_x][0],ke_y=D.cvs[He][1];He++;var pt_x=D.cvs[He][0],pt_y=D.cvs[He][1],Gt_x=D.cvs[He+=D.lim[0]][0],Gt_y=D.cvs[He][1];He--;var Tn_y=D.cvs[He][1],ln=ne_x*ne_y,Bn=ne_x*(1-ne_y),_i=(1-ne_x)*(1-ne_y),ui=(1-ne_x)*ne_y;return Te.x=_i*ke_x+Bn*pt_x+ui*D.cvs[He][0]+ln*Gt_x,Te.y=_i*ke_y+Bn*pt_y+ui*Tn_y+ln*Gt_y,Te}function An(v,D,F){var He,ke,pt,oe=F.x,ne=F.y,Te=F.z||0,Gt={};for(pt=0;pt<3;pt++)if(!D||2!==pt||void 0!==F.z)switch(0===pt?(He=oe,ke=-1!=="ew".indexOf(v.axis[pt])?"x":"y"):1===pt?(He=ne,ke=-1!=="ns".indexOf(v.axis[pt])?"y":"x"):(He=Te,ke="z"),v.axis[pt]){case"e":case"n":Gt[ke]=He;break;case"w":case"s":Gt[ke]=-He;break;case"u":void 0!==F[ke]&&(Gt.z=He);break;case"d":void 0!==F[ke]&&(Gt.z=-He);break;default:return null}return Gt}function no(v){var D={x:v[0],y:v[1]};return v.length>2&&(D.z=v[2]),v.length>3&&(D.m=v[3]),D}function Mr(v){if("function"==typeof Number.isFinite){if(Number.isFinite(v))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof v||v!=v||!isFinite(v))throw new TypeError("coordinates must be finite numbers")}function vi(v,D,F,oe){var ne,Te=void 0!==(F=Array.isArray(F)?no(F):{x:F.x,y:F.y,z:F.z,m:F.m}).z;if(function lr(v){Mr(v.x),Mr(v.y)}(F),v.datum&&D.datum&&function ii(v,D){return(v.datum.datum_type===C||v.datum.datum_type===de||v.datum.datum_type===a)&&"WGS84"!==D.datumCode||(D.datum.datum_type===C||D.datum.datum_type===de||D.datum.datum_type===a)&&"WGS84"!==v.datumCode}(v,D)&&(F=vi(v,ne=new mo("WGS84"),F,oe),v=ne),oe&&"enu"!==v.axis&&(F=An(v,!1,F)),"longlat"===v.projName)F={x:F.x*bt,y:F.y*bt,z:F.z||0};else if(v.to_meter&&(F={x:F.x*v.to_meter,y:F.y*v.to_meter,z:F.z||0}),!(F=v.inverse(F)))return;if(v.from_greenwich&&(F.x+=v.from_greenwich),F=function xn(v,D,F){if(function yr(v,D){return!(v.datum_type!==D.datum_type||v.a!==D.a||Math.abs(v.es-D.es)>5e-11)&&(v.datum_type===C?v.datum_params[0]===D.datum_params[0]&&v.datum_params[1]===D.datum_params[1]&&v.datum_params[2]===D.datum_params[2]:v.datum_type!==de||v.datum_params[0]===D.datum_params[0]&&v.datum_params[1]===D.datum_params[1]&&v.datum_params[2]===D.datum_params[2]&&v.datum_params[3]===D.datum_params[3]&&v.datum_params[4]===D.datum_params[4]&&v.datum_params[5]===D.datum_params[5]&&v.datum_params[6]===D.datum_params[6])}(v,D)||v.datum_type===Fe||D.datum_type===Fe)return F;var oe=v.a,ne=v.es;if(v.datum_type===a){if(0!==Xn(v,!1,F))return;oe=ve,ne=fe}var He=D.a,ke=D.b,pt=D.es;return D.datum_type===a&&(He=ve,ke=ee,pt=fe),ne!==pt||oe!==He||ht(v.datum_type)||ht(D.datum_type)?(F=Uo(F,ne,oe),ht(v.datum_type)&&(F=function Ft(v,D,F){if(D===C)return{x:v.x+F[0],y:v.y+F[1],z:v.z+F[2]};if(D===de){var He=F[3],ke=F[4],pt=F[5],Gt=F[6];return{x:Gt*(v.x-pt*v.y+ke*v.z)+F[0],y:Gt*(pt*v.x+v.y-He*v.z)+F[1],z:Gt*(-ke*v.x+He*v.y+v.z)+F[2]}}}(F,v.datum_type,v.datum_params)),ht(D.datum_type)&&(F=function Tt(v,D,F){if(D===C)return{x:v.x-F[0],y:v.y-F[1],z:v.z-F[2]};if(D===de){var He=F[3],ke=F[4],pt=F[5],Gt=F[6],Tn=(v.x-F[0])/Gt,ln=(v.y-F[1])/Gt,Bn=(v.z-F[2])/Gt;return{x:Tn+pt*ln-ke*Bn,y:-pt*Tn+ln+He*Bn,z:ke*Tn-He*ln+Bn}}}(F,D.datum_type,D.datum_params)),F=nt(F,pt,He,ke),D.datum_type!==a||0===Xn(D,!0,F)?F:void 0):F}(v.datum,D.datum,F))return D.from_greenwich&&(F={x:F.x-D.from_greenwich,y:F.y,z:F.z||0}),"longlat"===D.projName?F={x:F.x*xt,y:F.y*xt,z:F.z||0}:(F=D.forward(F),D.to_meter&&(F={x:F.x/D.to_meter,y:F.y/D.to_meter,z:F.z||0})),oe&&"enu"!==D.axis?An(D,!0,F):(F&&!Te&&delete F.z,F)}var Ui=mo("WGS84");function ur(v,D,F,oe){var ne,Te,He;return Array.isArray(F)?(ne=vi(v,D,F,oe)||{x:NaN,y:NaN},F.length>2?typeof v.name<"u"&&"geocent"===v.name||typeof D.name<"u"&&"geocent"===D.name?"number"==typeof ne.z?[ne.x,ne.y,ne.z].concat(F.slice(3)):[ne.x,ne.y,F[2]].concat(F.slice(3)):[ne.x,ne.y].concat(F.slice(2)):[ne.x,ne.y]):(Te=vi(v,D,F,oe),2===(He=Object.keys(F)).length||He.forEach(function(ke){if(typeof v.name<"u"&&"geocent"===v.name||typeof D.name<"u"&&"geocent"===D.name){if("x"===ke||"y"===ke||"z"===ke)return}else if("x"===ke||"y"===ke)return;Te[ke]=F[ke]}),Te)}function Ri(v){return v instanceof mo?v:v.oProj?v.oProj:mo(v)}const nr=function Oi(v,D,F){v=Ri(v);var ne,oe=!1;return typeof D>"u"?(D=v,v=Ui,oe=!0):(typeof D.x<"u"||Array.isArray(D))&&(F=D,D=v,v=Ui,oe=!0),D=Ri(D),F?ur(v,D,F):(ne={forward:function(Te,He){return ur(v,D,Te,He)},inverse:function(Te,He){return ur(D,v,Te,He)}},oe&&(ne.oProj=D),ne)};var mr=6,io="AJSAJS",yo="AFAFAF",Ji=65,Zi=73,hr=79,oa=86,jo=90;const gl={forward:ol,inverse:function Ga(v){var D=Rr(_s(v.toUpperCase()));return D.lat&&D.lon?[D.lon,D.lat,D.lon,D.lat]:[D.left,D.bottom,D.right,D.top]},toPoint:qs};function ol(v,D){return D=D||5,function Wa(v,D){var F="00000"+v.easting,oe="00000"+v.northing;return v.zoneNumber+v.zoneLetter+function gs(v,D,F){var oe=$o(F);return function vs(v,D,F){var oe=F-1,ne=io.charCodeAt(oe),Te=yo.charCodeAt(oe),He=ne+v-1,ke=Te+D,pt=!1;return He>jo&&(He=He-jo+Ji-1,pt=!0),(He===Zi||ne<Zi&&He>Zi||(He>Zi||ne<Zi)&&pt)&&He++,(He===hr||ne<hr&&He>hr||(He>hr||ne<hr)&&pt)&&++He===Zi&&He++,He>jo&&(He=He-jo+Ji-1),ke>oa?(ke=ke-oa+Ji-1,pt=!0):pt=!1,(ke===Zi||Te<Zi&&ke>Zi||(ke>Zi||Te<Zi)&&pt)&&ke++,(ke===hr||Te<hr&&ke>hr||(ke>hr||Te<hr)&&pt)&&++ke===Zi&&ke++,ke>oa&&(ke=ke-oa+Ji-1),String.fromCharCode(He)+String.fromCharCode(ke)}(Math.floor(v/1e5),Math.floor(D/1e5)%20,oe)}(v.easting,v.northing,v.zoneNumber)+F.substr(F.length-5,D)+oe.substr(oe.length-5,D)}(function Yo(v){var ke,pt,Gt,Tn,ln,Di,Bi,D=v.lat,F=v.lon,ne=.00669438,_i=Dr(D),ui=Dr(F);Bi=Math.floor((F+180)/6)+1,180===F&&(Bi=60),D>=56&&D<64&&F>=3&&F<12&&(Bi=32),D>=72&&D<84&&(F>=0&&F<9?Bi=31:F>=9&&F<21?Bi=33:F>=21&&F<33?Bi=35:F>=33&&F<42&&(Bi=37)),Di=Dr(6*(Bi-1)-180+3),ke=ne/(1-ne),pt=6378137/Math.sqrt(1-ne*Math.sin(_i)*Math.sin(_i)),Gt=Math.tan(_i)*Math.tan(_i),Tn=ke*Math.cos(_i)*Math.cos(_i);var Er=.9996*pt*((ln=Math.cos(_i)*(ui-Di))+(1-Gt+Tn)*ln*ln*ln/6+(5-18*Gt+Gt*Gt+72*Tn-58*ke)*ln*ln*ln*ln*ln/120)+5e5,lo=.9996*(6378137*(.9983242984503243*_i-.002514607064228144*Math.sin(2*_i)+2639046602129982e-21*Math.sin(4*_i)-35*ne*ne*ne/3072*Math.sin(6*_i))+pt*Math.tan(_i)*(ln*ln/2+(5-Gt+9*Tn+4*Tn*Tn)*ln*ln*ln*ln/24+(61-58*Gt+Gt*Gt+600*Tn-330*ke)*ln*ln*ln*ln*ln*ln/720));return D<0&&(lo+=1e7),{northing:Math.round(lo),easting:Math.round(Er),zoneNumber:Bi,zoneLetter:Zs(D)}}({lat:v[1],lon:v[0]}),D)}function qs(v){var D=Rr(_s(v.toUpperCase()));return D.lat&&D.lon?[D.lon,D.lat]:[(D.left+D.right)/2,(D.top+D.bottom)/2]}function Dr(v){return v*(Math.PI/180)}function Ps(v){return v/Math.PI*180}function Rr(v){var D=v.northing,F=v.easting,oe=v.zoneLetter,ne=v.zoneNumber;if(ne<0||ne>60)return null;var pt,Tn,ln,Bn,_i,ui,Bi,Er,lo,ke=.00669438,Gt=(1-Math.sqrt(1-ke))/(1+Math.sqrt(1-ke)),go=F-5e5,Bo=D;oe<"N"&&(Bo-=1e7),Bi=6*(ne-1)-180+3,pt=ke/(1-ke),lo=(Er=Bo/.9996/6367449.145945056)+(3*Gt/2-27*Gt*Gt*Gt/32)*Math.sin(2*Er)+(21*Gt*Gt/16-55*Gt*Gt*Gt*Gt/32)*Math.sin(4*Er)+151*Gt*Gt*Gt/96*Math.sin(6*Er),Tn=6378137/Math.sqrt(1-ke*Math.sin(lo)*Math.sin(lo)),ln=Math.tan(lo)*Math.tan(lo),Bn=pt*Math.cos(lo)*Math.cos(lo),_i=6378137*(1-ke)/Math.pow(1-ke*Math.sin(lo)*Math.sin(lo),1.5),ui=go/(.9996*Tn);var To=lo-Tn*Math.tan(lo)/_i*(ui*ui/2-(5+3*ln+10*Bn-4*Bn*Bn-9*pt)*ui*ui*ui*ui/24+(61+90*ln+298*Bn+45*ln*ln-252*pt-3*Bn*Bn)*ui*ui*ui*ui*ui*ui/720);To=Ps(To);var $s,Ao=(ui-(1+2*ln+Bn)*ui*ui*ui/6+(5-2*Bn+28*ln-3*Bn*Bn+8*pt+24*ln*ln)*ui*ui*ui*ui*ui/120)/Math.cos(lo);if(Ao=Bi+Ps(Ao),v.accuracy){var ts=Rr({northing:v.northing+v.accuracy,easting:v.easting+v.accuracy,zoneLetter:v.zoneLetter,zoneNumber:v.zoneNumber});$s={top:ts.lat,right:ts.lon,bottom:To,left:Ao}}else $s={lat:To,lon:Ao};return $s}function Zs(v){var D="Z";return 84>=v&&v>=72?D="X":72>v&&v>=64?D="W":64>v&&v>=56?D="V":56>v&&v>=48?D="U":48>v&&v>=40?D="T":40>v&&v>=32?D="S":32>v&&v>=24?D="R":24>v&&v>=16?D="Q":16>v&&v>=8?D="P":8>v&&v>=0?D="N":0>v&&v>=-8?D="M":-8>v&&v>=-16?D="L":-16>v&&v>=-24?D="K":-24>v&&v>=-32?D="J":-32>v&&v>=-40?D="H":-40>v&&v>=-48?D="G":-48>v&&v>=-56?D="F":-56>v&&v>=-64?D="E":-64>v&&v>=-72?D="D":-72>v&&v>=-80&&(D="C"),D}function $o(v){var D=v%mr;return 0===D&&(D=mr),D}function _s(v){if(v&&0===v.length)throw"MGRSPoint coverting from nothing";for(var ne,D=v.length,F=null,oe="",Te=0;!/[A-Z]/.test(ne=v.charAt(Te));){if(Te>=2)throw"MGRSPoint bad conversion from: "+v;oe+=ne,Te++}var He=parseInt(oe,10);if(0===Te||Te+3>D)throw"MGRSPoint bad conversion from: "+v;var ke=v.charAt(Te++);if(ke<="A"||"B"===ke||"Y"===ke||ke>="Z"||"I"===ke||"O"===ke)throw"MGRSPoint zone letter "+ke+" not handled: "+v;F=v.substring(Te,Te+=2);for(var pt=$o(He),Gt=function xo(v,D){for(var F=io.charCodeAt(D-1),oe=1e5,ne=!1;F!==v.charCodeAt(0);){if(++F===Zi&&F++,F===hr&&F++,F>jo){if(ne)throw"Bad character: "+v;F=Ji,ne=!0}oe+=1e5}return oe}(F.charAt(0),pt),Tn=function ga(v,D){if(v>"V")throw"MGRSPoint given invalid Northing "+v;for(var F=yo.charCodeAt(D-1),oe=0,ne=!1;F!==v.charCodeAt(0);){if(++F===Zi&&F++,F===hr&&F++,F>oa){if(ne)throw"Bad character: "+v;F=Ji,ne=!0}oe+=1e5}return oe}(F.charAt(1),pt);Tn<Da(ke);)Tn+=2e6;var ln=D-Te;if(ln%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+v;var Di,Bi,Er,Bn=ln/2,_i=0,ui=0;return Bn>0&&(Di=1e5/Math.pow(10,Bn),Bi=v.substring(Te,Te+Bn),_i=parseFloat(Bi)*Di,Er=v.substring(Te+Bn),ui=parseFloat(Er)*Di),{easting:_i+Gt,northing:ui+Tn,zoneLetter:ke,zoneNumber:He,accuracy:Di}}function Da(v){var D;switch(v){case"C":D=11e5;break;case"D":D=2e6;break;case"E":D=28e5;break;case"F":D=37e5;break;case"G":D=46e5;break;case"H":D=55e5;break;case"J":D=64e5;break;case"K":D=73e5;break;case"L":D=82e5;break;case"M":D=91e5;break;case"N":D=0;break;case"P":D=8e5;break;case"Q":D=17e5;break;case"R":D=26e5;break;case"S":D=35e5;break;case"T":D=44e5;break;case"U":D=53e5;break;case"V":D=62e5;break;case"W":D=7e6;break;case"X":D=79e5;break;default:D=-1}if(D>=0)return D;throw"Invalid zone letter: "+v}function Io(v,D,F){if(!(this instanceof Io))return new Io(v,D,F);if(Array.isArray(v))this.x=v[0],this.y=v[1],this.z=v[2]||0;else if("object"==typeof v)this.x=v.x,this.y=v.y,this.z=v.z||0;else if("string"==typeof v&&typeof D>"u"){var oe=v.split(",");this.x=parseFloat(oe[0],10),this.y=parseFloat(oe[1],10),this.z=parseFloat(oe[2],10)||0}else this.x=v,this.y=D,this.z=F||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Io.fromMGRS=function(v){return new Io(qs(v))},Io.prototype.toMGRS=function(v){return ol([this.x,this.y],v)};const po=Io;var vo=.01953125,zs=.01068115234375;function Is(v){var D=[];D[0]=1-v*(.25+v*(.046875+v*(vo+v*zs))),D[1]=v*(.75-v*(.046875+v*(vo+v*zs)));var F=v*v;return D[2]=F*(.46875-v*(.013020833333333334+.007120768229166667*v)),D[3]=(F*=v)*(.3645833333333333-.005696614583333333*v),D[4]=F*v*.3076171875,D}function Xo(v,D,F,oe){return oe[0]*v-(F*=D)*(oe[1]+(D*=D)*(oe[2]+D*(oe[3]+D*oe[4])))}var Ka=20;function Qs(v,D,F){for(var oe=1/(1-D),ne=v,Te=Ka;Te;--Te){var He=Math.sin(ne),ke=1-D*He*He;if(ne-=ke=(Xo(ne,He,Math.cos(ne),F)-v)*(ke*Math.sqrt(ke))*oe,Math.abs(ke)<ze)return ne}return ne}const rs={init:function Sa(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Is(this.es),this.ml0=Xo(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function ca(v){var ne,Te,He,F=v.y,oe=wt(v.x-this.long0),ke=Math.sin(F),pt=Math.cos(F);if(this.es){var Tn=pt*oe,ln=Math.pow(Tn,2),Bn=this.ep2*Math.pow(pt,2),_i=Math.pow(Bn,2),ui=Math.abs(pt)>ze?Math.tan(F):0,Di=Math.pow(ui,2),Bi=Math.pow(Di,2);ne=1-this.es*Math.pow(ke,2),Tn/=Math.sqrt(ne);var Er=Xo(F,ke,pt,this.en);Te=this.a*(this.k0*Tn*(1+ln/6*(1-Di+Bn+ln/20*(5-18*Di+Bi+14*Bn-58*Di*Bn+ln/42*(61+179*Bi-Bi*Di-479*Di)))))+this.x0,He=this.a*(this.k0*(Er-this.ml0+ke*oe*Tn/2*(1+ln/12*(5-Di+9*Bn+4*_i+ln/30*(61+Bi-58*Di+270*Bn-330*Di*Bn+ln/56*(1385+543*Bi-Bi*Di-3111*Di))))))+this.y0}else{var Gt=pt*Math.sin(oe);if(Math.abs(Math.abs(Gt)-1)<ze)return 93;if(Te=.5*this.a*this.k0*Math.log((1+Gt)/(1-Gt))+this.x0,He=pt*Math.cos(oe)/Math.sqrt(1-Math.pow(Gt,2)),(Gt=Math.abs(He))>=1){if(Gt-1>ze)return 93;He=0}else He=Math.acos(He);F<0&&(He=-He),He=this.a*this.k0*(He-this.lat0)+this.y0}return v.x=Te,v.y=He,v},inverse:function qa(v){var D,F,oe,ne,Te=1/this.a*(v.x-this.x0),He=1/this.a*(v.y-this.y0);if(this.es)if(F=Qs(D=this.ml0+He/this.k0,this.es,this.en),Math.abs(F)<ge){var ln=Math.sin(F),Bn=Math.cos(F),_i=Math.abs(Bn)>ze?Math.tan(F):0,ui=this.ep2*Math.pow(Bn,2),Di=Math.pow(ui,2),Bi=Math.pow(_i,2),Er=Math.pow(Bi,2);D=1-this.es*Math.pow(ln,2);var lo=Te*Math.sqrt(D)/this.k0,go=Math.pow(lo,2);oe=F-(D*=_i)*go/(1-this.es)*.5*(1-go/12*(5+3*Bi-9*ui*Bi+ui-4*Di-go/30*(61+90*Bi-252*ui*Bi+45*Er+46*ui-go/56*(1385+3633*Bi+4095*Er+1574*Er*Bi)))),ne=wt(this.long0+lo*(1-go/6*(1+2*Bi+ui-go/20*(5+28*Bi+24*Er+8*ui*Bi+6*ui-go/42*(61+662*Bi+1320*Er+720*Er*Bi))))/Bn)}else oe=ge*gt(He),ne=0;else{var ke=Math.exp(Te/this.k0),pt=.5*(ke-1/ke),Tn=Math.cos(this.lat0+He/this.k0);D=Math.sqrt((1-Math.pow(Tn,2))/(1+Math.pow(pt,2))),oe=Math.asin(D),He<0&&(oe=-oe),ne=0===pt&&0===Tn?0:wt(Math.atan2(pt,Tn)+this.long0)}return v.x=ne,v.y=oe,v},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function ya(v){var D=Math.exp(v);return(D-1/D)/2}function br(v,D){v=Math.abs(v),D=Math.abs(D);var F=Math.max(v,D),oe=Math.min(v,D)/(F||1);return F*Math.sqrt(1+Math.pow(oe,2))}function Xa(v,D){for(var He,F=2*Math.cos(2*D),oe=v.length-1,ne=v[oe],Te=0;--oe>=0;)He=F*ne-Te+v[oe],Te=ne,ne=He;return D+He*Math.sin(2*D)}function Lo(v,D,F){for(var ui,Di,oe=Math.sin(D),ne=Math.cos(D),Te=ya(F),He=function Na(v){var D=Math.exp(v);return(D+1/D)/2}(F),ke=2*ne*He,pt=-2*oe*Te,Gt=v.length-1,Tn=v[Gt],ln=0,Bn=0,_i=0;--Gt>=0;)ui=Bn,Di=ln,Tn=ke*(Bn=Tn)-ui-pt*(ln=_i)+v[Gt],_i=pt*Bn-Di+ke*ln;return[(ke=oe*He)*Tn-(pt=ne*Te)*_i,ke*_i+pt*Tn]}const Eo={init:function ks(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(rs.init.apply(this),this.forward=rs.forward,this.inverse=rs.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var v=this.es/(1+Math.sqrt(1-this.es)),D=v/(2-v),F=D;this.cgb[0]=D*(2+D*(-2/3+D*(D*(116/45+D*(26/45+D*(-2854/675)))-2))),this.cbg[0]=D*(D*(2/3+D*(4/3+D*(-82/45+D*(32/45+D*(4642/4725)))))-2),this.cgb[1]=(F*=D)*(7/3+D*(D*(-227/45+D*(2704/315+D*(2323/945)))-1.6)),this.cbg[1]=F*(5/3+D*(-16/15+D*(-13/9+D*(904/315+D*(-1522/945))))),this.cgb[2]=(F*=D)*(56/15+D*(-136/35+D*(-1262/105+D*(73814/2835)))),this.cbg[2]=F*(-26/15+D*(34/21+D*(1.6+D*(-12686/2835)))),this.cgb[3]=(F*=D)*(4279/630+D*(-332/35+D*(-399572/14175))),this.cbg[3]=F*(1237/630+D*(D*(-24832/14175)-2.4)),this.cgb[4]=(F*=D)*(4174/315+D*(-144838/6237)),this.cbg[4]=F*(-734/315+D*(109598/31185)),this.cgb[5]=(F*=D)*(601676/22275),this.cbg[5]=F*(444337/155925),F=Math.pow(D,2),this.Qn=this.k0/(1+D)*(1+F*(1/4+F*(1/64+F/256))),this.utg[0]=D*(D*(2/3+D*(-37/96+D*(1/360+D*(81/512+D*(-96199/604800)))))-.5),this.gtu[0]=D*(.5+D*(-2/3+D*(5/16+D*(41/180+D*(-127/288+D*(7891/37800)))))),this.utg[1]=F*(-1/48+D*(-1/15+D*(437/1440+D*(-46/105+D*(1118711/3870720))))),this.gtu[1]=F*(13/48+D*(D*(557/1440+D*(281/630+D*(-1983433/1935360)))-.6)),this.utg[2]=(F*=D)*(-17/480+D*(37/840+D*(209/4480+D*(-5569/90720)))),this.gtu[2]=F*(61/240+D*(-103/140+D*(15061/26880+D*(167603/181440)))),this.utg[3]=(F*=D)*(-4397/161280+D*(11/504+D*(830251/7257600))),this.gtu[3]=F*(49561/161280+D*(-179/168+D*(6601661/7257600))),this.utg[4]=(F*=D)*(-4583/161280+D*(108847/3991680)),this.gtu[4]=F*(34729/80640+D*(-3418889/1995840)),this.utg[5]=(F*=D)*(-20648693/638668800),this.gtu[5]=.6650675310896665*F;var oe=Xa(this.cbg,this.lat0);this.Zb=-this.Qn*(oe+function Ts(v,D){for(var He,F=2*Math.cos(D),oe=v.length-1,ne=v[oe],Te=0;--oe>=0;)He=F*ne-Te+v[oe],Te=ne,ne=He;return Math.sin(D)*He}(this.gtu,2*oe))},forward:function ys(v){var D=wt(v.x-this.long0),F=v.y;F=Xa(this.cbg,F);var oe=Math.sin(F),ne=Math.cos(F),Te=Math.sin(D),He=Math.cos(D);F=Math.atan2(oe,He*ne),D=Math.atan2(Te*ne,br(oe,ne*He)),D=function Za(v){var D=Math.abs(v);return D=function Fa(v){var D=1+v,F=D-1;return 0===F?v:v*Math.log(D)/F}(D*(1+D/(br(1,D)+1))),v<0?-D:D}(Math.tan(D));var pt,Gt,ke=Lo(this.gtu,2*F,2*D);return F+=ke[0],D+=ke[1],Math.abs(D)<=2.623395162778?(pt=this.a*(this.Qn*D)+this.x0,Gt=this.a*(this.Qn*F+this.Zb)+this.y0):(pt=1/0,Gt=1/0),v.x=pt,v.y=Gt,v},inverse:function xs(v){var oe,ne,D=1/this.a*(v.x-this.x0),F=1/this.a*(v.y-this.y0);if(F=(F-this.Zb)/this.Qn,D/=this.Qn,Math.abs(D)<=2.623395162778){var Te=Lo(this.utg,2*F,2*D);F+=Te[0],D+=Te[1],D=Math.atan(ya(D));var He=Math.sin(F),ke=Math.cos(F),pt=Math.sin(D),Gt=Math.cos(D);F=Math.atan2(He*Gt,br(pt,Gt*ke)),oe=wt((D=Math.atan2(pt,Gt*ke))+this.long0),ne=Xa(this.cgb,F)}else oe=1/0,ne=1/0;return v.x=oe,v.y=ne,v},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"]},Js={init:function Aa(){var v=function Kr(v,D){if(void 0===v){if((v=Math.floor(30*(wt(D)+Math.PI)/Math.PI)+1)<0)return 0;if(v>60)return 60}return v}(this.zone,this.long0);if(void 0===v)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(v)-183)*bt,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Eo.init.apply(this),this.forward=Eo.forward,this.inverse=Eo.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function Hs(v,D){return Math.pow((1-v)/(1+v),D)}const ua={init:function Wo(){var v=Math.sin(this.lat0),D=Math.cos(this.lat0);D*=D,this.rc=Math.sqrt(1-this.es)/(1-this.es*v*v),this.C=Math.sqrt(1+this.es*D*D/(1-this.es)),this.phic0=Math.asin(v/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Qt)/(Math.pow(Math.tan(.5*this.lat0+Qt),this.C)*Hs(this.e*v,this.ratexp))},forward:function Hr(v){var D=v.x,F=v.y;return v.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*F+Qt),this.C)*Hs(this.e*Math.sin(F),this.ratexp))-ge,v.x=this.C*D,v},inverse:function Ba(v){for(var F=v.x/this.C,oe=v.y,ne=Math.pow(Math.tan(.5*oe+Qt)/this.K,1/this.C),Te=20;Te>0&&(oe=2*Math.atan(ne*Hs(this.e*Math.sin(v.y),-.5*this.e))-ge,!(Math.abs(oe-v.y)<1e-14));--Te)v.y=oe;return Te?(v.x=F,v.y=oe,v):null},names:["gauss"]},vl={init:function xa(){ua.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function Os(v){var D,F,oe,ne;return v.x=wt(v.x-this.long0),ua.forward.apply(this,[v]),D=Math.sin(v.y),F=Math.cos(v.y),oe=Math.cos(v.x),v.x=(ne=this.k0*this.R2/(1+this.sinc0*D+this.cosc0*F*oe))*F*Math.sin(v.x),v.y=ne*(this.cosc0*D-this.sinc0*F*oe),v.x=this.a*v.x+this.x0,v.y=this.a*v.y+this.y0,v},inverse:function Pl(v){var D,F,oe,ne,Te;if(v.x=(v.x-this.x0)/this.a,v.y=(v.y-this.y0)/this.a,v.x/=this.k0,v.y/=this.k0,Te=br(v.x,v.y)){var He=2*Math.atan2(Te,this.R2);D=Math.sin(He),F=Math.cos(He),ne=Math.asin(F*this.sinc0+v.y*D*this.cosc0/Te),oe=Math.atan2(v.x*D,Te*this.cosc0*F-v.y*this.sinc0*D)}else ne=this.phic0,oe=0;return v.x=oe,v.y=ne,ua.inverse.apply(this,[v]),v.x=wt(v.x+this.long0),v},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},Fi={init:function Ae(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ze&&(this.k0=.5*(1+gt(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ze&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ze&&Math.abs(Math.cos(this.lat_ts))>ze&&(this.k0=.5*this.cons*Ve(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/en(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Ve(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-ge,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function K(v){var Te,He,ke,pt,Gt,Tn,D=v.x,F=v.y,oe=Math.sin(F),ne=Math.cos(F),ln=wt(D-this.long0);return Math.abs(Math.abs(D-this.long0)-Math.PI)<=ze&&Math.abs(F+this.lat0)<=ze?(v.x=NaN,v.y=NaN,v):this.sphere?(Te=2*this.k0/(1+this.sinlat0*oe+this.coslat0*ne*Math.cos(ln)),v.x=this.a*Te*ne*Math.sin(ln)+this.x0,v.y=this.a*Te*(this.coslat0*oe-this.sinlat0*ne*Math.cos(ln))+this.y0,v):(He=2*Math.atan(this.ssfn_(F,oe,this.e))-ge,pt=Math.cos(He),ke=Math.sin(He),Math.abs(this.coslat0)<=ze?(Gt=en(this.e,F*this.con,this.con*oe),v.x=this.x0+(Tn=2*this.a*this.k0*Gt/this.cons)*Math.sin(D-this.long0),v.y=this.y0-this.con*Tn*Math.cos(D-this.long0),v):(Math.abs(this.sinlat0)<ze?(Te=2*this.a*this.k0/(1+pt*Math.cos(ln)),v.y=Te*ke):(Te=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*ke+this.cosX0*pt*Math.cos(ln))),v.y=Te*(this.cosX0*ke-this.sinX0*pt*Math.cos(ln))+this.y0),v.x=Te*pt*Math.sin(ln)+this.x0,v))},inverse:function Ge(v){v.x-=this.x0,v.y-=this.y0;var D,F,ne,Te,He=Math.sqrt(v.x*v.x+v.y*v.y);if(this.sphere){var ke=2*Math.atan(He/(2*this.a*this.k0));return D=this.long0,F=this.lat0,He<=ze?(v.x=D,v.y=F,v):(F=Math.asin(Math.cos(ke)*this.sinlat0+v.y*Math.sin(ke)*this.coslat0/He),D=Math.abs(this.coslat0)<ze?wt(this.lat0>0?this.long0+Math.atan2(v.x,-1*v.y):this.long0+Math.atan2(v.x,v.y)):wt(this.long0+Math.atan2(v.x*Math.sin(ke),He*this.coslat0*Math.cos(ke)-v.y*this.sinlat0*Math.sin(ke))),v.x=D,v.y=F,v)}if(Math.abs(this.coslat0)<=ze){if(He<=ze)return F=this.lat0,v.x=D=this.long0,v.y=F,v;v.x*=this.con,v.y*=this.con,F=this.con*hn(this.e,He*this.cons/(2*this.a*this.k0)),D=this.con*wt(this.con*this.long0+Math.atan2(v.x,-1*v.y))}else ne=2*Math.atan(He*this.cosX0/(2*this.a*this.k0*this.ms1)),D=this.long0,He<=ze?Te=this.X0:(Te=Math.asin(Math.cos(ne)*this.sinX0+v.y*Math.sin(ne)*this.cosX0/He),D=wt(this.long0+Math.atan2(v.x*Math.sin(ne),He*this.cosX0*Math.cos(ne)-v.y*this.sinX0*Math.sin(ne)))),F=-1*hn(this.e,Math.tan(.5*(ge+Te)));return v.x=D,v.y=F,v},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],ssfn_:function be(v,D,F){return D*=F,Math.tan(.5*(ge+v))*Math.pow((1-D)/(1+D),.5*F)}},Ja={init:function Sr(){var v=this.lat0;this.lambda0=this.long0;var D=Math.sin(v),F=this.a,ne=1/this.rf,Te=2*ne-Math.pow(ne,2),He=this.e=Math.sqrt(Te);this.R=this.k0*F*Math.sqrt(1-Te)/(1-Te*Math.pow(D,2)),this.alpha=Math.sqrt(1+Te/(1-Te)*Math.pow(Math.cos(v),4)),this.b0=Math.asin(D/this.alpha);var ke=Math.log(Math.tan(Math.PI/4+this.b0/2)),pt=Math.log(Math.tan(Math.PI/4+v/2)),Gt=Math.log((1+He*D)/(1-He*D));this.K=ke-this.alpha*pt+this.alpha*He/2*Gt},forward:function Yr(v){var D=Math.log(Math.tan(Math.PI/4-v.y/2)),F=this.e/2*Math.log((1+this.e*Math.sin(v.y))/(1-this.e*Math.sin(v.y))),ne=2*(Math.atan(Math.exp(-this.alpha*(D+F)+this.K))-Math.PI/4),Te=this.alpha*(v.x-this.lambda0),He=Math.atan(Math.sin(Te)/(Math.sin(this.b0)*Math.tan(ne)+Math.cos(this.b0)*Math.cos(Te))),ke=Math.asin(Math.cos(this.b0)*Math.sin(ne)-Math.sin(this.b0)*Math.cos(ne)*Math.cos(Te));return v.y=this.R/2*Math.log((1+Math.sin(ke))/(1-Math.sin(ke)))+this.y0,v.x=this.R*He+this.x0,v},inverse:function ea(v){for(var oe=(v.x-this.x0)/this.R,ne=2*(Math.atan(Math.exp((v.y-this.y0)/this.R))-Math.PI/4),Te=Math.asin(Math.cos(this.b0)*Math.sin(ne)+Math.sin(this.b0)*Math.cos(ne)*Math.cos(oe)),He=Math.atan(Math.sin(oe)/(Math.cos(this.b0)*Math.cos(oe)-Math.sin(this.b0)*Math.tan(ne))),ke=this.lambda0+He/this.alpha,pt=0,Gt=Te,Tn=-1e3,ln=0;Math.abs(Gt-Tn)>1e-7;){if(++ln>20)return;pt=1/this.alpha*(Math.log(Math.tan(Math.PI/4+Te/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(Gt))/2)),Tn=Gt,Gt=2*Math.atan(Math.exp(pt))-Math.PI/2}return v.x=ke,v.y=Gt,v},names:["somerc"]};var Us=1e-7;const zl={init:function Pa(){var v,D,F,oe,ne,Te,He,ke,pt,Gt,ln,Tn=0,Bn=0,_i=0,ui=0,Di=0,Bi=0,Er=0;this.no_off=function Bl(v){var F="object"==typeof v.PROJECTION?Object.keys(v.PROJECTION)[0]:v.PROJECTION;return"no_uoff"in v||"no_off"in v||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(F)}(this),this.no_rot="no_rot"in this;var go=!1;"alpha"in this&&(go=!0);var Bo=!1;if("rectified_grid_angle"in this&&(Bo=!0),go&&(Er=this.alpha),Bo&&(Tn=this.rectified_grid_angle*bt),go||Bo)Bn=this.longc;else if(_i=this.long1,Di=this.lat1,ui=this.long2,Bi=this.lat2,Math.abs(Di-Bi)<=Us||(v=Math.abs(Di))<=Us||Math.abs(v-ge)<=Us||Math.abs(Math.abs(this.lat0)-ge)<=Us||Math.abs(Math.abs(Bi)-ge)<=Us)throw new Error;var To=1-this.es;D=Math.sqrt(To),Math.abs(this.lat0)>ze?(ke=Math.sin(this.lat0),F=Math.cos(this.lat0),v=1-this.es*ke*ke,this.B=F*F,this.B=Math.sqrt(1+this.es*this.B*this.B/To),this.A=this.B*this.k0*D/v,(ne=(oe=this.B*D/(F*Math.sqrt(v)))*oe-1)<=0?ne=0:(ne=Math.sqrt(ne),this.lat0<0&&(ne=-ne)),this.E=ne+=oe,this.E*=Math.pow(en(this.e,this.lat0,ke),this.B)):(this.B=1/D,this.A=this.k0,this.E=oe=ne=1),go||Bo?(go?(ln=Math.asin(Math.sin(Er)/oe),Bo||(Tn=Er)):(ln=Tn,Er=Math.asin(oe*Math.sin(ln))),this.lam0=Bn-Math.asin(.5*(ne-1/ne)*Math.tan(ln))/this.B):(Te=Math.pow(en(this.e,Di,Math.sin(Di)),this.B),He=Math.pow(en(this.e,Bi,Math.sin(Bi)),this.B),ne=this.E/Te,pt=(He-Te)/(He+Te),Gt=((Gt=this.E*this.E)-He*Te)/(Gt+He*Te),(v=_i-ui)<-Math.pi?ui-=sn:v>Math.pi&&(ui+=sn),this.lam0=wt(.5*(_i+ui)-Math.atan(Gt*Math.tan(.5*this.B*(_i-ui))/pt)/this.B),ln=Math.atan(2*Math.sin(this.B*wt(_i-this.lam0))/(ne-1/ne)),Tn=Er=Math.asin(oe*Math.sin(ln))),this.singam=Math.sin(ln),this.cosgam=Math.cos(ln),this.sinrot=Math.sin(Tn),this.cosrot=Math.cos(Tn),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(oe*oe-1)/Math.cos(Er))),this.lat0<0&&(this.u_0=-this.u_0)),ne=.5*ln,this.v_pole_n=this.ArB*Math.log(Math.tan(Qt-ne)),this.v_pole_s=this.ArB*Math.log(Math.tan(Qt+ne))},forward:function Hl(v){var F,oe,ne,Te,He,ke,pt,Gt,D={};if(v.x=v.x-this.lam0,Math.abs(Math.abs(v.y)-ge)>ze){if(F=.5*((He=this.E/Math.pow(en(this.e,v.y,Math.sin(v.y)),this.B))-(ke=1/He)),oe=.5*(He+ke),Te=Math.sin(this.B*v.x),ne=(F*this.singam-Te*this.cosgam)/oe,Math.abs(Math.abs(ne)-1)<ze)throw new Error;Gt=.5*this.ArB*Math.log((1-ne)/(1+ne)),ke=Math.cos(this.B*v.x),pt=Math.abs(ke)<Us?this.A*v.x:this.ArB*Math.atan2(F*this.cosgam+Te*this.singam,ke)}else Gt=v.y>0?this.v_pole_n:this.v_pole_s,pt=this.ArB*v.y;return this.no_rot?(D.x=pt,D.y=Gt):(D.x=Gt*this.cosrot+(pt-=this.u_0)*this.sinrot,D.y=pt*this.cosrot-Gt*this.sinrot),D.x=this.a*D.x+this.x0,D.y=this.a*D.y+this.y0,D},inverse:function Ul(v){var D,F,oe,ne,Te,He,ke,pt={};if(v.x=1/this.a*(v.x-this.x0),v.y=1/this.a*(v.y-this.y0),this.no_rot?(F=v.y,D=v.x):(F=v.x*this.cosrot-v.y*this.sinrot,D=v.y*this.cosrot+v.x*this.sinrot+this.u_0),ne=.5*((oe=Math.exp(-this.BrA*F))-1/oe),Te=.5*(oe+1/oe),ke=((He=Math.sin(this.BrA*D))*this.cosgam+ne*this.singam)/Te,Math.abs(Math.abs(ke)-1)<ze)pt.x=0,pt.y=ke<0?-ge:ge;else{if(pt.y=this.E/Math.sqrt((1+ke)/(1-ke)),pt.y=hn(this.e,Math.pow(pt.y,1/this.B)),pt.y===1/0)throw new Error;pt.x=-this.rB*Math.atan2(ne*this.cosgam-He*this.singam,Math.cos(this.BrA*D))}return pt.x+=this.lam0,pt},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},Ro={init:function el(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ze)){var v=this.b/this.a;this.e=Math.sqrt(1-v*v);var D=Math.sin(this.lat1),F=Math.cos(this.lat1),oe=Ve(this.e,D,F),ne=en(this.e,this.lat1,D),Te=Math.sin(this.lat2),He=Math.cos(this.lat2),ke=Ve(this.e,Te,He),pt=en(this.e,this.lat2,Te),Gt=en(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>ze?Math.log(oe/ke)/Math.log(ne/pt):D,isNaN(this.ns)&&(this.ns=D),this.f0=oe/(this.ns*Math.pow(ne,this.ns)),this.rh=this.a*this.f0*Math.pow(Gt,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function nc(v){var D=v.x,F=v.y;Math.abs(2*Math.abs(F)-Math.PI)<=ze&&(F=gt(F)*(ge-2*ze));var ne,Te,oe=Math.abs(Math.abs(F)-ge);if(oe>ze)ne=en(this.e,F,Math.sin(F)),Te=this.a*this.f0*Math.pow(ne,this.ns);else{if((oe=F*this.ns)<=0)return null;Te=0}var He=this.ns*wt(D-this.long0);return v.x=this.k0*(Te*Math.sin(He))+this.x0,v.y=this.k0*(this.rh-Te*Math.cos(He))+this.y0,v},inverse:function Gr(v){var D,F,oe,ne,Te,He=(v.x-this.x0)/this.k0,ke=this.rh-(v.y-this.y0)/this.k0;this.ns>0?(D=Math.sqrt(He*He+ke*ke),F=1):(D=-Math.sqrt(He*He+ke*ke),F=-1);var pt=0;if(0!==D&&(pt=Math.atan2(F*He,F*ke)),0!==D||this.ns>0){if(F=1/this.ns,oe=Math.pow(D/(this.a*this.f0),F),-9999===(ne=hn(this.e,oe)))return null}else ne=-ge;return Te=wt(pt/this.ns+this.long0),v.x=Te,v.y=ne,v},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]},al={init:function cs(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function Es(v){var D,F,oe,ne,Te,He,ke,Gt=v.y,Tn=wt(v.x-this.long0);return D=Math.pow((1+this.e*Math.sin(Gt))/(1-this.e*Math.sin(Gt)),this.alfa*this.e/2),F=2*(Math.atan(this.k*Math.pow(Math.tan(Gt/2+this.s45),this.alfa)/D)-this.s45),oe=-Tn*this.alfa,ne=Math.asin(Math.cos(this.ad)*Math.sin(F)+Math.sin(this.ad)*Math.cos(F)*Math.cos(oe)),Te=Math.asin(Math.cos(F)*Math.sin(oe)/Math.cos(ne)),He=this.n*Te,ke=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(ne/2+this.s45),this.n),v.y=ke*Math.cos(He)/1,v.x=ke*Math.sin(He)/1,this.czech||(v.y*=-1,v.x*=-1),v},inverse:function Zl(v){var D,F,oe,ne,He,ke,pt,Gt=v.x;v.x=v.y,v.y=Gt,this.czech||(v.y*=-1,v.x*=-1),He=Math.sqrt(v.x*v.x+v.y*v.y),ne=Math.atan2(v.y,v.x)/Math.sin(this.s0),oe=2*(Math.atan(Math.pow(this.ro0/He,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),D=Math.asin(Math.cos(this.ad)*Math.sin(oe)-Math.sin(this.ad)*Math.cos(oe)*Math.cos(ne)),F=Math.asin(Math.cos(oe)*Math.sin(ne)/Math.cos(D)),v.x=this.long0-F/this.alfa,ke=D,pt=0;var Tn=0;do{v.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(D/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(ke))/(1-this.e*Math.sin(ke)),this.e/2))-this.s45),Math.abs(ke-v.y)<1e-10&&(pt=1),ke=v.y,Tn+=1}while(0===pt&&Tn<15);return Tn>=15?null:v},names:["Krovak","krovak"]};function bs(v,D,F,oe,ne){return v*ne-D*Math.sin(2*ne)+F*Math.sin(4*ne)-oe*Math.sin(6*ne)}function kl(v){return 1-.25*v*(1+v/16*(3+1.25*v))}function za(v){return.375*v*(1+.25*v*(1+.46875*v))}function _l(v){return.05859375*v*v*(1+.75*v)}function Ls(v){return v*v*v*(35/3072)}function yl(v,D,F){var oe=D*F;return v/Math.sqrt(1-oe*oe)}function Ia(v){return Math.abs(v)<ge?v:v-gt(v)*Math.PI}function Ne(v,D,F,oe,ne){var Te,He;Te=v/D;for(var ke=0;ke<15;ke++)if(Te+=He=(v-(D*Te-F*Math.sin(2*Te)+oe*Math.sin(4*Te)-ne*Math.sin(6*Te)))/(D-2*F*Math.cos(2*Te)+4*oe*Math.cos(4*Te)-6*ne*Math.cos(6*Te)),Math.abs(He)<=1e-10)return Te;return NaN}const ot={init:function N(){this.sphere||(this.e0=kl(this.es),this.e1=za(this.es),this.e2=_l(this.es),this.e3=Ls(this.es),this.ml0=this.a*bs(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function V(v){var D,F,oe=v.x,ne=v.y;if(oe=wt(oe-this.long0),this.sphere)D=this.a*Math.asin(Math.cos(ne)*Math.sin(oe)),F=this.a*(Math.atan2(Math.tan(ne),Math.cos(oe))-this.lat0);else{var Te=Math.sin(ne),He=Math.cos(ne),ke=yl(this.a,this.e,Te),pt=Math.tan(ne)*Math.tan(ne),Gt=oe*Math.cos(ne),Tn=Gt*Gt,ln=this.es*He*He/(1-this.es);D=ke*Gt*(1-Tn*pt*(1/6-(8-pt+8*ln)*Tn/120)),F=this.a*bs(this.e0,this.e1,this.e2,this.e3,ne)-this.ml0+ke*Te/He*Tn*(.5+(5-pt+6*ln)*Tn/24)}return v.x=D+this.x0,v.y=F+this.y0,v},inverse:function te(v){v.x-=this.x0,v.y-=this.y0;var oe,ne,D=v.x/this.a,F=v.y/this.a;if(this.sphere){var Te=F+this.lat0;oe=Math.asin(Math.sin(Te)*Math.cos(D)),ne=Math.atan2(Math.tan(D),Math.cos(Te))}else{var ke=Ne(this.ml0/this.a+F,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(ke)-ge)<=ze)return v.x=this.long0,v.y=ge,F<0&&(v.y*=-1),v;var pt=yl(this.a,this.e,Math.sin(ke)),Gt=pt*pt*pt/this.a/this.a*(1-this.es),Tn=Math.pow(Math.tan(ke),2),ln=D*this.a/pt,Bn=ln*ln;oe=ke-pt*Math.tan(ke)/Gt*ln*ln*(.5-(1+3*Tn)*ln*ln/24),ne=ln*(1-Bn*(Tn/3+(1+3*Tn)*Tn*Bn/15))/Math.cos(ke)}return v.x=wt(ne+this.long0),v.y=Ia(oe),v},names:["Cassini","Cassini_Soldner","cass"]};function Lt(v,D){var F;return v>1e-7?(1-v*v)*(D/(1-(F=v*D)*F)-.5/v*Math.log((1-F)/(1+F))):2*D}const W={init:function Yi(){var D,v=Math.abs(this.lat0);if(this.mode=Math.abs(v-ge)<ze?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(v)<ze?this.EQUIT:this.OBLIQ,this.es>0)switch(this.qp=Lt(this.e,1),this.mmf=.5/(1-this.es),this.apa=function De(v){var D,F=[];return F[0]=.3333333333333333*v,F[0]+=.17222222222222222*(D=v*v),F[1]=.06388888888888888*D,F[0]+=.10257936507936508*(D*=v),F[1]+=.0664021164021164*D,F[2]=.016415012942191543*D,F}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),D=Math.sin(this.lat0),this.sinb1=Lt(this.e,D)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*D*D)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function $r(v){var D,F,oe,ne,Te,He,ke,pt,Gt,Tn,ln=v.x,Bn=v.y;if(ln=wt(ln-this.long0),this.sphere){if(Te=Math.sin(Bn),Tn=Math.cos(Bn),oe=Math.cos(ln),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((F=this.mode===this.EQUIT?1+Tn*oe:1+this.sinph0*Te+this.cosph0*Tn*oe)<=ze)return null;D=(F=Math.sqrt(2/F))*Tn*Math.sin(ln),F*=this.mode===this.EQUIT?Te:this.cosph0*Te-this.sinph0*Tn*oe}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(oe=-oe),Math.abs(Bn+this.lat0)<ze)return null;F=Qt-.5*Bn,D=(F=2*(this.mode===this.S_POLE?Math.cos(F):Math.sin(F)))*Math.sin(ln),F*=oe}}else{switch(ke=0,pt=0,Gt=0,oe=Math.cos(ln),ne=Math.sin(ln),Te=Math.sin(Bn),He=Lt(this.e,Te),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(ke=He/this.qp,pt=Math.sqrt(1-ke*ke)),this.mode){case this.OBLIQ:Gt=1+this.sinb1*ke+this.cosb1*pt*oe;break;case this.EQUIT:Gt=1+pt*oe;break;case this.N_POLE:Gt=ge+Bn,He=this.qp-He;break;case this.S_POLE:Gt=Bn-ge,He=this.qp+He}if(Math.abs(Gt)<ze)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:Gt=Math.sqrt(2/Gt),F=this.mode===this.OBLIQ?this.ymf*Gt*(this.cosb1*ke-this.sinb1*pt*oe):(Gt=Math.sqrt(2/(1+pt*oe)))*ke*this.ymf,D=this.xmf*Gt*pt*ne;break;case this.N_POLE:case this.S_POLE:He>=0?(D=(Gt=Math.sqrt(He))*ne,F=oe*(this.mode===this.S_POLE?Gt:-Gt)):D=F=0}}return v.x=this.a*D+this.x0,v.y=this.a*F+this.y0,v},inverse:function cr(v){v.x-=this.x0,v.y-=this.y0;var oe,ne,Te,He,ke,pt,Gt,D=v.x/this.a,F=v.y/this.a;if(this.sphere){var ln,Tn=0,Bn=0;if((ne=.5*(ln=Math.sqrt(D*D+F*F)))>1)return null;switch(ne=2*Math.asin(ne),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(Bn=Math.sin(ne),Tn=Math.cos(ne)),this.mode){case this.EQUIT:ne=Math.abs(ln)<=ze?0:Math.asin(F*Bn/ln),D*=Bn,F=Tn*ln;break;case this.OBLIQ:ne=Math.abs(ln)<=ze?this.lat0:Math.asin(Tn*this.sinph0+F*Bn*this.cosph0/ln),D*=Bn*this.cosph0,F=(Tn-Math.sin(ne)*this.sinph0)*ln;break;case this.N_POLE:F=-F,ne=ge-ne;break;case this.S_POLE:ne-=ge}oe=0!==F||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(D,F):0}else{if(Gt=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(D/=this.dd,F*=this.dd,(pt=Math.sqrt(D*D+F*F))<ze)return v.x=this.long0,v.y=this.lat0,v;He=2*Math.asin(.5*pt/this.rq),Te=Math.cos(He),D*=He=Math.sin(He),this.mode===this.OBLIQ?(ke=this.qp*(Gt=Te*this.sinb1+F*He*this.cosb1/pt),F=pt*this.cosb1*Te-F*this.sinb1*He):(ke=this.qp*(Gt=F*He/pt),F=pt*Te)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(F=-F),!(ke=D*D+F*F))return v.x=this.long0,v.y=this.lat0,v;Gt=1-ke/this.qp,this.mode===this.S_POLE&&(Gt=-Gt)}oe=Math.atan2(D,F),ne=function ie(v,D){var F=v+v;return v+D[0]*Math.sin(F)+D[1]*Math.sin(F+F)+D[2]*Math.sin(F+F+F)}(Math.asin(Gt),this.apa)}return v.x=wt(this.long0+oe),v.y=ne,v},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function Ce(v){return Math.abs(v)>1&&(v=v>1?1:-1),Math.asin(v)}const pe={init:function xe(){Math.abs(this.lat1+this.lat2)<ze||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Ve(this.e3,this.sin_po,this.cos_po),this.qs1=Lt(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Ve(this.e3,this.sin_po,this.cos_po),this.qs2=Lt(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Lt(this.e3,this.sin_po),this.ns0=Math.abs(this.lat1-this.lat2)>ze?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function ei(v){var D=v.x,F=v.y;this.sin_phi=Math.sin(F),this.cos_phi=Math.cos(F);var oe=Lt(this.e3,this.sin_phi),ne=this.a*Math.sqrt(this.c-this.ns0*oe)/this.ns0,Te=this.ns0*wt(D-this.long0),He=ne*Math.sin(Te)+this.x0,ke=this.rh-ne*Math.cos(Te)+this.y0;return v.x=He,v.y=ke,v},inverse:function L(v){var D,oe,ne,Te,He;return v.x-=this.x0,v.y=this.rh-v.y+this.y0,this.ns0>=0?(D=Math.sqrt(v.x*v.x+v.y*v.y),oe=1):(D=-Math.sqrt(v.x*v.x+v.y*v.y),oe=-1),ne=0,0!==D&&(ne=Math.atan2(oe*v.x,oe*v.y)),oe=D*this.ns0/this.a,He=this.sphere?Math.asin((this.c-oe*oe)/(2*this.ns0)):this.phi1z(this.e3,(this.c-oe*oe)/this.ns0),Te=wt(ne/this.ns0+this.long0),v.x=Te,v.y=He,v},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function Me(v,D){var F,ne,Te,He,ke=Ce(.5*D);if(v<ze)return ke;for(var pt=v*v,Gt=1;Gt<=25;Gt++)if(ke+=He=.5*(Te=1-(ne=v*(F=Math.sin(ke)))*ne)*Te/Math.cos(ke)*(D/(1-pt)-F/Te+.5/v*Math.log((1-ne)/(1+ne))),Math.abs(He)<=1e-7)return ke;return null}},zi={init:function vt(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function Nt(v){var D,F,oe,ne,He,ke,pt,Tn=v.y;return oe=wt(v.x-this.long0),D=Math.sin(Tn),F=Math.cos(Tn),ne=Math.cos(oe),(He=this.sin_p14*D+this.cos_p14*F*ne)>0||Math.abs(He)<=ze?(ke=this.x0+1*this.a*F*Math.sin(oe)/He,pt=this.y0+1*this.a*(this.cos_p14*D-this.sin_p14*F*ne)/He):(ke=this.x0+this.infinity_dist*F*Math.sin(oe),pt=this.y0+this.infinity_dist*(this.cos_p14*D-this.sin_p14*F*ne)),v.x=ke,v.y=pt,v},inverse:function tn(v){var D,F,oe,ne,Te,He;return v.x=(v.x-this.x0)/this.a,v.y=(v.y-this.y0)/this.a,v.x/=this.k0,v.y/=this.k0,(D=Math.sqrt(v.x*v.x+v.y*v.y))?(ne=Math.atan2(D,this.rc),F=Math.sin(ne),He=Ce((oe=Math.cos(ne))*this.sin_p14+v.y*F*this.cos_p14/D),Te=Math.atan2(v.x*F,D*this.cos_p14*oe-v.y*this.sin_p14*F),Te=wt(this.long0+Te)):(He=this.phic0,Te=0),v.x=Te,v.y=He,v},names:["gnom"]},qr={init:function Pr(){this.sphere||(this.k0=Ve(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function er(v){var oe,ne,F=v.y,Te=wt(v.x-this.long0);if(this.sphere)oe=this.x0+this.a*Te*Math.cos(this.lat_ts),ne=this.y0+this.a*Math.sin(F)/Math.cos(this.lat_ts);else{var He=Lt(this.e,Math.sin(F));oe=this.x0+this.a*this.k0*Te,ne=this.y0+this.a*He*.5/this.k0}return v.x=oe,v.y=ne,v},inverse:function _r(v){var D,F;return v.x-=this.x0,v.y-=this.y0,this.sphere?(D=wt(this.long0+v.x/this.a/Math.cos(this.lat_ts)),F=Math.asin(v.y/this.a*Math.cos(this.lat_ts))):(F=function pr(v,D){var F=1-(1-v*v)/(2*v)*Math.log((1-v)/(1+v));if(Math.abs(Math.abs(D)-F)<1e-6)return D<0?-1*ge:ge;for(var ne,Te,He,ke,oe=Math.asin(.5*D),pt=0;pt<30;pt++)if(Te=Math.sin(oe),He=Math.cos(oe),ke=v*Te,oe+=ne=Math.pow(1-ke*ke,2)/(2*He)*(D/(1-v*v)-Te/(1-ke*ke)+.5/v*Math.log((1-ke)/(1+ke))),Math.abs(ne)<=1e-10)return oe;return NaN}(this.e,2*v.y*this.k0/this.a),D=wt(this.long0+v.x/(this.a*this.k0))),v.x=D,v.y=F,v},names:["cea"]},uo={init:function Fr(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function In(v){var F=v.y,oe=wt(v.x-this.long0),ne=Ia(F-this.lat0);return v.x=this.x0+this.a*oe*this.rc,v.y=this.y0+this.a*ne,v},inverse:function Ni(v){var F=v.y;return v.x=wt(this.long0+(v.x-this.x0)/(this.a*this.rc)),v.y=Ia(this.lat0+(F-this.y0)/this.a),v},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Ds={init:function ss(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=kl(this.es),this.e1=za(this.es),this.e2=_l(this.es),this.e3=Ls(this.es),this.ml0=this.a*bs(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function ba(v){var oe,ne,Te,F=v.y,He=wt(v.x-this.long0);if(Te=He*Math.sin(F),this.sphere)Math.abs(F)<=ze?(oe=this.a*He,ne=-1*this.a*this.lat0):(oe=this.a*Math.sin(Te)/Math.tan(F),ne=this.a*(Ia(F-this.lat0)+(1-Math.cos(Te))/Math.tan(F)));else if(Math.abs(F)<=ze)oe=this.a*He,ne=-1*this.ml0;else{var ke=yl(this.a,this.e,Math.sin(F))/Math.tan(F);oe=ke*Math.sin(Te),ne=this.a*bs(this.e0,this.e1,this.e2,this.e3,F)-this.ml0+ke*(1-Math.cos(Te))}return v.x=oe+this.x0,v.y=ne+this.y0,v},inverse:function Nr(v){var D,F,oe,ne,Te,He,ke,pt,Gt;if(oe=v.x-this.x0,ne=v.y-this.y0,this.sphere)if(Math.abs(ne+this.a*this.lat0)<=ze)D=wt(oe/this.a+this.long0),F=0;else{var Tn;for(ke=oe*oe/this.a/this.a+(He=this.lat0+ne/this.a)*He,pt=He,Te=20;Te;--Te)if(pt+=Gt=-1*(He*(pt*(Tn=Math.tan(pt))+1)-pt-.5*(pt*pt+ke)*Tn)/((pt-He)/Tn-1),Math.abs(Gt)<=ze){F=pt;break}D=wt(this.long0+Math.asin(oe*Math.tan(pt)/this.a)/Math.sin(F))}else if(Math.abs(ne+this.ml0)<=ze)F=0,D=wt(this.long0+oe/this.a);else{var ln,Bn,_i,ui,Di;for(ke=oe*oe/this.a/this.a+(He=(this.ml0+ne)/this.a)*He,pt=He,Te=20;Te;--Te)if(Di=this.e*Math.sin(pt),ln=Math.sqrt(1-Di*Di)*Math.tan(pt),Bn=this.a*bs(this.e0,this.e1,this.e2,this.e3,pt),_i=this.e0-2*this.e1*Math.cos(2*pt)+4*this.e2*Math.cos(4*pt)-6*this.e3*Math.cos(6*pt),pt-=Gt=(He*(ln*(ui=Bn/this.a)+1)-ui-.5*ln*(ui*ui+ke))/(this.es*Math.sin(2*pt)*(ui*ui+ke-2*He*ui)/(4*ln)+(He-ui)*(ln*_i-2/Math.sin(2*pt))-_i),Math.abs(Gt)<=ze){F=pt;break}ln=Math.sqrt(1-this.es*Math.pow(Math.sin(F),2))*Math.tan(F),D=wt(this.long0+Math.asin(oe*ln/this.a)/Math.sin(F))}return v.x=D,v.y=F,v},names:["Polyconic","poly"]},jl={init:function ll(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function ic(v){var D,He=(v.y-this.lat0)/he*1e-5,ke=v.x-this.long0,pt=1,Gt=0;for(D=1;D<=10;D++)Gt+=this.A[D]*(pt*=He);var Di,Tn=Gt,ln=ke,Bn=1,_i=0,Bi=0,Er=0;for(D=1;D<=6;D++)Di=_i*Tn+Bn*ln,Bi=Bi+this.B_re[D]*(Bn=Bn*Tn-_i*ln)-this.B_im[D]*(_i=Di),Er=Er+this.B_im[D]*Bn+this.B_re[D]*_i;return v.x=Er*this.a+this.x0,v.y=Bi*this.a+this.y0,v},inverse:function ka(v){var D,ln,He=(v.y-this.y0)/this.a,ke=(v.x-this.x0)/this.a,pt=1,Gt=0,Bn=0,_i=0;for(D=1;D<=6;D++)ln=Gt*He+pt*ke,Bn=Bn+this.C_re[D]*(pt=pt*He-Gt*ke)-this.C_im[D]*(Gt=ln),_i=_i+this.C_im[D]*pt+this.C_re[D]*Gt;for(var ui=0;ui<this.iterations;ui++){var lo,Di=Bn,Bi=_i,go=He,Bo=ke;for(D=2;D<=6;D++)lo=Bi*Bn+Di*_i,go+=(D-1)*(this.B_re[D]*(Di=Di*Bn-Bi*_i)-this.B_im[D]*(Bi=lo)),Bo+=(D-1)*(this.B_im[D]*Di+this.B_re[D]*Bi);Di=1,Bi=0;var To=this.B_re[1],Ao=this.B_im[1];for(D=2;D<=6;D++)lo=Bi*Bn+Di*_i,To+=D*(this.B_re[D]*(Di=Di*Bn-Bi*_i)-this.B_im[D]*(Bi=lo)),Ao+=D*(this.B_im[D]*Di+this.B_re[D]*Bi);var $s=To*To+Ao*Ao;Bn=(go*To+Bo*Ao)/$s,_i=(Bo*To-go*Ao)/$s}var ts=Bn,fa=_i,wl=1,Ml=0;for(D=1;D<=9;D++)Ml+=this.D[D]*(wl*=ts);var Ql=this.lat0+Ml*he*1e5;return v.x=this.long0+fa,v.y=Ql,v},names:["New_Zealand_Map_Grid","nzmg"]},Fo={init:function cl(){},forward:function ul(v){var F=v.y,oe=wt(v.x-this.long0),ne=this.x0+this.a*oe,Te=this.y0+this.a*Math.log(Math.tan(Math.PI/4+F/2.5))*1.25;return v.x=ne,v.y=Te,v},inverse:function Ua(v){v.x-=this.x0,v.y-=this.y0;var D=wt(this.long0+v.x/this.a),F=2.5*(Math.atan(Math.exp(.8*v.y/this.a))-Math.PI/4);return v.x=D,v.y=F,v},names:["Miller_Cylindrical","mill"]},No={init:function Ss(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Is(this.es)},forward:function kr(v){var D,F,oe=v.x,ne=v.y;if(oe=wt(oe-this.long0),this.sphere){if(this.m)for(var Te=this.n*Math.sin(ne),He=20;He;--He){var ke=(this.m*ne+Math.sin(ne)-Te)/(this.m+Math.cos(ne));if(ne-=ke,Math.abs(ke)<ze)break}else ne=1!==this.n?Math.asin(this.n*Math.sin(ne)):ne;D=this.a*this.C_x*oe*(this.m+Math.cos(ne)),F=this.a*this.C_y*ne}else{var pt=Math.sin(ne),Gt=Math.cos(ne);F=this.a*Xo(ne,pt,Gt,this.en),D=this.a*oe*Gt/Math.sqrt(1-this.es*pt*pt)}return v.x=D,v.y=F,v},inverse:function dc(v){var D,oe,ne;return v.x-=this.x0,oe=v.x/this.a,v.y-=this.y0,D=v.y/this.a,this.sphere?(D/=this.C_y,oe/=this.C_x*(this.m+Math.cos(D)),this.m?D=Ce((this.m*D+Math.sin(D))/this.n):1!==this.n&&(D=Ce(Math.sin(D)/this.n)),oe=wt(oe+this.long0),D=Ia(D)):(D=Qs(v.y/this.a,this.es,this.en),(ne=Math.abs(D))<ge?(ne=Math.sin(D),oe=wt(this.long0+v.x*Math.sqrt(1-this.es*ne*ne)/(this.a*Math.cos(D)))):ne-ze<ge&&(oe=this.long0)),v.x=oe,v.y=D,v},names:["Sinusoidal","sinu"]},Jo={init:function fc(){},forward:function pc(v){for(var F=v.y,oe=wt(v.x-this.long0),ne=F,Te=Math.PI*Math.sin(F);;){var He=-(ne+Math.sin(ne)-Te)/(1+Math.cos(ne));if(ne+=He,Math.abs(He)<ze)break}ne/=2,Math.PI/2-Math.abs(F)<ze&&(oe=0);var ke=.900316316158*this.a*oe*Math.cos(ne)+this.x0,pt=1.4142135623731*this.a*Math.sin(ne)+this.y0;return v.x=ke,v.y=pt,v},inverse:function Rs(v){var D,F;v.x-=this.x0,v.y-=this.y0,F=v.y/(1.4142135623731*this.a),Math.abs(F)>.999999999999&&(F=.999999999999),D=Math.asin(F);var oe=wt(this.long0+v.x/(.900316316158*this.a*Math.cos(D)));oe<-Math.PI&&(oe=-Math.PI),oe>Math.PI&&(oe=Math.PI),F=(2*D+Math.sin(2*D))/Math.PI,Math.abs(F)>1&&(F=1);var ne=Math.asin(F);return v.x=oe,v.y=ne,v},names:["Mollweide","moll"]},da={init:function wa(){Math.abs(this.lat1+this.lat2)<ze||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=kl(this.es),this.e1=za(this.es),this.e2=_l(this.es),this.e3=Ls(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Ve(this.e,this.sinphi,this.cosphi),this.ml1=bs(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ze?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Ve(this.e,this.sinphi,this.cosphi),this.ml2=bs(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=bs(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function Pc(v){var oe,D=v.x,F=v.y;if(this.sphere)oe=this.a*(this.g-F);else{var ne=bs(this.e0,this.e1,this.e2,this.e3,F);oe=this.a*(this.g-ne)}var Te=this.ns*wt(D-this.long0),He=this.x0+oe*Math.sin(Te),ke=this.y0+this.rh-oe*Math.cos(Te);return v.x=He,v.y=ke,v},inverse:function ha(v){var D,F,oe,ne;v.x-=this.x0,v.y=this.rh-v.y+this.y0,this.ns>=0?(F=Math.sqrt(v.x*v.x+v.y*v.y),D=1):(F=-Math.sqrt(v.x*v.x+v.y*v.y),D=-1);var Te=0;return 0!==F&&(Te=Math.atan2(D*v.x,D*v.y)),this.sphere?(ne=wt(this.long0+Te/this.ns),oe=Ia(this.g-F/this.a),v.x=ne,v.y=oe,v):(oe=Ne(this.g-F/this.a,this.e0,this.e1,this.e2,this.e3),ne=wt(this.long0+Te/this.ns),v.x=ne,v.y=oe,v)},names:["Equidistant_Conic","eqdc"]},Xl={init:function mc(){this.R=this.a},forward:function $i(v){var ne,Te,F=v.y,oe=wt(v.x-this.long0);Math.abs(F)<=ze&&(ne=this.x0+this.R*oe,Te=this.y0);var He=Ce(2*Math.abs(F/Math.PI));(Math.abs(oe)<=ze||Math.abs(Math.abs(F)-ge)<=ze)&&(ne=this.x0,Te=F>=0?this.y0+Math.PI*this.R*Math.tan(.5*He):this.y0+Math.PI*this.R*-Math.tan(.5*He));var ke=.5*Math.abs(Math.PI/oe-oe/Math.PI),pt=ke*ke,Gt=Math.sin(He),Tn=Math.cos(He),ln=Tn/(Gt+Tn-1),_i=ln*(2/Gt-1),ui=_i*_i,Di=Math.PI*this.R*(ke*(ln-ui)+Math.sqrt(pt*(ln-ui)*(ln-ui)-(ui+pt)*(ln*ln-ui)))/(ui+pt);oe<0&&(Di=-Di),ne=this.x0+Di;var Bi=pt+ln;return Di=Math.PI*this.R*(_i*Bi-ke*Math.sqrt((ui+pt)*(pt+1)-Bi*Bi))/(ui+pt),Te=F>=0?this.y0+Di:this.y0-Di,v.x=ne,v.y=Te,v},inverse:function tu(v){var D,F,oe,ne,Te,He,ke,pt,Gt,Tn,ln,Bn;return v.x-=this.x0,v.y-=this.y0,ln=Math.PI*this.R,Te=(oe=v.x/ln)*oe+(ne=v.y/ln)*ne,ln=3*(ne*ne/(pt=-2*(He=-Math.abs(ne)*(1+Te))+1+2*ne*ne+Te*Te)+(2*(ke=He-2*ne*ne+oe*oe)*ke*ke/pt/pt/pt-9*He*ke/pt/pt)/27)/(Gt=(He-ke*ke/3/pt)/pt)/(Tn=2*Math.sqrt(-Gt/3)),Math.abs(ln)>1&&(ln=ln>=0?1:-1),Bn=Math.acos(ln)/3,F=v.y>=0?(-Tn*Math.cos(Bn+Math.PI/3)-ke/3/pt)*Math.PI:-(-Tn*Math.cos(Bn+Math.PI/3)-ke/3/pt)*Math.PI,D=Math.abs(oe)<ze?this.long0:wt(this.long0+Math.PI*(Te-1+Math.sqrt(1+2*(oe*oe-ne*ne)+Te*Te))/2/oe),v.x=D,v.y=F,v},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},hh={init:function rc(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function Ti(v){var He,ke,pt,Gt,Tn,ln,Bn,_i,ui,Di,Bi,Er,lo,go,Bo,To,Ao,$s,ts,fa,wl,Ml,D=v.x,F=v.y,oe=Math.sin(v.y),ne=Math.cos(v.y),Te=wt(D-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=ze?(v.x=this.x0+this.a*(ge-F)*Math.sin(Te),v.y=this.y0-this.a*(ge-F)*Math.cos(Te),v):Math.abs(this.sin_p12+1)<=ze?(v.x=this.x0+this.a*(ge+F)*Math.sin(Te),v.y=this.y0+this.a*(ge+F)*Math.cos(Te),v):($s=this.sin_p12*oe+this.cos_p12*ne*Math.cos(Te),Ao=(To=Math.acos($s))?To/Math.sin(To):1,v.x=this.x0+this.a*Ao*ne*Math.sin(Te),v.y=this.y0+this.a*Ao*(this.cos_p12*oe-this.sin_p12*ne*Math.cos(Te)),v):(He=kl(this.es),ke=za(this.es),pt=_l(this.es),Gt=Ls(this.es),Math.abs(this.sin_p12-1)<=ze?(Tn=this.a*bs(He,ke,pt,Gt,ge),ln=this.a*bs(He,ke,pt,Gt,F),v.x=this.x0+(Tn-ln)*Math.sin(Te),v.y=this.y0-(Tn-ln)*Math.cos(Te),v):Math.abs(this.sin_p12+1)<=ze?(Tn=this.a*bs(He,ke,pt,Gt,ge),ln=this.a*bs(He,ke,pt,Gt,F),v.x=this.x0+(Tn+ln)*Math.sin(Te),v.y=this.y0+(Tn+ln)*Math.cos(Te),v):(Bn=oe/ne,_i=yl(this.a,this.e,this.sin_p12),ui=yl(this.a,this.e,oe),Di=Math.atan((1-this.es)*Bn+this.es*_i*this.sin_p12/(ui*ne)),ts=0===(Bi=Math.atan2(Math.sin(Te),this.cos_p12*Math.tan(Di)-this.sin_p12*Math.cos(Te)))?Math.asin(this.cos_p12*Math.sin(Di)-this.sin_p12*Math.cos(Di)):Math.abs(Math.abs(Bi)-Math.PI)<=ze?-Math.asin(this.cos_p12*Math.sin(Di)-this.sin_p12*Math.cos(Di)):Math.asin(Math.sin(Te)*Math.cos(Di)/Math.sin(Bi)),Er=this.e*this.sin_p12/Math.sqrt(1-this.es),lo=this.e*this.cos_p12*Math.cos(Bi)/Math.sqrt(1-this.es),v.x=this.x0+(To=_i*ts*(1-(fa=ts*ts)*(Bo=lo*lo)*(1-Bo)/6+(wl=fa*ts)/8*(go=Er*lo)*(1-2*Bo)+(Ml=wl*ts)/120*(Bo*(4-7*Bo)-3*Er*Er*(1-7*Bo))-Ml*ts/48*go))*Math.sin(Bi),v.y=this.y0+To*Math.cos(Bi),v))},inverse:function Nu(v){var D,F,oe,ne,Te,He,ke,pt,Gt,Tn,ln,Bn,ui,Di,Bi,Er,lo,go,Bo,To,Ao,$s,ts;return v.x-=this.x0,v.y-=this.y0,this.sphere?(D=Math.sqrt(v.x*v.x+v.y*v.y))>2*ge*this.a?void 0:(F=D/this.a,oe=Math.sin(F),ne=Math.cos(F),Te=this.long0,Math.abs(D)<=ze?He=this.lat0:(He=Ce(ne*this.sin_p12+v.y*oe*this.cos_p12/D),ke=Math.abs(this.lat0)-ge,Te=Math.abs(ke)<=ze?wt(this.lat0>=0?this.long0+Math.atan2(v.x,-v.y):this.long0-Math.atan2(-v.x,v.y)):wt(this.long0+Math.atan2(v.x*oe,D*this.cos_p12*ne-v.y*this.sin_p12*oe))),v.x=Te,v.y=He,v):(pt=kl(this.es),Gt=za(this.es),Tn=_l(this.es),ln=Ls(this.es),Math.abs(this.sin_p12-1)<=ze?(He=Ne(((Bn=this.a*bs(pt,Gt,Tn,ln,ge))-(D=Math.sqrt(v.x*v.x+v.y*v.y)))/this.a,pt,Gt,Tn,ln),Te=wt(this.long0+Math.atan2(v.x,-1*v.y)),v.x=Te,v.y=He,v):Math.abs(this.sin_p12+1)<=ze?(Bn=this.a*bs(pt,Gt,Tn,ln,ge),He=Ne(((D=Math.sqrt(v.x*v.x+v.y*v.y))-Bn)/this.a,pt,Gt,Tn,ln),Te=wt(this.long0+Math.atan2(v.x,v.y)),v.x=Te,v.y=He,v):(D=Math.sqrt(v.x*v.x+v.y*v.y),Bi=Math.atan2(v.x,v.y),ui=yl(this.a,this.e,this.sin_p12),Er=Math.cos(Bi),Bo=3*this.es*(1-(go=-(lo=this.e*this.cos_p12*Er)*lo/(1-this.es)))*this.sin_p12*this.cos_p12*Er/(1-this.es),$s=1-go*(Ao=(To=D/ui)-go*(1+go)*Math.pow(To,3)/6-Bo*(1+3*go)*Math.pow(To,4)/24)*Ao/2-To*Ao*Ao*Ao/6,Di=Math.asin(this.sin_p12*Math.cos(Ao)+this.cos_p12*Math.sin(Ao)*Er),Te=wt(this.long0+Math.asin(Math.sin(Bi)*Math.sin(Ao)/Math.cos(Di))),ts=Math.sin(Di),He=Math.atan2((ts-this.es*$s*this.sin_p12)*Math.tan(Di),ts*(1-this.es)),v.x=Te,v.y=He,v))},names:["Azimuthal_Equidistant","aeqd"]},B={init:function pu(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function Vu(v){var D,F,oe,ne,He,ke,pt,Tn=v.y;return oe=wt(v.x-this.long0),D=Math.sin(Tn),F=Math.cos(Tn),ne=Math.cos(oe),((He=this.sin_p14*D+this.cos_p14*F*ne)>0||Math.abs(He)<=ze)&&(ke=1*this.a*F*Math.sin(oe),pt=this.y0+1*this.a*(this.cos_p14*D-this.sin_p14*F*ne)),v.x=ke,v.y=pt,v},inverse:function I(v){var D,F,oe,ne,Te,He,ke;return v.x-=this.x0,v.y-=this.y0,F=Ce((D=Math.sqrt(v.x*v.x+v.y*v.y))/this.a),oe=Math.sin(F),ne=Math.cos(F),He=this.long0,Math.abs(D)<=ze?(ke=this.lat0,v.x=He,v.y=ke,v):(ke=Ce(ne*this.sin_p14+v.y*oe*this.cos_p14/D),Te=Math.abs(this.lat0)-ge,Math.abs(Te)<=ze?(He=wt(this.lat0>=0?this.long0+Math.atan2(v.x,-v.y):this.long0-Math.atan2(-v.x,v.y)),v.x=He,v.y=ke,v):(He=wt(this.long0+Math.atan2(v.x*oe,D*this.cos_p14*ne-v.y*this.sin_p14*oe)),v.x=He,v.y=ke,v))},names:["ortho"]};var me_AREA_0=1,me_AREA_1=2,me_AREA_2=3,me_AREA_3=4;function r(v,D,F,oe){var ne;return v<ze?(oe.value=me_AREA_0,ne=0):(ne=Math.atan2(D,F),Math.abs(ne)<=Qt?oe.value=me_AREA_0:ne>Qt&&ne<=ge+Qt?(oe.value=me_AREA_1,ne-=ge):ne>ge+Qt||ne<=-(ge+Qt)?(oe.value=me_AREA_2,ne=ne>=0?ne-Yt:ne+Yt):(oe.value=me_AREA_3,ne+=ge)),ne}function u(v,D){var F=v+D;return F<-Yt?F+=sn:F>+Yt&&(F-=sn),F}const y={init:function We(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.face=this.lat0>=ge-Qt/2?5:this.lat0<=-(ge-Qt/2)?6:Math.abs(this.long0)<=Qt?1:Math.abs(this.long0)<=ge+Qt?this.long0>0?2:4:3,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function kt(v){var F,oe,ne,Te,He,ke,D={x:0,y:0},pt={value:0};if(v.x-=this.long0,F=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(v.y)):v.y,oe=v.x,5===this.face)Te=ge-F,oe>=Qt&&oe<=ge+Qt?(pt.value=me_AREA_0,ne=oe-ge):oe>ge+Qt||oe<=-(ge+Qt)?(pt.value=me_AREA_1,ne=oe>0?oe-Yt:oe+Yt):oe>-(ge+Qt)&&oe<=-Qt?(pt.value=me_AREA_2,ne=oe+ge):(pt.value=me_AREA_3,ne=oe);else if(6===this.face)Te=ge+F,oe>=Qt&&oe<=ge+Qt?(pt.value=me_AREA_0,ne=-oe+ge):oe<Qt&&oe>=-Qt?(pt.value=me_AREA_1,ne=-oe):oe<-Qt&&oe>=-(ge+Qt)?(pt.value=me_AREA_2,ne=-oe-ge):(pt.value=me_AREA_3,ne=oe>0?-oe+Yt:-oe-Yt);else{var Gt,Tn,ln,Bn,_i,ui;2===this.face?oe=u(oe,+ge):3===this.face?oe=u(oe,+Yt):4===this.face&&(oe=u(oe,-ge)),Bn=Math.sin(F),_i=Math.cos(F),ui=Math.sin(oe),Gt=_i*Math.cos(oe),Tn=_i*ui,ln=Bn,1===this.face?ne=r(Te=Math.acos(Gt),ln,Tn,pt):2===this.face?ne=r(Te=Math.acos(Tn),ln,-Gt,pt):3===this.face?ne=r(Te=Math.acos(-Gt),ln,-Tn,pt):4===this.face?ne=r(Te=Math.acos(-Tn),ln,Gt,pt):(Te=ne=0,pt.value=me_AREA_0)}return ke=Math.atan(12/Yt*(ne+Math.acos(Math.sin(ne)*Math.cos(Qt))-ge)),He=Math.sqrt((1-Math.cos(Te))/(Math.cos(ke)*Math.cos(ke))/(1-Math.cos(Math.atan(1/Math.cos(ne))))),pt.value===me_AREA_1?ke+=ge:pt.value===me_AREA_2?ke+=Yt:pt.value===me_AREA_3&&(ke+=1.5*Yt),D.x=He*Math.cos(ke),D.y=He*Math.sin(ke),D.x=D.x*this.a+this.x0,D.y=D.y*this.a+this.y0,v.x=D.x,v.y=D.y,v},inverse:function d(v){var F,oe,ne,Te,He,ke,pt,Gt,Tn,Di,Bi,Er,D={lam:0,phi:0},ln={value:0};if(v.x=(v.x-this.x0)/this.a,v.y=(v.y-this.y0)/this.a,oe=Math.atan(Math.sqrt(v.x*v.x+v.y*v.y)),F=Math.atan2(v.y,v.x),v.x>=0&&v.x>=Math.abs(v.y)?ln.value=me_AREA_0:v.y>=0&&v.y>=Math.abs(v.x)?(ln.value=me_AREA_1,F-=ge):v.x<0&&-v.x>=Math.abs(v.y)?(ln.value=me_AREA_2,F=F<0?F+Yt:F-Yt):(ln.value=me_AREA_3,F+=ge),Tn=Yt/12*Math.tan(F),He=Math.sin(Tn)/(Math.cos(Tn)-1/Math.sqrt(2)),ke=Math.atan(He),(pt=1-(ne=Math.cos(F))*ne*(Te=Math.tan(oe))*Te*(1-Math.cos(Math.atan(1/Math.cos(ke)))))<-1?pt=-1:pt>1&&(pt=1),5===this.face)Gt=Math.acos(pt),D.phi=ge-Gt,D.lam=ln.value===me_AREA_0?ke+ge:ln.value===me_AREA_1?ke<0?ke+Yt:ke-Yt:ln.value===me_AREA_2?ke-ge:ke;else if(6===this.face)Gt=Math.acos(pt),D.phi=Gt-ge,D.lam=ln.value===me_AREA_0?-ke+ge:ln.value===me_AREA_1?-ke:ln.value===me_AREA_2?-ke-ge:ke<0?-ke-Yt:-ke+Yt;else{var Bn,_i,ui;Tn=(Bn=pt)*Bn,_i=(Tn+=(ui=Tn>=1?0:Math.sqrt(1-Tn)*Math.sin(ke))*ui)>=1?0:Math.sqrt(1-Tn),ln.value===me_AREA_1?(Tn=_i,_i=-ui,ui=Tn):ln.value===me_AREA_2?(_i=-_i,ui=-ui):ln.value===me_AREA_3&&(Tn=_i,_i=ui,ui=-Tn),2===this.face?(Tn=Bn,Bn=-_i,_i=Tn):3===this.face?(Bn=-Bn,_i=-_i):4===this.face&&(Tn=Bn,Bn=_i,_i=-Tn),D.phi=Math.acos(-ui)-ge,D.lam=Math.atan2(_i,Bn),2===this.face?D.lam=u(D.lam,-ge):3===this.face?D.lam=u(D.lam,-Yt):4===this.face&&(D.lam=u(D.lam,+ge))}return 0!==this.es&&(Di=D.phi<0?1:0,Bi=Math.tan(D.phi),Er=this.b/Math.sqrt(Bi*Bi+this.one_minus_f_squared),D.phi=Math.atan(Math.sqrt(this.a*this.a-Er*Er)/(this.one_minus_f*Er)),Di&&(D.phi=-D.phi)),D.lam+=this.long0,v.x=D.lam,v.y=D.phi,v},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var b=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],S=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],z=.8487,U=1.3523,J=xt/5,Q=1/J,Ye=function(v,D){return v[0]+D*(v[1]+D*(v[2]+D*v[3]))};const yt={init:function it(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function ft(v){var D=wt(v.x-this.long0),F=Math.abs(v.y),oe=Math.floor(F*J);oe<0?oe=0:oe>=18&&(oe=17);var ne={x:Ye(b[oe],F=xt*(F-Q*oe))*D,y:Ye(S[oe],F)};return v.y<0&&(ne.y=-ne.y),ne.x=ne.x*this.a*z+this.x0,ne.y=ne.y*this.a*U+this.y0,ne},inverse:function Ee(v){var D={x:(v.x-this.x0)/(this.a*z),y:Math.abs(v.y-this.y0)/(this.a*U)};if(D.y>=1)D.x/=b[18][0],D.y=v.y<0?-ge:ge;else{var F=Math.floor(18*D.y);for(F<0?F=0:F>=18&&(F=17);;)if(S[F][0]>D.y)--F;else{if(!(S[F+1][0]<=D.y))break;++F}var oe=S[F],ne=5*(D.y-oe[0])/(S[F+1][0]-oe[0]);ne=function ut(v,D,F,oe){for(var ne=D;oe;--oe){var Te=v(ne);if(ne-=Te,Math.abs(Te)<F)break}return ne}(function(Te){return(Ye(oe,Te)-D.y)/function(v,D){return v[1]+D*(2*v[2]+3*D*v[3])}(oe,Te)},ne,ze,100),D.x/=Ye(b[F],ne),D.y=(5*F+ne)*bt,v.y<0&&(D.y=-D.y)}return D.x=wt(D.x+this.long0),D},names:["Robinson","robin"]},on={init:function Mt(){this.name="geocent"},forward:function $t(v){return Uo(v,this.es,this.a)},inverse:function Wt(v){return nt(v,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var cn={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const ai={init:function li(){if(Object.keys(cn).forEach(function(F){if(typeof this[F]>"u")this[F]=cn[F].def;else{if(cn[F].num&&isNaN(this[F]))throw new Error("Invalid parameter value, must be numeric "+F+" = "+this[F]);cn[F].num&&(this[F]=parseFloat(this[F]))}cn[F].degrees&&(this[F]=this[F]*bt)}.bind(this)),Math.abs(Math.abs(this.lat0)-ge)<ze?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<ze?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var v=this.tilt,D=this.azi;this.cg=Math.cos(D),this.sg=Math.sin(D),this.cw=Math.cos(v),this.sw=Math.sin(v)},forward:function fn(v){v.x-=this.long0;var ne,Te,He,ke,D=Math.sin(v.y),F=Math.cos(v.y),oe=Math.cos(v.x);switch(this.mode){case 3:Te=this.sinph0*D+this.cosph0*F*oe;break;case 2:Te=F*oe;break;case 1:Te=-D;break;case 0:Te=D}switch(ne=(Te=this.pn1/(this.p-Te))*F*Math.sin(v.x),this.mode){case 3:Te*=this.cosph0*D-this.sinph0*F*oe;break;case 2:Te*=D;break;case 0:Te*=-F*oe;break;case 1:Te*=F*oe}return ne=(ne*this.cg-Te*this.sg)*this.cw*(ke=1/((He=Te*this.cg+ne*this.sg)*this.sw*this.h1+this.cw)),Te=He*ke,v.x=ne*this.a,v.y=Te*this.a,v},inverse:function Fn(v){v.x/=this.a,v.y/=this.a;var F,oe,ne,D={x:v.x,y:v.y};v.x=(F=this.pn1*v.x*(ne=1/(this.pn1-v.y*this.sw)))*this.cg+(oe=this.pn1*v.y*this.cw*ne)*this.sg,v.y=oe*this.cg-F*this.sg;var Te=br(v.x,v.y);if(Math.abs(Te)<ze)D.x=0,D.y=v.y;else{var He,ke;switch(ke=1-Te*Te*this.pfact,ke=(this.p-Math.sqrt(ke))/(this.pn1/Te+Te/this.pn1),He=Math.sqrt(1-ke*ke),this.mode){case 3:D.y=Math.asin(He*this.sinph0+v.y*ke*this.cosph0/Te),v.y=(He-this.sinph0*Math.sin(D.y))*Te,v.x*=ke*this.cosph0;break;case 2:D.y=Math.asin(v.y*ke/Te),v.y=He*Te,v.x*=ke;break;case 0:D.y=Math.asin(He),v.y=-v.y;break;case 1:D.y=-Math.asin(He)}D.x=Math.atan2(v.x,v.y)}return v.x=D.x+this.long0,v.y=D.y,v},names:["Tilted_Perspective","tpers"]},fi={init:function vn(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var v=1-this.es,D=1/v;this.radius_p=Math.sqrt(v),this.radius_p2=v,this.radius_p_inv2=D,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function Hn(v){var oe,ne,Te,He,D=v.x,F=v.y;if(D-=this.long0,"ellipse"===this.shape){F=Math.atan(this.radius_p2*Math.tan(F));var ke=this.radius_p/br(this.radius_p*Math.cos(F),Math.sin(F));if(ne=ke*Math.cos(D)*Math.cos(F),Te=ke*Math.sin(D)*Math.cos(F),He=ke*Math.sin(F),(this.radius_g-ne)*ne-Te*Te-He*He*this.radius_p_inv2<0)return v.x=Number.NaN,v.y=Number.NaN,v;oe=this.radius_g-ne,this.flip_axis?(v.x=this.radius_g_1*Math.atan(Te/br(He,oe)),v.y=this.radius_g_1*Math.atan(He/oe)):(v.x=this.radius_g_1*Math.atan(Te/oe),v.y=this.radius_g_1*Math.atan(He/br(Te,oe)))}else"sphere"===this.shape&&(oe=Math.cos(F),ne=Math.cos(D)*oe,Te=Math.sin(D)*oe,He=Math.sin(F),oe=this.radius_g-ne,this.flip_axis?(v.x=this.radius_g_1*Math.atan(Te/br(He,oe)),v.y=this.radius_g_1*Math.atan(He/oe)):(v.x=this.radius_g_1*Math.atan(Te/oe),v.y=this.radius_g_1*Math.atan(He/br(Te,oe))));return v.x=v.x*this.a,v.y=v.y*this.a,v},inverse:function ri(v){var ne,Te,He,ke,D=-1,F=0,oe=0;if(v.x=v.x/this.a,v.y=v.y/this.a,"ellipse"===this.shape){this.flip_axis?(oe=Math.tan(v.y/this.radius_g_1),F=Math.tan(v.x/this.radius_g_1)*br(1,oe)):(F=Math.tan(v.x/this.radius_g_1),oe=Math.tan(v.y/this.radius_g_1)*br(1,F));var pt=oe/this.radius_p;if((He=(Te=2*this.radius_g*D)*Te-4*(ne=F*F+pt*pt+D*D)*this.C)<0)return v.x=Number.NaN,v.y=Number.NaN,v;ke=(-Te-Math.sqrt(He))/(2*ne),D=this.radius_g+ke*D,F*=ke,oe*=ke,v.x=Math.atan2(F,D),v.y=Math.atan(oe*Math.cos(v.x)/D),v.y=Math.atan(this.radius_p_inv2*Math.tan(v.y))}else if("sphere"===this.shape){if(this.flip_axis?(oe=Math.tan(v.y/this.radius_g_1),F=Math.tan(v.x/this.radius_g_1)*Math.sqrt(1+oe*oe)):(F=Math.tan(v.x/this.radius_g_1),oe=Math.tan(v.y/this.radius_g_1)*Math.sqrt(1+F*F)),(He=(Te=2*this.radius_g*D)*Te-4*(ne=F*F+oe*oe+D*D)*this.C)<0)return v.x=Number.NaN,v.y=Number.NaN,v;ke=(-Te-Math.sqrt(He))/(2*ne),D=this.radius_g+ke*D,F*=ke,oe*=ke,v.x=Math.atan2(F,D),v.y=Math.atan(oe*Math.cos(v.x)/D)}return v.x=v.x+this.long0,v},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};var tr=1.340264,wr=-.081106,Vi=893e-6,or=.003796,Ur=Math.sqrt(3)/2;const es={init:function Zr(){this.es=0,this.long0=void 0!==this.long0?this.long0:0},forward:function Qi(v){var D=wt(v.x-this.long0),oe=Math.asin(Ur*Math.sin(v.y)),ne=oe*oe,Te=ne*ne*ne;return v.x=D*Math.cos(oe)/(Ur*(tr+3*wr*ne+Te*(7*Vi+9*or*ne))),v.y=oe*(tr+wr*ne+Te*(Vi+or*ne)),v.x=this.a*v.x+this.x0,v.y=this.a*v.y+this.y0,v},inverse:function Wi(v){v.x=(v.x-this.x0)/this.a,v.y=(v.y-this.y0)/this.a;var ne,Te,pt,Gt,oe=v.y;for(Gt=0;Gt<12&&(oe-=pt=(oe*(tr+wr*(ne=oe*oe)+(Te=ne*ne*ne)*(Vi+or*ne))-v.y)/(tr+3*wr*ne+Te*(7*Vi+9*or*ne)),!(Math.abs(pt)<1e-9));++Gt);return v.x=Ur*v.x*(tr+3*wr*(ne=oe*oe)+(Te=ne*ne*ne)*(7*Vi+9*or*ne))/Math.cos(oe),v.y=Math.asin(Math.sin(oe)/Ur),v.x=wt(v.x+this.long0),v},names:["eqearth","Equal Earth","Equal_Earth"]};var Co=1e-10;function Ma(v){var oe,ne,Te,D=wt(v.x-(this.long0||0)),F=v.y;return oe=this.am1+this.m1-Xo(F,ne=Math.sin(F),Te=Math.cos(F),this.en),ne=Te*D/(oe*Math.sqrt(1-this.es*ne*ne)),v.x=oe*Math.sin(ne),v.y=this.am1-oe*Math.cos(ne),v.x=this.a*v.x+(this.x0||0),v.y=this.a*v.y+(this.y0||0),v}function bl(v){var D,F,oe,ne;if(v.x=(v.x-(this.x0||0))/this.a,v.y=(v.y-(this.y0||0))/this.a,F=br(v.x,v.y=this.am1-v.y),ne=Qs(this.am1+this.m1-F,this.es,this.en),(D=Math.abs(ne))<ge)D=Math.sin(ne),oe=F*Math.atan2(v.x,v.y)*Math.sqrt(1-this.es*D*D)/Math.cos(ne);else{if(!(Math.abs(D-ge)<=Co))throw new Error;oe=0}return v.x=wt(oe+(this.long0||0)),v.y=Ia(ne),v}function tl(v){var oe,ne,D=wt(v.x-(this.long0||0)),F=v.y;return ne=this.cphi1+this.phi1-F,Math.abs(ne)>Co?(v.x=ne*Math.sin(oe=D*Math.cos(F)/ne),v.y=this.cphi1-ne*Math.cos(oe)):v.x=v.y=0,v.x=this.a*v.x+(this.x0||0),v.y=this.a*v.y+(this.y0||0),v}function ds(v){v.x=(v.x-(this.x0||0))/this.a,v.y=(v.y-(this.y0||0))/this.a;var D,F,oe=br(v.x,v.y=this.cphi1-v.y);if(F=this.cphi1+this.phi1-oe,Math.abs(F)>ge)throw new Error;return D=Math.abs(Math.abs(F)-ge)<=Co?0:oe*Math.atan2(v.x,v.y)/Math.cos(F),v.x=wt(D+(this.long0||0)),v.y=Ia(F),v}const Mo={init:function Ya(){var v;if(this.phi1=this.lat1,Math.abs(this.phi1)<Co)throw new Error;this.es?(this.en=Is(this.es),this.m1=Xo(this.phi1,this.am1=Math.sin(this.phi1),v=Math.cos(this.phi1),this.en),this.am1=v/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=bl,this.forward=Ma):(this.cphi1=Math.abs(this.phi1)+Co>=ge?0:1/Math.tan(this.phi1),this.inverse=ds,this.forward=tl)},names:["bonne","Bonne (Werner lat_1=90)"]};nr.defaultDatum="WGS84",nr.Proj=mo,nr.WGS84=new nr.Proj("WGS84"),nr.Point=po,nr.toPoint=no,nr.defs=Br,nr.nadgrid=function Lr(v,D){var F=new DataView(D),oe=function ms(v){var D=v.getInt32(8,!1);return 11!==D&&(11!==(D=v.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(F),ne=function as(v,D){return{nFields:v.getInt32(8,D),nSubgridFields:v.getInt32(24,D),nSubgrids:v.getInt32(40,D),shiftType:fr(v,56,64).trim(),fromSemiMajorAxis:v.getFloat64(120,D),fromSemiMinorAxis:v.getFloat64(136,D),toSemiMajorAxis:v.getFloat64(152,D),toSemiMinorAxis:v.getFloat64(168,D)}}(F,oe),Te=function Xi(v,D,F){for(var oe=176,ne=[],Te=0;Te<D.nSubgrids;Te++){var He=oo(v,oe,F),ke=so(v,oe,He,F),pt=Math.round(1+(He.upperLongitude-He.lowerLongitude)/He.longitudeInterval),Gt=Math.round(1+(He.upperLatitude-He.lowerLatitude)/He.latitudeInterval);ne.push({ll:[Or(He.lowerLongitude),Or(He.lowerLatitude)],del:[Or(He.longitudeInterval),Or(He.latitudeInterval)],lim:[pt,Gt],count:He.gridNodeCount,cvs:fo(ke)}),oe+=176+16*He.gridNodeCount}return ne}(F,ne,oe),He={header:ne,subgrids:Te};return eo[v]=He,He},nr.transform=vi,nr.mgrs=gl,nr.version="__VERSION__",function js(v){v.Proj.projections.add(rs),v.Proj.projections.add(Eo),v.Proj.projections.add(Js),v.Proj.projections.add(vl),v.Proj.projections.add(Fi),v.Proj.projections.add(Ja),v.Proj.projections.add(zl),v.Proj.projections.add(Ro),v.Proj.projections.add(al),v.Proj.projections.add(ot),v.Proj.projections.add(W),v.Proj.projections.add(pe),v.Proj.projections.add(zi),v.Proj.projections.add(qr),v.Proj.projections.add(uo),v.Proj.projections.add(Ds),v.Proj.projections.add(jl),v.Proj.projections.add(Fo),v.Proj.projections.add(No),v.Proj.projections.add(Jo),v.Proj.projections.add(da),v.Proj.projections.add(Xl),v.Proj.projections.add(hh),v.Proj.projections.add(B),v.Proj.projections.add(y),v.Proj.projections.add(yt),v.Proj.projections.add(on),v.Proj.projections.add(ai),v.Proj.projections.add(fi),v.Proj.projections.add(es),v.Proj.projections.add(Mo)}(nr);const Ys=nr;var Mn=R(1354);const Vr=[[49,(0,Mn.n1)([[[-21.7,108],[-21.7,114],[-27.5,114],[-27.5,108],[-21.7,108]]])],[50,(0,Mn.n1)([[[-19.6,114],[-19.6,120],[-35.2,120],[-35.2,114],[-19.6,114]]])],[51,(0,Mn.n1)([[[-13.6,120],[-13.6,126],[-34.2,126],[-34.2,120],[-13.6,120]]])],[52,(0,Mn.n1)([[[-10.7,126],[-10.7,132],[-32.5,132],[-32.5,126],[-10.7,126]]])],[53,(0,Mn.n1)([[[-10.7,132],[-10.7,138],[-36.1,138],[-36.1,132],[-10.7,132]]])],[54,(0,Mn.n1)([[[-10.1,138],[-10.1,144],[-40.3,144],[-40.3,138],[-10.1,138]]])],[55,(0,Mn.n1)([[[-13.7,144],[-13.7,150],[-44.1,150],[-44.1,144],[-13.7,144]]])],[56,(0,Mn.n1)([[[-21.7,150],[-21.7,156],[-37.8,156],[-37.8,150],[-21.7,150]]])]];var nu=R(6267),gc=R(4438);let So=(()=>{class v{constructor(){Ys.defs([["EPSG:28349","+proj=utm +zone=49 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"],["EPSG:28350","+proj=utm +zone=50 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"],["EPSG:28351","+proj=utm +zone=51 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"],["EPSG:28352","+proj=utm +zone=52 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"],["EPSG:28353","+proj=utm +zone=53 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"],["EPSG:28354","+proj=utm +zone=54 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"],["EPSG:28355","+proj=utm +zone=55 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"],["EPSG:28356","+proj=utm +zone=56 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"],["EPSG:7844","+proj=longlat +ellps=GRS80 +towgs84=0.06155,-0.0187,-0.04019,-0.0394924,-0.0327221,-0.0328979,-9.994 +no_defs"],["EPSG:7849","+proj=utm +zone=49 +south +ellps=GRS80 +towgs84=0.06155,-0.0187,-0.04019,-0.0394924,-0.0327221,-0.0328979,-9.994 +no_defs"],["EPSG:7850","+proj=utm +zone=50 +south +ellps=GRS80 +towgs84=0.06155,-0.0187,-0.04019,-0.0394924,-0.0327221,-0.0328979,-9.994 +no_defs"],["EPSG:7851","+proj=utm +zone=51 +south +ellps=GRS80 +towgs84=0.06155,-0.0187,-0.04019,-0.0394924,-0.0327221,-0.0328979,-9.994 +no_defs"],["EPSG:7852","+proj=utm +zone=52 +south +ellps=GRS80 +towgs84=0.06155,-0.0187,-0.04019,-0.0394924,-0.0327221,-0.0328979,-9.994 +no_defs"],["EPSG:7853","+proj=utm +zone=53 +south +ellps=GRS80 +towgs84=0.06155,-0.0187,-0.04019,-0.0394924,-0.0327221,-0.0328979,-9.994 +no_defs"],["EPSG:7854","+proj=utm +zone=54 +south +ellps=GRS80 +towgs84=0.06155,-0.0187,-0.04019,-0.0394924,-0.0327221,-0.0328979,-9.994 +no_defs"],["EPSG:7855","+proj=utm +zone=55 +south +ellps=GRS80 +towgs84=0.06155,-0.0187,-0.04019,-0.0394924,-0.0327221,-0.0328979,-9.994 +no_defs"],["EPSG:7856","+proj=utm +zone=56 +south +ellps=GRS80 +towgs84=0.06155,-0.0187,-0.04019,-0.0394924,-0.0327221,-0.0328979,-9.994 +no_defs"],["EPSG:4283","+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs"]])}findMGAZone(F){const oe={type:"Point",coordinates:[F.lat,F.lng]};for(const ne of Vr)if((0,nu.A)(oe,ne[1]))return ne[0];return 0}projCoordsFromLatLng(F,oe){if("94"===oe){const ne=this.findMGAZone(F);return ne?Ys("EPSG:4326",`EPSG:283${ne}`).forward([F.lng,F.lat]).reverse():null}if("2020"===oe){const ne=this.findMGAZone(F);return ne?Ys("EPSG:4326",`EPSG:78${ne}`).forward([F.lng,F.lat]).reverse():null}return Ys("EPSG:4326",`EPSG:${oe}`).forward([F.lng,F.lat]).reverse()}projLatLngFromCoords(F,oe,ne,Te){return"94"===F?Te?Ys(`EPSG:283${Te}`,"EPSG:4326").forward([oe,ne]).reverse():null:"2020"===F?Te?Ys(`EPSG:78${Te}`,"EPSG:4326").forward([oe,ne]).reverse():null:Ys(`EPSG:${F}`,"EPSG:4326").forward([oe,ne]).reverse()}static{this.\u0275fac=function(oe){return new(oe||v)}}static{this.\u0275prov=gc.jDH({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})()},5023:(Nn,Ct,R)=>{"use strict";R.d(Ct,{O:()=>C});var M=R(4438);let C=(()=>{class de{transform(se,Fe="distance"){return"distance"===Fe?se<1e3?se.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})+" m":(se/1e3).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})+" km":"area"===Fe?se<1e6?se.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})+" m\xb2":(se/1e6).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})+" km\xb2":void 0}static{this.\u0275fac=function(Fe){return new(Fe||de)}}static{this.\u0275pipe=M.EJ8({name:"distance",type:de,pure:!0})}}return de})()},8954:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Y:()=>se});var M=R(1247),de=R(4438),a=R(4077);let se=(()=>{class Fe{constructor(ee){this.proj4Service=ee}transform(ee,fe,he=2){if(fe+="",!ee)return null;Array.isArray(ee)&&(ee=new M.LngLat(ee[0],ee[1]));const ge=this.proj4Service.projCoordsFromLatLng(ee,fe);if(!ge)return"Out of range";const at=ge.map(mt=>mt.toFixed(he)).join(", ");if("94"===fe||"2020"===fe){const mt=this.proj4Service.findMGAZone(ee);return mt?`Zone: ${mt}, ${at}`:at}return at}static{this.\u0275fac=function(fe){return new(fe||Fe)(de.rXU(a.R,16))}}static{this.\u0275pipe=de.EJ8({name:"printCoords",type:Fe,pure:!0})}}return Fe})()},3887:(Nn,Ct,R)=>{"use strict";R.d(Ct,{G:()=>de});var M=R(177),C=R(4438);let de=(()=>{class a{static{this.\u0275fac=function(ve){return new(ve||a)}}static{this.\u0275mod=C.$C({type:a})}static{this.\u0275inj=C.G2t({imports:[M.MD]})}}return a})()},5855:(Nn,Ct,R)=>{"use strict";R.d(Ct,{$:()=>de});var M=R(4438),C=R(6530);let de=(()=>{class a{constructor(Fe){this.router=Fe}setCurrentLocation(){this.routeWhichUserTriedAccessing()&&sessionStorage.setItem("userLastLocation",this.routeWhichUserTriedAccessing())}get(){return sessionStorage.getItem("userLastLocation")??""}pop(){const Fe=this.get();return sessionStorage.removeItem("userLastLocation"),Fe}routeWhichUserTriedAccessing(){const Fe=this.router.getCurrentNavigation();return null===Fe?"":Fe.extractedUrl.toString()}static{this.\u0275fac=function(ve){return new(ve||a)(M.KVO(C.Ix))}}static{this.\u0275prov=M.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})()},5312:(Nn,Ct,R)=>{"use strict";R.d(Ct,{c:()=>M});const M={production:!0,apiUrl:"https://api-v3.metromap.com.au/v3",authUrl:"https://api-v3.metromap.com.au/v3/auth",imageryServerURL:"https://api-v3.metromap.com.au/tiles",vectorServerURL:"https://api-v3.metromap.com.au/vtile",terrainServerURL:"https://api-v3.metromap.com.au/terrain",genericErrorMessage:"Oops! Something went wrong",acTokenCookieKey:"ac_token",uuid:"uuid_str",mapboxAcToken:"pk.eyJ1Ijoib2xpdmVyYWVybyIsImEiOiJjanptNHlkcnUwYXViM2RyNzJiaTZxN29nIn0.UbMRexd9ZNE8Awcv10ePow",googleApiKey:"AIzaSyC11E8I5ieAH-Fn17R5CaLsuTBdvmemNXE",geoscapeApiKey:"YSy19Fch7dhHqetKmlJXB2SoCjmtRUXN",geoescapeAPIURL:"https://api.psma.com.au/v1",hotjarSiteID:1632775,recaptchaSiteKey:"6LfPYhggAAAAAGAVjLcS50KLHxA_JLHFQ0Lsl4kS",cesiumIonAccessToken:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI3NjVjZTdmNC0zYjY5LTQxMTktYjUyNy1lZGM0ZWY1NTY2ZWUiLCJpZCI6NTIzOCwiaWF0IjoxNzE0MzU0MjQyfQ.eSf8hOEzNODsGvuVjbaELPyWTVZRMa1kz0DEE-GOleA",cesiumMapboxImageryToken:"sk.eyJ1Ijoib2xpdmVyYWVybyIsImEiOiJja3JuMmUzMnU1YWtsMnFyMmJ5YmgzcGg5In0.gf6CALYHhGMWl_R-WEkRZA",disableRecaptchaForTesting:!1}},7891:(Nn,Ct,R)=>{"use strict";var M=R(345),C=R(4438),de=R(6530),a=R(467),se=R(2956),Fe=R(5855);let ve=(()=>{class Ne{constructor(V,te,Le){this.authService=V,this.router=te,this.userLastLocationStorage=Le}canMatch(V,te){var Le=this;return(0,a.A)(function*(){return!!(yield Le.userIsAllowedToAccessRoute())||(Le.userLastLocationStorage.setCurrentLocation(),Le.router.createUrlTree(["/auth/login"],{}))})()}userIsAllowedToAccessRoute(){var V=this;return(0,a.A)(function*(){return null!==(yield V.authService.me())})()}static{this.\u0275fac=function(te){return new(te||Ne)(C.KVO(se.u),C.KVO(de.Ix),C.KVO(Fe.$))}}static{this.\u0275prov=C.jDH({token:Ne,factory:Ne.\u0275fac,providedIn:"root"})}}return Ne})(),ee=(()=>{class Ne{static{this.PRE_DEFINED_ROUTES=["suncorp-signup","smec-signup","d4c-signup","wsp-signup","telstra-signup","gww-signup","sa-power-networks-signup","frasers-property-signup"]}constructor(V){this.router=V}canActivate(V,te){const Le=-1!==Ne.PRE_DEFINED_ROUTES.indexOf(V.params.org_name);if(Le)return Le;this.router.navigate(["/map"])}static{this.\u0275fac=function(te){return new(te||Ne)(C.KVO(de.Ix))}}static{this.\u0275prov=C.jDH({token:Ne,factory:Ne.\u0275fac,providedIn:"root"})}}return Ne})();const ge={canceledNavigationResolution:"replace",paramsInheritanceStrategy:"always",urlUpdateStrategy:"eager"},at=[{path:"",redirectTo:"/map",pathMatch:"full"},{path:"map",loadChildren:()=>Promise.all([R.e(986),R.e(238),R.e(472),R.e(463),R.e(76),R.e(682)]).then(R.bind(R,5682)).then(Ne=>Ne.MapModule),canMatch:[ve]},{path:"3d",loadChildren:()=>Promise.all([R.e(986),R.e(877)]).then(R.bind(R,7877)).then(Ne=>Ne.Viewer3dModule),canMatch:[(()=>{class Ne{constructor(V,te){this.authService=V,this.router=te}canMatch(V,te){var Le=this;return(0,a.A)(function*(){const ot=yield Le.authService.me();if(null===ot)return!1;const Lt=ot.subscription_plan?ot.subscription_plan:ot.admin_group?.subscription_plan;return Lt?!!Lt.permission_schema["3d"]:(console.error("No subscription plan attached to the user"),!1)})()}static{this.\u0275fac=function(te){return new(te||Ne)(C.KVO(se.u),C.KVO(de.Ix))}}static{this.\u0275prov=C.jDH({token:Ne,factory:Ne.\u0275fac,providedIn:"root"})}}return Ne})()]},{path:"manage",loadChildren:()=>Promise.all([R.e(986),R.e(238),R.e(472),R.e(14),R.e(627)]).then(R.bind(R,7627)).then(Ne=>Ne.AdminModule)},{path:"auth",loadChildren:()=>Promise.all([R.e(986),R.e(238),R.e(14),R.e(463),R.e(534)]).then(R.bind(R,9534)).then(Ne=>Ne.AuthModule)},{path:"sso",redirectTo:"/auth/sso"},{path:":org_name",pathMatch:"full",canActivate:[ee],component:(()=>{class Ne{constructor(V,te){this.route=V,this.router=te}ngOnInit(){const V=this.route.snapshot.paramMap.get("org_name");this.router.navigate([`/auth/signup/${V}`])}static{this.\u0275fac=function(te){return new(te||Ne)(C.rXU(de.nX),C.rXU(de.Ix))}}static{this.\u0275cmp=C.VBU({type:Ne,selectors:[["app-old-signup"]],decls:0,vars:0,template:function(te,Le){},encapsulation:2})}}return Ne})()},{path:"**",redirectTo:"/map"}];let mt=(()=>{class Ne{static{this.\u0275fac=function(te){return new(te||Ne)}}static{this.\u0275mod=C.$C({type:Ne})}static{this.\u0275inj=C.G2t({imports:[de.iI.forRoot(at,ge),de.iI]})}}return Ne})();var $e=R(5312);const ze=new C.nKC("google-tag-manager-config");let bt=(()=>{class Ne{constructor(V){this._googleTagManagerConfig={id:null,gtm_auth:"",gtm_preview:""},V&&this.set(V)}set(V){this._googleTagManagerConfig=V}get(){return this._googleTagManagerConfig}static{this.\u0275fac=function(te){return new(te||Ne)(C.KVO(ze,8))}}static{this.\u0275prov=C.jDH({token:Ne,factory:Ne.\u0275fac,providedIn:"root"})}}return Ne})(),xt=(()=>{class Ne{constructor(V,te,Le="noisy",ot,Lt,Kt,mn){this.googleTagManagerConfiguration=V,this.googleTagManagerId=te,this.googleTagManagerMode=Le,this.googleTagManagerAuth=ot,this.googleTagManagerPreview=Lt,this.googleTagManagerResourcePath=Kt,this.googleTagManagerCSPNonce=mn,this.isLoaded=!1,this.browserGlobals={windowRef:()=>window,documentRef:()=>document},this.config=this.googleTagManagerConfiguration?.get(),null==this.config&&(this.config={id:null}),this.config={...this.config,id:te||this.config.id,gtm_auth:ot||this.config.gtm_auth,gtm_preview:Lt||this.config.gtm_preview,gtm_resource_path:Kt||this.config.gtm_resource_path}}checkForId(){if("silent"!==this.googleTagManagerMode&&!this.config.id)throw new Error("Google tag manager ID not provided.");return!!this.config.id}getDataLayer(){this.checkForId();const V=this.browserGlobals.windowRef();return V.dataLayer=V.dataLayer||[],V.dataLayer}pushOnDataLayer(V){this.checkForId(),this.getDataLayer().push(V)}addGtmToDom(){return new Promise((V,te)=>{if(this.isLoaded)return V(this.isLoaded);if(!this.checkForId())return V(!1);const Le=this.browserGlobals.documentRef();this.pushOnDataLayer({"gtm.start":(new Date).getTime(),event:"gtm.js"});const ot=Le.createElement("script");ot.id="GTMscript",ot.async=!0,ot.src=this.applyGtmQueryParams(this.config.gtm_resource_path?this.config.gtm_resource_path:"https://www.googletagmanager.com/gtm.js"),ot.addEventListener("load",()=>V(this.isLoaded=!0)),ot.addEventListener("error",()=>te(!1)),this.googleTagManagerCSPNonce&&ot.setAttribute("nonce",this.googleTagManagerCSPNonce),Le.head.insertBefore(ot,Le.head.firstChild)})}pushTag(V){return new Promise((te,Le)=>this.checkForId()?this.isLoaded?(this.pushOnDataLayer(V),te()):void this.addGtmToDom().then(()=>(this.pushOnDataLayer(V),te())).catch(()=>Le()):te())}applyGtmQueryParams(V){return-1===V.indexOf("?")&&(V+="?"),V+Object.keys(this.config).filter(te=>this.config[te]).map(te=>`${te}=${this.config[te]}`).join("&")}static{this.\u0275fac=function(te){return new(te||Ne)(C.KVO(bt,8),C.KVO("googleTagManagerId",8),C.KVO("googleTagManagerMode",8),C.KVO("googleTagManagerAuth",8),C.KVO("googleTagManagerPreview",8),C.KVO("googleTagManagerResourcePath",8),C.KVO("googleTagManagerCSPNonce",8))}}static{this.\u0275prov=C.jDH({token:Ne,factory:Ne.\u0275fac,providedIn:"root"})}}return Ne})(),sn=(()=>{class Ne{get hotjarSiteId(){return $e.c.hotjarSiteID}constructor(V,te){this.auth=V,this.gtmService=te,this.title="mm-front-v3"}ngOnInit(){var V=this;return(0,a.A)(function*(){V.initHotJar(),V.initMouseFlow(),V.gtmService.addGtmToDom()})()}initMouseFlow(){var V;window._mfq=window._mfq||[],(V=document.createElement("script")).type="text/javascript",V.defer=!0,V.src="//cdn.mouseflow.com/projects/d6c3fa8d-5824-426f-853c-4cf286f7798a.js",document.getElementsByTagName("head")[0].appendChild(V)}initHotJar(){var V,te,Lt,Kt;V=window,te=document,V.hj=V.hj||function(){(V.hj.q=V.hj.q||[]).push(arguments)},V._hjSettings={hjid:$e.c.hotjarSiteID,hjsv:6},Lt=te.getElementsByTagName("head")[0],(Kt=te.createElement("script")).async=1,Kt.src="https://static.hotjar.com/c/hotjar-"+V._hjSettings.hjid+".js?sv="+V._hjSettings.hjsv,Lt.appendChild(Kt)}static{this.\u0275fac=function(te){return new(te||Ne)(C.rXU(se.u),C.rXU(xt))}}static{this.\u0275cmp=C.VBU({type:Ne,selectors:[["app-root"]],decls:1,vars:0,template:function(te,Le){1&te&&C.nrm(0,"router-outlet")},dependencies:[de.n3]})}}return Ne})();var Yt=R(3341),Ut=R(177);const et=void 0,zt=["en",[["a","p"],["AM","PM"],et],[["AM","PM"],et,et],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],et,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],et,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",et,"{1} 'at' {0}",et],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function It(Ne){const V=Math.floor(Math.abs(Ne)),te=Ne.toString().replace(/^[^.]*\.?/,"").length;return 1===V&&0===te?1:5}];var je=R(4341),At=R(1626),Ze=R(9969);function wn(Ne){return new C.wOt(3e3,!1)}function hn(Ne){switch(Ne.length){case 0:return new Ze.sf;case 1:return Ne[0];default:return new Ze.ui(Ne)}}function si(Ne,N,V=new Map,te=new Map){const Le=[],ot=[];let Lt=-1,Kt=null;if(N.forEach(mn=>{const Pn=mn.get("offset"),Pi=Pn==Lt,Yi=Pi&&Kt||new Map;mn.forEach(($r,cr)=>{let ir=cr,Ar=$r;if("offset"!==cr)switch(ir=Ne.normalizePropertyName(ir,Le),Ar){case Ze.FX:Ar=V.get(cr);break;case Ze.kp:Ar=te.get(cr);break;default:Ar=Ne.normalizeStyleValue(cr,ir,Ar,Le)}Yi.set(ir,Ar)}),Pi||ot.push(Yi),Kt=Yi,Lt=Pn}),Le.length)throw function Bt(Ne){return new C.wOt(3502,!1)}();return ot}function Hi(Ne,N,V,te){switch(N){case"start":Ne.onStart(()=>te(V&&ti(V,"start",Ne)));break;case"done":Ne.onDone(()=>te(V&&ti(V,"done",Ne)));break;case"destroy":Ne.onDestroy(()=>te(V&&ti(V,"destroy",Ne)))}}function ti(Ne,N,V){const ot=bi(Ne.element,Ne.triggerName,Ne.fromState,Ne.toState,N||Ne.phaseName,V.totalTime??Ne.totalTime,!!V.disabled),Lt=Ne._data;return null!=Lt&&(ot._data=Lt),ot}function bi(Ne,N,V,te,Le="",ot=0,Lt){return{element:Ne,triggerName:N,fromState:V,toState:te,phaseName:Le,totalTime:ot,disabled:!!Lt}}function gi(Ne,N,V){let te=Ne.get(N);return te||Ne.set(N,te=V),te}function lt(Ne){const N=Ne.indexOf(":");return[Ne.substring(1,N),Ne.slice(N+1)]}const Pe=typeof document>"u"?null:document.documentElement;function Se(Ne){const N=Ne.parentNode||Ne.host||null;return N===Pe?null:N}let Oe=null,Ke=!1;function Z(Ne,N){for(;N;){if(N===Ne)return!0;N=Se(N)}return!1}function Y(Ne,N,V){if(V)return Array.from(Ne.querySelectorAll(N));const te=Ne.querySelector(N);return te?[te]:[]}let re=(()=>{class Ne{validateStyleProperty(V){return function Et(Ne){Oe||(Oe=function ae(){return typeof document<"u"?document.body:null}()||{},Ke=!!Oe.style&&"WebkitAppearance"in Oe.style);let N=!0;return Oe.style&&!function dt(Ne){return"ebkit"==Ne.substring(1,6)}(Ne)&&(N=Ne in Oe.style,!N&&Ke&&(N="Webkit"+Ne.charAt(0).toUpperCase()+Ne.slice(1)in Oe.style)),N}(V)}matchesElement(V,te){return!1}containsElement(V,te){return Z(V,te)}getParentElement(V){return Se(V)}query(V,te,Le){return Y(V,te,Le)}computeStyle(V,te,Le){return Le||""}animate(V,te,Le,ot,Lt,Kt=[],mn){return new Ze.sf(Le,ot)}static{this.\u0275fac=function(te){return new(te||Ne)}}static{this.\u0275prov=C.jDH({token:Ne,factory:Ne.\u0275fac})}}return Ne})();class Je{static{this.NOOP=new re}}class Pt{}const ni=1e3,Cr="ng-enter",Jr="ng-leave",eo="ng-trigger",Lr=".ng-trigger",Ci="ng-animating",Do=".ng-animating";function Or(Ne){if("number"==typeof Ne)return Ne;const N=Ne.match(/^(-?[\.\d]+)(m?s)/);return!N||N.length<2?0:ms(parseFloat(N[1]),N[2])}function ms(Ne,N){return"s"===N?Ne*ni:Ne}function as(Ne,N,V){return Ne.hasOwnProperty("duration")?Ne:function fr(Ne,N,V){let Le,ot=0,Lt="";if("string"==typeof Ne){const Kt=Ne.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===Kt)return N.push(wn()),{duration:0,delay:0,easing:""};Le=ms(parseFloat(Kt[1]),Kt[2]);const mn=Kt[3];null!=mn&&(ot=ms(parseFloat(mn),Kt[4]));const Pn=Kt[5];Pn&&(Lt=Pn)}else Le=Ne;if(!V){let Kt=!1,mn=N.length;Le<0&&(N.push(function Rn(){return new C.wOt(3100,!1)}()),Kt=!0),ot<0&&(N.push(function an(){return new C.wOt(3101,!1)}()),Kt=!0),Kt&&N.splice(mn,0,wn())}return{duration:Le,delay:ot,easing:Lt}}(Ne,N,V)}function oo(Ne,N,V){N.forEach((te,Le)=>{const ot=Tt(Le);V&&!V.has(Le)&&V.set(Le,Ne.style[ot]),Ne.style[ot]=te})}function so(Ne,N){N.forEach((V,te)=>{const Le=Tt(te);Ne.style[Le]=""})}function ci(Ne){return Array.isArray(Ne)?1==Ne.length?Ne[0]:(0,Ze.K2)(Ne):Ne}const yr=new RegExp("{{\\s*(.+?)\\s*}}","g");function Uo(Ne){let N=[];if("string"==typeof Ne){let V;for(;V=yr.exec(Ne);)N.push(V[1]);yr.lastIndex=0}return N}function nt(Ne,N,V){const te=`${Ne}`,Le=te.replace(yr,(ot,Lt)=>{let Kt=N[Lt];return null==Kt&&(V.push(function nn(Ne){return new C.wOt(3003,!1)}()),Kt=""),Kt.toString()});return Le==te?Ne:Le}const Ft=/-+([a-z0-9])/g;function Tt(Ne){return Ne.replace(Ft,(...N)=>N[1].toUpperCase())}function Zn(Ne,N,V){switch(N.type){case Ze.If.Trigger:return Ne.visitTrigger(N,V);case Ze.If.State:return Ne.visitState(N,V);case Ze.If.Transition:return Ne.visitTransition(N,V);case Ze.If.Sequence:return Ne.visitSequence(N,V);case Ze.If.Group:return Ne.visitGroup(N,V);case Ze.If.Animate:return Ne.visitAnimate(N,V);case Ze.If.Keyframes:return Ne.visitKeyframes(N,V);case Ze.If.Style:return Ne.visitStyle(N,V);case Ze.If.Reference:return Ne.visitReference(N,V);case Ze.If.AnimateChild:return Ne.visitAnimateChild(N,V);case Ze.If.AnimateRef:return Ne.visitAnimateRef(N,V);case Ze.If.Query:return Ne.visitQuery(N,V);case Ze.If.Stagger:return Ne.visitStagger(N,V);default:throw function di(Ne){return new C.wOt(3004,!1)}()}}function Ei(Ne,N){return window.getComputedStyle(Ne)[N]}const An=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class no extends Pt{normalizePropertyName(N,V){return Tt(N)}normalizeStyleValue(N,V,te,Le){let ot="";const Lt=te.toString().trim();if(An.has(V)&&0!==te&&"0"!==te)if("number"==typeof te)ot="px";else{const Kt=te.match(/^[+-]?[\d\.]+([a-z]*)$/);Kt&&0==Kt[1].length&&Le.push(function Wn(Ne,N){return new C.wOt(3005,!1)}())}return Lt+ot}}const Ri="*";const io=new Set(["true","1"]),yo=new Set(["false","0"]);function Ji(Ne,N){const V=io.has(Ne)||yo.has(Ne),te=io.has(N)||yo.has(N);return(Le,ot)=>{let Lt=Ne==Ri||Ne==Le,Kt=N==Ri||N==ot;return!Lt&&V&&"boolean"==typeof Le&&(Lt=Le?io.has(Ne):yo.has(Ne)),!Kt&&te&&"boolean"==typeof ot&&(Kt=ot?io.has(N):yo.has(N)),Lt&&Kt}}const hr=new RegExp("s*:selfs*,?","g");function oa(Ne,N,V,te){return new gl(Ne).build(N,V,te)}class gl{constructor(N){this._driver=N}build(N,V,te){const Le=new qs(V);return this._resetContextStyleTimingState(Le),Zn(this,ci(N),Le)}_resetContextStyleTimingState(N){N.currentQuerySelector="",N.collectedStyles=new Map,N.collectedStyles.set("",new Map),N.currentTime=0}visitTrigger(N,V){let te=V.queryCount=0,Le=V.depCount=0;const ot=[],Lt=[];return"@"==N.name.charAt(0)&&V.errors.push(function $n(){return new C.wOt(3006,!1)}()),N.definitions.forEach(Kt=>{if(this._resetContextStyleTimingState(V),Kt.type==Ze.If.State){const mn=Kt,Pn=mn.name;Pn.toString().split(/\s*,\s*/).forEach(Pi=>{mn.name=Pi,ot.push(this.visitState(mn,V))}),mn.name=Pn}else if(Kt.type==Ze.If.Transition){const mn=this.visitTransition(Kt,V);te+=mn.queryCount,Le+=mn.depCount,Lt.push(mn)}else V.errors.push(function ki(){return new C.wOt(3007,!1)}())}),{type:Ze.If.Trigger,name:N.name,states:ot,transitions:Lt,queryCount:te,depCount:Le,options:null}}visitState(N,V){const te=this.visitStyle(N.styles,V),Le=N.options&&N.options.params||null;if(te.containsDynamicStyles){const ot=new Set,Lt=Le||{};te.styles.forEach(Kt=>{Kt instanceof Map&&Kt.forEach(mn=>{Uo(mn).forEach(Pn=>{Lt.hasOwnProperty(Pn)||ot.add(Pn)})})}),ot.size&&V.errors.push(function Jt(Ne,N){return new C.wOt(3008,!1)}(0,ot.values()))}return{type:Ze.If.State,name:N.name,style:te,options:Le?{params:Le}:null}}visitTransition(N,V){V.queryCount=0,V.depCount=0;const te=Zn(this,ci(N.animation),V),Le=function Oi(Ne,N){const V=[];return"string"==typeof Ne?Ne.split(/\s*,\s*/).forEach(te=>function nr(Ne,N,V){if(":"==Ne[0]){const mn=function mr(Ne,N){switch(Ne){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(V,te)=>parseFloat(te)>parseFloat(V);case":decrement":return(V,te)=>parseFloat(te)<parseFloat(V);default:return N.push(function Mi(Ne){return new C.wOt(3016,!1)}()),"* => *"}}(Ne,V);if("function"==typeof mn)return void N.push(mn);Ne=mn}const te=Ne.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==te||te.length<4)return V.push(function Si(Ne){return new C.wOt(3015,!1)}()),N;const Le=te[1],ot=te[2],Lt=te[3];N.push(Ji(Le,Lt)),"<"==ot[0]&&(Le!=Ri||Lt!=Ri)&&N.push(Ji(Lt,Le))}(te,V,N)):V.push(Ne),V}(N.expr,V.errors);return{type:Ze.If.Transition,matchers:Le,animation:te,queryCount:V.queryCount,depCount:V.depCount,options:Yo(N.options)}}visitSequence(N,V){return{type:Ze.If.Sequence,steps:N.steps.map(te=>Zn(this,te,V)),options:Yo(N.options)}}visitGroup(N,V){const te=V.currentTime;let Le=0;const ot=N.steps.map(Lt=>{V.currentTime=te;const Kt=Zn(this,Lt,V);return Le=Math.max(Le,V.currentTime),Kt});return V.currentTime=Le,{type:Ze.If.Group,steps:ot,options:Yo(N.options)}}visitAnimate(N,V){const te=function Ps(Ne,N){if(Ne.hasOwnProperty("duration"))return Ne;if("number"==typeof Ne)return Rr(as(Ne,N).duration,0,"");const V=Ne;if(V.split(/\s+/).some(ot=>"{"==ot.charAt(0)&&"{"==ot.charAt(1))){const ot=Rr(0,0,"");return ot.dynamic=!0,ot.strValue=V,ot}const Le=as(V,N);return Rr(Le.duration,Le.delay,Le.easing)}(N.timings,V.errors);V.currentAnimateTimings=te;let Le,ot=N.styles?N.styles:(0,Ze.iF)({});if(ot.type==Ze.If.Keyframes)Le=this.visitKeyframes(ot,V);else{let Lt=N.styles,Kt=!1;if(!Lt){Kt=!0;const Pn={};te.easing&&(Pn.easing=te.easing),Lt=(0,Ze.iF)(Pn)}V.currentTime+=te.duration+te.delay;const mn=this.visitStyle(Lt,V);mn.isEmptyStep=Kt,Le=mn}return V.currentAnimateTimings=null,{type:Ze.If.Animate,timings:te,style:Le,options:null}}visitStyle(N,V){const te=this._makeStyleAst(N,V);return this._validateStyleAst(te,V),te}_makeStyleAst(N,V){const te=[],Le=Array.isArray(N.styles)?N.styles:[N.styles];for(let Kt of Le)"string"==typeof Kt?Kt===Ze.kp?te.push(Kt):V.errors.push(new C.wOt(3002,!1)):te.push(new Map(Object.entries(Kt)));let ot=!1,Lt=null;return te.forEach(Kt=>{if(Kt instanceof Map&&(Kt.has("easing")&&(Lt=Kt.get("easing"),Kt.delete("easing")),!ot))for(let mn of Kt.values())if(mn.toString().indexOf("{{")>=0){ot=!0;break}}),{type:Ze.If.Style,styles:te,easing:Lt,offset:N.offset,containsDynamicStyles:ot,options:null}}_validateStyleAst(N,V){const te=V.currentAnimateTimings;let Le=V.currentTime,ot=V.currentTime;te&&ot>0&&(ot-=te.duration+te.delay),N.styles.forEach(Lt=>{"string"!=typeof Lt&&Lt.forEach((Kt,mn)=>{const Pn=V.collectedStyles.get(V.currentQuerySelector),Pi=Pn.get(mn);let Yi=!0;Pi&&(ot!=Le&&ot>=Pi.startTime&&Le<=Pi.endTime&&(V.errors.push(function dn(Ne,N,V,te,Le){return new C.wOt(3010,!1)}()),Yi=!1),ot=Pi.startTime),Yi&&Pn.set(mn,{startTime:ot,endTime:Le}),V.options&&function mo(Ne,N,V){const te=N.params||{},Le=Uo(Ne);Le.length&&Le.forEach(ot=>{te.hasOwnProperty(ot)||V.push(function Un(Ne){return new C.wOt(3001,!1)}())})}(Kt,V.options,V.errors)})})}visitKeyframes(N,V){const te={type:Ze.If.Keyframes,styles:[],options:null};if(!V.currentAnimateTimings)return V.errors.push(function jn(){return new C.wOt(3011,!1)}()),te;let ot=0;const Lt=[];let Kt=!1,mn=!1,Pn=0;const Pi=N.steps.map(vr=>{const Qo=this._makeStyleAst(vr,V);let Ue=null!=Qo.offset?Qo.offset:function Dr(Ne){if("string"==typeof Ne)return null;let N=null;if(Array.isArray(Ne))Ne.forEach(V=>{if(V instanceof Map&&V.has("offset")){const te=V;N=parseFloat(te.get("offset")),te.delete("offset")}});else if(Ne instanceof Map&&Ne.has("offset")){const V=Ne;N=parseFloat(V.get("offset")),V.delete("offset")}return N}(Qo.styles),De=0;return null!=Ue&&(ot++,De=Qo.offset=Ue),mn=mn||De<0||De>1,Kt=Kt||De<Pn,Pn=De,Lt.push(De),Qo});mn&&V.errors.push(function Yn(){return new C.wOt(3012,!1)}()),Kt&&V.errors.push(function zn(){return new C.wOt(3200,!1)}());const Yi=N.steps.length;let $r=0;ot>0&&ot<Yi?V.errors.push(function qn(){return new C.wOt(3202,!1)}()):0==ot&&($r=1/(Yi-1));const cr=Yi-1,ir=V.currentTime,Ar=V.currentAnimateTimings,bo=Ar.duration;return Pi.forEach((vr,Qo)=>{const Ue=$r>0?Qo==cr?1:$r*Qo:Lt[Qo],De=Ue*bo;V.currentTime=ir+Ar.delay+De,Ar.duration=De,this._validateStyleAst(vr,V),vr.offset=Ue,te.styles.push(vr)}),te}visitReference(N,V){return{type:Ze.If.Reference,animation:Zn(this,ci(N.animation),V),options:Yo(N.options)}}visitAnimateChild(N,V){return V.depCount++,{type:Ze.If.AnimateChild,options:Yo(N.options)}}visitAnimateRef(N,V){return{type:Ze.If.AnimateRef,animation:this.visitReference(N.animation,V),options:Yo(N.options)}}visitQuery(N,V){const te=V.currentQuerySelector,Le=N.options||{};V.queryCount++,V.currentQuery=N;const[ot,Lt]=function ol(Ne){const N=!!Ne.split(/\s*,\s*/).find(V=>":self"==V);return N&&(Ne=Ne.replace(hr,"")),Ne=Ne.replace(/@\*/g,Lr).replace(/@\w+/g,V=>Lr+"-"+V.slice(1)).replace(/:animating/g,Do),[Ne,N]}(N.selector);V.currentQuerySelector=te.length?te+" "+ot:ot,gi(V.collectedStyles,V.currentQuerySelector,new Map);const Kt=Zn(this,ci(N.animation),V);return V.currentQuery=null,V.currentQuerySelector=te,{type:Ze.If.Query,selector:ot,limit:Le.limit||0,optional:!!Le.optional,includeSelf:Lt,animation:Kt,originalSelector:N.selector,options:Yo(N.options)}}visitStagger(N,V){V.currentQuery||V.errors.push(function ar(){return new C.wOt(3013,!1)}());const te="full"===N.timings?{duration:0,delay:0,easing:"full"}:as(N.timings,V.errors,!0);return{type:Ze.If.Stagger,animation:Zn(this,ci(N.animation),V),timings:te,options:null}}}class qs{constructor(N){this.errors=N,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Yo(Ne){return Ne?(Ne={...Ne}).params&&(Ne.params=function Ga(Ne){return Ne?{...Ne}:null}(Ne.params)):Ne={},Ne}function Rr(Ne,N,V){return{duration:Ne,delay:N,easing:V}}function Zs(Ne,N,V,te,Le,ot,Lt=null,Kt=!1){return{type:1,element:Ne,keyframes:N,preStyleProps:V,postStyleProps:te,duration:Le,delay:ot,totalTime:Le+ot,easing:Lt,subTimeline:Kt}}class Wa{constructor(){this._map=new Map}get(N){return this._map.get(N)||[]}append(N,V){let te=this._map.get(N);te||this._map.set(N,te=[]),te.push(...V)}has(N){return this._map.has(N)}clear(){this._map.clear()}}const vs=new RegExp(":enter","g"),xo=new RegExp(":leave","g");function ga(Ne,N,V,te,Le,ot=new Map,Lt=new Map,Kt,mn,Pn=[]){return(new Da).buildKeyframes(Ne,N,V,te,Le,ot,Lt,Kt,mn,Pn)}class Da{buildKeyframes(N,V,te,Le,ot,Lt,Kt,mn,Pn,Pi=[]){Pn=Pn||new Wa;const Yi=new po(N,V,Pn,Le,ot,Pi,[]);Yi.options=mn;const $r=mn.delay?Or(mn.delay):0;Yi.currentTimeline.delayNextStep($r),Yi.currentTimeline.setStyles([Lt],null,Yi.errors,mn),Zn(this,te,Yi);const cr=Yi.timelines.filter(ir=>ir.containsAnimation());if(cr.length&&Kt.size){let ir;for(let Ar=cr.length-1;Ar>=0;Ar--){const bo=cr[Ar];if(bo.element===V){ir=bo;break}}ir&&!ir.allowOnlyTimelineStyles()&&ir.setStyles([Kt],null,Yi.errors,mn)}return cr.length?cr.map(ir=>ir.buildKeyframes()):[Zs(V,[],[],[],0,$r,"",!1)]}visitTrigger(N,V){}visitState(N,V){}visitTransition(N,V){}visitAnimateChild(N,V){const te=V.subInstructions.get(V.element);if(te){const Le=V.createSubContext(N.options),ot=V.currentTimeline.currentTime,Lt=this._visitSubInstructions(te,Le,Le.options);ot!=Lt&&V.transformIntoNewTimeline(Lt)}V.previousNode=N}visitAnimateRef(N,V){const te=V.createSubContext(N.options);te.transformIntoNewTimeline(),this._applyAnimationRefDelays([N.options,N.animation.options],V,te),this.visitReference(N.animation,te),V.transformIntoNewTimeline(te.currentTimeline.currentTime),V.previousNode=N}_applyAnimationRefDelays(N,V,te){for(const Le of N){const ot=Le?.delay;if(ot){const Lt="number"==typeof ot?ot:Or(nt(ot,Le?.params??{},V.errors));te.delayNextStep(Lt)}}}_visitSubInstructions(N,V,te){let ot=V.currentTimeline.currentTime;const Lt=null!=te.duration?Or(te.duration):null,Kt=null!=te.delay?Or(te.delay):null;return 0!==Lt&&N.forEach(mn=>{const Pn=V.appendInstructionToTimeline(mn,Lt,Kt);ot=Math.max(ot,Pn.duration+Pn.delay)}),ot}visitReference(N,V){V.updateOptions(N.options,!0),Zn(this,N.animation,V),V.previousNode=N}visitSequence(N,V){const te=V.subContextCount;let Le=V;const ot=N.options;if(ot&&(ot.params||ot.delay)&&(Le=V.createSubContext(ot),Le.transformIntoNewTimeline(),null!=ot.delay)){Le.previousNode.type==Ze.If.Style&&(Le.currentTimeline.snapshotCurrentStyles(),Le.previousNode=Io);const Lt=Or(ot.delay);Le.delayNextStep(Lt)}N.steps.length&&(N.steps.forEach(Lt=>Zn(this,Lt,Le)),Le.currentTimeline.applyStylesToKeyframe(),Le.subContextCount>te&&Le.transformIntoNewTimeline()),V.previousNode=N}visitGroup(N,V){const te=[];let Le=V.currentTimeline.currentTime;const ot=N.options&&N.options.delay?Or(N.options.delay):0;N.steps.forEach(Lt=>{const Kt=V.createSubContext(N.options);ot&&Kt.delayNextStep(ot),Zn(this,Lt,Kt),Le=Math.max(Le,Kt.currentTimeline.currentTime),te.push(Kt.currentTimeline)}),te.forEach(Lt=>V.currentTimeline.mergeTimelineCollectedStyles(Lt)),V.transformIntoNewTimeline(Le),V.previousNode=N}_visitTiming(N,V){if(N.dynamic){const te=N.strValue;return as(V.params?nt(te,V.params,V.errors):te,V.errors)}return{duration:N.duration,delay:N.delay,easing:N.easing}}visitAnimate(N,V){const te=V.currentAnimateTimings=this._visitTiming(N.timings,V),Le=V.currentTimeline;te.delay&&(V.incrementTime(te.delay),Le.snapshotCurrentStyles());const ot=N.style;ot.type==Ze.If.Keyframes?this.visitKeyframes(ot,V):(V.incrementTime(te.duration),this.visitStyle(ot,V),Le.applyStylesToKeyframe()),V.currentAnimateTimings=null,V.previousNode=N}visitStyle(N,V){const te=V.currentTimeline,Le=V.currentAnimateTimings;!Le&&te.hasCurrentStyleProperties()&&te.forwardFrame();const ot=Le&&Le.easing||N.easing;N.isEmptyStep?te.applyEmptyStep(ot):te.setStyles(N.styles,ot,V.errors,V.options),V.previousNode=N}visitKeyframes(N,V){const te=V.currentAnimateTimings,Le=V.currentTimeline.duration,ot=te.duration,Kt=V.createSubContext().currentTimeline;Kt.easing=te.easing,N.styles.forEach(mn=>{Kt.forwardTime((mn.offset||0)*ot),Kt.setStyles(mn.styles,mn.easing,V.errors,V.options),Kt.applyStylesToKeyframe()}),V.currentTimeline.mergeTimelineCollectedStyles(Kt),V.transformIntoNewTimeline(Le+ot),V.previousNode=N}visitQuery(N,V){const te=V.currentTimeline.currentTime,Le=N.options||{},ot=Le.delay?Or(Le.delay):0;ot&&(V.previousNode.type===Ze.If.Style||0==te&&V.currentTimeline.hasCurrentStyleProperties())&&(V.currentTimeline.snapshotCurrentStyles(),V.previousNode=Io);let Lt=te;const Kt=V.invokeQuery(N.selector,N.originalSelector,N.limit,N.includeSelf,!!Le.optional,V.errors);V.currentQueryTotal=Kt.length;let mn=null;Kt.forEach((Pn,Pi)=>{V.currentQueryIndex=Pi;const Yi=V.createSubContext(N.options,Pn);ot&&Yi.delayNextStep(ot),Pn===V.element&&(mn=Yi.currentTimeline),Zn(this,N.animation,Yi),Yi.currentTimeline.applyStylesToKeyframe(),Lt=Math.max(Lt,Yi.currentTimeline.currentTime)}),V.currentQueryIndex=0,V.currentQueryTotal=0,V.transformIntoNewTimeline(Lt),mn&&(V.currentTimeline.mergeTimelineCollectedStyles(mn),V.currentTimeline.snapshotCurrentStyles()),V.previousNode=N}visitStagger(N,V){const te=V.parentContext,Le=V.currentTimeline,ot=N.timings,Lt=Math.abs(ot.duration),Kt=Lt*(V.currentQueryTotal-1);let mn=Lt*V.currentQueryIndex;switch(ot.duration<0?"reverse":ot.easing){case"reverse":mn=Kt-mn;break;case"full":mn=te.currentStaggerTime}const Pi=V.currentTimeline;mn&&Pi.delayNextStep(mn);const Yi=Pi.currentTime;Zn(this,N.animation,V),V.previousNode=N,te.currentStaggerTime=Le.currentTime-Yi+(Le.startTime-te.currentTimeline.startTime)}}const Io={};class po{constructor(N,V,te,Le,ot,Lt,Kt,mn){this._driver=N,this.element=V,this.subInstructions=te,this._enterClassName=Le,this._leaveClassName=ot,this.errors=Lt,this.timelines=Kt,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Io,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=mn||new sa(this._driver,V,0),Kt.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(N,V){if(!N)return;const te=N;let Le=this.options;null!=te.duration&&(Le.duration=Or(te.duration)),null!=te.delay&&(Le.delay=Or(te.delay));const ot=te.params;if(ot){let Lt=Le.params;Lt||(Lt=this.options.params={}),Object.keys(ot).forEach(Kt=>{(!V||!Lt.hasOwnProperty(Kt))&&(Lt[Kt]=nt(ot[Kt],Lt,this.errors))})}}_copyOptions(){const N={};if(this.options){const V=this.options.params;if(V){const te=N.params={};Object.keys(V).forEach(Le=>{te[Le]=V[Le]})}}return N}createSubContext(N=null,V,te){const Le=V||this.element,ot=new po(this._driver,Le,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(Le,te||0));return ot.previousNode=this.previousNode,ot.currentAnimateTimings=this.currentAnimateTimings,ot.options=this._copyOptions(),ot.updateOptions(N),ot.currentQueryIndex=this.currentQueryIndex,ot.currentQueryTotal=this.currentQueryTotal,ot.parentContext=this,this.subContextCount++,ot}transformIntoNewTimeline(N){return this.previousNode=Io,this.currentTimeline=this.currentTimeline.fork(this.element,N),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(N,V,te){const Le={duration:V??N.duration,delay:this.currentTimeline.currentTime+(te??0)+N.delay,easing:""},ot=new Ms(this._driver,N.element,N.keyframes,N.preStyleProps,N.postStyleProps,Le,N.stretchStartingKeyframe);return this.timelines.push(ot),Le}incrementTime(N){this.currentTimeline.forwardTime(this.currentTimeline.duration+N)}delayNextStep(N){N>0&&this.currentTimeline.delayNextStep(N)}invokeQuery(N,V,te,Le,ot,Lt){let Kt=[];if(Le&&Kt.push(this.element),N.length>0){N=(N=N.replace(vs,"."+this._enterClassName)).replace(xo,"."+this._leaveClassName);let Pn=this._driver.query(this.element,N,1!=te);0!==te&&(Pn=te<0?Pn.slice(Pn.length+te,Pn.length):Pn.slice(0,te)),Kt.push(...Pn)}return!ot&&0==Kt.length&&Lt.push(function Gi(Ne){return new C.wOt(3014,!1)}()),Kt}}class sa{constructor(N,V,te,Le){this._driver=N,this.element=V,this.startTime=te,this._elementTimelineStylesLookup=Le,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(V),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(V,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(N){const V=1===this._keyframes.size&&this._pendingStyles.size;this.duration||V?(this.forwardTime(this.currentTime+N),V&&this.snapshotCurrentStyles()):this.startTime+=N}fork(N,V){return this.applyStylesToKeyframe(),new sa(this._driver,N,V||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(N){this.applyStylesToKeyframe(),this.duration=N,this._loadKeyframe()}_updateStyle(N,V){this._localTimelineStyles.set(N,V),this._globalTimelineStyles.set(N,V),this._styleSummary.set(N,{time:this.currentTime,value:V})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(N){N&&this._previousKeyframe.set("easing",N);for(let[V,te]of this._globalTimelineStyles)this._backFill.set(V,te||Ze.kp),this._currentKeyframe.set(V,Ze.kp);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(N,V,te,Le){V&&this._previousKeyframe.set("easing",V);const ot=Le&&Le.params||{},Lt=function vo(Ne,N){const V=new Map;let te;return Ne.forEach(Le=>{if("*"===Le){te??=N.keys();for(let ot of te)V.set(ot,Ze.kp)}else for(let[ot,Lt]of Le)V.set(ot,Lt)}),V}(N,this._globalTimelineStyles);for(let[Kt,mn]of Lt){const Pn=nt(mn,ot,te);this._pendingStyles.set(Kt,Pn),this._localTimelineStyles.has(Kt)||this._backFill.set(Kt,this._globalTimelineStyles.get(Kt)??Ze.kp),this._updateStyle(Kt,Pn)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((N,V)=>{this._currentKeyframe.set(V,N)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((N,V)=>{this._currentKeyframe.has(V)||this._currentKeyframe.set(V,N)}))}snapshotCurrentStyles(){for(let[N,V]of this._localTimelineStyles)this._pendingStyles.set(N,V),this._updateStyle(N,V)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const N=[];for(let V in this._currentKeyframe)N.push(V);return N}mergeTimelineCollectedStyles(N){N._styleSummary.forEach((V,te)=>{const Le=this._styleSummary.get(te);(!Le||V.time>Le.time)&&this._updateStyle(te,V.value)})}buildKeyframes(){this.applyStylesToKeyframe();const N=new Set,V=new Set,te=1===this._keyframes.size&&0===this.duration;let Le=[];this._keyframes.forEach((Kt,mn)=>{const Pn=new Map([...this._backFill,...Kt]);Pn.forEach((Pi,Yi)=>{Pi===Ze.FX?N.add(Yi):Pi===Ze.kp&&V.add(Yi)}),te||Pn.set("offset",mn/this.duration),Le.push(Pn)});const ot=[...N.values()],Lt=[...V.values()];if(te){const Kt=Le[0],mn=new Map(Kt);Kt.set("offset",0),mn.set("offset",1),Le=[Kt,mn]}return Zs(this.element,Le,ot,Lt,this.duration,this.startTime,this.easing,!1)}}class Ms extends sa{constructor(N,V,te,Le,ot,Lt,Kt=!1){super(N,V,Lt.delay),this.keyframes=te,this.preStyleProps=Le,this.postStyleProps=ot,this._stretchStartingKeyframe=Kt,this.timings={duration:Lt.duration,delay:Lt.delay,easing:Lt.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let N=this.keyframes,{delay:V,duration:te,easing:Le}=this.timings;if(this._stretchStartingKeyframe&&V){const ot=[],Lt=te+V,Kt=V/Lt,mn=new Map(N[0]);mn.set("offset",0),ot.push(mn);const Pn=new Map(N[0]);Pn.set("offset",Cs(Kt)),ot.push(Pn);const Pi=N.length-1;for(let Yi=1;Yi<=Pi;Yi++){let $r=new Map(N[Yi]);const cr=$r.get("offset");$r.set("offset",Cs((V+cr*te)/Lt)),ot.push($r)}te=Lt,V=0,Le="",N=ot}return Zs(this.element,N,this.preStyleProps,this.postStyleProps,te,V,Le,!0)}}function Cs(Ne,N=3){const V=Math.pow(10,N-1);return Math.round(Ne*V)/V}function zs(Ne,N,V,te,Le,ot,Lt,Kt,mn,Pn,Pi,Yi,$r){return{type:0,element:Ne,triggerName:N,isRemovalTransition:Le,fromState:V,fromStyles:ot,toState:te,toStyles:Lt,timelines:Kt,queriedElements:mn,preStyleProps:Pn,postStyleProps:Pi,totalTime:Yi,errors:$r}}const xr={};class aa{constructor(N,V,te){this._triggerName=N,this.ast=V,this._stateStyles=te}match(N,V,te,Le){return function ls(Ne,N,V,te,Le){return Ne.some(ot=>ot(N,V,te,Le))}(this.ast.matchers,N,V,te,Le)}buildStyles(N,V,te){let Le=this._stateStyles.get("*");return void 0!==N&&(Le=this._stateStyles.get(N?.toString())||Le),Le?Le.buildStyles(V,te):new Map}build(N,V,te,Le,ot,Lt,Kt,mn,Pn,Pi){const Yi=[],$r=this.ast.options&&this.ast.options.params||xr,ir=this.buildStyles(te,Kt&&Kt.params||xr,Yi),Ar=mn&&mn.params||xr,bo=this.buildStyles(Le,Ar,Yi),vr=new Set,Qo=new Map,Ue=new Map,De="void"===Le,ie={params:_a(Ar,$r),delay:this.ast.options?.delay},le=Pi?[]:ga(N,V,this.ast.animation,ot,Lt,ir,bo,ie,Pn,Yi);let W=0;return le.forEach(Ce=>{W=Math.max(Ce.duration+Ce.delay,W)}),Yi.length?zs(V,this._triggerName,te,Le,De,ir,bo,[],[],Qo,Ue,W,Yi):(le.forEach(Ce=>{const xe=Ce.element,ei=gi(Qo,xe,new Set);Ce.preStyleProps.forEach(Me=>ei.add(Me));const L=gi(Ue,xe,new Set);Ce.postStyleProps.forEach(Me=>L.add(Me)),xe!==V&&vr.add(xe)}),zs(V,this._triggerName,te,Le,De,ir,bo,le,[...vr.values()],Qo,Ue,W))}}function _a(Ne,N){const V={...N};return Object.entries(Ne).forEach(([te,Le])=>{null!=Le&&(V[te]=Le)}),V}class Xs{constructor(N,V,te){this.styles=N,this.defaultParams=V,this.normalizer=te}buildStyles(N,V){const te=new Map,Le=_a(N,this.defaultParams);return this.styles.styles.forEach(ot=>{"string"!=typeof ot&&ot.forEach((Lt,Kt)=>{Lt&&(Lt=nt(Lt,Le,V));const mn=this.normalizer.normalizePropertyName(Kt,V);Lt=this.normalizer.normalizeStyleValue(Kt,mn,Lt,V),te.set(Kt,Lt)})}),te}}class Is{constructor(N,V,te){this.name=N,this.ast=V,this._normalizer=te,this.transitionFactories=[],this.states=new Map,V.states.forEach(Le=>{this.states.set(Le.name,new Xs(Le.style,Le.options&&Le.options.params||{},te))}),Ka(this.states,"true","1"),Ka(this.states,"false","0"),V.transitions.forEach(Le=>{this.transitionFactories.push(new aa(N,Le,this.states))}),this.fallbackTransition=function Xo(Ne,N,V){return new aa(Ne,{type:Ze.If.Transition,animation:{type:Ze.If.Sequence,steps:[],options:null},matchers:[(Lt,Kt)=>!0],options:null,queryCount:0,depCount:0},N)}(N,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(N,V,te,Le){return this.transitionFactories.find(Lt=>Lt.match(N,V,te,Le))||null}matchStyles(N,V,te){return this.fallbackTransition.buildStyles(N,V,te)}}function Ka(Ne,N,V){Ne.has(N)?Ne.has(V)||Ne.set(V,Ne.get(N)):Ne.has(V)&&Ne.set(N,Ne.get(V))}const Qs=new Wa;class Sa{constructor(N,V,te){this.bodyNode=N,this._driver=V,this._normalizer=te,this._animations=new Map,this._playersById=new Map,this.players=[]}register(N,V){const te=[],ot=oa(this._driver,V,te,[]);if(te.length)throw function jt(Ne){return new C.wOt(3503,!1)}();this._animations.set(N,ot)}_buildPlayer(N,V,te){const Le=N.element,ot=si(this._normalizer,N.keyframes,V,te);return this._driver.animate(Le,ot,N.duration,N.delay,N.easing,[],!0)}create(N,V,te={}){const Le=[],ot=this._animations.get(N);let Lt;const Kt=new Map;if(ot?(Lt=ga(this._driver,V,ot,Cr,Jr,new Map,new Map,te,Qs,Le),Lt.forEach(Pi=>{const Yi=gi(Kt,Pi.element,new Map);Pi.postStyleProps.forEach($r=>Yi.set($r,null))})):(Le.push(function Dn(){return new C.wOt(3300,!1)}()),Lt=[]),Le.length)throw function Ai(Ne){return new C.wOt(3504,!1)}();Kt.forEach((Pi,Yi)=>{Pi.forEach(($r,cr)=>{Pi.set(cr,this._driver.computeStyle(Yi,cr,Ze.kp))})});const Pn=hn(Lt.map(Pi=>{const Yi=Kt.get(Pi.element);return this._buildPlayer(Pi,new Map,Yi)}));return this._playersById.set(N,Pn),Pn.onDestroy(()=>this.destroy(N)),this.players.push(Pn),Pn}destroy(N){const V=this._getPlayer(N);V.destroy(),this._playersById.delete(N);const te=this.players.indexOf(V);te>=0&&this.players.splice(te,1)}_getPlayer(N){const V=this._playersById.get(N);if(!V)throw function Sn(Ne){return new C.wOt(3301,!1)}();return V}listen(N,V,te,Le){const ot=bi(V,"","","");return Hi(this._getPlayer(N),te,ot,Le),()=>{}}command(N,V,te,Le){if("register"==te)return void this.register(N,Le[0]);if("create"==te)return void this.create(N,V,Le[0]||{});const ot=this._getPlayer(N);switch(te){case"play":ot.play();break;case"pause":ot.pause();break;case"reset":ot.reset();break;case"restart":ot.restart();break;case"finish":ot.finish();break;case"init":ot.init();break;case"setPosition":ot.setPosition(parseFloat(Le[0]));break;case"destroy":this.destroy(N)}}}const ca="ng-animate-queued",Go="ng-animate-disabled",Fa=[],Za={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Xa={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ts="__ng_removed";class Na{get params(){return this.options.params}constructor(N,V=""){this.namespaceId=V;const te=N&&N.hasOwnProperty("value");if(this.value=function Kr(Ne){return Ne??null}(te?N.value:N),te){const{value:ot,...Lt}=N;this.options=Lt}else this.options={};this.options.params||(this.options.params={})}absorbOptions(N){const V=N.params;if(V){const te=this.options.params;Object.keys(V).forEach(Le=>{null==te[Le]&&(te[Le]=V[Le])})}}}const Lo="void",ks=new Na(Lo);class ys{constructor(N,V,te){this.id=N,this.hostElement=V,this._engine=te,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+N,ko(V,this._hostClassName)}listen(N,V,te,Le){if(!this._triggers.has(V))throw function On(Ne,N){return new C.wOt(3302,!1)}();if(null==te||0==te.length)throw function st(Ne){return new C.wOt(3303,!1)}();if(!function Aa(Ne){return"start"==Ne||"done"==Ne}(te))throw function Xe(Ne,N){return new C.wOt(3400,!1)}();const ot=gi(this._elementListeners,N,[]),Lt={name:V,phase:te,callback:Le};ot.push(Lt);const Kt=gi(this._engine.statesByElement,N,new Map);return Kt.has(V)||(ko(N,eo),ko(N,eo+"-"+V),Kt.set(V,ks)),()=>{this._engine.afterFlush(()=>{const mn=ot.indexOf(Lt);mn>=0&&ot.splice(mn,1),this._triggers.has(V)||Kt.delete(V)})}}register(N,V){return!this._triggers.has(N)&&(this._triggers.set(N,V),!0)}_getTrigger(N){const V=this._triggers.get(N);if(!V)throw function ye(Ne){return new C.wOt(3401,!1)}();return V}trigger(N,V,te,Le=!0){const ot=this._getTrigger(V),Lt=new hs(this.id,V,N);let Kt=this._engine.statesByElement.get(N);Kt||(ko(N,eo),ko(N,eo+"-"+V),this._engine.statesByElement.set(N,Kt=new Map));let mn=Kt.get(V);const Pn=new Na(te,this.id);if(!(te&&te.hasOwnProperty("value"))&&mn&&Pn.absorbOptions(mn.options),Kt.set(V,Pn),mn||(mn=ks),Pn.value!==Lo&&mn.value===Pn.value){if(!function ua(Ne,N){const V=Object.keys(Ne),te=Object.keys(N);if(V.length!=te.length)return!1;for(let Le=0;Le<V.length;Le++){const ot=V[Le];if(!N.hasOwnProperty(ot)||Ne[ot]!==N[ot])return!1}return!0}(mn.params,Pn.params)){const Ar=[],bo=ot.matchStyles(mn.value,mn.params,Ar),vr=ot.matchStyles(Pn.value,Pn.params,Ar);Ar.length?this._engine.reportError(Ar):this._engine.afterFlush(()=>{so(N,bo),oo(N,vr)})}return}const $r=gi(this._engine.playersByElement,N,[]);$r.forEach(Ar=>{Ar.namespaceId==this.id&&Ar.triggerName==V&&Ar.queued&&Ar.destroy()});let cr=ot.matchTransition(mn.value,Pn.value,N,Pn.params),ir=!1;if(!cr){if(!Le)return;cr=ot.fallbackTransition,ir=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:N,triggerName:V,transition:cr,fromState:mn,toState:Pn,player:Lt,isFallbackTransition:ir}),ir||(ko(N,ca),Lt.onStart(()=>{Wo(N,ca)})),Lt.onDone(()=>{let Ar=this.players.indexOf(Lt);Ar>=0&&this.players.splice(Ar,1);const bo=this._engine.playersByElement.get(N);if(bo){let vr=bo.indexOf(Lt);vr>=0&&bo.splice(vr,1)}}),this.players.push(Lt),$r.push(Lt),Lt}deregister(N){this._triggers.delete(N),this._engine.statesByElement.forEach(V=>V.delete(N)),this._elementListeners.forEach((V,te)=>{this._elementListeners.set(te,V.filter(Le=>Le.name!=N))})}clearElementCache(N){this._engine.statesByElement.delete(N),this._elementListeners.delete(N);const V=this._engine.playersByElement.get(N);V&&(V.forEach(te=>te.destroy()),this._engine.playersByElement.delete(N))}_signalRemovalForInnerTriggers(N,V){const te=this._engine.driver.query(N,Lr,!0);te.forEach(Le=>{if(Le[Ts])return;const ot=this._engine.fetchNamespacesByElement(Le);ot.size?ot.forEach(Lt=>Lt.triggerLeaveAnimation(Le,V,!1,!0)):this.clearElementCache(Le)}),this._engine.afterFlushAnimationsDone(()=>te.forEach(Le=>this.clearElementCache(Le)))}triggerLeaveAnimation(N,V,te,Le){const ot=this._engine.statesByElement.get(N),Lt=new Map;if(ot){const Kt=[];if(ot.forEach((mn,Pn)=>{if(Lt.set(Pn,mn.value),this._triggers.has(Pn)){const Pi=this.trigger(N,Pn,Lo,Le);Pi&&Kt.push(Pi)}}),Kt.length)return this._engine.markElementAsRemoved(this.id,N,!0,V,Lt),te&&hn(Kt).onDone(()=>this._engine.processLeaveNode(N)),!0}return!1}prepareLeaveAnimationListeners(N){const V=this._elementListeners.get(N),te=this._engine.statesByElement.get(N);if(V&&te){const Le=new Set;V.forEach(ot=>{const Lt=ot.name;if(Le.has(Lt))return;Le.add(Lt);const mn=this._triggers.get(Lt).fallbackTransition,Pn=te.get(Lt)||ks,Pi=new Na(Lo),Yi=new hs(this.id,Lt,N);this._engine.totalQueuedPlayers++,this._queue.push({element:N,triggerName:Lt,transition:mn,fromState:Pn,toState:Pi,player:Yi,isFallbackTransition:!0})})}}removeNode(N,V){const te=this._engine;if(N.childElementCount&&this._signalRemovalForInnerTriggers(N,V),this.triggerLeaveAnimation(N,V,!0))return;let Le=!1;if(te.totalAnimations){const ot=te.players.length?te.playersByQueriedElement.get(N):[];if(ot&&ot.length)Le=!0;else{let Lt=N;for(;Lt=Lt.parentNode;)if(te.statesByElement.get(Lt)){Le=!0;break}}}if(this.prepareLeaveAnimationListeners(N),Le)te.markElementAsRemoved(this.id,N,!1,V);else{const ot=N[Ts];(!ot||ot===Za)&&(te.afterFlush(()=>this.clearElementCache(N)),te.destroyInnerAnimations(N),te._onRemovalComplete(N,V))}}insertNode(N,V){ko(N,this._hostClassName)}drainQueuedTransitions(N){const V=[];return this._queue.forEach(te=>{const Le=te.player;if(Le.destroyed)return;const ot=te.element,Lt=this._elementListeners.get(ot);Lt&&Lt.forEach(Kt=>{if(Kt.name==te.triggerName){const mn=bi(ot,te.triggerName,te.fromState.value,te.toState.value);mn._data=N,Hi(te.player,Kt.phase,mn,Kt.callback)}}),Le.markedForDestroy?this._engine.afterFlush(()=>{Le.destroy()}):V.push(te)}),this._queue=[],V.sort((te,Le)=>{const ot=te.transition.ast.depCount,Lt=Le.transition.ast.depCount;return 0==ot||0==Lt?ot-Lt:this._engine.driver.containsElement(te.element,Le.element)?1:-1})}destroy(N){this.players.forEach(V=>V.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,N)}}class xs{_onRemovalComplete(N,V){this.onRemovalComplete(N,V)}constructor(N,V,te,Le){this.bodyNode=N,this.driver=V,this._normalizer=te,this.scheduler=Le,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(ot,Lt)=>{}}get queuedPlayers(){const N=[];return this._namespaceList.forEach(V=>{V.players.forEach(te=>{te.queued&&N.push(te)})}),N}createNamespace(N,V){const te=new ys(N,V,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,V)?this._balanceNamespaceList(te,V):(this.newHostElements.set(V,te),this.collectEnterElement(V)),this._namespaceLookup[N]=te}_balanceNamespaceList(N,V){const te=this._namespaceList,Le=this.namespacesByHostElement;if(te.length-1>=0){let Lt=!1,Kt=this.driver.getParentElement(V);for(;Kt;){const mn=Le.get(Kt);if(mn){const Pn=te.indexOf(mn);te.splice(Pn+1,0,N),Lt=!0;break}Kt=this.driver.getParentElement(Kt)}Lt||te.unshift(N)}else te.push(N);return Le.set(V,N),N}register(N,V){let te=this._namespaceLookup[N];return te||(te=this.createNamespace(N,V)),te}registerTrigger(N,V,te){let Le=this._namespaceLookup[N];Le&&Le.register(V,te)&&this.totalAnimations++}destroy(N,V){N&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const te=this._fetchNamespace(N);this.namespacesByHostElement.delete(te.hostElement);const Le=this._namespaceList.indexOf(te);Le>=0&&this._namespaceList.splice(Le,1),te.destroy(V),delete this._namespaceLookup[N]}))}_fetchNamespace(N){return this._namespaceLookup[N]}fetchNamespacesByElement(N){const V=new Set,te=this.statesByElement.get(N);if(te)for(let Le of te.values())if(Le.namespaceId){const ot=this._fetchNamespace(Le.namespaceId);ot&&V.add(ot)}return V}trigger(N,V,te,Le){if(Bs(V)){const ot=this._fetchNamespace(N);if(ot)return ot.trigger(V,te,Le),!0}return!1}insertNode(N,V,te,Le){if(!Bs(V))return;const ot=V[Ts];if(ot&&ot.setForRemoval){ot.setForRemoval=!1,ot.setForMove=!0;const Lt=this.collectedLeaveElements.indexOf(V);Lt>=0&&this.collectedLeaveElements.splice(Lt,1)}if(N){const Lt=this._fetchNamespace(N);Lt&&Lt.insertNode(V,te)}Le&&this.collectEnterElement(V)}collectEnterElement(N){this.collectedEnterElements.push(N)}markElementAsDisabled(N,V){V?this.disabledNodes.has(N)||(this.disabledNodes.add(N),ko(N,Go)):this.disabledNodes.has(N)&&(this.disabledNodes.delete(N),Wo(N,Go))}removeNode(N,V,te){if(Bs(V)){this.scheduler?.notify();const Le=N?this._fetchNamespace(N):null;Le?Le.removeNode(V,te):this.markElementAsRemoved(N,V,!1,te);const ot=this.namespacesByHostElement.get(V);ot&&ot.id!==N&&ot.removeNode(V,te)}else this._onRemovalComplete(V,te)}markElementAsRemoved(N,V,te,Le,ot){this.collectedLeaveElements.push(V),V[Ts]={namespaceId:N,setForRemoval:Le,hasAnimation:te,removedBeforeQueried:!1,previousTriggersValues:ot}}listen(N,V,te,Le,ot){return Bs(V)?this._fetchNamespace(N).listen(V,te,Le,ot):()=>{}}_buildInstruction(N,V,te,Le,ot){return N.transition.build(this.driver,N.element,N.fromState.value,N.toState.value,te,Le,N.fromState.options,N.toState.options,V,ot)}destroyInnerAnimations(N){let V=this.driver.query(N,Lr,!0);V.forEach(te=>this.destroyActiveAnimationsForElement(te)),0!=this.playersByQueriedElement.size&&(V=this.driver.query(N,Do,!0),V.forEach(te=>this.finishActiveQueriedAnimationOnElement(te)))}destroyActiveAnimationsForElement(N){const V=this.playersByElement.get(N);V&&V.forEach(te=>{te.queued?te.markedForDestroy=!0:te.destroy()})}finishActiveQueriedAnimationOnElement(N){const V=this.playersByQueriedElement.get(N);V&&V.forEach(te=>te.finish())}whenRenderingDone(){return new Promise(N=>{if(this.players.length)return hn(this.players).onDone(()=>N());N()})}processLeaveNode(N){const V=N[Ts];if(V&&V.setForRemoval){if(N[Ts]=Za,V.namespaceId){this.destroyInnerAnimations(N);const te=this._fetchNamespace(V.namespaceId);te&&te.clearElementCache(N)}this._onRemovalComplete(N,V.setForRemoval)}N.classList?.contains(Go)&&this.markElementAsDisabled(N,!1),this.driver.query(N,".ng-animate-disabled",!0).forEach(te=>{this.markElementAsDisabled(te,!1)})}flush(N=-1){let V=[];if(this.newHostElements.size&&(this.newHostElements.forEach((te,Le)=>this._balanceNamespaceList(te,Le)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let te=0;te<this.collectedEnterElements.length;te++)ko(this.collectedEnterElements[te],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const te=[];try{V=this._flushAnimations(te,N)}finally{for(let Le=0;Le<te.length;Le++)te[Le]()}}else for(let te=0;te<this.collectedLeaveElements.length;te++)this.processLeaveNode(this.collectedLeaveElements[te]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(te=>te()),this._flushFns=[],this._whenQuietFns.length){const te=this._whenQuietFns;this._whenQuietFns=[],V.length?hn(V).onDone(()=>{te.forEach(Le=>Le())}):te.forEach(Le=>Le())}}reportError(N){throw function Ve(Ne){return new C.wOt(3402,!1)}()}_flushAnimations(N,V){const te=new Wa,Le=[],ot=new Map,Lt=[],Kt=new Map,mn=new Map,Pn=new Map,Pi=new Set;this.disabledNodes.forEach(Nt=>{Pi.add(Nt);const tn=this.driver.query(Nt,".ng-animate-queued",!0);for(let Xt=0;Xt<tn.length;Xt++)Pi.add(tn[Xt])});const Yi=this.bodyNode,$r=Array.from(this.statesByElement.keys()),cr=Hs($r,this.collectedEnterElements),ir=new Map;let Ar=0;cr.forEach((Nt,tn)=>{const Xt=Cr+Ar++;ir.set(tn,Xt),Nt.forEach(zi=>ko(zi,Xt))});const bo=[],vr=new Set,Qo=new Set;for(let Nt=0;Nt<this.collectedLeaveElements.length;Nt++){const tn=this.collectedLeaveElements[Nt],Xt=tn[Ts];Xt&&Xt.setForRemoval&&(bo.push(tn),vr.add(tn),Xt.hasAnimation?this.driver.query(tn,".ng-star-inserted",!0).forEach(zi=>vr.add(zi)):Qo.add(tn))}const Ue=new Map,De=Hs($r,Array.from(vr));De.forEach((Nt,tn)=>{const Xt=Jr+Ar++;Ue.set(tn,Xt),Nt.forEach(zi=>ko(zi,Xt))}),N.push(()=>{cr.forEach((Nt,tn)=>{const Xt=ir.get(tn);Nt.forEach(zi=>Wo(zi,Xt))}),De.forEach((Nt,tn)=>{const Xt=Ue.get(tn);Nt.forEach(zi=>Wo(zi,Xt))}),bo.forEach(Nt=>{this.processLeaveNode(Nt)})});const ie=[],le=[];for(let Nt=this._namespaceList.length-1;Nt>=0;Nt--)this._namespaceList[Nt].drainQueuedTransitions(V).forEach(Xt=>{const zi=Xt.player,pr=Xt.element;if(ie.push(zi),this.collectedEnterElements.length){const In=pr[Ts];if(In&&In.setForMove){if(In.previousTriggersValues&&In.previousTriggersValues.has(Xt.triggerName)){const Ni=In.previousTriggersValues.get(Xt.triggerName),Tr=this.statesByElement.get(Xt.element);if(Tr&&Tr.has(Xt.triggerName)){const uo=Tr.get(Xt.triggerName);uo.value=Ni,Tr.set(Xt.triggerName,uo)}}return void zi.destroy()}}const Pr=!Yi||!this.driver.containsElement(Yi,pr),er=Ue.get(pr),_r=ir.get(pr),rr=this._buildInstruction(Xt,te,_r,er,Pr);if(rr.errors&&rr.errors.length)return void le.push(rr);if(Pr)return zi.onStart(()=>so(pr,rr.fromStyles)),zi.onDestroy(()=>oo(pr,rr.toStyles)),void Le.push(zi);if(Xt.isFallbackTransition)return zi.onStart(()=>so(pr,rr.fromStyles)),zi.onDestroy(()=>oo(pr,rr.toStyles)),void Le.push(zi);const qr=[];rr.timelines.forEach(In=>{In.stretchStartingKeyframe=!0,this.disabledNodes.has(In.element)||qr.push(In)}),rr.timelines=qr,te.append(pr,rr.timelines),Lt.push({instruction:rr,player:zi,element:pr}),rr.queriedElements.forEach(In=>gi(Kt,In,[]).push(zi)),rr.preStyleProps.forEach((In,Ni)=>{if(In.size){let Tr=mn.get(Ni);Tr||mn.set(Ni,Tr=new Set),In.forEach((uo,ho)=>Tr.add(ho))}}),rr.postStyleProps.forEach((In,Ni)=>{let Tr=Pn.get(Ni);Tr||Pn.set(Ni,Tr=new Set),In.forEach((uo,ho)=>Tr.add(ho))})});if(le.length){const Nt=[];le.forEach(tn=>{Nt.push(function wt(Ne,N){return new C.wOt(3505,!1)}())}),ie.forEach(tn=>tn.destroy()),this.reportError(Nt)}const W=new Map,Ce=new Map;Lt.forEach(Nt=>{const tn=Nt.element;te.has(tn)&&(Ce.set(tn,tn),this._beforeAnimationBuild(Nt.player.namespaceId,Nt.instruction,W))}),Le.forEach(Nt=>{const tn=Nt.element;this._getPreviousPlayers(tn,!1,Nt.namespaceId,Nt.triggerName,null).forEach(zi=>{gi(W,tn,[]).push(zi),zi.destroy()})});const xe=bo.filter(Nt=>xa(Nt,mn,Pn)),ei=new Map;Js(ei,this.driver,Qo,Pn,Ze.kp).forEach(Nt=>{xa(Nt,mn,Pn)&&xe.push(Nt)});const Me=new Map;cr.forEach((Nt,tn)=>{Js(Me,this.driver,new Set(Nt),mn,Ze.FX)}),xe.forEach(Nt=>{const tn=ei.get(Nt),Xt=Me.get(Nt);ei.set(Nt,new Map([...tn?.entries()??[],...Xt?.entries()??[]]))});const X=[],pe=[],vt={};Lt.forEach(Nt=>{const{element:tn,player:Xt,instruction:zi}=Nt;if(te.has(tn)){if(Pi.has(tn))return Xt.onDestroy(()=>oo(tn,zi.toStyles)),Xt.disabled=!0,Xt.overrideTotalTime(zi.totalTime),void Le.push(Xt);let pr=vt;if(Ce.size>1){let er=tn;const _r=[];for(;er=er.parentNode;){const rr=Ce.get(er);if(rr){pr=rr;break}_r.push(er)}_r.forEach(rr=>Ce.set(rr,pr))}const Pr=this._buildAnimation(Xt.namespaceId,zi,W,ot,Me,ei);if(Xt.setRealPlayer(Pr),pr===vt)X.push(Xt);else{const er=this.playersByElement.get(pr);er&&er.length&&(Xt.parentPlayer=hn(er)),Le.push(Xt)}}else so(tn,zi.fromStyles),Xt.onDestroy(()=>oo(tn,zi.toStyles)),pe.push(Xt),Pi.has(tn)&&Le.push(Xt)}),pe.forEach(Nt=>{const tn=ot.get(Nt.element);if(tn&&tn.length){const Xt=hn(tn);Nt.setRealPlayer(Xt)}}),Le.forEach(Nt=>{Nt.parentPlayer?Nt.syncPlayerEvents(Nt.parentPlayer):Nt.destroy()});for(let Nt=0;Nt<bo.length;Nt++){const tn=bo[Nt],Xt=tn[Ts];if(Wo(tn,Jr),Xt&&Xt.hasAnimation)continue;let zi=[];if(Kt.size){let Pr=Kt.get(tn);Pr&&Pr.length&&zi.push(...Pr);let er=this.driver.query(tn,Do,!0);for(let _r=0;_r<er.length;_r++){let rr=Kt.get(er[_r]);rr&&rr.length&&zi.push(...rr)}}const pr=zi.filter(Pr=>!Pr.destroyed);pr.length?Hr(this,tn,pr):this.processLeaveNode(tn)}return bo.length=0,X.forEach(Nt=>{this.players.push(Nt),Nt.onDone(()=>{Nt.destroy();const tn=this.players.indexOf(Nt);this.players.splice(tn,1)}),Nt.play()}),X}afterFlush(N){this._flushFns.push(N)}afterFlushAnimationsDone(N){this._whenQuietFns.push(N)}_getPreviousPlayers(N,V,te,Le,ot){let Lt=[];if(V){const Kt=this.playersByQueriedElement.get(N);Kt&&(Lt=Kt)}else{const Kt=this.playersByElement.get(N);if(Kt){const mn=!ot||ot==Lo;Kt.forEach(Pn=>{Pn.queued||!mn&&Pn.triggerName!=Le||Lt.push(Pn)})}}return(te||Le)&&(Lt=Lt.filter(Kt=>!(te&&te!=Kt.namespaceId||Le&&Le!=Kt.triggerName))),Lt}_beforeAnimationBuild(N,V,te){const ot=V.element,Lt=V.isRemovalTransition?void 0:N,Kt=V.isRemovalTransition?void 0:V.triggerName;for(const mn of V.timelines){const Pn=mn.element,Pi=Pn!==ot,Yi=gi(te,Pn,[]);this._getPreviousPlayers(Pn,Pi,Lt,Kt,V.toState).forEach(cr=>{const ir=cr.getRealPlayer();ir.beforeDestroy&&ir.beforeDestroy(),cr.destroy(),Yi.push(cr)})}so(ot,V.fromStyles)}_buildAnimation(N,V,te,Le,ot,Lt){const Kt=V.triggerName,mn=V.element,Pn=[],Pi=new Set,Yi=new Set,$r=V.timelines.map(ir=>{const Ar=ir.element;Pi.add(Ar);const bo=Ar[Ts];if(bo&&bo.removedBeforeQueried)return new Ze.sf(ir.duration,ir.delay);const vr=Ar!==mn,Qo=function Ba(Ne){const N=[];return Qa(Ne,N),N}((te.get(Ar)||Fa).map(W=>W.getRealPlayer())).filter(W=>!!W.element&&W.element===Ar),Ue=ot.get(Ar),De=Lt.get(Ar),ie=si(this._normalizer,ir.keyframes,Ue,De),le=this._buildPlayer(ir,ie,Qo);if(ir.subTimeline&&Le&&Yi.add(Ar),vr){const W=new hs(N,Kt,Ar);W.setRealPlayer(le),Pn.push(W)}return le});Pn.forEach(ir=>{gi(this.playersByQueriedElement,ir.element,[]).push(ir),ir.onDone(()=>function Eo(Ne,N,V){let te=Ne.get(N);if(te){if(te.length){const Le=te.indexOf(V);te.splice(Le,1)}0==te.length&&Ne.delete(N)}return te}(this.playersByQueriedElement,ir.element,ir))}),Pi.forEach(ir=>ko(ir,Ci));const cr=hn($r);return cr.onDestroy(()=>{Pi.forEach(ir=>Wo(ir,Ci)),oo(mn,V.toStyles)}),Yi.forEach(ir=>{gi(Le,ir,[]).push(cr)}),cr}_buildPlayer(N,V,te){return V.length>0?this.driver.animate(N.element,V,N.duration,N.delay,N.easing,te):new Ze.sf(N.duration,N.delay)}}class hs{constructor(N,V,te){this.namespaceId=N,this.triggerName=V,this.element=te,this._player=new Ze.sf,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(N){this._containsRealPlayer||(this._player=N,this._queuedCallbacks.forEach((V,te)=>{V.forEach(Le=>Hi(N,te,void 0,Le))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(N.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(N){this.totalTime=N}syncPlayerEvents(N){const V=this._player;V.triggerCallback&&N.onStart(()=>V.triggerCallback("start")),N.onDone(()=>this.finish()),N.onDestroy(()=>this.destroy())}_queueEvent(N,V){gi(this._queuedCallbacks,N,[]).push(V)}onDone(N){this.queued&&this._queueEvent("done",N),this._player.onDone(N)}onStart(N){this.queued&&this._queueEvent("start",N),this._player.onStart(N)}onDestroy(N){this.queued&&this._queueEvent("destroy",N),this._player.onDestroy(N)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(N){this.queued||this._player.setPosition(N)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(N){const V=this._player;V.triggerCallback&&V.triggerCallback(N)}}function Bs(Ne){return Ne&&1===Ne.nodeType}function Va(Ne,N){const V=Ne.style.display;return Ne.style.display=N??"none",V}function Js(Ne,N,V,te,Le){const ot=[];V.forEach(mn=>ot.push(Va(mn)));const Lt=[];te.forEach((mn,Pn)=>{const Pi=new Map;mn.forEach(Yi=>{const $r=N.computeStyle(Pn,Yi,Le);Pi.set(Yi,$r),(!$r||0==$r.length)&&(Pn[Ts]=Xa,Lt.push(Pn))}),Ne.set(Pn,Pi)});let Kt=0;return V.forEach(mn=>Va(mn,ot[Kt++])),Lt}function Hs(Ne,N){const V=new Map;if(Ne.forEach(Kt=>V.set(Kt,[])),0==N.length)return V;const Le=new Set(N),ot=new Map;function Lt(Kt){if(!Kt)return 1;let mn=ot.get(Kt);if(mn)return mn;const Pn=Kt.parentNode;return mn=V.has(Pn)?Pn:Le.has(Pn)?1:Lt(Pn),ot.set(Kt,mn),mn}return N.forEach(Kt=>{const mn=Lt(Kt);1!==mn&&V.get(mn).push(Kt)}),V}function ko(Ne,N){Ne.classList?.add(N)}function Wo(Ne,N){Ne.classList?.remove(N)}function Hr(Ne,N,V){hn(V).onDone(()=>Ne.processLeaveNode(N))}function Qa(Ne,N){for(let V=0;V<Ne.length;V++){const te=Ne[V];te instanceof Ze.ui?Qa(te.players,N):N.push(te)}}function xa(Ne,N,V){const te=V.get(Ne);if(!te)return!1;let Le=N.get(Ne);return Le?te.forEach(ot=>Le.add(ot)):N.set(Ne,te),V.delete(Ne),!0}class Os{constructor(N,V,te,Le){this._driver=V,this._normalizer=te,this._triggerCache={},this.onRemovalComplete=(ot,Lt)=>{},this._transitionEngine=new xs(N.body,V,te,Le),this._timelineEngine=new Sa(N.body,V,te),this._transitionEngine.onRemovalComplete=(ot,Lt)=>this.onRemovalComplete(ot,Lt)}registerTrigger(N,V,te,Le,ot){const Lt=N+"-"+Le;let Kt=this._triggerCache[Lt];if(!Kt){const mn=[],Pi=oa(this._driver,ot,mn,[]);if(mn.length)throw function Ln(Ne,N){return new C.wOt(3404,!1)}();Kt=function la(Ne,N,V){return new Is(Ne,N,V)}(Le,Pi,this._normalizer),this._triggerCache[Lt]=Kt}this._transitionEngine.registerTrigger(V,Le,Kt)}register(N,V){this._transitionEngine.register(N,V)}destroy(N,V){this._transitionEngine.destroy(N,V)}onInsert(N,V,te,Le){this._transitionEngine.insertNode(N,V,te,Le)}onRemove(N,V,te){this._transitionEngine.removeNode(N,V,te)}disableAnimations(N,V){this._transitionEngine.markElementAsDisabled(N,V)}process(N,V,te,Le){if("@"==te.charAt(0)){const[ot,Lt]=lt(te);this._timelineEngine.command(ot,V,Lt,Le)}else this._transitionEngine.trigger(N,V,te,Le)}listen(N,V,te,Le,ot){if("@"==te.charAt(0)){const[Lt,Kt]=lt(te);return this._timelineEngine.listen(Lt,V,Kt,ot)}return this._transitionEngine.listen(N,V,te,Le,ot)}flush(N=-1){this._transitionEngine.flush(N)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(N){this._transitionEngine.afterFlushAnimationsDone(N)}}class sl{static{this.initialStylesByElement=new WeakMap}constructor(N,V,te){this._element=N,this._startStyles=V,this._endStyles=te,this._state=0;let Le=sl.initialStylesByElement.get(N);Le||sl.initialStylesByElement.set(N,Le=new Map),this._initialStyles=Le}start(){this._state<1&&(this._startStyles&&oo(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(oo(this._element,this._initialStyles),this._endStyles&&(oo(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(sl.initialStylesByElement.delete(this._element),this._startStyles&&(so(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(so(this._element,this._endStyles),this._endStyles=null),oo(this._element,this._initialStyles),this._state=3)}}function vl(Ne){let N=null;return Ne.forEach((V,te)=>{(function be(Ne){return"display"===Ne||"position"===Ne})(te)&&(N=N||new Map,N.set(te,V))}),N}class Ae{constructor(N,V,te,Le){this.element=N,this.keyframes=V,this.options=te,this._specialStyles=Le,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=te.duration,this._delay=te.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(N=>N()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const N=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,N,this.options),this._finalKeyframe=N.length?N[N.length-1]:new Map;const V=()=>this._onFinish();this.domPlayer.addEventListener("finish",V),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",V)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(N){const V=[];return N.forEach(te=>{V.push(Object.fromEntries(te))}),V}_triggerWebAnimation(N,V,te){return N.animate(this._convertKeyframesToObject(V),te)}onStart(N){this._originalOnStartFns.push(N),this._onStartFns.push(N)}onDone(N){this._originalOnDoneFns.push(N),this._onDoneFns.push(N)}onDestroy(N){this._onDestroyFns.push(N)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(N=>N()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(N=>N()),this._onDestroyFns=[])}setPosition(N){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=N*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const N=new Map;this.hasStarted()&&this._finalKeyframe.forEach((te,Le)=>{"offset"!==Le&&N.set(Le,this._finished?te:Ei(this.element,Le))}),this.currentSnapshot=N}triggerCallback(N){const V="start"===N?this._onStartFns:this._onDoneFns;V.forEach(te=>te()),V.length=0}}class K{validateStyleProperty(N){return!0}validateAnimatableStyleProperty(N){return!0}matchesElement(N,V){return!1}containsElement(N,V){return Z(N,V)}getParentElement(N){return Se(N)}query(N,V,te){return Y(N,V,te)}computeStyle(N,V,te){return Ei(N,V)}animate(N,V,te,Le,ot,Lt=[]){const mn={duration:te,delay:Le,fill:0==Le?"both":"forwards"};ot&&(mn.easing=ot);const Pn=new Map,Pi=Lt.filter(cr=>cr instanceof Ae);(function xn(Ne,N){return 0===Ne||0===N})(te,Le)&&Pi.forEach(cr=>{cr.currentSnapshot.forEach((ir,Ar)=>Pn.set(Ar,ir))});let Yi=function Xi(Ne){return Ne.length?Ne[0]instanceof Map?Ne:Ne.map(N=>new Map(Object.entries(N))):[]}(V).map(cr=>new Map(cr));Yi=function Xn(Ne,N,V){if(V.size&&N.length){let te=N[0],Le=[];if(V.forEach((ot,Lt)=>{te.has(Lt)||Le.push(Lt),te.set(Lt,ot)}),Le.length)for(let ot=1;ot<N.length;ot++){let Lt=N[ot];Le.forEach(Kt=>Lt.set(Kt,Ei(Ne,Kt)))}}return N}(N,Yi,Pn);const $r=function Pl(Ne,N){let V=null,te=null;return Array.isArray(N)&&N.length?(V=vl(N[0]),N.length>1&&(te=vl(N[N.length-1]))):N instanceof Map&&(V=vl(N)),V||te?new sl(Ne,V,te):null}(N,Yi);return new Ae(N,Yi,mn,$r)}}const Sr="@.disabled";class Yr{constructor(N,V,te,Le){this.namespaceId=N,this.delegate=V,this.engine=te,this._onDestroy=Le,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(N){this.delegate.destroyNode?.(N)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(N,V){return this.delegate.createElement(N,V)}createComment(N){return this.delegate.createComment(N)}createText(N){return this.delegate.createText(N)}appendChild(N,V){this.delegate.appendChild(N,V),this.engine.onInsert(this.namespaceId,V,N,!1)}insertBefore(N,V,te,Le=!0){this.delegate.insertBefore(N,V,te),this.engine.onInsert(this.namespaceId,V,N,Le)}removeChild(N,V,te){this.engine.onRemove(this.namespaceId,V,this.delegate)}selectRootElement(N,V){return this.delegate.selectRootElement(N,V)}parentNode(N){return this.delegate.parentNode(N)}nextSibling(N){return this.delegate.nextSibling(N)}setAttribute(N,V,te,Le){this.delegate.setAttribute(N,V,te,Le)}removeAttribute(N,V,te){this.delegate.removeAttribute(N,V,te)}addClass(N,V){this.delegate.addClass(N,V)}removeClass(N,V){this.delegate.removeClass(N,V)}setStyle(N,V,te,Le){this.delegate.setStyle(N,V,te,Le)}removeStyle(N,V,te){this.delegate.removeStyle(N,V,te)}setProperty(N,V,te){"@"==V.charAt(0)&&V==Sr?this.disableAnimations(N,!!te):this.delegate.setProperty(N,V,te)}setValue(N,V){this.delegate.setValue(N,V)}listen(N,V,te){return this.delegate.listen(N,V,te)}disableAnimations(N,V){this.engine.disableAnimations(N,V)}}class ea extends Yr{constructor(N,V,te,Le,ot){super(V,te,Le,ot),this.factory=N,this.namespaceId=V}setProperty(N,V,te){"@"==V.charAt(0)?"."==V.charAt(1)&&V==Sr?this.disableAnimations(N,te=void 0===te||!!te):this.engine.process(this.namespaceId,N,V.slice(1),te):this.delegate.setProperty(N,V,te)}listen(N,V,te){if("@"==V.charAt(0)){const Le=function ta(Ne){switch(Ne){case"body":return document.body;case"document":return document;case"window":return window;default:return Ne}}(N);let ot=V.slice(1),Lt="";return"@"!=ot.charAt(0)&&([ot,Lt]=function Ja(Ne){const N=Ne.indexOf(".");return[Ne.substring(0,N),Ne.slice(N+1)]}(ot)),this.engine.listen(this.namespaceId,Le,ot,Lt,Kt=>{this.factory.scheduleListenerCallback(Kt._data||-1,te,Kt)})}return this.delegate.listen(N,V,te)}}class Us{constructor(N,V,te){this.delegate=N,this.engine=V,this._zone=te,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,V.onRemovalComplete=(Le,ot)=>{const Lt=ot?.parentNode(Le);Lt&&ot.removeChild(Lt,Le)}}createRenderer(N,V){const Le=this.delegate.createRenderer(N,V);if(!N||!V?.data?.animation){const Pn=this._rendererCache;let Pi=Pn.get(Le);return Pi||(Pi=new Yr("",Le,this.engine,()=>Pn.delete(Le)),Pn.set(Le,Pi)),Pi}const ot=V.id,Lt=V.id+"-"+this._currentId;this._currentId++,this.engine.register(Lt,N);const Kt=Pn=>{Array.isArray(Pn)?Pn.forEach(Kt):this.engine.registerTrigger(ot,Lt,N,Pn.name,Pn)};return V.data.animation.forEach(Kt),new ea(this,Lt,Le,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(N,V,te){if(N>=0&&N<this._microtaskId)return void this._zone.run(()=>V(te));const Le=this._animationCallbacksBuffer;0==Le.length&&queueMicrotask(()=>{this._zone.run(()=>{Le.forEach(ot=>{const[Lt,Kt]=ot;Lt(Kt)}),this._animationCallbacksBuffer=[]})}),Le.push([V,te])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}const Ul=[{provide:Pt,useFactory:function Pa(){return new no}},{provide:Os,useClass:(()=>{class Ne extends Os{constructor(V,te,Le){super(V,te,Le,(0,C.WQX)(C.An2,{optional:!0}))}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(te){return new(te||Ne)(C.KVO(Ut.qQ),C.KVO(Je),C.KVO(Pt))}}static{this.\u0275prov=C.jDH({token:Ne,factory:Ne.\u0275fac})}}return Ne})()},{provide:C._9s,useFactory:function Hl(Ne,N,V){return new Us(Ne,N,V)},deps:[M.B7,Os,C.SKi]}],Ha=[{provide:Je,useFactory:()=>new K},{provide:C.bc$,useValue:"BrowserAnimations"},...Ul],zl=[{provide:Je,useClass:re},{provide:C.bc$,useValue:"NoopAnimations"},...Ul];let el=(()=>{class Ne{static withConfig(V){return{ngModule:Ne,providers:V.disableAnimations?zl:Ha}}static{this.\u0275fac=function(te){return new(te||Ne)}}static{this.\u0275mod=C.$C({type:Ne})}static{this.\u0275inj=C.G2t({providers:Ha,imports:[M.Bb]})}}return Ne})();var Ro=R(2490);class cs{static{this.URL_WHITELIST=[$e.c.geoescapeAPIURL]}constructor(N){this.cookieService=N}intercept(N,V){for(const Le of cs.URL_WHITELIST)if(N.url.startsWith(Le))return V.handle(N);const te=this.cookieService.get($e.c.acTokenCookieKey);if(te){const Le=N.headers.append("Authorization","Bearer "+te);N=N.clone({headers:Le})}return V.handle(N)}static{this.\u0275fac=function(V){return new(V||cs)(C.KVO(Ro.O))}}static{this.\u0275prov=C.jDH({token:cs,factory:cs.\u0275fac})}}var Es=R(7094),Zl=R(2096),Il=R(8954),al=R(5023),bs=R(3887);(0,Ut.EO)(zt);let kl=(()=>{class Ne{static{this.\u0275fac=function(te){return new(te||Ne)}}static{this.\u0275mod=C.$C({type:Ne,bootstrap:[sn]})}static{this.\u0275inj=C.G2t({providers:[{provide:Yt._N,useValue:Yt.Bh},Ro.O,{provide:At.a7,useClass:cs,multi:!0},Il.Y,al.O,{provide:"googleTagManagerId",useValue:"GTM-TLL8QGT9"}],imports:[M.Bb,mt,je.YN,At.q1,el,Es.Sg,Zl.U6,bs.G]})}}return Ne})();$e.c.production&&(0,C.SmG)();const Ia=Cesium.Rectangle.fromDegrees(114.28,-36,152.36,-11);Cesium.Camera.DEFAULT_VIEW_RECTANGLE=Ia,Cesium.Camera.DEFAULT_VIEW_FACTOR=1.2,Cesium.buildModuleUrl.setBaseUrl("/assets/cesium/"),Cesium.Ion.defaultAccessToken=$e.c.cesiumIonAccessToken,M.sG().bootstrapModule(kl).catch(Ne=>console.error(Ne))},4319:(Nn,Ct,R)=>{"use strict";R.d(Ct,{q:()=>C});var M={};function C(){return M}},3511:(Nn,Ct,R)=>{"use strict";function M(C){var de=new Date(Date.UTC(C.getFullYear(),C.getMonth(),C.getDate(),C.getHours(),C.getMinutes(),C.getSeconds(),C.getMilliseconds()));return de.setUTCFullYear(C.getFullYear()),C.getTime()-de.getTime()}R.d(Ct,{A:()=>M})},738:(Nn,Ct,R)=>{"use strict";function M(C,de){if(de.length<C)throw new TypeError(C+" argument"+(C>1?"s":"")+" required, but only "+de.length+" present")}R.d(Ct,{A:()=>M})},179:(Nn,Ct,R)=>{"use strict";function M(C){if(null===C||!0===C||!1===C)return NaN;var de=Number(C);return isNaN(de)?de:de<0?Math.ceil(de):Math.floor(de)}R.d(Ct,{A:()=>M})},6746:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Cg:()=>a,_m:()=>Fe,s0:()=>se}),Math.pow(10,8);var a=6e4,se=36e5,Fe=1e3},2764:(Nn,Ct,R)=>{"use strict";R.d(Ct,{A:()=>se});var M=R(2284),C=R(738),a=R(628);function se(Fe){if((0,C.A)(1,arguments),!function de(Fe){return(0,C.A)(1,arguments),Fe instanceof Date||"object"===(0,M.A)(Fe)&&"[object Date]"===Object.prototype.toString.call(Fe)}(Fe)&&"number"!=typeof Fe)return!1;var ve=(0,a.A)(Fe);return!isNaN(Number(ve))}},6190:(Nn,Ct,R)=>{"use strict";R.d(Ct,{A:()=>se});var M=R(628),C=R(179),de=R(738),a=R(4319);function se(Fe,ve){var ee,fe,he,ge,at,mt,$e,ze;(0,de.A)(1,arguments);var bt=(0,a.q)(),xt=(0,C.A)(null!==(ee=null!==(fe=null!==(he=null!==(ge=ve?.weekStartsOn)&&void 0!==ge?ge:null==ve||null===(at=ve.locale)||void 0===at||null===(mt=at.options)||void 0===mt?void 0:mt.weekStartsOn)&&void 0!==he?he:bt.weekStartsOn)&&void 0!==fe?fe:null===($e=bt.locale)||void 0===$e||null===(ze=$e.options)||void 0===ze?void 0:ze.weekStartsOn)&&void 0!==ee?ee:0);if(!(xt>=0&&xt<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var Qt=(0,M.A)(Fe),sn=Qt.getDay(),Yt=(sn<xt?7:0)+sn-xt;return Qt.setDate(Qt.getDate()-Yt),Qt.setHours(0,0,0,0),Qt}},628:(Nn,Ct,R)=>{"use strict";R.d(Ct,{A:()=>de});var M=R(2284),C=R(738);function de(a){(0,C.A)(1,arguments);var se=Object.prototype.toString.call(a);return a instanceof Date||"object"===(0,M.A)(a)&&"[object Date]"===se?new Date(a.getTime()):"number"==typeof a||"[object Number]"===se?new Date(a):(("string"==typeof a||"[object String]"===se)&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},1247:function(Nn){Nn.exports=function(){"use strict";var Ct,R,M;function C(a,se){if(Ct)if(R){var Fe="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Ct+")(sharedChunk); ("+R+")(sharedChunk); self.onerror = null;",ve={};Ct(ve),M=se(ve),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(M.workerUrl=window.URL.createObjectURL(new Blob([Fe],{type:"text/javascript"})))}else R=se;else Ct=se}return C(0,function(a){var se=typeof self<"u"?self:{},Fe="2.15.0";let ve;const ee={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==ve){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{ve=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):i}catch{ve=i}}return ve},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ee.API_URL)return null;try{const i=new URL(ee.API_URL);return"api.mapbox.cn"===i.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===i.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},fe={supported:!1,testSupport:function(i){!at&&ge&&(mt?$e(i):he=i)}};let he,ge,at=!1,mt=!1;function $e(i){const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,ge),i.isContextLost())return;fe.supported=!0}catch{}i.deleteTexture(e),at=!0}se.document&&(ge=se.document.createElement("img"),ge.onload=function(){he&&$e(he),he=null,mt=!0},ge.onerror=function(){at=!0,he=null},ge.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ze="01";function bt(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var xt=Qt;function Qt(i,e,o,l){this.cx=3*i,this.bx=3*(o-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(l-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=e,this.p2x=o,this.p2y=l}Qt.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,e){if(void 0===e&&(e=1e-6),i<0)return 0;if(i>1)return 1;for(var o=i,l=0;l<8;l++){var h=this.sampleCurveX(o)-i;if(Math.abs(h)<e)return o;var p=this.sampleCurveDerivativeX(o);if(Math.abs(p)<1e-6)break;o-=h/p}var g=0,x=1;for(o=i,l=0;l<20&&(h=this.sampleCurveX(o),!(Math.abs(h-i)<e));l++)i>h?g=o:x=o,o=.5*(x-g)+g;return o},solve:function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))}};var sn=bt(xt),Yt=Ut;function Ut(i,e){this.x=i,this.y=e}Ut.prototype={clone:function(){return new Ut(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,e){return this.clone()._rotateAround(i,e)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var e=i.x-this.x,o=i.y-this.y;return e*e+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult:function(i){var e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var e=Math.cos(i),o=Math.sin(i),l=o*this.x+e*this.y;return this.x=e*this.x-o*this.y,this.y=l,this},_rotateAround:function(i,e){var o=Math.cos(i),l=Math.sin(i),h=e.y+l*(this.x-e.x)+o*(this.y-e.y);return this.x=e.x+o*(this.x-e.x)-l*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ut.convert=function(i){return i instanceof Ut?i:Array.isArray(i)?new Ut(i[0],i[1]):i};var et=bt(Yt);const It=Math.PI/180,zt=180/Math.PI;function je(i){return i*It}function At(i){return i*zt}const Ze=[[0,0],[1,0],[1,1],[0,1]];function St(i){if(i<=0)return 0;if(i>=1)return 1;const e=i*i,o=e*i;return 4*(i<.5?o:3*(i-e)+o-.75)}function wn(i,e,o,l){const h=new sn(i,e,o,l);return function(p){return h.solve(p)}}const Rn=wn(.25,.1,.25,1);function an(i,e,o){return Math.min(o,Math.max(e,i))}function Un(i,e,o){return(o=an((o-i)/(e-i),0,1))*o*(3-2*o)}function nn(i,e,o){const l=o-e,h=((i-e)%l+l)%l+e;return h===e?o:h}function di(i,e,o){if(!i.length)return o(null,[]);let l=i.length;const h=new Array(i.length);let p=null;i.forEach((g,x)=>{e(g,(w,T)=>{w&&(p=w),h[x]=T,0==--l&&o(p,h)})})}function Wn(i){const e=[];for(const o in i)e.push(i[o]);return e}function $n(i,...e){for(const o of e)for(const l in o)i[l]=o[l];return i}let ki=1;function Jt(){return ki++}function un(){return function i(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function pn(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function dn(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function jn(i,e){i.forEach(o=>{e[o]&&(e[o]=e[o].bind(e))})}function Yn(i,e){return-1!==i.indexOf(e,i.length-e.length)}function zn(i,e,o){const l={};for(const h in i)l[h]=e.call(o||this,i[h],h,i);return l}function qn(i,e,o){const l={};for(const h in i)e.call(o||this,i[h],h,i)&&(l[h]=i[h]);return l}function ar(i){return Array.isArray(i)?i.map(ar):"object"==typeof i&&i?zn(i,ar):i}const Gi={};function Si(i){Gi[i]||(typeof console<"u"&&console.warn(i),Gi[i]=!0)}function Mi(i,e,o){return(o.y-i.y)*(e.x-i.x)>(e.y-i.y)*(o.x-i.x)}function Br(i){let e=0;for(let o,l,h=0,p=i.length,g=p-1;h<p;g=h++)o=i[h],l=i[g],e+=(l.x-o.x)*(o.y+l.y);return e}function ji(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ln(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,l,h,p)=>{const g=h||p;return e[l]=!g||g.toLowerCase(),""}),e["max-age"]){const o=parseInt(e["max-age"],10);isNaN(o)?delete e["max-age"]:e["max-age"]=o}return e}let Bt=null;function jt(i){if(null==Bt){const e=i.navigator?i.navigator.userAgent:null;Bt=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Bt}function Dn(i){try{const e=se[i];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ai(i,e){return[i[4*e],i[4*e+1],i[4*e+2],i[4*e+3]]}const Sn="mapbox-tiles";let Xe,ye,On=500,st=50;function Ve(){try{return se.caches}catch{}}function gt(){Ve()&&!Xe&&(Xe=se.caches.open(Sn))}function wt(i){const e=i.indexOf("?");if(e<0)return i;const l=function(h){const p=h.indexOf("?");return p>0?h.slice(p+1).split("&"):[]}(i).filter(h=>{const p=h.split("=");return"language"===p[0]||"worldview"===p[0]});return l.length?`${i.slice(0,e)}?${l.join("&")}`:i.slice(0,e)}let en=1/0;const hn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(hn);class si extends Error{constructor(e,o,l){401===o&&Et(l)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=o,this.url=l}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Hi=ji()?()=>self.worker&&self.worker.referrer:()=>("blob:"===se.location.protocol?se.parent:se).location.href,ti=function(i,e){if(!(/^file:/.test(o=i.url)||/^file:/.test(Hi())&&!/^\w+:/.test(o))){if(se.fetch&&se.Request&&se.AbortController&&se.Request.prototype.hasOwnProperty("signal"))return function(l,h){const p=new se.AbortController,g=new se.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:Hi(),referrerPolicy:l.referrerPolicy,signal:p.signal});let x=!1,w=!1;const T=(P=g.url).indexOf("sku=")>0&&Et(P);var P;"json"===l.type&&g.headers.set("Accept","application/json");const O=(j,q,ue)=>{if(w)return;if(j&&"SecurityError"!==j.message&&Si(j.toString()),q&&ue)return k(q);const Be=Date.now();se.fetch(g).then(tt=>{if(tt.ok){const _t=T?tt.clone():null;return k(tt,_t,Be)}return h(new si(tt.statusText,tt.status,l.url))}).catch(tt=>{"AbortError"!==tt.name&&h(new Error(`${tt.message} ${l.url}`))})},k=(j,q,ue)=>{("arrayBuffer"===l.type?j.arrayBuffer():"json"===l.type?j.json():j.text()).then(Be=>{w||(q&&ue&&function(tt,_t,rt){if(gt(),!Xe)return;const Dt={status:_t.status,statusText:_t.statusText,headers:new se.Headers};_t.headers.forEach((bn,_n)=>Dt.headers.set(_n,bn));const Rt=Ln(_t.headers.get("Cache-Control")||"");if(Rt["no-store"])return;Rt["max-age"]&&Dt.headers.set("Expires",new Date(rt+1e3*Rt["max-age"]).toUTCString());const Vt=Dt.headers.get("Expires");Vt&&(new Date(Vt).getTime()-rt<42e4||function(bn,_n){if(void 0===ye)try{new Response(new ReadableStream),ye=!0}catch{ye=!1}ye?_n(bn.body):bn.blob().then(_n)}(_t,bn=>{const _n=new se.Response(bn,Dt);gt(),Xe&&Xe.then(Vn=>Vn.put(wt(tt.url),_n)).catch(Vn=>Si(Vn.message))}))}(g,q,ue),x=!0,h(null,Be,j.headers.get("Cache-Control"),j.headers.get("Expires")))}).catch(Be=>{w||h(new Error(Be.message))})};return T?function(j,q){if(gt(),!Xe)return q(null);const ue=wt(j.url);Xe.then(Be=>{Be.match(ue).then(tt=>{const _t=function(rt){if(!rt)return!1;const Dt=new Date(rt.headers.get("Expires")||0),Rt=Ln(rt.headers.get("Cache-Control")||"");return Dt>Date.now()&&!Rt["no-cache"]}(tt);Be.delete(ue),_t&&Be.put(ue,tt.clone()),q(null,tt,_t)}).catch(q)}).catch(q)}(g,O):O(null,null),{cancel:()=>{w=!0,x||p.abort()}}}(i,e);if(ji()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var o;return function(l,h){const p=new se.XMLHttpRequest;p.open(l.method||"GET",l.url,!0),"arrayBuffer"===l.type&&(p.responseType="arraybuffer");for(const g in l.headers)p.setRequestHeader(g,l.headers[g]);return"json"===l.type&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials="include"===l.credentials,p.onerror=()=>{h(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||0===p.status)&&null!==p.response){let g=p.response;if("json"===l.type)try{g=JSON.parse(p.response)}catch(x){return h(x)}h(null,g,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else h(new si(p.statusText,p.status,l.url))},p.send(l.body),{cancel:()=>p.abort()}}(i,e)},bi=function(i,e){return ti($n(i,{type:"arrayBuffer"}),e)};function gi(i){const e=se.document.createElement("a");return e.href=i,e.protocol===se.document.location.protocol&&e.host===se.document.location.host}const lt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Pe,Se;Pe=[],Se=0;const dt=function(i,e){if(fe.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),Se>=ee.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:i,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Pe.push(p),p}Se++;let o=!1;const l=()=>{if(!o)for(o=!0,Se--;Pe.length&&Se<ee.MAX_PARALLEL_IMAGE_REQUESTS;){const p=Pe.shift(),{requestParameters:g,callback:x,cancelled:w}=p;w||(p.cancel=dt(g,x).cancel)}},h=bi(i,(p,g,x,w)=>{l(),p?e(p):g&&(se.createImageBitmap?function(T,P){const O=new se.Blob([new Uint8Array(T)],{type:"image/png"});se.createImageBitmap(O).then(k=>{P(null,k)}).catch(k=>{P(new Error(`Could not load image because of ${k.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(T,P)=>e(T,P,x,w)):function(T,P){const O=new se.Image,k=se.URL;O.onload=()=>{P(null,O),k.revokeObjectURL(O.src),O.onload=null,se.requestAnimationFrame(()=>{O.src=lt})},O.onerror=()=>P(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const j=new se.Blob([new Uint8Array(T)],{type:"image/png"});O.src=T.byteLength?k.createObjectURL(j):lt}(g,(T,P)=>e(T,P,x,w)))});return{cancel:()=>{h.cancel(),l()}}},Oe="NO_ACCESS_TOKEN";function Ke(i){return 0===i.indexOf("mapbox:")}function Et(i){return ee.API_URL_REGEX.test(i)}function Ie(i){return ee.API_CDN_URL_REGEX.test(i)}function ae(i){return ee.API_STYLE_REGEX.test(i)&&!Z(i)}function Z(i){return ee.API_SPRITE_REGEX.test(i)}const Y=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function _e(i){const e=i.match(Y);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function re(i){const e=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${e}`}const Je="mapbox.eventData";function Pt(i){if(!i)return null;const e=i.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(se.atob(e[1]).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Cn{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const o=Pt(ee.ACCESS_TOKEN);let l="";return l=o&&o.u?se.btoa(encodeURIComponent(o.u).replace(/%([0-9A-F]{2})/g,(h,p)=>String.fromCharCode(+("0x"+p)))):ee.ACCESS_TOKEN||"",e?`${Je}.${e}:${l}`:`${Je}:${l}`}fetchEventData(){const e=Dn("localStorage"),o=this.getStorageKey(),l=this.getStorageKey("uuid");if(e)try{const h=se.localStorage.getItem(o);h&&(this.eventData=JSON.parse(h));const p=se.localStorage.getItem(l);p&&(this.anonId=p)}catch{Si("Unable to read from LocalStorage")}}saveEventData(){const e=Dn("localStorage"),o=this.getStorageKey(),l=this.getStorageKey("uuid");if(e)try{se.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&se.localStorage.setItem(o,JSON.stringify(this.eventData))}catch{Si("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,o,l,h){if(!ee.EVENTS_URL)return;const p=_e(ee.EVENTS_URL);p.params.push(`access_token=${h||ee.ACCESS_TOKEN||""}`);const g={event:this.type,created:new Date(e).toISOString()},x=o?$n(g,o):g,w={url:re(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([x])};var P;this.pendingRequest=(P=T=>{this.pendingRequest=null,l(T),this.saveEventData(),this.processRequests(h)},ti($n(w,{method:"POST"}),P))}queueRequest(e,o){this.queue.push(e),this.processRequests(o)}}const ni=new class extends Cn{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,e){ee.EVENTS_URL&&ee.ACCESS_TOKEN&&Array.isArray(i)&&i.some(o=>Ke(o)||Et(o))&&this.queueRequest(Date.now(),e)}processRequests(i){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Pt(ee.ACCESS_TOKEN),o=e?e.u:ee.ACCESS_TOKEN;let l=o!==this.eventData.tokenU;dn(this.anonId)||(this.anonId=un(),l=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),g=new Date(h),x=(h-this.eventData.lastSuccess)/864e5;l=l||x>=1||x<-1||p.getDate()!==g.getDate()}else l=!0;l?this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Fe,skuId:ze,"enabled.telemetry":!1,userId:this.anonId},p=>{p||(this.eventData.lastSuccess=h,this.eventData.tokenU=o)},i):this.processRequests()}},xi=ni.postTurnstileEvent.bind(ni),sr=new class extends Cn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,e,o,l){this.skuToken=e,this.errorCb=l,ee.EVENTS_URL&&(o||ee.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},o):this.errorCb(new Error(Oe)))}processRequests(i){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:o}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),dn(this.anonId)||(this.anonId=un()),this.postEvent(o,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Fe,skuId:ze,skuToken:this.skuToken,userId:this.anonId},l=>{l?this.errorCb(l):e&&(this.success[e]=!0)},i))}},Cr=sr.postMapLoadEvent.bind(sr),Jr=new class extends Cn{constructor(){super("gljs.performance")}postPerformanceEvent(i,e){ee.EVENTS_URL&&(i||ee.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},i)}processRequests(i){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,performanceData:o}=this.queue.shift(),l=function(h){const p=se.performance.getEntriesByType("resource"),g=se.performance.getEntriesByType("mark"),x=function(k){const j={};if(k)for(const q in k)if("other"!==q)for(const ue of k[q]){const Be=`${q}ResolveRangeMin`,tt=`${q}ResolveRangeMax`,_t=`${q}RequestCount`,rt=`${q}RequestCachedCount`;j[Be]=Math.min(j[Be]||1/0,ue.startTime),j[tt]=Math.max(j[tt]||-1/0,ue.responseEnd);const Dt=Rt=>{void 0===j[Rt]&&(j[Rt]=0),++j[Rt]};void 0!==ue.transferSize&&0===ue.transferSize&&Dt(rt),Dt(_t)}return j}(function(k,j){const q={};if(k)for(const ue of k){const Be=j(ue);void 0===q[Be]&&(q[Be]=[]),q[Be].push(ue)}return q}(p,as)),w=se.devicePixelRatio,T=se.navigator.connection||se.navigator.mozConnection||se.navigator.webkitConnection,P={counters:[],metadata:[],attributes:[]},O=(k,j,q)=>{null!=q&&k.push({name:j,value:q.toString()})};for(const k in x)O(P.counters,k,x[k]);if(h.interactionRange[0]!==1/0&&h.interactionRange[1]!==-1/0&&(O(P.counters,"interactionRangeMin",h.interactionRange[0]),O(P.counters,"interactionRangeMax",h.interactionRange[1])),g)for(const k of Object.keys(Or)){const j=Or[k],q=g.find(ue=>ue.name===j);q&&O(P.counters,j,q.startTime)}return O(P.counters,"visibilityHidden",h.visibilityHidden),O(P.attributes,"style",function(k){if(k)for(const j of k){const q=j.name.split("?")[0];if(ae(q)){const ue=q.split("/").slice(-2);if(2===ue.length)return`mapbox://styles/${ue[0]}/${ue[1]}`}}}(p)),O(P.attributes,"terrainEnabled",h.terrainEnabled?"true":"false"),O(P.attributes,"fogEnabled",h.fogEnabled?"true":"false"),O(P.attributes,"projection",h.projection),O(P.attributes,"zoom",h.zoom),O(P.metadata,"devicePixelRatio",w),O(P.metadata,"connectionEffectiveType",T?T.effectiveType:void 0),O(P.metadata,"navigatorUserAgent",se.navigator.userAgent),O(P.metadata,"screenWidth",se.screen.width),O(P.metadata,"screenHeight",se.screen.height),O(P.metadata,"windowWidth",se.innerWidth),O(P.metadata,"windowHeight",se.innerHeight),O(P.metadata,"mapWidth",h.width/w),O(P.metadata,"mapHeight",h.height/w),O(P.metadata,"webglRenderer",h.renderer),O(P.metadata,"webglVendor",h.vendor),O(P.metadata,"sdkVersion",Fe),O(P.metadata,"sdkIdentifier","mapbox-gl-js"),P}(o);for(const h of l.metadata);for(const h of l.counters);for(const h of l.attributes);this.postEvent(e,l,()=>{},i)}},eo=Jr.postPerformanceEvent.bind(Jr),Lr=new class extends Cn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,e,o,l){if(!ee.API_URL||!ee.SESSION_PATH)return;const h=_e(ee.API_URL+ee.SESSION_PATH);h.params.push(`sku=${e||""}`),h.params.push(`access_token=${l||ee.ACCESS_TOKEN||""}`);const p={url:re(h),headers:{"Content-Type":"text/plain"}};var x;this.pendingRequest=(x=g=>{this.pendingRequest=null,o(g),this.saveEventData(),this.processRequests(l)},ti($n(p,{method:"GET"}),x))}getSessionAPI(i,e,o,l){this.skuToken=e,this.errorCb=l,ee.SESSION_PATH&&ee.API_URL&&(o||ee.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},o):this.errorCb(new Error(Oe)))}processRequests(i){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:o}=this.queue.shift();e&&this.success[e]||this.getSession(o,this.skuToken,l=>{l?this.errorCb(l):e&&(this.success[e]=!0)},i)}},Ci=Lr.getSessionAPI.bind(Lr),Do=new Set,Or={create:"create",load:"load",fullLoad:"fullLoad"},ms={mark(i){se.performance.mark(i)},measure(i,e,o){se.performance.measure(i,e,o)}};function as(i){const e=i.name.split("?")[0];return Ie(e)&&e.includes("mapbox-gl.js")?"javascript":Ie(e)&&e.includes("mapbox-gl.css")?"css":ee.API_FONTS_REGEX.test(e)?"fontRange":Z(e)?"sprite":ae(e)?"style":ee.API_TILEJSON_REGEX.test(e)?"tilejson":"other"}const fr=se.performance;function Xi(i){const e=i?i.url.toString():void 0;return fr.getEntriesByName(e)}let fo,oo,so,ci;const mo={now:()=>void 0!==so?so:se.performance.now(),setNow(i){so=i},restoreNow(){so=void 0},frame(i){const e=se.requestAnimationFrame(i);return{cancel:()=>se.cancelAnimationFrame(e)}},getImageData(i,e=0){const{width:o,height:l}=i;ci||(ci=se.document.createElement("canvas"));const h=ci.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(o>ci.width||l>ci.height)&&(ci.width=o,ci.height=l),h.clearRect(-e,-e,o+2*e,l+2*e),h.drawImage(i,0,0,o,l),h.getImageData(-e,-e,o+2*e,l+2*e)},resolveURL:i=>(fo||(fo=se.document.createElement("a")),fo.href=i,fo.href),get devicePixelRatio(){return se.devicePixelRatio},get prefersReducedMotion(){return!!se.matchMedia&&(null==oo&&(oo=se.matchMedia("(prefers-reduced-motion: reduce)")),oo.matches)}};function yr(i,e,o){o[i]&&-1!==o[i].indexOf(e)||(o[i]=o[i]||[],o[i].push(e))}function Uo(i,e,o){if(o&&o[i]){const l=o[i].indexOf(e);-1!==l&&o[i].splice(l,1)}}class nt{constructor(e,o={}){$n(this,o),this.type=e}}class Ft extends nt{constructor(e,o={}){super("error",$n({error:e},o))}}class Tt{on(e,o){return this._listeners=this._listeners||{},yr(e,o,this._listeners),this}off(e,o){return Uo(e,o,this._listeners),Uo(e,o,this._oneTimeListeners),this}once(e,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},yr(e,o,this._oneTimeListeners),this):new Promise(l=>this.once(e,l))}fire(e,o){"string"==typeof e&&(e=new nt(e,o||{}));const l=e.type;if(this.listens(l)){e.target=this;const h=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const x of h)x.call(this,e);const p=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const x of p)Uo(l,x,this._oneTimeListeners),x.call(this,e);const g=this._eventedParent;g&&($n(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),g.fire(e))}else e instanceof Ft&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,o){return this._eventedParent=e,this._eventedParentData=o,this}}var ht=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function xn(i,...e){for(const o of e)for(const l in o)i[l]=o[l];return i}function Xn(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Zn(i){if(Array.isArray(i))return i.map(Zn);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const o in i)e[o]=Zn(i[o]);return e}return Xn(i)}class Ei extends Error{constructor(e,o){super(o),this.message=o,this.key=e}}var An=Ei;class no{constructor(e,o=[]){this.parent=e,this.bindings={};for(const[l,h]of o)this.bindings[l]=h}concat(e){return new no(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var lr=no;const Mr={kind:"null"},ii={kind:"number"},vi={kind:"string"},Ui={kind:"boolean"},ur={kind:"color"},Ri={kind:"object"},Oi={kind:"value"},nr={kind:"collator"},mr={kind:"formatted"},io={kind:"resolvedImage"};function yo(i,e){return{kind:"array",itemType:i,N:e}}function Ji(i){if("array"===i.kind){const e=Ji(i.itemType);return"number"==typeof i.N?`array<${e}, ${i.N}>`:"value"===i.itemType.kind?"array":`array<${e}>`}return i.kind}const Zi=[Mr,ii,vi,Ui,ur,mr,Ri,yo(Oi),io];function hr(i,e){if("error"===e.kind)return null;if("array"===i.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!hr(i.itemType,e.itemType))&&("number"!=typeof i.N||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if("value"===i.kind)for(const o of Zi)if(!hr(o,e))return null}return`Expected ${Ji(i)} but found ${Ji(e)} instead.`}function oa(i,e){return e.some(o=>o.kind===i.kind)}function jo(i,e){return e.some(o=>"null"===o?null===i:"array"===o?Array.isArray(i):"object"===o?i&&!Array.isArray(i)&&"object"==typeof i:o===typeof i)}var gl,ol={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ga(i){return(i=Math.round(i))<0?0:i>255?255:i}function qs(i){return Ga("%"===i[i.length-1]?parseFloat(i)/100*255:parseInt(i))}function Dr(i){return(e="%"===i[i.length-1]?parseFloat(i)/100:parseFloat(i))<0?0:e>1?1:e;var e}function Ps(i,e,o){return o<0?o+=1:o>1&&(o-=1),6*o<1?i+(e-i)*o*6:2*o<1?e:3*o<2?i+(e-i)*(2/3-o)*6:i}try{gl={}.parseCSSColor=function(i){var e,o=i.replace(/ /g,"").toLowerCase();if(o in ol)return ol[o].slice();if("#"===o[0])return 4===o.length?(e=parseInt(o.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===o.length&&(e=parseInt(o.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=o.indexOf("("),h=o.indexOf(")");if(-1!==l&&h+1===o.length){var p=o.substr(0,l),g=o.substr(l+1,h-(l+1)).split(","),x=1;switch(p){case"rgba":if(4!==g.length)return null;x=Dr(g.pop());case"rgb":return 3!==g.length?null:[qs(g[0]),qs(g[1]),qs(g[2]),x];case"hsla":if(4!==g.length)return null;x=Dr(g.pop());case"hsl":if(3!==g.length)return null;var w=(parseFloat(g[0])%360+360)%360/360,T=Dr(g[1]),P=Dr(g[2]),O=P<=.5?P*(T+1):P+T-P*T,k=2*P-O;return[Ga(255*Ps(k,O,w+1/3)),Ga(255*Ps(k,O,w)),Ga(255*Ps(k,O,w-1/3)),x];default:return null}}return null}}catch{}class Yo{constructor(e,o,l,h=1){this.r=e,this.g=o,this.b=l,this.a=h}static parse(e){if(!e)return;if(e instanceof Yo)return e;if("string"!=typeof e)return;const o=gl(e);return o?new Yo(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[e,o,l,h]=this.toArray();return`rgba(${Math.round(e)},${Math.round(o)},${Math.round(l)},${h})`}toArray(){const{r:e,g:o,b:l,a:h}=this;return 0===h?[0,0,0,0]:[255*e/h,255*o/h,255*l/h,h]}toArray01(){const{r:e,g:o,b:l,a:h}=this;return 0===h?[0,0,0,0]:[e/h,o/h,l/h,h]}toArray01PremultipliedAlpha(){const{r:e,g:o,b:l,a:h}=this;return[e,o,l,h]}}Yo.black=new Yo(0,0,0,1),Yo.white=new Yo(1,1,1,1),Yo.transparent=new Yo(0,0,0,0),Yo.red=new Yo(1,0,0,1),Yo.blue=new Yo(0,0,1,1);var Rr=Yo;class Zs{constructor(e,o,l){this.sensitivity=e?o?"variant":"case":o?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,o){return this.collator.compare(e,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Wa{constructor(e,o,l,h,p){this.text=e.normalize?e.normalize():e,this.image=o,this.scale=l,this.fontStack=h,this.textColor=p}}class gs{constructor(e){this.sections=e}static fromString(e){return new gs([new Wa(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof gs?e:gs.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const o of this.sections){if(o.image){e.push(["image",o.image.name]);continue}e.push(o.text);const l={};o.fontStack&&(l["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(l["font-scale"]=o.scale),o.textColor&&(l["text-color"]=["rgba"].concat(o.textColor.toArray())),e.push(l)}return e}}class $o{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new $o({name:e,available:!1}):null}serialize(){return["image",this.name]}}function vs(i,e,o,l){return"number"==typeof i&&i>=0&&i<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof o&&o>=0&&o<=255?void 0===l||"number"==typeof l&&l>=0&&l<=1?null:`Invalid rgba value [${[i,e,o,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof l?[i,e,o,l]:[i,e,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function _s(i){if(null===i||"string"==typeof i||"boolean"==typeof i||"number"==typeof i||i instanceof Rr||i instanceof Zs||i instanceof gs||i instanceof $o)return!0;if(Array.isArray(i)){for(const e of i)if(!_s(e))return!1;return!0}if("object"==typeof i){for(const e in i)if(!_s(i[e]))return!1;return!0}return!1}function xo(i){if(null===i)return Mr;if("string"==typeof i)return vi;if("boolean"==typeof i)return Ui;if("number"==typeof i)return ii;if(i instanceof Rr)return ur;if(i instanceof Zs)return nr;if(i instanceof gs)return mr;if(i instanceof $o)return io;if(Array.isArray(i)){const e=i.length;let o;for(const l of i){const h=xo(l);if(o){if(o===h)continue;o=Oi;break}o=h}return yo(o||Oi,e)}return Ri}function ga(i){const e=typeof i;return null===i?"":"string"===e||"number"===e||"boolean"===e?String(i):i instanceof Rr||i instanceof gs||i instanceof $o?i.toString():JSON.stringify(i)}class Da{constructor(e,o){this.type=e,this.value=o}static parse(e,o){if(2!==e.length)return o.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!_s(e[1]))return o.error("invalid value");const l=e[1];let h=xo(l);const p=o.expectedType;return"array"!==h.kind||0!==h.N||!p||"array"!==p.kind||"number"==typeof p.N&&0!==p.N||(h=p),new Da(h,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Rr?["rgba"].concat(this.value.toArray()):this.value instanceof gs?this.value.serialize():this.value}}var Io=Da,po=class{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}};const sa={string:vi,number:ii,boolean:Ui,object:Ri};class Ms{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");let l,h=1;const p=e[0];if("array"===p){let x,w;if(e.length>2){const T=e[1];if("string"!=typeof T||!(T in sa)||"object"===T)return o.error('The item type argument of "array" must be one of string, number, boolean',1);x=sa[T],h++}else x=Oi;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return o.error('The length argument to "array" must be a positive integer literal',2);w=e[2],h++}l=yo(x,w)}else l=sa[p];const g=[];for(;h<e.length;h++){const x=o.parse(e[h],h,Oi);if(!x)return null;g.push(x)}return new Ms(l,g)}evaluate(e){for(let o=0;o<this.args.length;o++){const l=this.args[o].evaluate(e);if(!hr(this.type,xo(l)))return l;if(o===this.args.length-1)throw new po(`Expected value to be of type ${Ji(this.type)}, but found ${Ji(xo(l))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,o=[e.kind];if("array"===e.kind){const l=e.itemType;if("string"===l.kind||"number"===l.kind||"boolean"===l.kind){o.push(l.kind);const h=e.N;("number"==typeof h||this.args.length>1)&&o.push(h)}}return o.concat(this.args.map(l=>l.serialize()))}}var Cs=Ms;class vo{constructor(e){this.type=mr,this.sections=e}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const l=e[1];if(!Array.isArray(l)&&"object"==typeof l)return o.error("First argument must be an image or text section.");const h=[];let p=!1;for(let g=1;g<=e.length-1;++g){const x=e[g];if(p&&"object"==typeof x&&!Array.isArray(x)){p=!1;let w=null;if(x["font-scale"]&&(w=o.parse(x["font-scale"],1,ii),!w))return null;let T=null;if(x["text-font"]&&(T=o.parse(x["text-font"],1,yo(vi)),!T))return null;let P=null;if(x["text-color"]&&(P=o.parse(x["text-color"],1,ur),!P))return null;const O=h[h.length-1];O.scale=w,O.font=T,O.textColor=P}else{const w=o.parse(e[g],1,Oi);if(!w)return null;const T=w.type.kind;if("string"!==T&&"value"!==T&&"null"!==T&&"resolvedImage"!==T)return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,h.push({content:w,scale:null,font:null,textColor:null})}}return new vo(h)}evaluate(e){return new gs(this.sections.map(o=>{const l=o.content.evaluate(e);return xo(l)===io?new Wa("",l,null,null,null):new Wa(ga(l),null,o.scale?o.scale.evaluate(e):null,o.font?o.font.evaluate(e).join(","):null,o.textColor?o.textColor.evaluate(e):null)}))}eachChild(e){for(const o of this.sections)e(o.content),o.scale&&e(o.scale),o.font&&e(o.font),o.textColor&&e(o.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const o of this.sections){e.push(o.content.serialize());const l={};o.scale&&(l["font-scale"]=o.scale.serialize()),o.font&&(l["text-font"]=o.font.serialize()),o.textColor&&(l["text-color"]=o.textColor.serialize()),e.push(l)}return e}}class zs{constructor(e){this.type=io,this.input=e}static parse(e,o){if(2!==e.length)return o.error("Expected two arguments.");const l=o.parse(e[1],1,vi);return l?new zs(l):o.error("No image name provided.")}evaluate(e){const o=this.input.evaluate(e),l=$o.fromString(o);return l&&e.availableImages&&(l.available=e.availableImages.indexOf(o)>-1),l}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const xr={"to-boolean":Ui,"to-color":ur,"to-number":ii,"to-string":vi};class aa{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const l=e[0];if(("to-boolean"===l||"to-string"===l)&&2!==e.length)return o.error("Expected one argument.");const h=xr[l],p=[];for(let g=1;g<e.length;g++){const x=o.parse(e[g],g,Oi);if(!x)return null;p.push(x)}return new aa(h,p)}evaluate(e){if("boolean"===this.type.kind)return!!this.args[0].evaluate(e);if("color"===this.type.kind){let o,l;for(const h of this.args){if(o=h.evaluate(e),l=null,o instanceof Rr)return o;if("string"==typeof o){const p=e.parseColor(o);if(p)return p}else if(Array.isArray(o)&&(l=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:vs(o[0],o[1],o[2],o[3]),!l))return new Rr(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new po(l||`Could not parse color from value '${"string"==typeof o?o:String(JSON.stringify(o))}'`)}if("number"===this.type.kind){let o=null;for(const l of this.args){if(o=l.evaluate(e),null===o)return 0;const h=Number(o);if(!isNaN(h))return h}throw new po(`Could not convert ${JSON.stringify(o)} to number.`)}return"formatted"===this.type.kind?gs.fromString(ga(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?$o.fromString(ga(this.args[0].evaluate(e))):ga(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new vo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new zs(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(o=>{e.push(o.serialize())}),e}}var va=aa;const ls=["Unknown","Point","LineString","Polygon"];var _a=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ls[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:o,y:l}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(o*e-i[0])+this.featureDistanceData.bearing[1]*(l*e-i[1])}return 0}parseColor(i){let e=this._parseColorCache[i];return e||(e=this._parseColorCache[i]=Rr.parse(i)),e}};class Xs{constructor(e,o,l,h){this.name=e,this.type=o,this._evaluate=l,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,o){const l=e[0],h=Xs.definitions[l];if(!h)return o.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(h)?h[0]:h.type,g=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,x=g.filter(([T])=>!Array.isArray(T)||T.length===e.length-1);let w=null;for(const[T,P]of x){w=new Va(o.registry,o.path,null,o.scope);const O=[];let k=!1;for(let j=1;j<e.length;j++){const q=e[j],ue=Array.isArray(T)?T[j-1]:T.type,Be=w.parse(q,1+O.length,ue);if(!Be){k=!0;break}O.push(Be)}if(!k)if(Array.isArray(T)&&T.length!==O.length)w.error(`Expected ${T.length} arguments, but found ${O.length} instead.`);else{for(let j=0;j<O.length;j++){const q=Array.isArray(T)?T[j]:T.type,ue=O[j];w.concat(j+1).checkSubtype(q,ue.type)}if(0===w.errors.length)return new Xs(l,p,P,O)}}if(1===x.length)o.errors.push(...w.errors);else{const T=(x.length?x:g).map(([O])=>{return k=O,Array.isArray(k)?`(${k.map(Ji).join(", ")})`:`(${Ji(k.type)}...)`;var k}).join(" | "),P=[];for(let O=1;O<e.length;O++){const k=o.parse(e[O],1+P.length);if(!k)return null;P.push(Ji(k.type))}o.error(`Expected arguments of type ${T}, but found (${P.join(", ")}) instead.`)}return null}static register(e,o){Xs.definitions=o;for(const l in o)e[l]=Xs}}var la=Xs;class Is{constructor(e,o,l){this.type=nr,this.locale=l,this.caseSensitive=e,this.diacriticSensitive=o}static parse(e,o){if(2!==e.length)return o.error("Expected one argument.");const l=e[1];if("object"!=typeof l||Array.isArray(l))return o.error("Collator options argument must be an object.");const h=o.parse(void 0!==l["case-sensitive"]&&l["case-sensitive"],1,Ui);if(!h)return null;const p=o.parse(void 0!==l["diacritic-sensitive"]&&l["diacritic-sensitive"],1,Ui);if(!p)return null;let g=null;return l.locale&&(g=o.parse(l.locale,1,vi),!g)?null:new Is(h,p,g)}evaluate(e){return new Zs(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Xo=8192;function Ka(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function Qs(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function Sa(i,e){const o=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(o*h*Xo),Math.round(l*h*Xo)]}function ca(i,e,o){const l=i[0]-e[0],h=i[1]-e[1],p=i[0]-o[0],g=i[1]-o[1];return l*g-p*h==0&&l*p<=0&&h*g<=0}function qa(i,e){let o=!1;for(let g=0,x=e.length;g<x;g++){const w=e[g];for(let T=0,P=w.length;T<P-1;T++){if(ca(i,w[T],w[T+1]))return!1;(h=w[T])[1]>(l=i)[1]!=(p=w[T+1])[1]>l[1]&&l[0]<(p[0]-h[0])*(l[1]-h[1])/(p[1]-h[1])+h[0]&&(o=!o)}}var l,h,p;return o}function Go(i,e){for(let o=0;o<e.length;o++)if(qa(i,e[o]))return!0;return!1}function rs(i,e,o,l){const h=l[0]-o[0],p=l[1]-o[1],g=(i[0]-o[0])*p-h*(i[1]-o[1]),x=(e[0]-o[0])*p-h*(e[1]-o[1]);return g>0&&x<0||g<0&&x>0}function ya(i,e,o){for(const T of o)for(let P=0;P<T.length-1;++P)if((x=[(g=T[P+1])[0]-(p=T[P])[0],g[1]-p[1]])[0]*(w=[(h=e)[0]-(l=i)[0],h[1]-l[1]])[1]-x[1]*w[0]!=0&&rs(l,h,p,g)&&rs(p,g,l,h))return!0;var l,h,p,g,x,w;return!1}function br(i,e){for(let o=0;o<i.length;++o)if(!qa(i[o],e))return!1;for(let o=0;o<i.length-1;++o)if(ya(i[o],i[o+1],e))return!1;return!0}function Fa(i,e){for(let o=0;o<e.length;o++)if(br(i,e[o]))return!0;return!1}function Za(i,e,o){const l=[];for(let h=0;h<i.length;h++){const p=[];for(let g=0;g<i[h].length;g++){const x=Sa(i[h][g],o);Ka(e,x),p.push(x)}l.push(p)}return l}function Xa(i,e,o){const l=[];for(let h=0;h<i.length;h++){const p=Za(i[h],e,o);l.push(p)}return l}function Ts(i,e,o,l){if(i[0]<o[0]||i[0]>o[2]){const h=.5*l;let p=i[0]-o[0]>h?-l:o[0]-i[0]>h?l:0;0===p&&(p=i[0]-o[2]>h?-l:o[2]-i[0]>h?l:0),i[0]+=p}Ka(e,i)}function Na(i,e,o,l){const h=Math.pow(2,l.z)*Xo,p=[l.x*Xo,l.y*Xo],g=[];if(!i)return g;for(const x of i)for(const w of x){const T=[w.x+p[0],w.y+p[1]];Ts(T,e,o,h),g.push(T)}return g}function Lo(i,e,o,l){const h=Math.pow(2,l.z)*Xo,p=[l.x*Xo,l.y*Xo],g=[];if(!i)return g;for(const w of i){const T=[];for(const P of w){const O=[P.x+p[0],P.y+p[1]];Ka(e,O),T.push(O)}g.push(T)}if(e[2]-e[0]<=h/2){(x=e)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const w of g)for(const T of w)Ts(T,e,o,h)}var x;return g}class ks{constructor(e,o){this.type=Ui,this.geojson=e,this.geometries=o}static parse(e,o){if(2!==e.length)return o.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(_s(e[1])){const l=e[1];if("FeatureCollection"===l.type)for(let h=0;h<l.features.length;++h){const p=l.features[h].geometry.type;if("Polygon"===p||"MultiPolygon"===p)return new ks(l,l.features[h].geometry)}else if("Feature"===l.type){const h=l.geometry.type;if("Polygon"===h||"MultiPolygon"===h)return new ks(l,l.geometry)}else if("Polygon"===l.type||"MultiPolygon"===l.type)return new ks(l,l)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(o,l){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],g=o.canonicalID();if(!g)return!1;if("Polygon"===l.type){const x=Za(l.coordinates,p,g),w=Na(o.geometry(),h,p,g);if(!Qs(h,p))return!1;for(const T of w)if(!qa(T,x))return!1}if("MultiPolygon"===l.type){const x=Xa(l.coordinates,p,g),w=Na(o.geometry(),h,p,g);if(!Qs(h,p))return!1;for(const T of w)if(!Go(T,x))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(o,l){const h=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],g=o.canonicalID();if(!g)return!1;if("Polygon"===l.type){const x=Za(l.coordinates,p,g),w=Lo(o.geometry(),h,p,g);if(!Qs(h,p))return!1;for(const T of w)if(!br(T,x))return!1}if("MultiPolygon"===l.type){const x=Xa(l.coordinates,p,g),w=Lo(o.geometry(),h,p,g);if(!Qs(h,p))return!1;for(const T of w)if(!Fa(T,x))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var ys=ks;function xs(i){if(i instanceof la&&("get"===i.name&&1===i.args.length||"feature-state"===i.name||"has"===i.name&&1===i.args.length||"properties"===i.name||"geometry-type"===i.name||"id"===i.name||/^filter-/.test(i.name))||i instanceof ys)return!1;let e=!0;return i.eachChild(o=>{e&&!xs(o)&&(e=!1)}),e}function hs(i){if(i instanceof la&&"feature-state"===i.name)return!1;let e=!0;return i.eachChild(o=>{e&&!hs(o)&&(e=!1)}),e}function Eo(i,e){if(i instanceof la&&e.indexOf(i.name)>=0)return!1;let o=!0;return i.eachChild(l=>{o&&!Eo(l,e)&&(o=!1)}),o}class Kr{constructor(e,o){this.type=o.type,this.name=e,this.boundExpression=o}static parse(e,o){if(2!==e.length||"string"!=typeof e[1])return o.error("'var' expression requires exactly one string literal argument.");const l=e[1];return o.scope.has(l)?new Kr(l,o.scope.get(l)):o.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Bs=Kr;class Aa{constructor(e,o=[],l,h=new lr,p=[]){this.registry=e,this.path=o,this.key=o.map(g=>`[${g}]`).join(""),this.scope=h,this.errors=p,this.expectedType=l}parse(e,o,l,h,p={}){return o?this.concat(o,l,h)._parse(e,p):this._parse(e,p)}_parse(e,o){function l(h,p,g){return"assert"===g?new Cs(p,[h]):"coerce"===g?new va(p,[h]):h}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if("string"!=typeof h)return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[h];if(p){let g=p.parse(e,this);if(!g)return null;if(this.expectedType){const x=this.expectedType,w=g.type;if("string"!==x.kind&&"number"!==x.kind&&"boolean"!==x.kind&&"object"!==x.kind&&"array"!==x.kind||"value"!==w.kind)if("color"!==x.kind&&"formatted"!==x.kind&&"resolvedImage"!==x.kind||"value"!==w.kind&&"string"!==w.kind){if(this.checkSubtype(x,w))return null}else g=l(g,x,o.typeAnnotation||"coerce");else g=l(g,x,o.typeAnnotation||"assert")}if(!(g instanceof Io)&&"resolvedImage"!==g.type.kind&&Js(g)){const x=new _a;try{g=new Io(g.type,g.evaluate(x))}catch(w){return this.error(w.message),null}}return g}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,o,l){const h="number"==typeof e?this.path.concat(e):this.path,p=l?this.scope.concat(l):this.scope;return new Aa(this.registry,h,o||null,p,this.errors)}error(e,...o){const l=`${this.key}${o.map(h=>`[${h}]`).join("")}`;this.errors.push(new An(l,e))}checkSubtype(e,o){const l=hr(e,o);return l&&this.error(l),l}}var Va=Aa;function Js(i){if(i instanceof Bs)return Js(i.boundExpression);if(i instanceof la&&"error"===i.name||i instanceof Is||i instanceof ys)return!1;const e=i instanceof va||i instanceof Cs;let o=!0;return i.eachChild(l=>{o=e?o&&Js(l):o&&l instanceof Io}),!!o&&xs(i)&&Eo(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Hs(i,e){const o=i.length-1;let l,h,p=0,g=o,x=0;for(;p<=g;)if(x=Math.floor((p+g)/2),l=i[x],h=i[x+1],l<=e){if(x===o||e<h)return x;p=x+1}else{if(!(l>e))throw new po("Input is not a number.");g=x-1}return 0}class ko{constructor(e,o,l){this.type=e,this.input=o,this.labels=[],this.outputs=[];for(const[h,p]of l)this.labels.push(h),this.outputs.push(p)}static parse(e,o){if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");const l=o.parse(e[1],1,ii);if(!l)return null;const h=[];let p=null;o.expectedType&&"value"!==o.expectedType.kind&&(p=o.expectedType);for(let g=1;g<e.length;g+=2){const x=1===g?-1/0:e[g],w=e[g+1],T=g,P=g+1;if("number"!=typeof x)return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(h.length&&h[h.length-1][0]>=x)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const O=o.parse(w,P,p);if(!O)return null;p=p||O.type,h.push([x,O])}return new ko(p,l,h)}evaluate(e){const o=this.labels,l=this.outputs;if(1===o.length)return l[0].evaluate(e);const h=this.input.evaluate(e);if(h<=o[0])return l[0].evaluate(e);const p=o.length;return h>=o[p-1]?l[p-1].evaluate(e):l[Hs(o,h)].evaluate(e)}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&e.push(this.labels[o]),e.push(this.outputs[o].serialize());return e}}var Wo=ko;function Hr(i,e,o){return i*(1-o)+e*o}var Ba=Object.freeze({__proto__:null,array:function(i,e,o){return i.map((l,h)=>Hr(l,e[h],o))},color:function(i,e,o){return new Rr(Hr(i.r,e.r,o),Hr(i.g,e.g,o),Hr(i.b,e.b,o),Hr(i.a,e.a,o))},number:Hr});const xa=4/29,Os=6/29,Pl=3*Os*Os,sl=Os*Os*Os,vl=Math.PI/180,be=180/Math.PI;function Ae(i){return i>sl?Math.pow(i,1/3):i/Pl+xa}function K(i){return i>Os?i*i*i:Pl*(i-xa)}function Ge(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function Ht(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Fi(i){const e=Ht(i.r),o=Ht(i.g),l=Ht(i.b),h=Ae((.4124564*e+.3575761*o+.1804375*l)/.95047),p=Ae((.2126729*e+.7151522*o+.072175*l)/1);return{l:116*p-16,a:500*(h-p),b:200*(p-Ae((.0193339*e+.119192*o+.9503041*l)/1.08883)),alpha:i.a}}function Sr(i){let e=(i.l+16)/116,o=isNaN(i.a)?e:e+i.a/500,l=isNaN(i.b)?e:e-i.b/200;return e=1*K(e),o=.95047*K(o),l=1.08883*K(l),new Rr(Ge(3.2404542*o-1.5371385*e-.4985314*l),Ge(-.969266*o+1.8760108*e+.041556*l),Ge(.0556434*o-.2040259*e+1.0572252*l),i.alpha)}function Yr(i,e,o){const l=e-i;return i+o*(l>180||l<-180?l-360*Math.round(l/360):l)}const ea={forward:Fi,reverse:Sr,interpolate:function(i,e,o){return{l:Hr(i.l,e.l,o),a:Hr(i.a,e.a,o),b:Hr(i.b,e.b,o),alpha:Hr(i.alpha,e.alpha,o)}}},ta={forward:function(i){const{l:e,a:o,b:l}=Fi(i),h=Math.atan2(l,o)*be;return{h:h<0?h+360:h,c:Math.sqrt(o*o+l*l),l:e,alpha:i.a}},reverse:function(i){const e=i.h*vl,o=i.c;return Sr({l:i.l,a:Math.cos(e)*o,b:Math.sin(e)*o,alpha:i.alpha})},interpolate:function(i,e,o){return{h:Yr(i.h,e.h,o),c:Hr(i.c,e.c,o),l:Hr(i.l,e.l,o),alpha:Hr(i.alpha,e.alpha,o)}}};var Ja=Object.freeze({__proto__:null,hcl:ta,lab:ea});class Us{constructor(e,o,l,h,p){this.type=e,this.operator=o,this.interpolation=l,this.input=h,this.labels=[],this.outputs=[];for(const[g,x]of p)this.labels.push(g),this.outputs.push(x)}static interpolationFactor(e,o,l,h){let p=0;if("exponential"===e.name)p=Bl(o,e.base,l,h);else if("linear"===e.name)p=Bl(o,1,l,h);else if("cubic-bezier"===e.name){const g=e.controlPoints;p=new sn(g[0],g[1],g[2],g[3]).solve(Bl(o,1,l,h))}return p}static parse(e,o){let[l,h,p,...g]=e;if(!Array.isArray(h)||0===h.length)return o.error("Expected an interpolation type expression.",1);if("linear"===h[0])h={name:"linear"};else if("exponential"===h[0]){const T=h[1];if("number"!=typeof T)return o.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:T}}else{if("cubic-bezier"!==h[0])return o.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const T=h.slice(1);if(4!==T.length||T.some(P=>"number"!=typeof P||P<0||P>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:T}}}if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(p=o.parse(p,2,ii),!p)return null;const x=[];let w=null;"interpolate-hcl"===l||"interpolate-lab"===l?w=ur:o.expectedType&&"value"!==o.expectedType.kind&&(w=o.expectedType);for(let T=0;T<g.length;T+=2){const P=g[T],O=g[T+1],k=T+3,j=T+4;if("number"!=typeof P)return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(x.length&&x[x.length-1][0]>=P)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',k);const q=o.parse(O,j,w);if(!q)return null;w=w||q.type,x.push([P,q])}return"number"===w.kind||"color"===w.kind||"array"===w.kind&&"number"===w.itemType.kind&&"number"==typeof w.N?new Us(w,l,h,p,x):o.error(`Type ${Ji(w)} is not interpolatable.`)}evaluate(e){const o=this.labels,l=this.outputs;if(1===o.length)return l[0].evaluate(e);const h=this.input.evaluate(e);if(h<=o[0])return l[0].evaluate(e);const p=o.length;if(h>=o[p-1])return l[p-1].evaluate(e);const g=Hs(o,h),x=Us.interpolationFactor(this.interpolation,h,o[g],o[g+1]),w=l[g].evaluate(e),T=l[g+1].evaluate(e);return"interpolate"===this.operator?Ba[this.type.kind.toLowerCase()](w,T,x):"interpolate-hcl"===this.operator?ta.reverse(ta.interpolate(ta.forward(w),ta.forward(T),x)):ea.reverse(ea.interpolate(ea.forward(w),ea.forward(T),x))}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,e,this.input.serialize()];for(let l=0;l<this.labels.length;l++)o.push(this.labels[l],this.outputs[l].serialize());return o}}function Bl(i,e,o,l){const h=l-o,p=i-o;return 0===h?0:1===e?p/h:(Math.pow(e,p)-1)/(Math.pow(e,h)-1)}var Pa=Us;class Hl{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expectected at least one argument.");let l=null;const h=o.expectedType;h&&"value"!==h.kind&&(l=h);const p=[];for(const x of e.slice(1)){const w=o.parse(x,1+p.length,l,void 0,{typeAnnotation:"omit"});if(!w)return null;l=l||w.type,p.push(w)}const g=h&&p.some(x=>hr(h,x.type));return new Hl(g?Oi:l,p)}evaluate(e){let o,l=null,h=0;for(const p of this.args){if(h++,l=p.evaluate(e),l&&l instanceof $o&&!l.available&&(o||(o=l),l=null,h===this.args.length))return o;if(null!==l)break}return l}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(o=>{e.push(o.serialize())}),e}}var Ul=Hl;class Ha{constructor(e,o){this.type=o.type,this.bindings=[].concat(e),this.result=o}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const o of this.bindings)e(o[1]);e(this.result)}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const l=[];for(let p=1;p<e.length-1;p+=2){const g=e[p];if("string"!=typeof g)return o.error(`Expected string, but found ${typeof g} instead.`,p);if(/[^a-zA-Z0-9_]/.test(g))return o.error("Variable names must contain only alphanumeric characters or '_'.",p);const x=o.parse(e[p+1],p+1);if(!x)return null;l.push([g,x])}const h=o.parse(e[e.length-1],e.length-1,o.expectedType,l);return h?new Ha(l,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[o,l]of this.bindings)e.push(o,l.serialize());return e.push(this.result.serialize()),e}}var zl=Ha;class el{constructor(e,o,l){this.type=e,this.index=o,this.input=l}static parse(e,o){if(3!==e.length)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,ii),h=o.parse(e[2],2,yo(o.expectedType||Oi));return l&&h?new el(h.type.itemType,l,h):null}evaluate(e){const o=this.index.evaluate(e),l=this.input.evaluate(e);if(o<0)throw new po(`Array index out of bounds: ${o} < 0.`);if(o>=l.length)throw new po(`Array index out of bounds: ${o} > ${l.length-1}.`);if(o!==Math.floor(o))throw new po(`Array index must be an integer, but found ${o} instead.`);return l[o]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var nc=el;class Gr{constructor(e,o){this.type=Ui,this.needle=e,this.haystack=o}static parse(e,o){if(3!==e.length)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,Oi),h=o.parse(e[2],2,Oi);return l&&h?oa(l.type,[Ui,vi,ii,Mr,Oi])?new Gr(l,h):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ji(l.type)} instead`):null}evaluate(e){const o=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(null==l)return!1;if(!jo(o,["boolean","string","number","null"]))throw new po(`Expected first argument to be of type boolean, string, number or null, but found ${Ji(xo(o))} instead.`);if(!jo(l,["string","array"]))throw new po(`Expected second argument to be of type array or string, but found ${Ji(xo(l))} instead.`);return l.indexOf(o)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var os=Gr;class Ro{constructor(e,o,l){this.type=ii,this.needle=e,this.haystack=o,this.fromIndex=l}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,Oi),h=o.parse(e[2],2,Oi);if(!l||!h)return null;if(!oa(l.type,[Ui,vi,ii,Mr,Oi]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ji(l.type)} instead`);if(4===e.length){const p=o.parse(e[3],3,ii);return p?new Ro(l,h,p):null}return new Ro(l,h)}evaluate(e){const o=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!jo(o,["boolean","string","number","null"]))throw new po(`Expected first argument to be of type boolean, string, number or null, but found ${Ji(xo(o))} instead.`);if(!jo(l,["string","array"]))throw new po(`Expected second argument to be of type array or string, but found ${Ji(xo(l))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return l.indexOf(o,h)}return l.indexOf(o)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var cs=Ro;class Es{constructor(e,o,l,h,p,g){this.inputType=e,this.type=o,this.input=l,this.cases=h,this.outputs=p,this.otherwise=g}static parse(e,o){if(e.length<5)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return o.error("Expected an even number of arguments.");let l,h;o.expectedType&&"value"!==o.expectedType.kind&&(h=o.expectedType);const p={},g=[];for(let T=2;T<e.length-1;T+=2){let P=e[T];const O=e[T+1];Array.isArray(P)||(P=[P]);const k=o.concat(T);if(0===P.length)return k.error("Expected at least one branch label.");for(const q of P){if("number"!=typeof q&&"string"!=typeof q)return k.error("Branch labels must be numbers or strings.");if("number"==typeof q&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return k.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof q&&Math.floor(q)!==q)return k.error("Numeric branch labels must be integer values.");if(l){if(k.checkSubtype(l,xo(q)))return null}else l=xo(q);if(void 0!==p[String(q)])return k.error("Branch labels must be unique.");p[String(q)]=g.length}const j=o.parse(O,T,h);if(!j)return null;h=h||j.type,g.push(j)}const x=o.parse(e[1],1,Oi);if(!x)return null;const w=o.parse(e[e.length-1],e.length-1,h);return w?"value"!==x.type.kind&&o.concat(1).checkSubtype(l,x.type)?null:new Es(l,h,x,p,g,w):null}evaluate(e){const o=this.input.evaluate(e);return(xo(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),l=[],h={};for(const g of o){const x=h[this.cases[g]];void 0===x?(h[this.cases[g]]=l.length,l.push([this.cases[g],[g]])):l[x][1].push(g)}const p=g=>"number"===this.inputType.kind?Number(g):g;for(const[g,x]of l)e.push(1===x.length?p(x[0]):x.map(p)),e.push(this.outputs[g].serialize());return e.push(this.otherwise.serialize()),e}}var Zl=Es;class Il{constructor(e,o,l){this.type=e,this.branches=o,this.otherwise=l}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return o.error("Expected an odd number of arguments.");let l;o.expectedType&&"value"!==o.expectedType.kind&&(l=o.expectedType);const h=[];for(let g=1;g<e.length-1;g+=2){const x=o.parse(e[g],g,Ui);if(!x)return null;const w=o.parse(e[g+1],g+1,l);if(!w)return null;h.push([x,w]),l=l||w.type}const p=o.parse(e[e.length-1],e.length-1,l);return p?new Il(l,h,p):null}evaluate(e){for(const[o,l]of this.branches)if(o.evaluate(e))return l.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[o,l]of this.branches)e(o),e(l);e(this.otherwise)}outputDefined(){return this.branches.every(([e,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(o=>{e.push(o.serialize())}),e}}var al=Il;class bs{constructor(e,o,l,h){this.type=e,this.input=o,this.beginIndex=l,this.endIndex=h}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=o.parse(e[1],1,Oi),h=o.parse(e[2],2,ii);if(!l||!h)return null;if(!oa(l.type,[yo(Oi),vi,Oi]))return o.error(`Expected first argument to be of type array or string, but found ${Ji(l.type)} instead`);if(4===e.length){const p=o.parse(e[3],3,ii);return p?new bs(l.type,l,h,p):null}return new bs(l.type,l,h)}evaluate(e){const o=this.input.evaluate(e),l=this.beginIndex.evaluate(e);if(!jo(o,["string","array"]))throw new po(`Expected first argument to be of type array or string, but found ${Ji(xo(o))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return o.slice(l,h)}return o.slice(l)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var kl=bs;function za(i,e){return"=="===i||"!="===i?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function _l(i,e,o,l){return 0===l.compare(e,o)}function Ls(i,e,o){const l="=="!==i&&"!="!==i;return class Zv{constructor(p,g,x){this.type=Ui,this.lhs=p,this.rhs=g,this.collator=x,this.hasUntypedArgument="value"===p.type.kind||"value"===g.type.kind}static parse(p,g){if(3!==p.length&&4!==p.length)return g.error("Expected two or three arguments.");const x=p[0];let w=g.parse(p[1],1,Oi);if(!w)return null;if(!za(x,w.type))return g.concat(1).error(`"${x}" comparisons are not supported for type '${Ji(w.type)}'.`);let T=g.parse(p[2],2,Oi);if(!T)return null;if(!za(x,T.type))return g.concat(2).error(`"${x}" comparisons are not supported for type '${Ji(T.type)}'.`);if(w.type.kind!==T.type.kind&&"value"!==w.type.kind&&"value"!==T.type.kind)return g.error(`Cannot compare types '${Ji(w.type)}' and '${Ji(T.type)}'.`);l&&("value"===w.type.kind&&"value"!==T.type.kind?w=new Cs(T.type,[w]):"value"!==w.type.kind&&"value"===T.type.kind&&(T=new Cs(w.type,[T])));let P=null;if(4===p.length){if("string"!==w.type.kind&&"string"!==T.type.kind&&"value"!==w.type.kind&&"value"!==T.type.kind)return g.error("Cannot use collator to compare non-string types.");if(P=g.parse(p[3],3,nr),!P)return null}return new Zv(w,T,P)}evaluate(p){const g=this.lhs.evaluate(p),x=this.rhs.evaluate(p);if(l&&this.hasUntypedArgument){const w=xo(g),T=xo(x);if(w.kind!==T.kind||"string"!==w.kind&&"number"!==w.kind)throw new po(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${w.kind}, ${T.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const w=xo(g),T=xo(x);if("string"!==w.kind||"string"!==T.kind)return e(p,g,x)}return this.collator?o(p,g,x,this.collator.evaluate(p)):e(p,g,x)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[i];return this.eachChild(g=>{p.push(g.serialize())}),p}}}const yl=Ls("==",function(i,e,o){return e===o},_l),Ia=Ls("!=",function(i,e,o){return e!==o},function(i,e,o,l){return!_l(0,e,o,l)}),Ne=Ls("<",function(i,e,o){return e<o},function(i,e,o,l){return l.compare(e,o)<0}),N=Ls(">",function(i,e,o){return e>o},function(i,e,o,l){return l.compare(e,o)>0}),V=Ls("<=",function(i,e,o){return e<=o},function(i,e,o,l){return l.compare(e,o)<=0}),te=Ls(">=",function(i,e,o){return e>=o},function(i,e,o,l){return l.compare(e,o)>=0});class Le{constructor(e,o,l,h,p,g){this.type=vi,this.number=e,this.locale=o,this.currency=l,this.unit=h,this.minFractionDigits=p,this.maxFractionDigits=g}static parse(e,o){if(3!==e.length)return o.error("Expected two arguments.");const l=o.parse(e[1],1,ii);if(!l)return null;const h=e[2];if("object"!=typeof h||Array.isArray(h))return o.error("NumberFormat options argument must be an object.");let p=null;if(h.locale&&(p=o.parse(h.locale,1,vi),!p))return null;let g=null;if(h.currency&&(g=o.parse(h.currency,1,vi),!g))return null;let x=null;if(h.unit&&(x=o.parse(h.unit,1,vi),!x))return null;let w=null;if(h["min-fraction-digits"]&&(w=o.parse(h["min-fraction-digits"],1,ii),!w))return null;let T=null;return h["max-fraction-digits"]&&(T=o.parse(h["max-fraction-digits"],1,ii),!T)?null:new Le(l,p,g,x,w,T)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class ot{constructor(e){this.type=ii,this.input=e}static parse(e,o){if(2!==e.length)return o.error(`Expected 1 argument, but found ${e.length-1} instead.`);const l=o.parse(e[1],1);return l?"array"!==l.type.kind&&"string"!==l.type.kind&&"value"!==l.type.kind?o.error(`Expected argument of type string or array, but found ${Ji(l.type)} instead.`):new ot(l):null}evaluate(e){const o=this.input.evaluate(e);if("string"==typeof o||Array.isArray(o))return o.length;throw new po(`Expected value to be of type string or array, but found ${Ji(xo(o))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(o=>{e.push(o.serialize())}),e}}const Lt={"==":yl,"!=":Ia,">":N,"<":Ne,">=":te,"<=":V,array:Cs,at:nc,boolean:Cs,case:al,coalesce:Ul,collator:Is,format:vo,image:zs,in:os,"index-of":cs,interpolate:Pa,"interpolate-hcl":Pa,"interpolate-lab":Pa,length:ot,let:zl,literal:Io,match:Zl,number:Cs,"number-format":Le,object:Cs,slice:kl,step:Wo,string:Cs,"to-boolean":va,"to-color":va,"to-number":va,"to-string":va,var:Bs,within:ys};function Kt(i,[e,o,l,h]){e=e.evaluate(i),o=o.evaluate(i),l=l.evaluate(i);const p=h?h.evaluate(i):1,g=vs(e,o,l,p);if(g)throw new po(g);return new Rr(e/255*p,o/255*p,l/255*p,p)}function mn(i,e){return i in e}function Pn(i,e){const o=e[i];return void 0===o?null:o}function Pi(i){return{type:i}}la.register(Lt,{error:[{kind:"error"},[vi],(i,[e])=>{throw new po(e.evaluate(i))}],typeof:[vi,[Oi],(i,[e])=>Ji(xo(e.evaluate(i)))],"to-rgba":[yo(ii,4),[ur],(i,[e])=>e.evaluate(i).toArray()],rgb:[ur,[ii,ii,ii],Kt],rgba:[ur,[ii,ii,ii,ii],Kt],has:{type:Ui,overloads:[[[vi],(i,[e])=>mn(e.evaluate(i),i.properties())],[[vi,Ri],(i,[e,o])=>mn(e.evaluate(i),o.evaluate(i))]]},get:{type:Oi,overloads:[[[vi],(i,[e])=>Pn(e.evaluate(i),i.properties())],[[vi,Ri],(i,[e,o])=>Pn(e.evaluate(i),o.evaluate(i))]]},"feature-state":[Oi,[vi],(i,[e])=>Pn(e.evaluate(i),i.featureState||{})],properties:[Ri,[],i=>i.properties()],"geometry-type":[vi,[],i=>i.geometryType()],id:[Oi,[],i=>i.id()],zoom:[ii,[],i=>i.globals.zoom],pitch:[ii,[],i=>i.globals.pitch||0],"distance-from-center":[ii,[],i=>i.distanceFromCenter()],"heatmap-density":[ii,[],i=>i.globals.heatmapDensity||0],"line-progress":[ii,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[ii,[],i=>i.globals.skyRadialProgress||0],accumulated:[Oi,[],i=>void 0===i.globals.accumulated?null:i.globals.accumulated],"+":[ii,Pi(ii),(i,e)=>{let o=0;for(const l of e)o+=l.evaluate(i);return o}],"*":[ii,Pi(ii),(i,e)=>{let o=1;for(const l of e)o*=l.evaluate(i);return o}],"-":{type:ii,overloads:[[[ii,ii],(i,[e,o])=>e.evaluate(i)-o.evaluate(i)],[[ii],(i,[e])=>-e.evaluate(i)]]},"/":[ii,[ii,ii],(i,[e,o])=>e.evaluate(i)/o.evaluate(i)],"%":[ii,[ii,ii],(i,[e,o])=>e.evaluate(i)%o.evaluate(i)],ln2:[ii,[],()=>Math.LN2],pi:[ii,[],()=>Math.PI],e:[ii,[],()=>Math.E],"^":[ii,[ii,ii],(i,[e,o])=>Math.pow(e.evaluate(i),o.evaluate(i))],sqrt:[ii,[ii],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[ii,[ii],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[ii,[ii],(i,[e])=>Math.log(e.evaluate(i))],log2:[ii,[ii],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[ii,[ii],(i,[e])=>Math.sin(e.evaluate(i))],cos:[ii,[ii],(i,[e])=>Math.cos(e.evaluate(i))],tan:[ii,[ii],(i,[e])=>Math.tan(e.evaluate(i))],asin:[ii,[ii],(i,[e])=>Math.asin(e.evaluate(i))],acos:[ii,[ii],(i,[e])=>Math.acos(e.evaluate(i))],atan:[ii,[ii],(i,[e])=>Math.atan(e.evaluate(i))],min:[ii,Pi(ii),(i,e)=>Math.min(...e.map(o=>o.evaluate(i)))],max:[ii,Pi(ii),(i,e)=>Math.max(...e.map(o=>o.evaluate(i)))],abs:[ii,[ii],(i,[e])=>Math.abs(e.evaluate(i))],round:[ii,[ii],(i,[e])=>{const o=e.evaluate(i);return o<0?-Math.round(-o):Math.round(o)}],floor:[ii,[ii],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[ii,[ii],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[Ui,[vi,Oi],(i,[e,o])=>i.properties()[e.value]===o.value],"filter-id-==":[Ui,[Oi],(i,[e])=>i.id()===e.value],"filter-type-==":[Ui,[vi],(i,[e])=>i.geometryType()===e.value],"filter-<":[Ui,[vi,Oi],(i,[e,o])=>{const l=i.properties()[e.value],h=o.value;return typeof l==typeof h&&l<h}],"filter-id-<":[Ui,[Oi],(i,[e])=>{const o=i.id(),l=e.value;return typeof o==typeof l&&o<l}],"filter->":[Ui,[vi,Oi],(i,[e,o])=>{const l=i.properties()[e.value],h=o.value;return typeof l==typeof h&&l>h}],"filter-id->":[Ui,[Oi],(i,[e])=>{const o=i.id(),l=e.value;return typeof o==typeof l&&o>l}],"filter-<=":[Ui,[vi,Oi],(i,[e,o])=>{const l=i.properties()[e.value],h=o.value;return typeof l==typeof h&&l<=h}],"filter-id-<=":[Ui,[Oi],(i,[e])=>{const o=i.id(),l=e.value;return typeof o==typeof l&&o<=l}],"filter->=":[Ui,[vi,Oi],(i,[e,o])=>{const l=i.properties()[e.value],h=o.value;return typeof l==typeof h&&l>=h}],"filter-id->=":[Ui,[Oi],(i,[e])=>{const o=i.id(),l=e.value;return typeof o==typeof l&&o>=l}],"filter-has":[Ui,[Oi],(i,[e])=>e.value in i.properties()],"filter-has-id":[Ui,[],i=>null!==i.id()&&void 0!==i.id()],"filter-type-in":[Ui,[yo(vi)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[Ui,[yo(Oi)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[Ui,[vi,yo(Oi)],(i,[e,o])=>o.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[Ui,[vi,yo(Oi)],(i,[e,o])=>function(l,h,p,g){for(;p<=g;){const x=p+g>>1;if(h[x]===l)return!0;h[x]>l?g=x-1:p=x+1}return!1}(i.properties()[e.value],o.value,0,o.value.length-1)],all:{type:Ui,overloads:[[[Ui,Ui],(i,[e,o])=>e.evaluate(i)&&o.evaluate(i)],[Pi(Ui),(i,e)=>{for(const o of e)if(!o.evaluate(i))return!1;return!0}]]},any:{type:Ui,overloads:[[[Ui,Ui],(i,[e,o])=>e.evaluate(i)||o.evaluate(i)],[Pi(Ui),(i,e)=>{for(const o of e)if(o.evaluate(i))return!0;return!1}]]},"!":[Ui,[Ui],(i,[e])=>!e.evaluate(i)],"is-supported-script":[Ui,[vi],(i,[e])=>{const o=i.globals&&i.globals.isSupportedScript;return!o||o(e.evaluate(i))}],upcase:[vi,[vi],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[vi,[vi],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[vi,Pi(Oi),(i,e)=>e.map(o=>ga(o.evaluate(i))).join("")],"resolved-locale":[vi,[nr],(i,[e])=>e.evaluate(i).resolvedLocale()]});var Yi=Lt;function $r(i){return{result:"success",value:i}}function cr(i){return{result:"error",value:i}}function ir(i){return"data-driven"===i["property-type"]}function Ar(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function bo(i){return!!i.expression&&i.expression.interpolated}function vr(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":null===i?"null":typeof i}function Qo(i){return"object"==typeof i&&null!==i&&!Array.isArray(i)}function Ue(i){return i}function De(i,e){const o="color"===e.type,l=i.stops&&"object"==typeof i.stops[0][0],h=l||!(l||void 0!==i.property),p=i.type||(bo(e)?"exponential":"interval");if(o&&((i=xn({},i)).stops&&(i.stops=i.stops.map(T=>[T[0],Rr.parse(T[1])])),i.default=Rr.parse(i.default?i.default:e.default)),i.colorSpace&&"rgb"!==i.colorSpace&&!Ja[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let g,x,w;if("exponential"===p)g=Ce;else if("interval"===p)g=W;else if("categorical"===p){g=le,x=Object.create(null);for(const T of i.stops)x[T[0]]=T[1];w=typeof i.stops[0][0]}else{if("identity"!==p)throw new Error(`Unknown function type "${p}"`);g=xe}if(l){const T={},P=[];for(let j=0;j<i.stops.length;j++){const q=i.stops[j],ue=q[0].zoom;void 0===T[ue]&&(T[ue]={zoom:ue,type:i.type,property:i.property,default:i.default,stops:[]},P.push(ue)),T[ue].stops.push([q[0].value,q[1]])}const O=[];for(const j of P)O.push([T[j].zoom,De(T[j],e)]);const k={name:"linear"};return{kind:"composite",interpolationType:k,interpolationFactor:Pa.interpolationFactor.bind(void 0,k),zoomStops:O.map(j=>j[0]),evaluate:({zoom:j},q)=>Ce({stops:O,base:i.base},e,j).evaluate(j,q)}}if(h){const T="exponential"===p?{name:"exponential",base:void 0!==i.base?i.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:Pa.interpolationFactor.bind(void 0,T),zoomStops:i.stops.map(P=>P[0]),evaluate:({zoom:P})=>g(i,e,P,x,w)}}return{kind:"source",evaluate(T,P){const O=P&&P.properties?P.properties[i.property]:void 0;return void 0===O?ie(i.default,e.default):g(i,e,O,x,w)}}}function ie(i,e,o){return void 0!==i?i:void 0!==e?e:void 0!==o?o:void 0}function le(i,e,o,l,h){return ie(typeof o===h?l[o]:void 0,i.default,e.default)}function W(i,e,o){if("number"!==vr(o))return ie(i.default,e.default);const l=i.stops.length;if(1===l||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[l-1][0])return i.stops[l-1][1];const h=Hs(i.stops.map(p=>p[0]),o);return i.stops[h][1]}function Ce(i,e,o){const l=void 0!==i.base?i.base:1;if("number"!==vr(o))return ie(i.default,e.default);const h=i.stops.length;if(1===h||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[h-1][0])return i.stops[h-1][1];const p=Hs(i.stops.map(P=>P[0]),o),g=function(P,O,k,j){const q=j-k,ue=P-k;return 0===q?0:1===O?ue/q:(Math.pow(O,ue)-1)/(Math.pow(O,q)-1)}(o,l,i.stops[p][0],i.stops[p+1][0]),x=i.stops[p][1],w=i.stops[p+1][1];let T=Ba[e.type]||Ue;if(i.colorSpace&&"rgb"!==i.colorSpace){const P=Ja[i.colorSpace];T=(O,k)=>P.reverse(P.interpolate(P.forward(O),P.forward(k),g))}return"function"==typeof x.evaluate?{evaluate(...P){const O=x.evaluate.apply(void 0,P),k=w.evaluate.apply(void 0,P);if(void 0!==O&&void 0!==k)return T(O,k,g)}}:T(x,w,g)}function xe(i,e,o){return"color"===e.type?o=Rr.parse(o):"formatted"===e.type?o=gs.fromString(o.toString()):"resolvedImage"===e.type?o=$o.fromString(o.toString()):vr(o)===e.type||"enum"===e.type&&e.values[o]||(o=void 0),ie(o,i.default,e.default)}class ei{constructor(e,o){var l;this.expression=e,this._warningHistory={},this._evaluator=new _a,this._defaultValue=o?"color"===(l=o).type&&(Qo(l.default)||Array.isArray(l.default))?new Rr(0,0,0,0):"color"===l.type?Rr.parse(l.default)||null:void 0===l.default?null:l.default:null,this._enumValues=o&&"enum"===o.type?o.values:null}evaluateWithoutErrorHandling(e,o,l,h,p,g,x,w){return this._evaluator.globals=e,this._evaluator.feature=o,this._evaluator.featureState=l,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=w||null,this.expression.evaluate(this._evaluator)}evaluate(e,o,l,h,p,g,x,w){this._evaluator.globals=e,this._evaluator.feature=o||null,this._evaluator.featureState=l||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=w||null;try{const T=this.expression.evaluate(this._evaluator);if(null==T||"number"==typeof T&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new po(`Expected value to be one of ${Object.keys(this._enumValues).map(P=>JSON.stringify(P)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function L(i){return Array.isArray(i)&&i.length>0&&"string"==typeof i[0]&&i[0]in Yi}function Me(i,e){const o=new Va(Yi,[],e?function(h){const p={color:ur,string:vi,number:ii,enum:vi,boolean:Ui,formatted:mr,resolvedImage:io};return"array"===h.type?yo(p[h.value]||Oi,h.length):p[h.type]}(e):void 0),l=o.parse(i,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return l?$r(new ei(l,e)):cr(o.errors)}class X{constructor(e,o){this.kind=e,this._styleExpression=o,this.isStateDependent="constant"!==e&&!hs(o.expression)}evaluateWithoutErrorHandling(e,o,l,h,p,g){return this._styleExpression.evaluateWithoutErrorHandling(e,o,l,h,p,g)}evaluate(e,o,l,h,p,g){return this._styleExpression.evaluate(e,o,l,h,p,g)}}class pe{constructor(e,o,l,h){this.kind=e,this.zoomStops=l,this._styleExpression=o,this.isStateDependent="camera"!==e&&!hs(o.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,o,l,h,p,g){return this._styleExpression.evaluateWithoutErrorHandling(e,o,l,h,p,g)}evaluate(e,o,l,h,p,g){return this._styleExpression.evaluate(e,o,l,h,p,g)}interpolationFactor(e,o,l){return this.interpolationType?Pa.interpolationFactor(this.interpolationType,e,o,l):0}}function vt(i,e){if("error"===(i=Me(i,e)).result)return i;const o=i.value.expression,l=xs(o);if(!l&&!ir(e))return cr([new An("","data expressions not supported")]);const h=Eo(o,["zoom","pitch","distance-from-center"]);if(!h&&!Ar(e))return cr([new An("","zoom expressions not supported")]);const p=tn(o);return p||h?p instanceof An?cr([p]):p instanceof Pa&&!bo(e)?cr([new An("",'"interpolate" expressions cannot be used with this property')]):$r(p?new pe(l?"camera":"composite",i.value,p.labels,p instanceof Pa?p.interpolation:void 0):new X(l?"constant":"source",i.value)):cr([new An("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Nt{constructor(e,o){this._parameters=e,this._specification=o,xn(this,De(this._parameters,this._specification))}static deserialize(e){return new Nt(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function tn(i){let e=null;if(i instanceof zl)e=tn(i.result);else if(i instanceof Ul){for(const o of i.args)if(e=tn(o),e)break}else(i instanceof Wo||i instanceof Pa)&&i.input instanceof la&&"zoom"===i.input.name&&(e=i);return e instanceof An||i.eachChild(o=>{const l=tn(o);l instanceof An?e=l:!e&&l?e=new An("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&l&&e!==l&&(e=new An("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class Xt{constructor(e,o,l,h){this.message=(e?`${e}: `:"")+l,h&&(this.identifier=h),null!=o&&o.__line__&&(this.line=o.__line__)}}function zi(i){const e=i.key,o=i.value,l=i.valueSpec||{},h=i.objectElementValidators||{},p=i.style,g=i.styleSpec;let x=[];const w=vr(o);if("object"!==w)return[new Xt(e,o,`object expected, ${w} found`)];for(const T in o){const P=T.split(".")[0];let O;h[P]?O=h[P]:l[P]?O=No:h["*"]?O=h["*"]:l["*"]&&(O=No),O?x=x.concat(O({key:(e&&`${e}.`)+T,value:o[T],valueSpec:l[P]||l["*"],style:p,styleSpec:g,object:o,objectKey:T},o)):x.push(new Xt(e,o[T],`unknown property "${T}"`))}for(const T in l)h[T]||l[T].required&&void 0===l[T].default&&void 0===o[T]&&x.push(new Xt(e,o,`missing required property "${T}"`));return x}function pr(i){const e=i.value,o=i.valueSpec,l=i.style,h=i.styleSpec,p=i.key,g=i.arrayElementValidator||No;if("array"!==vr(e))return[new Xt(p,e,`array expected, ${vr(e)} found`)];if(o.length&&e.length!==o.length)return[new Xt(p,e,`array length ${o.length} expected, length ${e.length} found`)];if(o["min-length"]&&e.length<o["min-length"])return[new Xt(p,e,`array length at least ${o["min-length"]} expected, length ${e.length} found`)];let x={type:o.value,values:o.values,minimum:o.minimum,maximum:o.maximum,function:void 0};h.$version<7&&(x.function=o.function),"object"===vr(o.value)&&(x=o.value);let w=[];for(let T=0;T<e.length;T++)w=w.concat(g({array:e,arrayIndex:T,value:e[T],valueSpec:x,style:l,styleSpec:h,key:`${p}[${T}]`}));return w}function Pr(i){const e=i.key,o=i.value,l=i.valueSpec;let h=vr(o);if("number"===h&&o!=o&&(h="NaN"),"number"!==h)return[new Xt(e,o,`number expected, ${h} found`)];if("minimum"in l){let p=l.minimum;if("array"===vr(l.minimum)&&(p=l.minimum[i.arrayIndex]),o<p)return[new Xt(e,o,`${o} is less than the minimum value ${p}`)]}if("maximum"in l){let p=l.maximum;if("array"===vr(l.maximum)&&(p=l.maximum[i.arrayIndex]),o>p)return[new Xt(e,o,`${o} is greater than the maximum value ${p}`)]}return[]}function er(i){const e=i.valueSpec,o=Xn(i.value.type);let l,h,p,g={};const x="categorical"!==o&&void 0===i.value.property,w=!x,T="array"===vr(i.value.stops)&&"array"===vr(i.value.stops[0])&&"object"===vr(i.value.stops[0][0]),P=zi({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(j){if("identity"===o)return[new Xt(j.key,j.value,'identity function may not have a "stops" property')];let q=[];const ue=j.value;return q=q.concat(pr({key:j.key,value:ue,valueSpec:j.valueSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:O})),"array"===vr(ue)&&0===ue.length&&q.push(new Xt(j.key,ue,"array must have at least one stop")),q},default:function(j){return No({key:j.key,value:j.value,valueSpec:e,style:j.style,styleSpec:j.styleSpec})}}});return"identity"===o&&x&&P.push(new Xt(i.key,i.value,'missing required property "property"')),"identity"===o||i.value.stops||P.push(new Xt(i.key,i.value,'missing required property "stops"')),"exponential"===o&&i.valueSpec.expression&&!bo(i.valueSpec)&&P.push(new Xt(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(w&&!ir(i.valueSpec)?P.push(new Xt(i.key,i.value,"property functions not supported")):x&&!Ar(i.valueSpec)&&P.push(new Xt(i.key,i.value,"zoom functions not supported"))),"categorical"!==o&&!T||void 0!==i.value.property||P.push(new Xt(i.key,i.value,'"property" property is required')),P;function O(j){let q=[];const ue=j.value,Be=j.key;if("array"!==vr(ue))return[new Xt(Be,ue,`array expected, ${vr(ue)} found`)];if(2!==ue.length)return[new Xt(Be,ue,`array length 2 expected, length ${ue.length} found`)];if(T){if("object"!==vr(ue[0]))return[new Xt(Be,ue,`object expected, ${vr(ue[0])} found`)];if(void 0===ue[0].zoom)return[new Xt(Be,ue,"object stop key must have zoom")];if(void 0===ue[0].value)return[new Xt(Be,ue,"object stop key must have value")];const tt=Xn(ue[0].zoom);if("number"!=typeof tt)return[new Xt(Be,ue[0].zoom,"stop zoom values must be numbers")];if(p&&p>tt)return[new Xt(Be,ue[0].zoom,"stop zoom values must appear in ascending order")];tt!==p&&(p=tt,h=void 0,g={}),q=q.concat(zi({key:`${Be}[0]`,value:ue[0],valueSpec:{zoom:{}},style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:Pr,value:k}}))}else q=q.concat(k({key:`${Be}[0]`,value:ue[0],valueSpec:{},style:j.style,styleSpec:j.styleSpec},ue));return L(Zn(ue[1]))?q.concat([new Xt(`${Be}[1]`,ue[1],"expressions are not allowed in function stops.")]):q.concat(No({key:`${Be}[1]`,value:ue[1],valueSpec:e,style:j.style,styleSpec:j.styleSpec}))}function k(j,q){const ue=vr(j.value),Be=Xn(j.value),tt=null!==j.value?j.value:q;if(l){if(ue!==l)return[new Xt(j.key,tt,`${ue} stop domain type must match previous stop domain type ${l}`)]}else l=ue;if("number"!==ue&&"string"!==ue&&"boolean"!==ue&&"number"!=typeof Be&&"string"!=typeof Be&&"boolean"!=typeof Be)return[new Xt(j.key,tt,"stop domain value must be a number, string, or boolean")];if("number"!==ue&&"categorical"!==o){let _t=`number expected, ${ue} found`;return ir(e)&&void 0===o&&(_t+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Xt(j.key,tt,_t)]}return"categorical"!==o||"number"!==ue||"number"==typeof Be&&isFinite(Be)&&Math.floor(Be)===Be?"categorical"!==o&&"number"===ue&&"number"==typeof Be&&"number"==typeof h&&void 0!==h&&Be<h?[new Xt(j.key,tt,"stop domain values must appear in ascending order")]:(h=Be,"categorical"===o&&Be in g?[new Xt(j.key,tt,"stop domain values must be unique")]:(g[Be]=!0,[])):[new Xt(j.key,tt,`integer expected, found ${String(Be)}`)]}}function _r(i){const e=("property"===i.expressionContext?vt:Me)(Zn(i.value),i.valueSpec);if("error"===e.result)return e.value.map(l=>new Xt(`${i.key}${l.key}`,i.value,l.message));const o=e.value.expression||e.value._styleExpression.expression;if("property"===i.expressionContext&&"text-font"===i.propertyKey&&!o.outputDefined())return[new Xt(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===i.expressionContext&&"layout"===i.propertyType&&!hs(o))return[new Xt(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===i.expressionContext)return rr(o,i);if(i.expressionContext&&0===i.expressionContext.indexOf("cluster")){if(!Eo(o,["zoom","feature-state"]))return[new Xt(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===i.expressionContext&&!xs(o))return[new Xt(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function rr(i,e){const o=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const h of e.valueSpec.expression.parameters)o.delete(h);if(0===o.size)return[];const l=[];return i instanceof la&&o.has(i.name)?[new Xt(e.key,e.value,`["${i.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(i.eachChild(h=>{l.push(...rr(h,e))}),l)}function qr(i){const e=i.key,o=i.value,l=i.valueSpec,h=[];return Array.isArray(l.values)?-1===l.values.indexOf(Xn(o))&&h.push(new Xt(e,o,`expected one of [${l.values.join(", ")}], ${JSON.stringify(o)} found`)):-1===Object.keys(l.values).indexOf(Xn(o))&&h.push(new Xt(e,o,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(o)} found`)),h}function Fr(i){if(!0===i||!1===i)return!0;if(!Array.isArray(i)||0===i.length)return!1;switch(i[0]){case"has":return i.length>=2&&"$id"!==i[1]&&"$type"!==i[1];case"in":return i.length>=3&&("string"!=typeof i[1]||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==i.length||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!Fr(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function In(i,e="fill"){if(null==i)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Fr(i)||(i=Nr(i));const o=i;let l=!0;try{l=function(T){if(!uo(T))return T;let P=Zn(T);return Tr(P),P=Ni(P),P}(o)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(o,null,2)}\n        `)}const h=ht[`filter_${e}`],p=Me(l,h);let g=null;if("error"===p.result)throw new Error(p.value.map(T=>`${T.key}: ${T.message}`).join(", "));g=(T,P,O)=>p.value.evaluate(T,P,{},O);let x=null,w=null;if(l!==o){const T=Me(o,h);if("error"===T.result)throw new Error(T.value.map(P=>`${P.key}: ${P.message}`).join(", "));x=(P,O,k,j,q)=>T.value.evaluate(P,O,{},k,void 0,void 0,j,q),w=!xs(T.value.expression)}return{filter:g,dynamicFilter:x||void 0,needGeometry:ba(l),needFeature:!!w}}function Ni(i){if(!Array.isArray(i))return i;const e=function(o){if(ho.has(o[0]))for(let l=1;l<o.length;l++)if(uo(o[l]))return!0;return o}(i);return!0===e?e:e.map(o=>Ni(o))}function Tr(i){let e=!1;const o=[];if("case"===i[0]){for(let l=1;l<i.length-1;l+=2)e=e||uo(i[l]),o.push(i[l+1]);o.push(i[i.length-1])}else if("match"===i[0]){e=e||uo(i[1]);for(let l=2;l<i.length-1;l+=2)o.push(i[l+1]);o.push(i[i.length-1])}else if("step"===i[0]){e=e||uo(i[1]);for(let l=1;l<i.length-1;l+=2)o.push(i[l+1])}e&&(i.length=0,i.push("any",...o));for(let l=1;l<i.length;l++)Tr(i[l])}function uo(i){if(!Array.isArray(i))return!1;if("pitch"===(e=i[0])||"distance-from-center"===e)return!0;var e;for(let o=1;o<i.length;o++)if(uo(i[o]))return!0;return!1}const ho=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ss(i,e){return i<e?-1:i>e?1:0}function ba(i){if(!Array.isArray(i))return!1;if("within"===i[0])return!0;for(let e=1;e<i.length;e++)if(ba(i[e]))return!0;return!1}function Nr(i){if(!i)return!0;const e=i[0];return i.length<=1?"any"!==e:"=="===e?_o(i[1],i[2],"=="):"!="===e?ll(_o(i[1],i[2],"==")):"<"===e||">"===e||"<="===e||">="===e?_o(i[1],i[2],e):"any"===e?(o=i.slice(1),["any"].concat(o.map(Nr))):"all"===e?["all"].concat(i.slice(1).map(Nr)):"none"===e?["all"].concat(i.slice(1).map(Nr).map(ll)):"in"===e?Ds(i[1],i.slice(2)):"!in"===e?ll(Ds(i[1],i.slice(2))):"has"===e?Ir(i[1]):"!has"===e?ll(Ir(i[1])):"within"!==e||i;var o}function _o(i,e,o){switch(i){case"$type":return[`filter-type-${o}`,e];case"$id":return[`filter-id-${o}`,e];default:return[`filter-${o}`,i,e]}}function Ds(i,e){if(0===e.length)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(o=>typeof o!=typeof e[0])?["filter-in-large",i,["literal",e.sort(ss)]]:["filter-in-small",i,["literal",e]]}}function Ir(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function ll(i){return["!",i]}function ic(i){return Fr(Zn(i.value))?_r(xn({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):ka(i)}function ka(i){const e=i.value,o=i.key;if("array"!==vr(e))return[new Xt(o,e,`array expected, ${vr(e)} found`)];const l=i.styleSpec;let h,p=[];if(e.length<1)return[new Xt(o,e,"filter array must have at least 1 element")];switch(p=p.concat(qr({key:`${o}[0]`,value:e[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),Xn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===Xn(e[1])&&p.push(new Xt(o,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&p.push(new Xt(o,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=vr(e[1]),"string"!==h&&p.push(new Xt(`${o}[1]`,e[1],`string expected, ${h} found`)));for(let g=2;g<e.length;g++)h=vr(e[g]),"$type"===Xn(e[1])?p=p.concat(qr({key:`${o}[${g}]`,value:e[g],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):"string"!==h&&"number"!==h&&"boolean"!==h&&p.push(new Xt(`${o}[${g}]`,e[g],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let g=1;g<e.length;g++)p=p.concat(ka({key:`${o}[${g}]`,value:e[g],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":h=vr(e[1]),2!==e.length?p.push(new Xt(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==h&&p.push(new Xt(`${o}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=vr(e[1]),2!==e.length?p.push(new Xt(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==h&&p.push(new Xt(`${o}[1]`,e[1],`object expected, ${h} found`))}return p}function ao(i,e){const o=i.key,l=i.style,h=i.styleSpec,p=i.value,g=i.objectKey,x=h[`${e}_${i.layerType}`];if(!x)return[];const w=g.match(/^(.*)-transition$/);if("paint"===e&&w&&x[w[1]]&&x[w[1]].transition)return No({key:o,value:p,valueSpec:h.transition,style:l,styleSpec:h});const T=i.valueSpec||x[g];if(!T)return[new Xt(o,p,`unknown property "${g}"`)];let P;if("string"===vr(p)&&ir(T)&&!T.tokens&&(P=/^{([^}]+)}$/.exec(p))){const k=`\`{ "type": "identity", "property": ${P?JSON.stringify(P[1]):'"_"'} }\``;return[new Xt(o,p,`"${g}" does not support interpolation syntax\nUse an identity property function instead: ${k}.`)]}const O=[];return"symbol"===i.layerType&&("text-field"===g&&l&&!l.glyphs&&O.push(new Xt(o,p,'use of "text-field" requires a style "glyphs" property')),"text-font"===g&&Qo(Zn(p))&&"identity"===Xn(p.type)&&O.push(new Xt(o,p,'"text-font" does not support identity functions'))),O.concat(No({key:i.key,value:p,valueSpec:T,style:l,styleSpec:h,expressionContext:"property",propertyType:e,propertyKey:g}))}function jl(i){return ao(i,"paint")}function cl(i){return ao(i,"layout")}function ul(i){let e=[];const o=i.value,l=i.key,h=i.style,p=i.styleSpec;o.type||o.ref||e.push(new Xt(l,o,'either "type" or "ref" is required'));let g=Xn(o.type);const x=Xn(o.ref);if(o.id){const w=Xn(o.id);for(let T=0;T<i.arrayIndex;T++){const P=h.layers[T];Xn(P.id)===w&&e.push(new Xt(l,o.id,`duplicate layer id "${o.id}", previously used at line ${P.id.__line__}`))}}if("ref"in o){let w;["type","source","source-layer","filter","layout"].forEach(T=>{T in o&&e.push(new Xt(l,o[T],`"${T}" is prohibited for ref layers`))}),h.layers.forEach(T=>{Xn(T.id)===x&&(w=T)}),w?w.ref?e.push(new Xt(l,o.ref,"ref cannot reference another ref layer")):g=Xn(w.type):"string"==typeof x&&e.push(new Xt(l,o.ref,`ref layer "${x}" not found`))}else if("background"!==g&&"sky"!==g)if(o.source){const w=h.sources&&h.sources[o.source],T=w&&Xn(w.type);w?"vector"===T&&"raster"===g?e.push(new Xt(l,o.source,`layer "${o.id}" requires a raster source`)):"raster"===T&&"raster"!==g?e.push(new Xt(l,o.source,`layer "${o.id}" requires a vector source`)):"vector"!==T||o["source-layer"]?"raster-dem"===T&&"hillshade"!==g?e.push(new Xt(l,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==g||!o.paint||!o.paint["line-gradient"]&&!o.paint["line-trim-offset"]||"geojson"===T&&w.lineMetrics||e.push(new Xt(l,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Xt(l,o,`layer "${o.id}" must specify a "source-layer"`)):e.push(new Xt(l,o.source,`source "${o.source}" not found`))}else e.push(new Xt(l,o,'missing required property "source"'));return e=e.concat(zi({key:l,value:o,valueSpec:p.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>No({key:`${l}.type`,value:o.type,valueSpec:p.layer.type,style:i.style,styleSpec:i.styleSpec,object:o,objectKey:"type"}),filter:w=>ic(xn({layerType:g},w)),layout:w=>zi({layer:o,key:w.key,value:w.value,valueSpec:{},style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":T=>cl(xn({layerType:g},T))}}),paint:w=>zi({layer:o,key:w.key,value:w.value,valueSpec:{},style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":T=>jl(xn({layerType:g},T))}})}})),e}function Ua(i){const e=i.value,o=i.key,l=vr(e);return"string"!==l?[new Xt(o,e,`string expected, ${l} found`)]:[]}const Yl={promoteId:function({key:i,value:e}){if("string"===vr(e))return Ua({key:i,value:e});{const o=[];for(const l in e)o.push(...Ua({key:`${i}.${l}`,value:e[l]}));return o}}};function Fo(i){const e=i.value,o=i.key,l=i.styleSpec,h=i.style;if(!e.type)return[new Xt(o,e,'"type" is required')];const p=Xn(e.type);let g;switch(p){case"vector":case"raster":case"raster-dem":return g=zi({key:o,value:e,valueSpec:l[`source_${p.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:Yl}),g;case"geojson":if(g=zi({key:o,value:e,valueSpec:l.source_geojson,style:h,styleSpec:l,objectElementValidators:Yl}),e.cluster)for(const x in e.clusterProperties){const[w,T]=e.clusterProperties[x],P="string"==typeof w?[w,["accumulated"],["get",x]]:w;g.push(..._r({key:`${o}.${x}.map`,value:T,expressionContext:"cluster-map"})),g.push(..._r({key:`${o}.${x}.reduce`,value:P,expressionContext:"cluster-reduce"}))}return g;case"video":return zi({key:o,value:e,valueSpec:l.source_video,style:h,styleSpec:l});case"image":return zi({key:o,value:e,valueSpec:l.source_image,style:h,styleSpec:l});case"canvas":return[new Xt(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return qr({key:`${o}.type`,value:e.type,valueSpec:{values:wo(l)},style:h,styleSpec:l})}}function wo(i){return i.source.reduce((e,o)=>{const l=i[o];return"enum"===l.type.type&&(e=e.concat(Object.keys(l.type.values))),e},[])}function Ss(i){const e=i.value,o=i.styleSpec,l=o.light,h=i.style;let p=[];const g=vr(e);if(void 0===e)return p;if("object"!==g)return p=p.concat([new Xt("light",e,`object expected, ${g} found`)]),p;for(const x in e){const w=x.match(/^(.*)-transition$/);p=p.concat(w&&l[w[1]]&&l[w[1]].transition?No({key:x,value:e[x],valueSpec:o.transition,style:h,styleSpec:o}):l[x]?No({key:x,value:e[x],valueSpec:l[x],style:h,styleSpec:o}):[new Xt(x,e[x],`unknown property "${x}"`)])}return p}function kr(i){const e=i.value,o=i.key,l=i.style,h=i.styleSpec,p=h.terrain;let g=[];const x=vr(e);if(void 0===e)return g;if("object"!==x)return g=g.concat([new Xt("terrain",e,`object expected, ${x} found`)]),g;for(const w in e){const T=w.match(/^(.*)-transition$/);g=g.concat(T&&p[T[1]]&&p[T[1]].transition?No({key:w,value:e[w],valueSpec:h.transition,style:l,styleSpec:h}):p[w]?No({key:w,value:e[w],valueSpec:p[w],style:l,styleSpec:h}):[new Xt(w,e[w],`unknown property "${w}"`)])}if(e.source){const w=l.sources&&l.sources[e.source],T=w&&Xn(w.type);w?"raster-dem"!==T&&g.push(new Xt(o,e.source,`terrain cannot be used with a source of type ${String(T)}, it only be used with a "raster-dem" source type`)):g.push(new Xt(o,e.source,`source "${e.source}" not found`))}else g.push(new Xt(o,e,'terrain is missing required property "source"'));return g}function dc(i){const e=i.value,o=i.style,l=i.styleSpec,h=l.fog;let p=[];const g=vr(e);if(void 0===e)return p;if("object"!==g)return p=p.concat([new Xt("fog",e,`object expected, ${g} found`)]),p;for(const x in e){const w=x.match(/^(.*)-transition$/);p=p.concat(w&&h[w[1]]&&h[w[1]].transition?No({key:x,value:e[x],valueSpec:l.transition,style:o,styleSpec:l}):h[x]?No({key:x,value:e[x],valueSpec:h[x],style:o,styleSpec:l}):[new Xt(x,e[x],`unknown property "${x}"`)])}return p}const xl={"*":()=>[],array:pr,boolean:function(i){const e=i.value,o=i.key,l=vr(e);return"boolean"!==l?[new Xt(o,e,`boolean expected, ${l} found`)]:[]},number:Pr,color:function(i){const e=i.key,o=i.value,l=vr(o);return"string"!==l?[new Xt(e,o,`color expected, ${l} found`)]:null===gl(o)?[new Xt(e,o,`color expected, "${o}" found`)]:[]},enum:qr,filter:ic,function:er,layer:ul,object:zi,source:Fo,light:Ss,terrain:kr,fog:dc,string:Ua,formatted:function(i){return 0===Ua(i).length?[]:_r(i)},resolvedImage:function(i){return 0===Ua(i).length?[]:_r(i)},projection:function(i){const e=i.value,o=i.styleSpec,l=o.projection,h=i.style;let p=[];const g=vr(e);if("object"===g)for(const x in e)p=p.concat(No({key:x,value:e[x],valueSpec:l[x],style:h,styleSpec:o}));else"string"!==g&&(p=p.concat([new Xt("projection",e,`object or string expected, ${g} found`)]));return p}};function No(i){const e=i.value,o=i.valueSpec,l=i.styleSpec;return o.expression&&Qo(Xn(e))?er(i):o.expression&&L(Zn(e))?_r(i):o.type&&xl[o.type]?xl[o.type](i):zi(xn({},i,{valueSpec:o.type?l[o.type]:o}))}function fc(i){const e=i.value,o=i.key,l=Ua(i);return l.length||(-1===e.indexOf("{fontstack}")&&l.push(new Xt(o,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&l.push(new Xt(o,e,'"glyphs" url must include a "{range}" token'))),l}function pc(i,e=ht){return Jo(No({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,objectElementValidators:{glyphs:fc,"*":()=>[]}}))}const Rs=i=>Jo(jl(i)),eu=i=>Jo(cl(i));function Jo(i){return i.slice().sort((e,o)=>e.line&&o.line?e.line-o.line:0)}function wa(i,e){let o=!1;if(e&&e.length)for(const l of e)i.fire(new Ft(new Error(l.message))),o=!0;return o}var Pc=ja,ha=3;function ja(i,e,o){var l=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var h=new Int32Array(this.arrayBuffer);i=h[0],this.d=(e=h[1])+2*(o=h[2]);for(var p=0;p<this.d*this.d;p++){var g=h[ha+p],x=h[ha+p+1];l.push(g===x?null:h.subarray(g,x))}var w=h[ha+l.length+1];this.keys=h.subarray(h[ha+l.length],w),this.bboxes=h.subarray(w),this.insert=this._insertReadonly}else{this.d=e+2*o;for(var T=0;T<this.d*this.d;T++)l.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=i,this.padding=o,this.scale=e/i,this.uid=0;var P=o/e*i;this.min=-P,this.max=i+P}ja.prototype.insert=function(i,e,o,l,h){this._forEachCell(e,o,l,h,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(e),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(h)},ja.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ja.prototype._insertCell=function(i,e,o,l,h,p){this.cells[h].push(p)},ja.prototype.query=function(i,e,o,l,h){var p=this.min,g=this.max;if(i<=p&&e<=p&&g<=o&&g<=l&&!h)return Array.prototype.slice.call(this.keys);var x=[];return this._forEachCell(i,e,o,l,this._queryCell,x,{},h),x},ja.prototype._queryCell=function(i,e,o,l,h,p,g,x){var w=this.cells[h];if(null!==w)for(var T=this.keys,P=this.bboxes,O=0;O<w.length;O++){var k=w[O];if(void 0===g[k]){var j=4*k;(x?x(P[j+0],P[j+1],P[j+2],P[j+3]):i<=P[j+2]&&e<=P[j+3]&&o>=P[j+0]&&l>=P[j+1])?(g[k]=!0,p.push(T[k])):g[k]=!1}}},ja.prototype._forEachCell=function(i,e,o,l,h,p,g,x){for(var w=this._convertToCellCoord(i),T=this._convertToCellCoord(e),P=this._convertToCellCoord(o),O=this._convertToCellCoord(l),k=w;k<=P;k++)for(var j=T;j<=O;j++){var q=this.d*j+k;if((!x||x(this._convertFromCellCoord(k),this._convertFromCellCoord(j),this._convertFromCellCoord(k+1),this._convertFromCellCoord(j+1)))&&h.call(this,i,e,o,l,q,p,g,x))return}},ja.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},ja.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},ja.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,e=ha+this.cells.length+1+1,o=0,l=0;l<this.cells.length;l++)o+=this.cells[l].length;var h=new Int32Array(e+o+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var p=e,g=0;g<i.length;g++){var x=i[g];h[ha+g]=p,h.set(x,p),p+=x.length}return h[ha+i.length]=p,h.set(this.keys,p),h[ha+i.length+1]=p+=this.keys.length,h.set(this.bboxes,p),p+=this.bboxes.length,h.buffer};var da=bt(Pc);const mc={};function $i(i,e,o={}){Object.defineProperty(i,"_classRegistryKey",{value:e,writeable:!1}),mc[e]={klass:i,omit:o.omit||[]}}$i(Object,"Object"),da.serialize=function(i,e){const o=i.toArrayBuffer();return e&&e.push(o),{buffer:o}},da.deserialize=function(i){return new da(i.buffer)},Object.defineProperty(da,"name",{value:"Grid"}),$i(da,"Grid"),$i(Rr,"Color"),$i(Error,"Error"),$i(si,"AJAXError"),$i($o,"ResolvedImage"),$i(Nt,"StylePropertyFunction"),$i(ei,"StyleExpression",{omit:["_evaluator"]}),$i(pe,"ZoomDependentExpression"),$i(X,"ZoomConstantExpression"),$i(la,"CompoundExpression",{omit:["_evaluate"]});for(const i in Yi)mc[Yi[i]._classRegistryKey]||$i(Yi[i],`Expression${i}`);function tu(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&"ArrayBuffer"===i.constructor.name)}function zc(i){return se.ImageBitmap&&i instanceof se.ImageBitmap}function Xl(i,e){if(null==i||"boolean"==typeof i||"number"==typeof i||"string"==typeof i||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(tu(i)||zc(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){const o=i;return e&&e.push(o.buffer),o}if(i instanceof se.ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const o=[];for(const l of i)o.push(Xl(l,e));return o}if("object"==typeof i){const o=i.constructor,l=o._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${l}`);const h=o.serialize?o.serialize(i,e):{};if(!o.serialize){for(const p in i)i.hasOwnProperty(p)&&(mc[l].omit.indexOf(p)>=0||(h[p]=Xl(i[p],e)));i instanceof Error&&(h.message=i.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==l&&(h.$name=l),h}throw new Error("can't serialize object of type "+typeof i)}function rc(i){if(null==i||"boolean"==typeof i||"number"==typeof i||"string"==typeof i||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||tu(i)||zc(i)||ArrayBuffer.isView(i)||i instanceof se.ImageData)return i;if(Array.isArray(i))return i.map(rc);if("object"==typeof i){const e=i.$name||"Object",{klass:o}=mc[e];if(!o)throw new Error(`can't deserialize unregistered class ${e}`);if(o.deserialize)return o.deserialize(i);const l=Object.create(o.prototype);for(const h of Object.keys(i))"$name"!==h&&(l[h]=rc(i[h]));return l}throw new Error("can't deserialize object of type "+typeof i)}const Ti={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Nu(i){for(const e of i)if(pu(e.charCodeAt(0)))return!0;return!1}function Bh(i){for(const e of i)if(!hh(e.charCodeAt(0)))return!1;return!0}function hh(i){return!(Ti.Arabic(i)||Ti["Arabic Supplement"](i)||Ti["Arabic Extended-A"](i)||Ti["Arabic Presentation Forms-A"](i)||Ti["Arabic Presentation Forms-B"](i))}function pu(i){return!(746!==i&&747!==i&&(i<4352||!(Ti["Bopomofo Extended"](i)||Ti.Bopomofo(i)||Ti["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Ti["CJK Compatibility Ideographs"](i)||Ti["CJK Compatibility"](i)||Ti["CJK Radicals Supplement"](i)||Ti["CJK Strokes"](i)||!(!Ti["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||12336===i)||Ti["CJK Unified Ideographs Extension A"](i)||Ti["CJK Unified Ideographs"](i)||Ti["Enclosed CJK Letters and Months"](i)||Ti["Hangul Compatibility Jamo"](i)||Ti["Hangul Jamo Extended-A"](i)||Ti["Hangul Jamo Extended-B"](i)||Ti["Hangul Jamo"](i)||Ti["Hangul Syllables"](i)||Ti.Hiragana(i)||Ti["Ideographic Description Characters"](i)||Ti.Kanbun(i)||Ti["Kangxi Radicals"](i)||Ti["Katakana Phonetic Extensions"](i)||Ti.Katakana(i)&&12540!==i||!(!Ti["Halfwidth and Fullwidth Forms"](i)||65288===i||65289===i||65293===i||i>=65306&&i<=65310||65339===i||65341===i||65343===i||i>=65371&&i<=65503||65507===i||i>=65512&&i<=65519)||!(!Ti["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Ti["Unified Canadian Aboriginal Syllabics"](i)||Ti["Unified Canadian Aboriginal Syllabics Extended"](i)||Ti["Vertical Forms"](i)||Ti["Yijing Hexagram Symbols"](i)||Ti["Yi Syllables"](i)||Ti["Yi Radicals"](i))))}function Vu(i){return!(pu(i)||(e=i,Ti["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||Ti["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||Ti["Letterlike Symbols"](e)||Ti["Number Forms"](e)||Ti["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||Ti["Control Pictures"](e)&&9251!==e||Ti["Optical Character Recognition"](e)||Ti["Enclosed Alphanumerics"](e)||Ti["Geometric Shapes"](e)||Ti["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Ti["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ti["CJK Symbols and Punctuation"](e)||Ti.Katakana(e)||Ti["Private Use Area"](e)||Ti["CJK Compatibility Forms"](e)||Ti["Small Form Variants"](e)||Ti["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e}function I(i){return i>=1424&&i<=2303||Ti["Arabic Presentation Forms-A"](i)||Ti["Arabic Presentation Forms-B"](i)}function G(i,e){return!(!e&&I(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Ti.Khmer(i))}function B(i){for(const e of i)if(I(e.charCodeAt(0)))return!0;return!1}const $="deferred",me="loading",We="loaded";let kt=null,d="unavailable",r=null;const u=function(i){i&&"string"==typeof i&&i.indexOf("NetworkError")>-1&&(d="error"),kt&&kt(i)};function m(){y.fire(new nt("pluginStateChange",{pluginStatus:d,pluginURL:r}))}const y=new Tt,b=function(){return d},S=function(){if(d!==$||!r)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");d=me,m(),r&&bi({url:r},i=>{i?u(i):(d=We,m())})},z={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>d===We||null!=z.applyArabicShaping,isLoading:()=>d===me,setState(i){d=i.pluginStatus,r=i.pluginURL},isParsed:()=>null!=z.applyArabicShaping&&null!=z.processBidirectionalText&&null!=z.processStyledBidirectionalText,getPluginURL:()=>r};class U{constructor(e,o){this.zoom=e,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(o,l){for(const h of o)if(!G(h.charCodeAt(0),l))return!1;return!0}(e,z.isLoaded())}}class J{constructor(e,o){this.property=e,this.value=o,this.expression=function(l,h){if(Qo(l))return new Nt(l,h);if(L(l)){const p=vt(l,h);if("error"===p.result)throw new Error(p.value.map(g=>`${g.key}: ${g.message}`).join(", "));return p.value}{let p=l;return"string"==typeof l&&"color"===h.type&&(p=Rr.parse(l)),{kind:"constant",evaluate:()=>p}}}(void 0===o?e.specification.default:o,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,o,l){return this.property.possiblyEvaluate(this,e,o,l)}}class Q{constructor(e){this.property=e,this.value=new J(e,void 0)}transitioned(e,o){return new Ye(this.property,this.value,o,$n({},e.transition,this.transition),e.now)}untransitioned(){return new Ye(this.property,this.value,null,{},0)}}class we{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return ar(this._values[e].value.value)}setValue(e,o){this._values.hasOwnProperty(e)||(this._values[e]=new Q(this._values[e].property)),this._values[e].value=new J(this._values[e].property,null===o?void 0:ar(o))}getTransition(e){return ar(this._values[e].transition)}setTransition(e,o){this._values.hasOwnProperty(e)||(this._values[e]=new Q(this._values[e].property)),this._values[e].transition=ar(o)||void 0}serialize(){const e={};for(const o of Object.keys(this._values)){const l=this.getValue(o);void 0!==l&&(e[o]=l);const h=this.getTransition(o);void 0!==h&&(e[`${o}-transition`]=h)}return e}transitioned(e,o){const l=new Qe(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].transitioned(e,o._values[h]);return l}untransitioned(){const e=new Qe(this._properties);for(const o of Object.keys(this._values))e._values[o]=this._values[o].untransitioned();return e}}class Ye{constructor(e,o,l,h,p){const g=h.delay||0,x=h.duration||0;p=p||0,this.property=e,this.value=o,this.begin=p+g,this.end=this.begin+x,e.specification.transition&&(h.delay||h.duration)&&(this.prior=l)}possiblyEvaluate(e,o,l){const h=e.now||0,p=this.value.possiblyEvaluate(e,o,l),g=this.prior;if(g){if(h>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(h<this.begin)return g.possiblyEvaluate(e,o,l);{const x=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,o,l),p,St(x))}}return p}}class Qe{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,o,l){const h=new ft(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(e,o,l);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class ut{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return ar(this._values[e].value)}setValue(e,o){this._values[e]=new J(this._values[e].property,null===o?void 0:ar(o))}serialize(){const e={};for(const o of Object.keys(this._values)){const l=this.getValue(o);void 0!==l&&(e[o]=l)}return e}possiblyEvaluate(e,o,l){const h=new ft(this._properties);for(const p of Object.keys(this._values))h._values[p]=this._values[p].possiblyEvaluate(e,o,l);return h}}class it{constructor(e,o,l){this.property=e,this.value=o,this.parameters=l}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,o,l,h){return this.property.evaluate(this.value,this.parameters,e,o,l,h)}}class ft{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Ee{constructor(e){this.specification=e}possiblyEvaluate(e,o){return e.expression.evaluate(o)}interpolate(e,o,l){const h=Ba[this.specification.type];return h?h(e,o,l):e}}class qe{constructor(e,o){this.specification=e,this.overrides=o}possiblyEvaluate(e,o,l,h){return new it(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(o,null,{},l,h)}:e.expression,o)}interpolate(e,o,l){if("constant"!==e.value.kind||"constant"!==o.value.kind)return e;if(void 0===e.value.value||void 0===o.value.value)return new it(this,{kind:"constant",value:void 0},e.parameters);const h=Ba[this.specification.type];return h?new it(this,{kind:"constant",value:h(e.value.value,o.value.value,l)},e.parameters):e}evaluate(e,o,l,h,p,g){return"constant"===e.kind?e.value:e.evaluate(o,l,h,p,g)}}class yt{constructor(e){this.specification=e}possiblyEvaluate(e,o,l,h){return!!e.expression.evaluate(o,null,{},l,h)}interpolate(){return!1}}class Mt{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new U(0,{});for(const l in e){const h=e[l];h.specification.overridable&&this.overridableProperties.push(l);const p=this.defaultPropertyValues[l]=new J(h,void 0),g=this.defaultTransitionablePropertyValues[l]=new Q(h);this.defaultTransitioningPropertyValues[l]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=p.possiblyEvaluate(o)}}}function $t(i,e){return 256*(i=an(Math.floor(i),0,255))+an(Math.floor(e),0,255)}$i(qe,"DataDrivenProperty"),$i(Ee,"DataConstantProperty"),$i(yt,"ColorRampProperty");const Wt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ot{constructor(e,o){this._structArray=e,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class on{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,o){return e._trim(),o&&(e.isTransferred=!0,o.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const o=Object.create(this.prototype);return o.arrayBuffer=e.arrayBuffer,o.length=e.length,o.capacity=e.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Zt(i,e=1){let o=0,l=0;return{members:i.map(h=>{const p=Wt[h.type].BYTES_PER_ELEMENT,g=o=cn(o,Math.max(e,p)),x=h.components||1;return l=Math.max(l,p),o+=p*x,{name:h.name,type:h.type,components:x,offset:g}}),size:cn(o,Math.max(l,e)),alignment:e}}function cn(i,e){return Math.ceil(i/e)*e}class li extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,o)}emplace(e,o,l){const h=2*e;return this.int16[h+0]=o,this.int16[h+1]=l,e}}li.prototype.bytesPerElement=4,$i(li,"StructArrayLayout2i4");class fn extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l){const h=this.length;return this.resize(h+1),this.emplace(h,e,o,l)}emplace(e,o,l,h){const p=3*e;return this.int16[p+0]=o,this.int16[p+1]=l,this.int16[p+2]=h,e}}fn.prototype.bytesPerElement=6,$i(fn,"StructArrayLayout3i6");class Fn extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,o,l,h)}emplace(e,o,l,h,p){const g=4*e;return this.int16[g+0]=o,this.int16[g+1]=l,this.int16[g+2]=h,this.int16[g+3]=p,e}}Fn.prototype.bytesPerElement=8,$i(Fn,"StructArrayLayout4i8");class gn extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,h,p,g,x){const w=this.length;return this.resize(w+1),this.emplace(w,e,o,l,h,p,g,x)}emplace(e,o,l,h,p,g,x,w){const T=6*e,P=12*e,O=3*e;return this.int16[T+0]=o,this.int16[T+1]=l,this.uint8[P+4]=h,this.uint8[P+5]=p,this.uint8[P+6]=g,this.uint8[P+7]=x,this.float32[O+2]=w,e}}gn.prototype.bytesPerElement=12,$i(gn,"StructArrayLayout2i4ub1f12");class ai extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,o,l,h)}emplace(e,o,l,h,p){const g=4*e;return this.float32[g+0]=o,this.float32[g+1]=l,this.float32[g+2]=h,this.float32[g+3]=p,e}}ai.prototype.bytesPerElement=16,$i(ai,"StructArrayLayout4f16");class vn extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,h,p){const g=this.length;return this.resize(g+1),this.emplace(g,e,o,l,h,p)}emplace(e,o,l,h,p,g){const x=6*e,w=3*e;return this.uint16[x+0]=o,this.uint16[x+1]=l,this.uint16[x+2]=h,this.uint16[x+3]=p,this.float32[w+2]=g,e}}vn.prototype.bytesPerElement=12,$i(vn,"StructArrayLayout4ui1f12");class Hn extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,o,l,h)}emplace(e,o,l,h,p){const g=4*e;return this.uint16[g+0]=o,this.uint16[g+1]=l,this.uint16[g+2]=h,this.uint16[g+3]=p,e}}Hn.prototype.bytesPerElement=8,$i(Hn,"StructArrayLayout4ui8");class ri extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,h,p,g){const x=this.length;return this.resize(x+1),this.emplace(x,e,o,l,h,p,g)}emplace(e,o,l,h,p,g,x){const w=6*e;return this.int16[w+0]=o,this.int16[w+1]=l,this.int16[w+2]=h,this.int16[w+3]=p,this.int16[w+4]=g,this.int16[w+5]=x,e}}ri.prototype.bytesPerElement=12,$i(ri,"StructArrayLayout6i12");class Qn extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,h,p,g,x,w,T,P,O,k){const j=this.length;return this.resize(j+1),this.emplace(j,e,o,l,h,p,g,x,w,T,P,O,k)}emplace(e,o,l,h,p,g,x,w,T,P,O,k,j){const q=12*e;return this.int16[q+0]=o,this.int16[q+1]=l,this.int16[q+2]=h,this.int16[q+3]=p,this.uint16[q+4]=g,this.uint16[q+5]=x,this.uint16[q+6]=w,this.uint16[q+7]=T,this.int16[q+8]=P,this.int16[q+9]=O,this.int16[q+10]=k,this.int16[q+11]=j,e}}Qn.prototype.bytesPerElement=24,$i(Qn,"StructArrayLayout4i4ui4i24");class fi extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,h,p,g){const x=this.length;return this.resize(x+1),this.emplace(x,e,o,l,h,p,g)}emplace(e,o,l,h,p,g,x){const w=10*e,T=5*e;return this.int16[w+0]=o,this.int16[w+1]=l,this.int16[w+2]=h,this.float32[T+2]=p,this.float32[T+3]=g,this.float32[T+4]=x,e}}fi.prototype.bytesPerElement=20,$i(fi,"StructArrayLayout3i3f20");class tr extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint32[1*e+0]=o,e}}tr.prototype.bytesPerElement=4,$i(tr,"StructArrayLayout1ul4");class wr extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,h,p,g,x,w,T,P,O,k,j){const q=this.length;return this.resize(q+1),this.emplace(q,e,o,l,h,p,g,x,w,T,P,O,k,j)}emplace(e,o,l,h,p,g,x,w,T,P,O,k,j,q){const ue=20*e,Be=10*e;return this.int16[ue+0]=o,this.int16[ue+1]=l,this.int16[ue+2]=h,this.int16[ue+3]=p,this.int16[ue+4]=g,this.float32[Be+3]=x,this.float32[Be+4]=w,this.float32[Be+5]=T,this.float32[Be+6]=P,this.int16[ue+14]=O,this.uint32[Be+8]=k,this.uint16[ue+18]=j,this.uint16[ue+19]=q,e}}wr.prototype.bytesPerElement=40,$i(wr,"StructArrayLayout5i4f1i1ul2ui40");class Vi extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,h,p,g,x){const w=this.length;return this.resize(w+1),this.emplace(w,e,o,l,h,p,g,x)}emplace(e,o,l,h,p,g,x,w){const T=8*e;return this.int16[T+0]=o,this.int16[T+1]=l,this.int16[T+2]=h,this.int16[T+4]=p,this.int16[T+5]=g,this.int16[T+6]=x,this.int16[T+7]=w,e}}Vi.prototype.bytesPerElement=16,$i(Vi,"StructArrayLayout3i2i2i16");class or extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,l,h,p){const g=this.length;return this.resize(g+1),this.emplace(g,e,o,l,h,p)}emplace(e,o,l,h,p,g){const x=4*e,w=8*e;return this.float32[x+0]=o,this.float32[x+1]=l,this.float32[x+2]=h,this.int16[w+6]=p,this.int16[w+7]=g,e}}or.prototype.bytesPerElement=16,$i(or,"StructArrayLayout2f1f2i16");class Ur extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,o,l,h)}emplace(e,o,l,h,p){const g=12*e,x=3*e;return this.uint8[g+0]=o,this.uint8[g+1]=l,this.float32[x+1]=h,this.float32[x+2]=p,e}}Ur.prototype.bytesPerElement=12,$i(Ur,"StructArrayLayout2ub2f12");class Zr extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l){const h=this.length;return this.resize(h+1),this.emplace(h,e,o,l)}emplace(e,o,l,h){const p=3*e;return this.float32[p+0]=o,this.float32[p+1]=l,this.float32[p+2]=h,e}}Zr.prototype.bytesPerElement=12,$i(Zr,"StructArrayLayout3f12");class Qi extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l){const h=this.length;return this.resize(h+1),this.emplace(h,e,o,l)}emplace(e,o,l,h){const p=3*e;return this.uint16[p+0]=o,this.uint16[p+1]=l,this.uint16[p+2]=h,e}}Qi.prototype.bytesPerElement=6,$i(Qi,"StructArrayLayout3ui6");class Wi extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,o,l,h,p,g,x,w,T,P,O,k,j,q,ue,Be,tt,_t,rt,Dt,Rt){const Vt=this.length;return this.resize(Vt+1),this.emplace(Vt,e,o,l,h,p,g,x,w,T,P,O,k,j,q,ue,Be,tt,_t,rt,Dt,Rt)}emplace(e,o,l,h,p,g,x,w,T,P,O,k,j,q,ue,Be,tt,_t,rt,Dt,Rt,Vt){const bn=30*e,_n=15*e,Vn=60*e;return this.int16[bn+0]=o,this.int16[bn+1]=l,this.int16[bn+2]=h,this.float32[_n+2]=p,this.float32[_n+3]=g,this.uint16[bn+8]=x,this.uint16[bn+9]=w,this.uint32[_n+5]=T,this.uint32[_n+6]=P,this.uint32[_n+7]=O,this.uint16[bn+16]=k,this.uint16[bn+17]=j,this.uint16[bn+18]=q,this.float32[_n+10]=ue,this.float32[_n+11]=Be,this.uint8[Vn+48]=tt,this.uint8[Vn+49]=_t,this.uint8[Vn+50]=rt,this.uint32[_n+13]=Dt,this.int16[bn+28]=Rt,this.uint8[Vn+58]=Vt,e}}Wi.prototype.bytesPerElement=60,$i(Wi,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Vo extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,o,l,h,p,g,x,w,T,P,O,k,j,q,ue,Be,tt,_t,rt,Dt,Rt,Vt,bn,_n,Vn,hi,En,Kn,Gn,oi){const pi=this.length;return this.resize(pi+1),this.emplace(pi,e,o,l,h,p,g,x,w,T,P,O,k,j,q,ue,Be,tt,_t,rt,Dt,Rt,Vt,bn,_n,Vn,hi,En,Kn,Gn,oi)}emplace(e,o,l,h,p,g,x,w,T,P,O,k,j,q,ue,Be,tt,_t,rt,Dt,Rt,Vt,bn,_n,Vn,hi,En,Kn,Gn,oi,pi){const kn=38*e,Ii=19*e;return this.int16[kn+0]=o,this.int16[kn+1]=l,this.int16[kn+2]=h,this.float32[Ii+2]=p,this.float32[Ii+3]=g,this.int16[kn+8]=x,this.int16[kn+9]=w,this.int16[kn+10]=T,this.int16[kn+11]=P,this.int16[kn+12]=O,this.int16[kn+13]=k,this.uint16[kn+14]=j,this.uint16[kn+15]=q,this.uint16[kn+16]=ue,this.uint16[kn+17]=Be,this.uint16[kn+18]=tt,this.uint16[kn+19]=_t,this.uint16[kn+20]=rt,this.uint16[kn+21]=Dt,this.uint16[kn+22]=Rt,this.uint16[kn+23]=Vt,this.uint16[kn+24]=bn,this.uint16[kn+25]=_n,this.uint16[kn+26]=Vn,this.uint16[kn+27]=hi,this.uint16[kn+28]=En,this.uint32[Ii+15]=Kn,this.float32[Ii+16]=Gn,this.float32[Ii+17]=oi,this.float32[Ii+18]=pi,e}}Vo.prototype.bytesPerElement=76,$i(Vo,"StructArrayLayout3i2f6i15ui1ul3f76");class es extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.float32[1*e+0]=o,e}}es.prototype.bytesPerElement=4,$i(es,"StructArrayLayout1f4");class Co extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,l,h,p){const g=this.length;return this.resize(g+1),this.emplace(g,e,o,l,h,p)}emplace(e,o,l,h,p,g){const x=5*e;return this.float32[x+0]=o,this.float32[x+1]=l,this.float32[x+2]=h,this.float32[x+3]=p,this.float32[x+4]=g,e}}Co.prototype.bytesPerElement=20,$i(Co,"StructArrayLayout5f20");class Ya extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,l,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,o,l,h)}emplace(e,o,l,h,p){const g=6*e;return this.uint32[3*e+0]=o,this.uint16[g+2]=l,this.uint16[g+3]=h,this.uint16[g+4]=p,e}}Ya.prototype.bytesPerElement=12,$i(Ya,"StructArrayLayout1ul3ui12");class Ma extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,o)}emplace(e,o,l){const h=2*e;return this.uint16[h+0]=o,this.uint16[h+1]=l,e}}Ma.prototype.bytesPerElement=4,$i(Ma,"StructArrayLayout2ui4");class bl extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint16[1*e+0]=o,e}}bl.prototype.bytesPerElement=2,$i(bl,"StructArrayLayout1ui2");class tl extends on{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o){const l=this.length;return this.resize(l+1),this.emplace(l,e,o)}emplace(e,o,l){const h=2*e;return this.float32[h+0]=o,this.float32[h+1]=l,e}}tl.prototype.bytesPerElement=8,$i(tl,"StructArrayLayout2f8");class ds extends Ot{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ds.prototype.size=40;class Ko extends wr{get(e){return new ds(this,e)}}$i(Ko,"CollisionBoxArray");class Mo extends Ot{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Mo.prototype.size=60;class js extends Wi{get(e){return new Mo(this,e)}}$i(js,"PlacedSymbolArray");class Ys extends Ot{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Ys.prototype.size=76;class Mn extends Vo{get(e){return new Ys(this,e)}}$i(Mn,"SymbolInstanceArray");class Vr extends es{getoffsetX(e){return this.float32[1*e+0]}}$i(Vr,"GlyphOffsetArray");class nu extends li{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}$i(nu,"SymbolLineVertexArray");class gc extends Ot{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}gc.prototype.size=12;class So extends Ya{get(e){return new gc(this,e)}}$i(So,"FeatureIndexArray");class v extends Ma{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}$i(v,"FillExtrusionCentroidArray");const D=Zt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),F=Zt([{name:"a_dash",components:4,type:"Uint16"}]);var oe={exports:{}},ke=function(i,e){var o,l,h,p,g,x,w,T;for(l=i.length-(o=3&i.length),h=e,g=3432918353,x=461845907,T=0;T<l;)w=255&i.charCodeAt(T)|(255&i.charCodeAt(++T))<<8|(255&i.charCodeAt(++T))<<16|(255&i.charCodeAt(++T))<<24,++T,h=27492+(65535&(p=5*(65535&(h=(h^=w=(65535&(w=(w=(65535&w)*g+(((w>>>16)*g&65535)<<16)&4294967295)<<15|w>>>17))*x+(((w>>>16)*x&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(p>>>16)&65535)<<16);switch(w=0,o){case 3:w^=(255&i.charCodeAt(T+2))<<16;case 2:w^=(255&i.charCodeAt(T+1))<<8;case 1:h^=w=(65535&(w=(w=(65535&(w^=255&i.charCodeAt(T)))*g+(((w>>>16)*g&65535)<<16)&4294967295)<<15|w>>>17))*x+(((w>>>16)*x&65535)<<16)&4294967295}return h^=i.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0},pt=function(i,e){for(var o,l=i.length,h=e^l,p=0;l>=4;)o=1540483477*(65535&(o=255&i.charCodeAt(p)|(255&i.charCodeAt(++p))<<8|(255&i.charCodeAt(++p))<<16|(255&i.charCodeAt(++p))<<24))+((1540483477*(o>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),l-=4,++p;switch(l){case 3:h^=(255&i.charCodeAt(p+2))<<16;case 2:h^=(255&i.charCodeAt(p+1))<<8;case 1:h=1540483477*(65535&(h^=255&i.charCodeAt(p)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};oe.exports=ke,oe.exports.murmur3=ke,oe.exports.murmur2=pt;var Gt=bt(oe.exports);class Tn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,o,l,h){this.ids.push(ln(e)),this.positions.push(o,l,h)}getPositions(e){const o=ln(e);let l=0,h=this.ids.length-1;for(;l<h;){const g=l+h>>1;this.ids[g]>=o?h=g:l=g+1}const p=[];for(;this.ids[l]===o;)p.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return p}static serialize(e,o){const l=new Float64Array(e.ids),h=new Uint32Array(e.positions);return Bn(l,h,0,l.length-1),o&&o.push(l.buffer,h.buffer),{ids:l,positions:h}}static deserialize(e){const o=new Tn;return o.ids=e.ids,o.positions=e.positions,o.indexed=!0,o}}function ln(i){const e=+i;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Gt(String(i))}function Bn(i,e,o,l){for(;o<l;){const h=i[o+l>>1];let p=o-1,g=l+1;for(;;){do{p++}while(i[p]<h);do{g--}while(i[g]>h);if(p>=g)break;_i(i,p,g),_i(e,3*p,3*g),_i(e,3*p+1,3*g+1),_i(e,3*p+2,3*g+2)}g-o<l-g?(Bn(i,e,o,g),o=g+1):(Bn(i,e,g+1,l),l=g)}}function _i(i,e,o){const l=i[e];i[e]=i[o],i[o]=l}$i(Tn,"FeaturePositionMap");class ui{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,o),this.initialized=!0),!!this.location}}class Di extends ui{constructor(e){super(e),this.current=0}set(e,o,l){this.fetchUniformLocation(e,o)&&this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class Bi extends ui{constructor(e){super(e),this.current=[0,0,0,0]}set(e,o,l){this.fetchUniformLocation(e,o)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3])))}}class Er extends ui{constructor(e){super(e),this.current=Rr.transparent}set(e,o,l){this.fetchUniformLocation(e,o)&&(l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a)))}}const lo=new Float32Array(16),go=new Float32Array(9),Bo=new Float32Array(4);function To(i){return[$t(255*i.r,255*i.g),$t(255*i.b,255*i.a)]}class Ao{constructor(e,o,l){this.value=e,this.uniformNames=o.map(h=>`u_${h}`),this.type=l}setUniform(e,o,l,h,p){o.set(e,p,h.constantOr(this.value))}getBinding(e,o){return"color"===this.type?new Er(e):new Di(e)}}class $s{constructor(e,o){this.uniformNames=o.map(l=>`u_${l}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,o,l,h,p){const g="u_pattern"===p||"u_dash"===p?this.pattern:"u_pixel_ratio"===p?this.pixelRatio:null;g&&o.set(e,p,g)}getBinding(e,o){return"u_pattern"===o||"u_dash"===o?new Bi(e):new Di(e)}}class ts{constructor(e,o,l,h){this.expression=e,this.type=l,this.maxValue=0,this.paintVertexAttributes=o.map(p=>({name:`a_${p}`,type:"Float32",components:"color"===l?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,o,l,h,p,g){const x=this.paintVertexArray.length,w=this.expression.evaluate(new U(0),o,{},p,h,g);this.paintVertexArray.resize(e),this._setPaintValue(x,e,w)}updatePaintArray(e,o,l,h,p){const g=this.expression.evaluate({zoom:0},l,h,void 0,p);this._setPaintValue(e,o,g)}_setPaintValue(e,o,l){if("color"===this.type){const h=To(l);for(let p=e;p<o;p++)this.paintVertexArray.emplace(p,h[0],h[1])}else{for(let h=e;h<o;h++)this.paintVertexArray.emplace(h,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class fa{constructor(e,o,l,h,p,g){this.expression=e,this.uniformNames=o.map(x=>`u_${x}_t`),this.type=l,this.useIntegerZoom=h,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=o.map(x=>({name:`a_${x}`,type:"Float32",components:"color"===l?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(e,o,l,h,p,g){const x=this.expression.evaluate(new U(this.zoom),o,{},p,h,g),w=this.expression.evaluate(new U(this.zoom+1),o,{},p,h,g),T=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(T,e,x,w)}updatePaintArray(e,o,l,h,p){const g=this.expression.evaluate({zoom:this.zoom},l,h,void 0,p),x=this.expression.evaluate({zoom:this.zoom+1},l,h,void 0,p);this._setPaintValue(e,o,g,x)}_setPaintValue(e,o,l,h){if("color"===this.type){const p=To(l),g=To(h);for(let x=e;x<o;x++)this.paintVertexArray.emplace(x,p[0],p[1],g[0],g[1])}else{for(let p=e;p<o;p++)this.paintVertexArray.emplace(p,l,h);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,o,l,h,p){const g=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,x=an(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);o.set(e,p,x)}getBinding(e,o){return new Di(e)}}class wl{constructor(e,o,l,h,p){this.expression=e,this.layerId=p,this.paintVertexAttributes=("array"===l?F:D).members;for(let g=0;g<o.length;++g);this.paintVertexArray=new h}populatePaintArray(e,o,l){const h=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(h,e,o.patterns&&o.patterns[this.layerId],l)}updatePaintArray(e,o,l,h,p,g){this._setPaintValues(e,o,l.patterns&&l.patterns[this.layerId],g)}_setPaintValues(e,o,l,h){if(!h||!l)return;const p=h[l];if(!p)return;const{tl:g,br:x,pixelRatio:w}=p;for(let T=e;T<o;T++)this.paintVertexArray.emplace(T,g[0],g[1],x[0],x[1],w)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ml{constructor(e,o,l=(()=>!0)){this.binders={},this._buffers=[];const h=[];for(const p in e.paint._values){if(!l(p))continue;const g=e.paint.get(p);if(!(g instanceof it&&ir(g.property.specification)))continue;const x=Ol(p,e.type),w=g.value,T=g.property.specification.type,P=!!g.property.useIntegerZoom,O="line-dasharray"===p||p.endsWith("pattern"),k="line-dasharray"===p&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==w.kind||k)if("source"===w.kind||k||O){const j=e0(p,T,"source");this.binders[p]=O?new wl(w,x,T,j,e.id):new ts(w,x,T,j),h.push(`/a_${p}`)}else{const j=e0(p,T,"composite");this.binders[p]=new fa(w,x,T,P,o,j),h.push(`/z_${p}`)}else this.binders[p]=O?new $s(w.value,x):new Ao(w.value,x,T),h.push(`/u_${p}`)}this.cacheKey=h.sort().join("")}getMaxValue(e){const o=this.binders[e];return o instanceof ts||o instanceof fa?o.maxValue:0}populatePaintArrays(e,o,l,h,p,g){for(const x in this.binders){const w=this.binders[x];(w instanceof ts||w instanceof fa||w instanceof wl)&&w.populatePaintArray(e,o,l,h,p,g)}}setConstantPatternPositions(e){for(const o in this.binders){const l=this.binders[o];l instanceof $s&&l.setConstantPatternPositions(e)}}updatePaintArrays(e,o,l,h,p,g){let x=!1;for(const w in e){const T=o.getPositions(w);for(const P of T){const O=l.feature(P.index);for(const k in this.binders){const j=this.binders[k];if((j instanceof ts||j instanceof fa||j instanceof wl)&&!0===j.expression.isStateDependent){const q=h.paint.get(k);j.expression=q.value,j.updatePaintArray(P.start,P.end,O,e[w],p,g),x=!0}}}}return x}defines(){const e=[];for(const o in this.binders){const l=this.binders[o];(l instanceof Ao||l instanceof $s)&&e.push(...l.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof ts||l instanceof fa||l instanceof wl)for(let h=0;h<l.paintVertexAttributes.length;h++)e.push(l.paintVertexAttributes[h].name)}return e}getBinderUniforms(){const e=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof Ao||l instanceof $s||l instanceof fa)for(const h of l.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const o=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof Ao||h instanceof $s||h instanceof fa)for(const p of h.uniformNames)o.push({name:p,property:l,binding:h.getBinding(e,p)})}return o}setUniforms(e,o,l,h,p){for(const{name:g,property:x,binding:w}of l)this.binders[x].setUniform(e,w,p,h.get(x),g)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const o=this.binders[e];(o instanceof ts||o instanceof fa||o instanceof wl)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(e){for(const o in this.binders){const l=this.binders[o];(l instanceof ts||l instanceof fa||l instanceof wl)&&l.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const o=this.binders[e];(o instanceof ts||o instanceof fa||o instanceof wl)&&o.destroy()}}}class Ql{constructor(e,o,l=(()=>!0)){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new Ml(h,o,l);this.needsUpload=!1,this._featureMap=new Tn,this._bufferOffset=0}populatePaintArrays(e,o,l,h,p,g,x){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(e,o,h,p,g,x);void 0!==o.id&&this._featureMap.add(o.id,l,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,o,l,h,p){for(const g of l)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(e,this._featureMap,o,g,h,p)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Jd={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Ol(i,e){return Jd[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}const Bu={"line-pattern":{source:vn,composite:vn},"fill-pattern":{source:vn,composite:vn},"fill-extrusion-pattern":{source:vn,composite:vn},"line-dasharray":{source:Hn,composite:Hn}},Fs={color:{source:tl,composite:ai},number:{source:es,composite:tl}};function e0(i,e,o){const l=Bu[i];return l&&l[o]||Fs[e][o]}$i(Ao,"ConstantBinder"),$i($s,"PatternConstantBinder"),$i(ts,"SourceExpressionBinder"),$i(wl,"PatternCompositeBinder"),$i(fa,"CompositeExpressionBinder"),$i(Ml,"ProgramConfiguration",{omit:["_buffers"]}),$i(Ql,"ProgramConfigurationSet");const G4="-transition";class Ic extends Tt{constructor(e,o){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),o.layout&&(this._unevaluatedLayout=new ut(o.layout)),o.paint)){this._transitionablePaint=new we(o.paint);for(const l in e.paint)this.setPaintProperty(l,e.paint[l],{validate:!1});for(const l in e.layout)this.setLayoutProperty(l,e.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ft(o.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,o,l={}){null!=o&&this._validate(eu,`layers.${this.id}.layout.${e}`,e,o,l)||("visibility"!==e?this._unevaluatedLayout.setValue(e,o):this.visibility=o)}getPaintProperty(e){return Yn(e,G4)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,o,l={}){if(null!=o&&this._validate(Rs,`layers.${this.id}.paint.${e}`,e,o,l))return!1;if(Yn(e,G4))return this._transitionablePaint.setTransition(e.slice(0,-11),o||void 0),!1;{const h=this._transitionablePaint._values[e],p=h.value.isDataDriven(),g=h.value;this._transitionablePaint.setValue(e,o),this._handleSpecialPaintPropertyUpdate(e);const x=this._transitionablePaint._values[e].value,w=x.isDataDriven(),T=Yn(e,"pattern")||"line-dasharray"===e;return w||p||T||this._handleOverridablePaintPropertyUpdate(e,g,x)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,o,l){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,o)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),qn(e,(o,l)=>!(void 0===o||"layout"===l&&!Object.keys(o).length||"paint"===l&&!Object.keys(o).length))}_validate(e,o,l,h,p={}){return(!p||!1!==p.validate)&&wa(this,e.call(pc,{key:o,layerType:this.type,objectKey:l,value:h,styleSpec:ht,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const o=this.paint.get(e);if(o instanceof it&&ir(o.property.specification)&&("source"===o.value.kind||"composite"===o.value.kind)&&o.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=In(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Bf=Zt([{name:"a_pos",components:2,type:"Int16"}],4),W4=Zt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class na{constructor(e=[]){this.segments=e}prepareSegment(e,o,l,h){let p=this.segments[this.segments.length-1];return e>na.MAX_VERTEX_ARRAY_LENGTH&&Si(`Max vertices per segment is ${na.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!p||p.vertexLength+e>na.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==h)&&(p={vertexOffset:o.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},void 0!==h&&(p.sortKey=h),this.segments.push(p)),p}get(){return this.segments}destroy(){for(const e of this.segments)for(const o in e.vaos)e.vaos[o].destroy()}static simpleSegment(e,o,l,h){return new na([{vertexOffset:e,primitiveOffset:o,vertexLength:l,primitiveLength:h,vaos:{},sortKey:0}])}}na.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,$i(na,"SegmentVector");var dr=8192;class El{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Po?new Po(e.lng,e.lat):Po.convert(e),this}setSouthWest(e){return this._sw=e instanceof Po?new Po(e.lng,e.lat):Po.convert(e),this}extend(e){const o=this._sw,l=this._ne;let h,p;if(e instanceof Po)h=e,p=e;else{if(!(e instanceof El))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(El.convert(e)):this.extend(Po.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(Po.convert(e)):this;if(h=e._sw,p=e._ne,!h||!p)return this}return o||l?(o.lng=Math.min(h.lng,o.lng),o.lat=Math.min(h.lat,o.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new Po(h.lng,h.lat),this._ne=new Po(p.lng,p.lat)),this}getCenter(){return new Po((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Po(this.getWest(),this.getNorth())}getSouthEast(){return new Po(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:l}=Po.convert(e);let h=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&h}static convert(e){return!e||e instanceof El?e:new El(e)}}var k1=1e-6,Cl=typeof Float32Array<"u"?Float32Array:Array;function Hh(){var i=new Cl(9);return Cl!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function Uh(i,e,o){var l=e[0],h=e[1],p=e[2],g=e[3],x=e[4],w=e[5],T=e[6],P=e[7],O=e[8],k=o[0],j=o[1],q=o[2],ue=o[3],Be=o[4],tt=o[5],_t=o[6],rt=o[7],Dt=o[8];return i[0]=k*l+j*g+q*T,i[1]=k*h+j*x+q*P,i[2]=k*p+j*w+q*O,i[3]=ue*l+Be*g+tt*T,i[4]=ue*h+Be*x+tt*P,i[5]=ue*p+Be*w+tt*O,i[6]=_t*l+rt*g+Dt*T,i[7]=_t*h+rt*x+Dt*P,i[8]=_t*p+rt*w+Dt*O,i}function oc(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function O1(i,e){var o=e[0],l=e[1],h=e[2],p=e[3],g=e[4],x=e[5],w=e[6],T=e[7],P=e[8],O=e[9],k=e[10],j=e[11],q=e[12],ue=e[13],Be=e[14],tt=e[15],_t=o*x-l*g,rt=o*w-h*g,Dt=o*T-p*g,Rt=l*w-h*x,Vt=l*T-p*x,bn=h*T-p*w,_n=P*ue-O*q,Vn=P*Be-k*q,hi=P*tt-j*q,En=O*Be-k*ue,Kn=O*tt-j*ue,Gn=k*tt-j*Be,oi=_t*Gn-rt*Kn+Dt*En+Rt*hi-Vt*Vn+bn*_n;return oi?(i[0]=(x*Gn-w*Kn+T*En)*(oi=1/oi),i[1]=(h*Kn-l*Gn-p*En)*oi,i[2]=(ue*bn-Be*Vt+tt*Rt)*oi,i[3]=(k*Vt-O*bn-j*Rt)*oi,i[4]=(w*hi-g*Gn-T*Vn)*oi,i[5]=(o*Gn-h*hi+p*Vn)*oi,i[6]=(Be*Dt-q*bn-tt*rt)*oi,i[7]=(P*bn-k*Dt+j*rt)*oi,i[8]=(g*Kn-x*hi+T*_n)*oi,i[9]=(l*hi-o*Kn-p*_n)*oi,i[10]=(q*Vt-ue*Dt+tt*_t)*oi,i[11]=(O*Dt-P*Vt-j*_t)*oi,i[12]=(x*Vn-g*En-w*_n)*oi,i[13]=(o*En-l*Vn+h*_n)*oi,i[14]=(ue*rt-q*Rt-Be*_t)*oi,i[15]=(P*Rt-O*rt+k*_t)*oi,i):null}function mu(i,e,o){var l=e[0],h=e[1],p=e[2],g=e[3],x=e[4],w=e[5],T=e[6],P=e[7],O=e[8],k=e[9],j=e[10],q=e[11],ue=e[12],Be=e[13],tt=e[14],_t=e[15],rt=o[0],Dt=o[1],Rt=o[2],Vt=o[3];return i[0]=rt*l+Dt*x+Rt*O+Vt*ue,i[1]=rt*h+Dt*w+Rt*k+Vt*Be,i[2]=rt*p+Dt*T+Rt*j+Vt*tt,i[3]=rt*g+Dt*P+Rt*q+Vt*_t,i[4]=(rt=o[4])*l+(Dt=o[5])*x+(Rt=o[6])*O+(Vt=o[7])*ue,i[5]=rt*h+Dt*w+Rt*k+Vt*Be,i[6]=rt*p+Dt*T+Rt*j+Vt*tt,i[7]=rt*g+Dt*P+Rt*q+Vt*_t,i[8]=(rt=o[8])*l+(Dt=o[9])*x+(Rt=o[10])*O+(Vt=o[11])*ue,i[9]=rt*h+Dt*w+Rt*k+Vt*Be,i[10]=rt*p+Dt*T+Rt*j+Vt*tt,i[11]=rt*g+Dt*P+Rt*q+Vt*_t,i[12]=(rt=o[12])*l+(Dt=o[13])*x+(Rt=o[14])*O+(Vt=o[15])*ue,i[13]=rt*h+Dt*w+Rt*k+Vt*Be,i[14]=rt*p+Dt*T+Rt*j+Vt*tt,i[15]=rt*g+Dt*P+Rt*q+Vt*_t,i}function jh(i,e,o){var l,h,p,g,x,w,T,P,O,k,j,q,ue=o[0],Be=o[1],tt=o[2];return e===i?(i[12]=e[0]*ue+e[4]*Be+e[8]*tt+e[12],i[13]=e[1]*ue+e[5]*Be+e[9]*tt+e[13],i[14]=e[2]*ue+e[6]*Be+e[10]*tt+e[14],i[15]=e[3]*ue+e[7]*Be+e[11]*tt+e[15]):(h=e[1],p=e[2],g=e[3],x=e[4],w=e[5],T=e[6],P=e[7],O=e[8],k=e[9],j=e[10],q=e[11],i[0]=l=e[0],i[1]=h,i[2]=p,i[3]=g,i[4]=x,i[5]=w,i[6]=T,i[7]=P,i[8]=O,i[9]=k,i[10]=j,i[11]=q,i[12]=l*ue+x*Be+O*tt+e[12],i[13]=h*ue+w*Be+k*tt+e[13],i[14]=p*ue+T*Be+j*tt+e[14],i[15]=g*ue+P*Be+q*tt+e[15]),i}function vc(i,e,o){var l=o[0],h=o[1],p=o[2];return i[0]=e[0]*l,i[1]=e[1]*l,i[2]=e[2]*l,i[3]=e[3]*l,i[4]=e[4]*h,i[5]=e[5]*h,i[6]=e[6]*h,i[7]=e[7]*h,i[8]=e[8]*p,i[9]=e[9]*p,i[10]=e[10]*p,i[11]=e[11]*p,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function Hu(i,e,o){var l=Math.sin(o),h=Math.cos(o),p=e[4],g=e[5],x=e[6],w=e[7],T=e[8],P=e[9],O=e[10],k=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=p*h+T*l,i[5]=g*h+P*l,i[6]=x*h+O*l,i[7]=w*h+k*l,i[8]=T*h-p*l,i[9]=P*h-g*l,i[10]=O*h-x*l,i[11]=k*h-w*l,i}function L1(i,e,o){var l=Math.sin(o),h=Math.cos(o),p=e[0],g=e[1],x=e[2],w=e[3],T=e[8],P=e[9],O=e[10],k=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=p*h-T*l,i[1]=g*h-P*l,i[2]=x*h-O*l,i[3]=w*h-k*l,i[8]=p*l+T*h,i[9]=g*l+P*h,i[10]=x*l+O*h,i[11]=w*l+k*h,i}function R1(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function K4(i,e,o){var l,h,p,g=o[0],x=o[1],w=o[2],T=Math.hypot(g,x,w);return T<k1?null:(g*=T=1/T,x*=T,w*=T,l=Math.sin(e),h=Math.cos(e),i[0]=g*g*(p=1-h)+h,i[1]=x*g*p+w*l,i[2]=w*g*p-x*l,i[3]=0,i[4]=g*x*p-w*l,i[5]=x*x*p+h,i[6]=w*x*p+g*l,i[7]=0,i[8]=g*w*p+x*l,i[9]=x*w*p-g*l,i[10]=w*w*p+h,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var Hf=mu;function t0(){var i=new Cl(3);return Cl!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function Uf(i){var e=new Cl(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function F1(i){return Math.hypot(i[0],i[1],i[2])}function gu(i,e,o){var l=new Cl(3);return l[0]=i,l[1]=e,l[2]=o,l}function sc(i,e,o){return i[0]=e[0]+o[0],i[1]=e[1]+o[1],i[2]=e[2]+o[2],i}function n0(i,e,o){return i[0]=e[0]-o[0],i[1]=e[1]-o[1],i[2]=e[2]-o[2],i}function dh(i,e,o){return i[0]=e[0]*o[0],i[1]=e[1]*o[1],i[2]=e[2]*o[2],i}function Uu(i,e,o){return i[0]=Math.min(e[0],o[0]),i[1]=Math.min(e[1],o[1]),i[2]=Math.min(e[2],o[2]),i}function vu(i,e,o){return i[0]=Math.max(e[0],o[0]),i[1]=Math.max(e[1],o[1]),i[2]=Math.max(e[2],o[2]),i}function _c(i,e,o){return i[0]=e[0]*o,i[1]=e[1]*o,i[2]=e[2]*o,i}function fh(i,e,o,l){return i[0]=e[0]+o[0]*l,i[1]=e[1]+o[1]*l,i[2]=e[2]+o[2]*l,i}function Tl(i,e){var o=e[0],l=e[1],h=e[2],p=o*o+l*l+h*h;return p>0&&(p=1/Math.sqrt(p)),i[0]=e[0]*p,i[1]=e[1]*p,i[2]=e[2]*p,i}function yc(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function xc(i,e,o){var l=e[0],h=e[1],p=e[2],g=o[0],x=o[1],w=o[2];return i[0]=h*w-p*x,i[1]=p*g-l*w,i[2]=l*x-h*g,i}function ia(i,e,o){var l=e[0],h=e[1],p=e[2],g=o[3]*l+o[7]*h+o[11]*p+o[15];return i[0]=(o[0]*l+o[4]*h+o[8]*p+o[12])/(g=g||1),i[1]=(o[1]*l+o[5]*h+o[9]*p+o[13])/g,i[2]=(o[2]*l+o[6]*h+o[10]*p+o[14])/g,i}function Yh(i,e,o){var l=o[0],h=o[1],p=o[2],g=e[0],x=e[1],w=e[2],T=h*w-p*x,P=p*g-l*w,O=l*x-h*g,k=h*O-p*P,j=p*T-l*O,q=l*P-h*T,ue=2*o[3];return P*=ue,O*=ue,j*=2,q*=2,i[0]=g+(T*=ue)+(k*=2),i[1]=x+P+j,i[2]=w+O+q,i}var ju,bc=n0,N1=dh,r0=F1;function q4(i,e,o){return i[0]=e[0]*o,i[1]=e[1]*o,i[2]=e[2]*o,i[3]=e[3]*o,i}function o0(i,e){var o=e[0],l=e[1],h=e[2],p=e[3],g=o*o+l*l+h*h+p*p;return g>0&&(g=1/Math.sqrt(g)),i[0]=o*g,i[1]=l*g,i[2]=h*g,i[3]=p*g,i}function _u(i,e,o){var l=e[0],h=e[1],p=e[2],g=e[3];return i[0]=o[0]*l+o[4]*h+o[8]*p+o[12]*g,i[1]=o[1]*l+o[5]*h+o[9]*p+o[13]*g,i[2]=o[2]*l+o[6]*h+o[10]*p+o[14]*g,i[3]=o[3]*l+o[7]*h+o[11]*p+o[15]*g,i}function s0(){var i=new Cl(4);return Cl!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function a0(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function Z4(i,e,o){o*=.5;var l=e[0],h=e[1],p=e[2],g=e[3],x=Math.sin(o),w=Math.cos(o);return i[0]=l*w+g*x,i[1]=h*w+p*x,i[2]=p*w-h*x,i[3]=g*w-l*x,i}function $h(i,e,o){o*=.5;var l=e[0],h=e[1],p=e[2],g=e[3],x=Math.sin(o),w=Math.cos(o);return i[0]=l*w-p*x,i[1]=h*w+g*x,i[2]=p*w+l*x,i[3]=g*w-h*x,i}t0(),ju=new Cl(4),Cl!=Float32Array&&(ju[0]=0,ju[1]=0,ju[2]=0,ju[3]=0);var Yu=o0;t0(),gu(1,0,0),gu(0,1,0),s0(),s0(),Hh();const jf=Zt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:l0}=jf,c0=Zt([{name:"a_pos_3",components:3,type:"Int16"}]);var Uc=Zt([{name:"a_pos",type:"Int16",components:2}]);class yu{constructor(e,o){this.pos=e,this.dir=o}intersectsPlane(e,o,l){const h=yc(o,this.dir);if(Math.abs(h)<1e-6)return!1;const p=((e[0]-this.pos[0])*o[0]+(e[1]-this.pos[1])*o[1]+(e[2]-this.pos[2])*o[2])/h;return l[0]=this.pos[0]+this.dir[0]*p,l[1]=this.pos[1]+this.dir[1]*p,l[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(e,o,l){if(ue=(j=this.pos)[0],Be=j[1],tt=j[2],_t=(q=e)[0],rt=q[1],Dt=q[2],Math.abs(ue-_t)<=k1*Math.max(1,Math.abs(ue),Math.abs(_t))&&Math.abs(Be-rt)<=k1*Math.max(1,Math.abs(Be),Math.abs(rt))&&Math.abs(tt-Dt)<=k1*Math.max(1,Math.abs(tt),Math.abs(Dt))||0===o)return l[0]=l[1]=l[2]=0,!1;var j,q,ue,Be,tt,_t,rt,Dt;const[h,p,g]=this.dir,x=this.pos[0]-e[0],w=this.pos[1]-e[1],T=this.pos[2]-e[2],P=h*h+p*p+g*g,O=2*(x*h+w*p+T*g),k=O*O-4*P*(x*x+w*w+T*T-o*o);if(k<0){const j=Math.max(-O/2,0),q=x+h*j,ue=w+p*j,Be=T+g*j,tt=Math.hypot(q,ue,Be);return l[0]=q*o/tt,l[1]=ue*o/tt,l[2]=Be*o/tt,!1}{const j=(-O-Math.sqrt(k))/(2*P);if(j<0){const q=Math.hypot(x,w,T);return l[0]=x*o/q,l[1]=w*o/q,l[2]=T*o/q,!1}return l[0]=x+h*j,l[1]=w+p*j,l[2]=T+g*j,!0}}}class Oa{constructor(e,o,l,h,p){this.TL=e,this.TR=o,this.BR=l,this.BL=h,this.horizon=p}static fromInvProjectionMatrix(e,o,l){const h=[-1,1,1],p=[1,1,1],g=[1,-1,1],x=[-1,-1,1],w=ia(h,h,e),T=ia(p,p,e),P=ia(g,g,e),O=ia(x,x,e);return new Oa(w,T,P,O,o/l)}}class u0{constructor(e,o){this.points=e,this.planes=o}static fromInvProjectionMatrix(e,o,l,h){const p=Math.pow(2,l),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{const T=_u([],w,e),P=1/T[3]/o*p;return(O=T)[0]=(k=T)[0]*(j=[P,P,h?1/T[3]:P,P])[0],O[1]=k[1]*j[1],O[2]=k[2]*j[2],O[3]=k[3]*j[3],O;var O,k,j}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{const T=Tl([],xc([],bc([],g[w[0]],g[w[1]]),bc([],g[w[2]],g[w[1]]))),P=-yc(T,g[w[1]]);return T.concat(P)});return new u0(g,x)}}class Dl{static fromPoints(e){const o=[1/0,1/0,1/0],l=[-1/0,-1/0,-1/0];for(const h of e)Uu(o,o,h),vu(l,l,h);return new Dl(o,l)}static applyTransform(e,o){const l=e.getCorners();for(let h=0;h<l.length;++h)ia(l[h],l[h],o);return Dl.fromPoints(l)}constructor(e,o){this.min=e,this.max=o,this.center=_c([],sc([],this.min,this.max),.5)}quadrant(e){const o=[e%2==0,e<2],l=Uf(this.min),h=Uf(this.max);for(let p=0;p<o.length;p++)l[p]=o[p]?this.min[p]:this.center[p],h[p]=o[p]?this.center[p]:this.max[p];return h[2]=this.max[2],new Dl(l,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,o=this.max;return[[e[0],e[1],e[2]],[o[0],e[1],e[2]],[o[0],o[1],e[2]],[e[0],o[1],e[2]],[e[0],e[1],o[2]],[o[0],e[1],o[2]],[o[0],o[1],o[2]],[e[0],o[1],o[2]]]}intersects(e){const o=this.getCorners();let l=!0;for(let h=0;h<e.planes.length;h++){const p=e.planes[h];let g=0;for(let x=0;x<o.length;x++)g+=yc(p,o[x])+p[3]>=0;if(0===g)return 0;g!==o.length&&(l=!1)}if(l)return 2;for(let h=0;h<3;h++){let p=Number.MAX_VALUE,g=-Number.MAX_VALUE;for(let x=0;x<e.points.length;x++){const w=e.points[x][h]-this.min[h];p=Math.min(p,w),g=Math.max(g,w)}if(g<0||p>this.max[h]-this.min[h])return 0}return 1}}const Gh=5,X4=6,kc=dr/Math.PI/2,V1=16383,ph=[64,32,16],Jl=-kc,$l=kc,h0=[new Dl([Jl,Jl,Jl],[$l,$l,$l]),new Dl([Jl,Jl,Jl],[0,0,$l]),new Dl([0,Jl,Jl],[$l,0,$l]),new Dl([Jl,0,Jl],[0,$l,$l]),new Dl([0,0,Jl],[$l,$l,$l])];function B1(i){return i*kc/G1}function Q4(i,e,o,l=!0){const h=_c([],i._camera.position,i.worldSize),p=[e,o,1,1];_u(p,p,i.pixelMatrixInverse),q4(p,p,1/p[3]);const g=Tl([],bc([],p,h)),x=i.globeMatrix,w=[x[12],x[13],x[14]],T=bc([],w,h),P=F1(T),O=Tl([],T),k=i.worldSize/(2*Math.PI),j=yc(O,g),q=Math.asin(k/P);if(q<Math.acos(j)){if(!l)return null;const hi=[],En=[];_c(hi,g,P/j),Tl(En,bc(En,hi,T)),Tl(g,sc(g,T,_c(g,En,Math.tan(q)*P)))}const ue=[];new yu(h,g).closestPointOnSphere(w,k,ue);const Be=Tl([],Ai(x,0)),tt=Tl([],Ai(x,1)),_t=Tl([],Ai(x,2)),rt=yc(Be,ue),Dt=yc(tt,ue),Rt=yc(_t,ue),Vt=At(Math.asin(-Dt/k));let bn=At(Math.atan2(rt,Rt));bn=i.center.lng+function(hi,En){const Kn=(En-hi+180)%360-180;return Kn<-180?Kn+360:Kn}(i.center.lng,bn);const _n=wc(bn),Vn=an(Yc(Vt),0,1);return new Ku(_n,Vn)}class Yf{constructor(e,o,l){this.a=bc([],e,l),this.b=bc([],o,l),this.center=l;const h=Tl([],this.a),p=Tl([],this.b);this.angle=Math.acos(yc(h,p))}}function H1(i,e){if(0===i.angle)return null;let o;return o=0===i.a[e]?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[e]/i.a[e]/Math.sin(i.angle)-1/Math.tan(i.angle)),o<0||o>1?null:function(l,h,p,g){const x=Math.sin(p);return l*(Math.sin((1-g)*p)/x)+h*(Math.sin(g*p)/x)}(i.a[e],i.b[e],i.angle,an(o,0,1))+i.center[e]}function jc(i){if(i.z<=1)return h0[i.z+2*i.y+i.x];const e=U1(Wh(i));return Dl.fromPoints(e)}function xu(i,e,o){return _c(i,i,1-o),fh(i,i,e,o)}function d0(i,e){const o=gh(e.zoom);if(0===o)return jc(i);const l=Wh(i),h=U1(l),p=wc(l.getWest())*e.worldSize,g=wc(l.getEast())*e.worldSize,x=Yc(l.getNorth())*e.worldSize,w=Yc(l.getSouth())*e.worldSize,T=[p,x,0],P=[g,x,0],O=[p,w,0],k=[g,w,0],j=O1([],e.globeMatrix);return ia(T,T,j),ia(P,P,j),ia(O,O,j),ia(k,k,j),h[0]=xu(h[0],O,o),h[1]=xu(h[1],k,o),h[2]=xu(h[2],P,o),h[3]=xu(h[3],T,o),Dl.fromPoints(h)}function J4(i,e,o){for(const l of i)ia(l,l,e),_c(l,l,o)}function Wh({x:i,y:e,z:o}){const l=1/(1<<o),h=new Po(Ea(i*l),dl((e+1)*l)),p=new Po(Ea((i+1)*l),dl(e*l));return new El(h,p)}function U1(i){const e=je(i.getNorth()),o=je(i.getSouth()),l=Math.cos(e),h=Math.cos(o),p=Math.sin(e),g=Math.sin(o),x=i.getWest(),w=i.getEast();return[hl(h,g,x),hl(h,g,w),hl(l,p,w),hl(l,p,x)]}function hl(i,e,o,l=kc){return o=je(o),[i*Math.sin(o)*l,-e*l,i*Math.cos(o)*l]}function Kh(i,e,o){return hl(Math.cos(je(i)),Math.sin(je(i)),e,o)}function mh(i,e,o,l){const h=1<<o.z,p=(i/dr+o.x)/h;return Kh(dl((e/dr+o.y)/h),Ea(p),l)}function f0({min:i,max:e}){return V1/Math.max(e[0]-i[0],e[1]-i[1],e[2]-i[2])}const j1=new Float64Array(16);function ac(i){const e=f0(i),o=R1(j1,[e,e,e]);return jh(o,o,((l=[])[0]=-(h=i.min)[0],l[1]=-h[1],l[2]=-h[2],l));var l,h}function Y1(i){const e=(l=i.min,(o=j1)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=l[0],o[13]=l[1],o[14]=l[2],o[15]=1,o);var o,l;const h=1/f0(i);return vc(e,e,[h,h,h])}function Gu(i,e,o,l,h){const p=function(w){const T=dr/(2*Math.PI);return w/(2*Math.PI)/T}(o),g=[i,e,-o/(2*Math.PI)],x=oc(new Float64Array(16));return jh(x,x,g),vc(x,x,[p,p,p]),Hu(x,x,je(-h)),L1(x,x,je(-l)),x}function gh(i){return Un(Gh,X4,i)}function e2(i,e){const o=Kh(e.lat,e.lng);return g=(h=n0([],function(q){const ue=Kh(q._center.lat,q._center.lng);let Be=xc([],gu(0,1,0),ue);const tt=K4([],-q.angle,ue);Be=ia(Be,Be,tt),K4(tt,-q._pitch,Be);const _t=Tl([],ue);return _c(_t,_t,B1(q.cameraToCenterDistance/q.pixelsPerMeter)),ia(_t,_t,tt),sc([],ue,_t)}(i),o))[0],x=h[1],w=h[2],T=(p=o)[0],P=p[1],O=p[2],j=(k=Math.sqrt(g*g+x*x+w*w)*Math.sqrt(T*T+P*P+O*O))&&yc(h,p)/k,Math.acos(Math.min(Math.max(j,-1),1));var h,p,g,x,w,T,P,O,k,j}function $1(i,e){return e2(i,e)>Math.PI/2*1.01}const t2=je(85),k8=Math.cos(t2),O8=Math.sin(t2),G1=6371008.8,$f=2*Math.PI*G1;class bu{constructor(e,o){if(isNaN(e)||isNaN(o))throw new Error(`Invalid LngLat object: (${e}, ${o})`);if(this.lng=+e,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new bu(nn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const o=Math.PI/180,l=this.lat*o,h=e.lat*o,p=Math.sin(l)*Math.sin(h)+Math.cos(l)*Math.cos(h)*Math.cos((e.lng-this.lng)*o);return G1*Math.acos(Math.min(p,1))}toBounds(e=0){const o=360*e/40075017,l=o/Math.cos(Math.PI/180*this.lat);return new El(new bu(this.lng-l,this.lat-o),new bu(this.lng+l,this.lat+o))}toEcef(e){const o=B1(e);return Kh(this.lat,this.lng,kc+o)}static convert(e){if(e instanceof bu)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new bu(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new bu(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Po=bu;function Wu(i){return $f*Math.cos(i*Math.PI/180)}function wc(i){return(180+i)/360}function Yc(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function lc(i,e){return i/Wu(e)}function Ea(i){return 360*i-180}function dl(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function qh(i,e){return i*Wu(dl(e))}const Ca=85.051129;function n2(i){return 1/Math.cos(i*Math.PI/180)}class Ku{constructor(e,o,l=0){this.x=+e,this.y=+o,this.z=+l}static fromLngLat(e,o=0){const l=Po.convert(e);return new Ku(wc(l.lng),Yc(l.lat),lc(o,l.lat))}toLngLat(){return new Po(Ea(this.x),dl(this.y))}toAltitude(){return qh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/$f*n2(dl(this.y))}}function W1(i,e,o,l,h,p,g,x,w){const T=(e+l)/2,P=(o+h)/2,O=new et(T,P);x(O),function(k,j,q,ue,Be,tt){const _t=q-Be,rt=ue-tt;return Math.abs((ue-j)*_t-(q-k)*rt)/Math.hypot(_t,rt)}(O.x,O.y,p.x,p.y,g.x,g.y)>=w?(W1(i,e,o,T,P,p,O,x,w),W1(i,T,P,l,h,O,g,x,w)):i.push(g)}function Zh(i,e,o){let l=i[0],h=l.x,p=l.y;e(l);const g=[l];for(let x=1;x<i.length;x++){const w=i[x],{x:T,y:P}=w;e(w),W1(g,h,p,T,P,l,w,e,o),h=T,p=P,l=w}return g}function vh(i,e,o,l){if(l(e,o)){const h=e.add(o)._mult(.5);vh(i,e,h,l),vh(i,h,o,l)}else i.push(o)}function p0(i,e){let o=i[0];const l=[o];for(let h=1;h<i.length;h++){const p=i[h];vh(l,o,p,e),o=p}return l}const m0=Math.pow(2,14)-1,r2=-m0-1;function Gf(i,e){const o=Math.round(i.x*e),l=Math.round(i.y*e);return i.x=an(o,r2,m0),i.y=an(l,r2,m0),(o<i.x||o>i.x+1||l<i.y||l>i.y+1)&&Si("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function $c(i,e,o){const l=i.loadGeometry(),h=i.extent,p=dr/h;if(e&&o&&o.projection.isReprojectedInTileSpace){const g=1<<e.z,{scale:x,x:w,y:T,projection:P}=o,O=k=>{const j=Ea((e.x+k.x/h)/g),q=dl((e.y+k.y/h)/g),ue=P.project(j,q);k.x=(ue.x*x-w)*h,k.y=(ue.y*x-T)*h};for(let k=0;k<l.length;k++)if(1!==i.type)l[k]=Zh(l[k],O,1);else{const j=[];for(const q of l[k])q.x<0||q.x>=h||q.y<0||q.y>=h||(O(q),j.push(q));l[k]=j}}for(const g of l)for(const x of g)Gf(x,p);return l}function qu(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?$c(i):[]}}function K1(i,e,o,l,h){i.emplaceBack(2*e+(l+1)/2,2*o+(h+1)/2)}function Sl(i,e,o){i.emplaceBack(e.x,e.y,e.z,16384*o[0],16384*o[1],16384*o[2])}class _h{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new li,this.indexArray=new Qi,this.segments=new na,this.programConfigurations=new Ql(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,l,h){const p=this.layers[0],g=[];let x=null;"circle"===p.type&&(x=p.layout.get("circle-sort-key"));for(const{feature:T,id:P,index:O,sourceLayerIndex:k}of e){const j=this.layers[0]._featureFilter.needGeometry,q=qu(T,j);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),q,l))continue;const ue=x?x.evaluate(q,{},l):void 0,Be={id:P,properties:T.properties,type:T.type,sourceLayerIndex:k,index:O,geometry:j?q.geometry:$c(T,l,h),patterns:{},sortKey:ue};g.push(Be)}x&&g.sort((T,P)=>T.sortKey-P.sortKey);let w=null;"globe"===h.projection.name&&(this.globeExtVertexArray=new ri,w=h.projection);for(const T of g){const{geometry:P,index:O,sourceLayerIndex:k}=T,j=e[O].feature;this.addFeature(T,P,O,o.availableImages,l,w),o.featureIndex.insert(j,P,O,k,this.index)}}update(e,o,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Bf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,W4.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,o,l,h,p,g){for(const x of o)for(const w of x){const T=w.x,P=w.y;if(T<0||T>=dr||P<0||P>=dr)continue;if(g){const j=g.projectTilePoint(T,P,p),q=g.upVector(p,T,P),ue=this.globeExtVertexArray;Sl(ue,j,q),Sl(ue,j,q),Sl(ue,j,q),Sl(ue,j,q)}const O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),k=O.vertexLength;K1(this.layoutVertexArray,T,P,-1,-1),K1(this.layoutVertexArray,T,P,1,-1),K1(this.layoutVertexArray,T,P,1,1),K1(this.layoutVertexArray,T,P,-1,1),this.indexArray.emplaceBack(k,k+1,k+2),this.indexArray.emplaceBack(k,k+2,k+3),O.vertexLength+=4,O.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,{},h,p)}}function g0(i,e){for(let o=0;o<i.length;o++)if(wu(e,i[o]))return!0;for(let o=0;o<e.length;o++)if(wu(i,e[o]))return!0;return!!q1(i,e)}function v0(i,e,o){return!!wu(i,e)||!!_0(e,i,o)}function Al(i,e){if(1===i.length)return x0(e,i[0]);for(let o=0;o<e.length;o++){const l=e[o];for(let h=0;h<l.length;h++)if(wu(i,l[h]))return!0}for(let o=0;o<i.length;o++)if(x0(e,i[o]))return!0;for(let o=0;o<e.length;o++)if(q1(i,e[o]))return!0;return!1}function Xh(i,e,o){if(i.length>1){if(q1(i,e))return!0;for(let l=0;l<e.length;l++)if(_0(e[l],i,o))return!0}for(let l=0;l<i.length;l++)if(_0(i[l],e,o))return!0;return!1}function q1(i,e){if(0===i.length||0===e.length)return!1;for(let o=0;o<i.length-1;o++){const l=i[o],h=i[o+1];for(let p=0;p<e.length-1;p++)if(o2(l,h,e[p],e[p+1]))return!0}return!1}function o2(i,e,o,l){return Mi(i,o,l)!==Mi(e,o,l)&&Mi(i,e,o)!==Mi(i,e,l)}function _0(i,e,o){const l=o*o;if(1===e.length)return i.distSqr(e[0])<l;for(let h=1;h<e.length;h++)if(y0(i,e[h-1],e[h])<l)return!0;return!1}function y0(i,e,o){const l=e.distSqr(o);if(0===l)return i.distSqr(e);const h=((i.x-e.x)*(o.x-e.x)+(i.y-e.y)*(o.y-e.y))/l;return i.distSqr(h<0?e:h>1?o:o.sub(e)._mult(h)._add(e))}function x0(i,e){let o,l,h,p=!1;for(let g=0;g<i.length;g++){o=i[g];for(let x=0,w=o.length-1;x<o.length;w=x++)l=o[x],h=o[w],l.y>e.y!=h.y>e.y&&e.x<(h.x-l.x)*(e.y-l.y)/(h.y-l.y)+l.x&&(p=!p)}return p}function wu(i,e){let o=!1;for(let l=0,h=i.length-1;l<i.length;h=l++){const p=i[l],g=i[h];p.y>e.y!=g.y>e.y&&e.x<(g.x-p.x)*(e.y-p.y)/(g.y-p.y)+p.x&&(o=!o)}return o}function s2(i,e,o,l,h){for(const g of i)if(e<=g.x&&o<=g.y&&l>=g.x&&h>=g.y)return!0;const p=[new et(e,o),new et(e,h),new et(l,h),new et(l,o)];if(i.length>2)for(const g of p)if(wu(i,g))return!0;for(let g=0;g<i.length-1;g++)if(a2(i[g],i[g+1],p))return!0;return!1}function a2(i,e,o){const l=o[0],h=o[2];if(i.x<l.x&&e.x<l.x||i.x>h.x&&e.x>h.x||i.y<l.y&&e.y<l.y||i.y>h.y&&e.y>h.y)return!1;const p=Mi(i,e,o[0]);return p!==Mi(i,e,o[1])||p!==Mi(i,e,o[2])||p!==Mi(i,e,o[3])}function yh(i,e,o){const l=e.paint.get(i).value;return"constant"===l.kind?l.value:o.programConfigurations.get(e.id).getMaxValue(i)}function Z1(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function l2(i,e,o,l,h){if(!e[0]&&!e[1])return i;const p=et.convert(e)._mult(h);"viewport"===o&&p._rotate(-l);const g=[];for(let x=0;x<i.length;x++)g.push(i[x].sub(p));return g}function c2(i,e,o,l){const h=et.convert(i)._mult(l);return"viewport"===e&&h._rotate(-o),h}$i(_h,"CircleBucket",{omit:["layers"]});const u2=new Mt({"circle-sort-key":new qe(ht.layout_circle["circle-sort-key"])});var h2={paint:new Mt({"circle-radius":new qe(ht.paint_circle["circle-radius"]),"circle-color":new qe(ht.paint_circle["circle-color"]),"circle-blur":new qe(ht.paint_circle["circle-blur"]),"circle-opacity":new qe(ht.paint_circle["circle-opacity"]),"circle-translate":new Ee(ht.paint_circle["circle-translate"]),"circle-translate-anchor":new Ee(ht.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ee(ht.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ee(ht.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new qe(ht.paint_circle["circle-stroke-width"]),"circle-stroke-color":new qe(ht.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new qe(ht.paint_circle["circle-stroke-opacity"])}),layout:u2};function b0(i,e,o,l,h,p,g,x,w){if(p&&i.queryGeometry.isAboveHorizon)return!1;p&&(w*=i.pixelToTileUnitsFactor);const T=i.tileID.canonical,P=o.projection.upVectorScale(T,o.center.lat,o.worldSize).metersToTile;for(const O of e)for(const k of O){const j=k.add(x),q=h&&o.elevation?o.elevation.exaggeration()*h.getElevationAt(j.x,j.y,!0):0,ue=o.projection.projectTilePoint(j.x,j.y,T);if(q>0){const rt=o.projection.upVector(T,j.x,j.y);ue.x+=rt[0]*P*q,ue.y+=rt[1]*P*q,ue.z+=rt[2]*P*q}const Be=p?j:X1(ue.x,ue.y,ue.z,l),tt=p?i.tilespaceRays.map(rt=>f2(rt,q)):i.queryGeometry.screenGeometry,_t=_u([],[ue.x,ue.y,ue.z,1],l);if(!g&&p?w*=_t[3]/o.cameraToCenterDistance:g&&!p&&(w*=o.cameraToCenterDistance/_t[3]),p){const rt=dl((k.y/dr+T.y)/(1<<T.z));w/=o.projection.pixelsPerMeter(rt,1)/lc(1,rt)}if(v0(tt,Be,w))return!0}return!1}function X1(i,e,o,l){const h=_u([],[i,e,o,1],l);return new et(h[0]/h[3],h[1]/h[3])}const w0=gu(0,0,0),d2=gu(0,0,1);function f2(i,e){const o=t0();return w0[2]=e,i.intersectsPlane(w0,d2,o),new et(o[0],o[1])}class M0 extends _h{}function p2(i,{width:e,height:o},l,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*o*l)throw new RangeError("mismatched image size")}else h=new Uint8Array(e*o*l);return i.width=e,i.height=o,i.data=h,i}function m2(i,e,o){const{width:l,height:h}=e;l===i.width&&h===i.height||(E0(i,e,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,l),height:Math.min(i.height,h)},o),i.width=l,i.height=h,i.data=e.data)}function E0(i,e,o,l,h,p){if(0===h.width||0===h.height)return e;if(h.width>i.width||h.height>i.height||o.x>i.width-h.width||o.y>i.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||l.x>e.width-h.width||l.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const g=i.data,x=e.data;for(let w=0;w<h.height;w++){const T=((o.y+w)*i.width+o.x)*p,P=((l.y+w)*e.width+l.x)*p;for(let O=0;O<h.width*p;O++)x[P+O]=g[T+O]}return e}$i(M0,"HeatmapBucket",{omit:["layers"]});class iu{constructor(e,o){p2(this,e,1,o)}resize(e){m2(this,new iu(e),1)}clone(){return new iu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,l,h,p){E0(e,o,l,h,p,1)}}class Gl{constructor(e,o){p2(this,e,4,o)}resize(e){m2(this,new Gl(e),4)}replace(e,o){o?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Gl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,l,h,p){E0(e,o,l,h,p,4)}}$i(iu,"AlphaImage"),$i(Gl,"RGBAImage");var L8={paint:new Mt({"heatmap-radius":new qe(ht.paint_heatmap["heatmap-radius"]),"heatmap-weight":new qe(ht.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ee(ht.paint_heatmap["heatmap-intensity"]),"heatmap-color":new yt(ht.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ee(ht.paint_heatmap["heatmap-opacity"])})};function Q1(i){const e={},o=i.resolution||256,l=i.clips?i.clips.length:1,h=i.image||new Gl({width:o,height:l}),p=(g,x,w)=>{e[i.evaluationKey]=w;const T=i.expression.evaluate(e);h.data[g+x+0]=Math.floor(255*T.r/T.a),h.data[g+x+1]=Math.floor(255*T.g/T.a),h.data[g+x+2]=Math.floor(255*T.b/T.a),h.data[g+x+3]=Math.floor(255*T.a)};if(i.clips)for(let g=0,x=0;g<l;++g,x+=4*o)for(let w=0,T=0;w<o;w++,T+=4){const P=w/(o-1),{start:O,end:k}=i.clips[g];p(x,T,O*(1-P)+k*P)}else for(let g=0,x=0;g<o;g++,x+=4)p(0,x,g/(o-1));return h}var Wf={paint:new Mt({"hillshade-illumination-direction":new Ee(ht.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ee(ht.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ee(ht.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ee(ht.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ee(ht.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ee(ht.paint_hillshade["hillshade-accent-color"])})};const Kf=Zt([{name:"a_pos",components:2,type:"Int16"}],4),{members:R8}=Kf;var C0={exports:{}};function Qh(i,e,o){o=o||2;var l,h,p,g,x,w,T,P=e&&e.length,O=P?e[0]*o:i.length,k=J1(i,0,O,o,!0),j=[];if(!k||k.next===k.prev)return j;if(P&&(k=function(ue,Be,tt,_t){var rt,Dt,Rt,Vt=[];for(rt=0,Dt=Be.length;rt<Dt;rt++)(Rt=J1(ue,Be[rt]*_t,rt<Dt-1?Be[rt+1]*_t:ue.length,_t,!1))===Rt.next&&(Rt.steiner=!0),Vt.push(Qf(Rt));for(Vt.sort(F8),rt=0;rt<Vt.length;rt++)tt=Zf(Vt[rt],tt);return tt}(i,e,k,o)),i.length>80*o){l=p=i[0],h=g=i[1];for(var q=o;q<O;q+=o)(x=i[q])<l&&(l=x),(w=i[q+1])<h&&(h=w),x>p&&(p=x),w>g&&(g=w);T=0!==(T=Math.max(p-l,g-h))?32767/T:0}return Mc(k,j,o,l,h,T,0),j}function J1(i,e,o,l,h){var p,g;if(h===e1(i,e,o,l)>0)for(p=e;p<o;p+=l)g=bh(p,i[p],i[p+1],g);else for(p=o-l;p>=e;p-=l)g=bh(p,i[p],i[p+1],g);return g&&td(g,g.next)&&(Mu(g),g=g.next),g}function Zu(i,e){if(!i)return i;e||(e=i);var o,l=i;do{if(o=!1,l.steiner||!td(l,l.next)&&0!==Ns(l.prev,l,l.next))l=l.next;else{if(Mu(l),(l=e=l.prev)===l.next)break;o=!0}}while(o||l!==e);return e}function Mc(i,e,o,l,h,p,g){if(i){!g&&p&&function(P,O,k,j){var q=P;do{0===q.z&&(q.z=T0(q.x,q.y,O,k,j)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next}while(q!==P);q.prevZ.nextZ=null,q.prevZ=null,function(ue){var Be,tt,_t,rt,Dt,Rt,Vt,bn,_n=1;do{for(tt=ue,ue=null,Dt=null,Rt=0;tt;){for(Rt++,_t=tt,Vt=0,Be=0;Be<_n&&(Vt++,_t=_t.nextZ);Be++);for(bn=_n;Vt>0||bn>0&&_t;)0!==Vt&&(0===bn||!_t||tt.z<=_t.z)?(rt=tt,tt=tt.nextZ,Vt--):(rt=_t,_t=_t.nextZ,bn--),Dt?Dt.nextZ=rt:ue=rt,rt.prevZ=Dt,Dt=rt;tt=_t}Dt.nextZ=null,_n*=2}while(Rt>1)}(q)}(i,l,h,p);for(var x,w,T=i;i.prev!==i.next;)if(x=i.prev,w=i.next,p?qf(i,l,h,p):g2(i))e.push(x.i/o|0),e.push(i.i/o|0),e.push(w.i/o|0),Mu(i),i=w.next,T=w.next;else if((i=w)===T){g?1===g?Mc(i=v2(Zu(i),e,o),e,o,l,h,p,2):2===g&&ed(i,e,o,l,h,p):Mc(Zu(i),e,o,l,h,p,1);break}}}function g2(i){var e=i.prev,o=i,l=i.next;if(Ns(e,o,l)>=0)return!1;for(var h=e.x,p=o.x,g=l.x,x=e.y,w=o.y,T=l.y,P=h<p?h<g?h:g:p<g?p:g,O=x<w?x<T?x:T:w<T?w:T,k=h>p?h>g?h:g:p>g?p:g,j=x>w?x>T?x:T:w>T?w:T,q=l.next;q!==e;){if(q.x>=P&&q.x<=k&&q.y>=O&&q.y<=j&&Jh(h,x,p,w,g,T,q.x,q.y)&&Ns(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function qf(i,e,o,l){var h=i.prev,p=i,g=i.next;if(Ns(h,p,g)>=0)return!1;for(var x=h.x,w=p.x,T=g.x,P=h.y,O=p.y,k=g.y,j=x<w?x<T?x:T:w<T?w:T,q=P<O?P<k?P:k:O<k?O:k,ue=x>w?x>T?x:T:w>T?w:T,Be=P>O?P>k?P:k:O>k?O:k,tt=T0(j,q,e,o,l),_t=T0(ue,Be,e,o,l),rt=i.prevZ,Dt=i.nextZ;rt&&rt.z>=tt&&Dt&&Dt.z<=_t;){if(rt.x>=j&&rt.x<=ue&&rt.y>=q&&rt.y<=Be&&rt!==h&&rt!==g&&Jh(x,P,w,O,T,k,rt.x,rt.y)&&Ns(rt.prev,rt,rt.next)>=0||(rt=rt.prevZ,Dt.x>=j&&Dt.x<=ue&&Dt.y>=q&&Dt.y<=Be&&Dt!==h&&Dt!==g&&Jh(x,P,w,O,T,k,Dt.x,Dt.y)&&Ns(Dt.prev,Dt,Dt.next)>=0))return!1;Dt=Dt.nextZ}for(;rt&&rt.z>=tt;){if(rt.x>=j&&rt.x<=ue&&rt.y>=q&&rt.y<=Be&&rt!==h&&rt!==g&&Jh(x,P,w,O,T,k,rt.x,rt.y)&&Ns(rt.prev,rt,rt.next)>=0)return!1;rt=rt.prevZ}for(;Dt&&Dt.z<=_t;){if(Dt.x>=j&&Dt.x<=ue&&Dt.y>=q&&Dt.y<=Be&&Dt!==h&&Dt!==g&&Jh(x,P,w,O,T,k,Dt.x,Dt.y)&&Ns(Dt.prev,Dt,Dt.next)>=0)return!1;Dt=Dt.nextZ}return!0}function v2(i,e,o){var l=i;do{var h=l.prev,p=l.next.next;!td(h,p)&&nd(h,l,l.next,p)&&Xu(h,p)&&Xu(p,h)&&(e.push(h.i/o|0),e.push(l.i/o|0),e.push(p.i/o|0),Mu(l),Mu(l.next),l=i=p),l=l.next}while(l!==i);return Zu(l)}function ed(i,e,o,l,h,p){var g=i;do{for(var x=g.next.next;x!==g.prev;){if(g.i!==x.i&&N8(g,x)){var w=id(g,x);return g=Zu(g,g.next),w=Zu(w,w.next),Mc(g,e,o,l,h,p,0),void Mc(w,e,o,l,h,p,0)}x=x.next}g=g.next}while(g!==i)}function F8(i,e){return i.x-e.x}function Zf(i,e){var o=function(h,p){var g,x=p,w=h.x,T=h.y,P=-1/0;do{if(T<=x.y&&T>=x.next.y&&x.next.y!==x.y){var O=x.x+(T-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(O<=w&&O>P&&(P=O,g=x.x<x.next.x?x:x.next,O===w))return g}x=x.next}while(x!==p);if(!g)return null;var k,j=g,q=g.x,ue=g.y,Be=1/0;x=g;do{w>=x.x&&x.x>=q&&w!==x.x&&Jh(T<ue?w:P,T,q,ue,T<ue?P:w,T,x.x,x.y)&&(k=Math.abs(T-x.y)/(w-x.x),Xu(x,h)&&(k<Be||k===Be&&(x.x>g.x||x.x===g.x&&Xf(g,x)))&&(g=x,Be=k)),x=x.next}while(x!==j);return g}(i,e);if(!o)return e;var l=id(o,i);return Zu(l,l.next),Zu(o,o.next)}function Xf(i,e){return Ns(i.prev,i,e.prev)<0&&Ns(e.next,i,i.next)<0}function T0(i,e,o,l,h){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-o)*h|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-l)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Qf(i){var e=i,o=i;do{(e.x<o.x||e.x===o.x&&e.y<o.y)&&(o=e),e=e.next}while(e!==i);return o}function Jh(i,e,o,l,h,p,g,x){return(h-g)*(e-x)>=(i-g)*(p-x)&&(i-g)*(l-x)>=(o-g)*(e-x)&&(o-g)*(p-x)>=(h-g)*(l-x)}function N8(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(o,l){var h=o;do{if(h.i!==o.i&&h.next.i!==o.i&&h.i!==l.i&&h.next.i!==l.i&&nd(h,h.next,o,l))return!0;h=h.next}while(h!==o);return!1}(i,e)&&(Xu(i,e)&&Xu(e,i)&&function(o,l){var h=o,p=!1,g=(o.x+l.x)/2,x=(o.y+l.y)/2;do{h.y>x!=h.next.y>x&&h.next.y!==h.y&&g<(h.next.x-h.x)*(x-h.y)/(h.next.y-h.y)+h.x&&(p=!p),h=h.next}while(h!==o);return p}(i,e)&&(Ns(i.prev,i,e.prev)||Ns(i,e.prev,e))||td(i,e)&&Ns(i.prev,i,i.next)>0&&Ns(e.prev,e,e.next)>0)}function Ns(i,e,o){return(e.y-i.y)*(o.x-e.x)-(e.x-i.x)*(o.y-e.y)}function td(i,e){return i.x===e.x&&i.y===e.y}function nd(i,e,o,l){var h=ru(Ns(i,e,o)),p=ru(Ns(i,e,l)),g=ru(Ns(o,l,i)),x=ru(Ns(o,l,e));return h!==p&&g!==x||!(0!==h||!xh(i,o,e))||!(0!==p||!xh(i,l,e))||!(0!==g||!xh(o,i,l))||!(0!==x||!xh(o,e,l))}function xh(i,e,o){return e.x<=Math.max(i.x,o.x)&&e.x>=Math.min(i.x,o.x)&&e.y<=Math.max(i.y,o.y)&&e.y>=Math.min(i.y,o.y)}function ru(i){return i>0?1:i<0?-1:0}function Xu(i,e){return Ns(i.prev,i,i.next)<0?Ns(i,e,i.next)>=0&&Ns(i,i.prev,e)>=0:Ns(i,e,i.prev)<0||Ns(i,i.next,e)<0}function id(i,e){var o=new Eu(i.i,i.x,i.y),l=new Eu(e.i,e.x,e.y),h=i.next,p=e.prev;return i.next=e,e.prev=i,o.next=h,h.prev=o,l.next=o,o.prev=l,p.next=l,l.prev=p,l}function bh(i,e,o,l){var h=new Eu(i,e,o);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function Mu(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Eu(i,e,o){this.i=i,this.x=e,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function e1(i,e,o,l){for(var h=0,p=e,g=o-l;p<o;p+=l)h+=(i[g]-i[p])*(i[p+1]+i[g+1]),g=p;return h}C0.exports=Qh,C0.exports.default=Qh,Qh.deviation=function(i,e,o,l){var h=e&&e.length,p=Math.abs(e1(i,0,h?e[0]*o:i.length,o));if(h)for(var g=0,x=e.length;g<x;g++)p-=Math.abs(e1(i,e[g]*o,g<x-1?e[g+1]*o:i.length,o));var w=0;for(g=0;g<l.length;g+=3){var T=l[g]*o,P=l[g+1]*o,O=l[g+2]*o;w+=Math.abs((i[T]-i[O])*(i[P+1]-i[T+1])-(i[T]-i[P])*(i[O+1]-i[T+1]))}return 0===p&&0===w?0:Math.abs((w-p)/p)},Qh.flatten=function(i){for(var e=i[0][0].length,o={vertices:[],holes:[],dimensions:e},l=0,h=0;h<i.length;h++){for(var p=0;p<i[h].length;p++)for(var g=0;g<e;g++)o.vertices.push(i[h][p][g]);h>0&&o.holes.push(l+=i[h-1].length)}return o};var t1=bt(C0.exports);function rd(i,e,o,l,h){Jf(i,e,o||0,l||i.length-1,h||n1)}function Jf(i,e,o,l,h){for(;l>o;){if(l-o>600){var p=l-o+1,g=e-o+1,x=Math.log(p),w=.5*Math.exp(2*x/3),T=.5*Math.sqrt(x*w*(p-w)/p)*(g-p/2<0?-1:1);Jf(i,e,Math.max(o,Math.floor(e-g*w/p+T)),Math.min(l,Math.floor(e+(p-g)*w/p+T)),h)}var P=i[e],O=o,k=l;for(Qu(i,o,e),h(i[l],P)>0&&Qu(i,o,l);O<k;){for(Qu(i,O,k),O++,k--;h(i[O],P)<0;)O++;for(;h(i[k],P)>0;)k--}0===h(i[o],P)?Qu(i,o,k):Qu(i,++k,l),k<=e&&(o=k+1),e<=k&&(l=k-1)}}function Qu(i,e,o){var l=i[e];i[e]=i[o],i[o]=l}function n1(i,e){return i<e?-1:i>e?1:0}function D0(i,e){const o=i.length;if(o<=1)return[i];const l=[];let h,p;for(let g=0;g<o;g++){const x=Br(i[g]);0!==x&&(i[g].area=Math.abs(x),void 0===p&&(p=x<0),p===x<0?(h&&l.push(h),h=[i[g]]):h.push(i[g]))}if(h&&l.push(h),e>1)for(let g=0;g<l.length;g++)l[g].length<=e||(rd(l[g],e,1,l[g].length-1,_2),l[g]=l[g].slice(0,e));return l}function _2(i,e){return e.area-i.area}function S0(i,e,o){const l=o.patternDependencies;let h=!1;for(const p of e){const g=p.paint.get(`${i}-pattern`);g.isConstant()||(h=!0);const x=g.constantOr(null);x&&(h=!0,l[x]=!0)}return h}function A0(i,e,o,l,h){const p=h.patternDependencies;for(const g of e){const x=g.paint.get(`${i}-pattern`).value;if("constant"!==x.kind){let w=x.evaluate({zoom:l},o,{},h.availableImages);w=w&&w.name?w.name:w,p[w]=!0,o.patterns[g.id]=w}}return o}class wh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new li,this.indexArray=new Qi,this.indexArray2=new Ma,this.programConfigurations=new Ql(e.layers,e.zoom),this.segments=new na,this.segments2=new na,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=e.projection}populate(e,o,l,h){this.hasPattern=S0("fill",this.layers,o);const p=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:x,id:w,index:T,sourceLayerIndex:P}of e){const O=this.layers[0]._featureFilter.needGeometry,k=qu(x,O);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),k,l))continue;const j=p?p.evaluate(k,{},l,o.availableImages):void 0,q={id:w,properties:x.properties,type:x.type,sourceLayerIndex:P,index:T,geometry:O?k.geometry:$c(x,l,h),patterns:{},sortKey:j};g.push(q)}p&&g.sort((x,w)=>x.sortKey-w.sortKey);for(const x of g){const{geometry:w,index:T,sourceLayerIndex:P}=x;if(this.hasPattern){const O=A0("fill",this.layers,x,this.zoom,o);this.patternFeatures.push(O)}else this.addFeature(x,w,T,l,{},o.availableImages);o.featureIndex.insert(e[T].feature,w,T,P,this.index)}}update(e,o,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l,h)}addFeatures(e,o,l,h,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,o,l,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,R8),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,o,l,h,p,g=[]){for(const x of D0(o,500)){let w=0;for(const q of x)w+=q.length;const T=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),P=T.vertexLength,O=[],k=[];for(const q of x){if(0===q.length)continue;q!==x[0]&&k.push(O.length/2);const ue=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),Be=ue.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(Be+q.length-1,Be),O.push(q[0].x),O.push(q[0].y);for(let tt=1;tt<q.length;tt++)this.layoutVertexArray.emplaceBack(q[tt].x,q[tt].y),this.indexArray2.emplaceBack(Be+tt-1,Be+tt),O.push(q[tt].x),O.push(q[tt].y);ue.vertexLength+=q.length,ue.primitiveLength+=q.length}const j=t1(O,k);for(let q=0;q<j.length;q+=3)this.indexArray.emplaceBack(P+j[q],P+j[q+1],P+j[q+2]);T.vertexLength+=w,T.primitiveLength+=j.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,p,g,h)}}$i(wh,"FillBucket",{omit:["layers","patternFeatures"]});const y2=new Mt({"fill-sort-key":new qe(ht.layout_fill["fill-sort-key"])});var e3={paint:new Mt({"fill-antialias":new Ee(ht.paint_fill["fill-antialias"]),"fill-opacity":new qe(ht.paint_fill["fill-opacity"]),"fill-color":new qe(ht.paint_fill["fill-color"]),"fill-outline-color":new qe(ht.paint_fill["fill-outline-color"]),"fill-translate":new Ee(ht.paint_fill["fill-translate"]),"fill-translate-anchor":new Ee(ht.paint_fill["fill-translate-anchor"]),"fill-pattern":new qe(ht.paint_fill["fill-pattern"])}),layout:y2};const t3=Zt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),r1=Zt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),x2=Zt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:P0}=t3;var od={},V8=Yt,n3=Gc;function Gc(i,e,o,l,h){this.properties={},this.extent=o,this.type=0,this._pbf=i,this._geometry=-1,this._keys=l,this._values=h,i.readFields(i3,this,e)}function i3(i,e,o){1==i?e.id=o.readVarint():2==i?function(l,h){for(var p=l.readVarint()+l.pos;l.pos<p;){var g=h._keys[l.readVarint()],x=h._values[l.readVarint()];h.properties[g]=x}}(o,e):3==i?e.type=o.readVarint():4==i&&(e._geometry=o.pos)}function sd(i){for(var e,o,l=0,h=0,p=i.length,g=p-1;h<p;g=h++)l+=((o=i[g]).x-(e=i[h]).x)*(e.y+o.y);return l}Gc.types=["Unknown","Point","LineString","Polygon"],Gc.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var e,o=i.readVarint()+i.pos,l=1,h=0,p=0,g=0,x=[];i.pos<o;){if(h<=0){var w=i.readVarint();l=7&w,h=w>>3}if(h--,1===l||2===l)p+=i.readSVarint(),g+=i.readSVarint(),1===l&&(e&&x.push(e),e=[]),e.push(new V8(p,g));else{if(7!==l)throw new Error("unknown command "+l);e&&e.push(e[0].clone())}}return e&&x.push(e),x},Gc.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var e=i.readVarint()+i.pos,o=1,l=0,h=0,p=0,g=1/0,x=-1/0,w=1/0,T=-1/0;i.pos<e;){if(l<=0){var P=i.readVarint();o=7&P,l=P>>3}if(l--,1===o||2===o)(h+=i.readSVarint())<g&&(g=h),h>x&&(x=h),(p+=i.readSVarint())<w&&(w=p),p>T&&(T=p);else if(7!==o)throw new Error("unknown command "+o)}return[g,w,x,T]},Gc.prototype.toGeoJSON=function(i,e,o){var l,h,p=this.extent*Math.pow(2,o),g=this.extent*i,x=this.extent*e,w=this.loadGeometry(),T=Gc.types[this.type];function P(j){for(var q=0;q<j.length;q++){var ue=j[q];j[q]=[360*(ue.x+g)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(ue.y+x)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var O=[];for(l=0;l<w.length;l++)O[l]=w[l][0];P(w=O);break;case 2:for(l=0;l<w.length;l++)P(w[l]);break;case 3:for(w=function(j){var q=j.length;if(q<=1)return[j];for(var ue,Be,tt=[],_t=0;_t<q;_t++){var rt=sd(j[_t]);0!==rt&&(void 0===Be&&(Be=rt<0),Be===rt<0?(ue&&tt.push(ue),ue=[j[_t]]):ue.push(j[_t]))}return ue&&tt.push(ue),tt}(w),l=0;l<w.length;l++)for(h=0;h<w[l].length;h++)P(w[l][h])}1===w.length?w=w[0]:T="Multi"+T;var k={type:"Feature",geometry:{type:T,coordinates:w},properties:this.properties};return"id"in this&&(k.id=this.id),k};var z0=n3,b2=I0;function I0(i,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(k0,this,e),this.length=this._features.length}function k0(i,e,o){15===i?e.version=o.readVarint():1===i?e.name=o.readString():5===i?e.extent=o.readVarint():2===i?e._features.push(o.pos):3===i?e._keys.push(o.readString()):4===i&&e._values.push(function(l){for(var h=null,p=l.readVarint()+l.pos;l.pos<p;){var g=l.readVarint()>>3;h=1===g?l.readString():2===g?l.readFloat():3===g?l.readDouble():4===g?l.readVarint64():5===g?l.readVarint():6===g?l.readSVarint():7===g?l.readBoolean():null}return h}(o))}I0.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var e=this._pbf.readVarint()+this._pbf.pos;return new z0(this._pbf,e,this.extent,this._keys,this._values)};var ad=b2;function ld(i,e,o){if(3===i){var l=new ad(o,o.readVarint()+o.pos);l.length&&(e[l.name]=l)}}var cd=od.VectorTile=function(i,e){this.layers=i.readFields(ld,{},e)},o1=od.VectorTileFeature=n3;function s1(i,e,o,l){const h=[],p=0===l?(g,x,w,T,P,O)=>{g.push(new et(O,w+(O-x)/(T-x)*(P-w)))}:(g,x,w,T,P,O)=>{g.push(new et(x+(O-w)/(P-w)*(T-x),O))};for(const g of i){const x=[];for(const w of g){if(w.length<=2)continue;const T=[];for(let k=0;k<w.length-1;k++){const j=w[k].x,q=w[k].y,ue=w[k+1].x,Be=w[k+1].y,tt=0===l?j:q,_t=0===l?ue:Be;tt<e?_t>e&&p(T,j,q,ue,Be,e):tt>o?_t<o&&p(T,j,q,ue,Be,o):T.push(w[k]),_t<e&&tt>=e&&p(T,j,q,ue,Be,e),_t>o&&tt<=o&&p(T,j,q,ue,Be,o)}let P=w[w.length-1];const O=0===l?P.x:P.y;O>=e&&O<=o&&T.push(P),T.length&&(P=T[T.length-1],T[0].x===P.x&&T[0].y===P.y||T.push(T[0]),x.push(T))}x.length&&h.push(x)}return h}od.VectorTileLayer=b2;const ud=o1.types,O0=Math.pow(2,13);function Wc(i,e,o,l,h,p,g,x){i.emplaceBack((e<<1)+g,(o<<1)+p,(Math.floor(l*O0)<<1)+h,Math.round(x))}function a1(i,e,o){i.emplaceBack(e.x,e.y,e.z,16384*o[0],16384*o[1],16384*o[2])}class w2{constructor(){this.acc=new et(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new et(e.x,e.y),this.max=new et(e.x,e.y))}append(e,o){this.currentPolyCount.edges++,this.acc._add(e);const l=this.min,h=this.max;e.x<l.x?l.x=e.x:e.x>h.x&&(h.x=e.x),e.y<l.y?l.y=e.y:e.y>h.y&&(h.y=e.y),((0===e.x||e.x===dr)&&e.x===o.x)!=((0===e.y||e.y===dr)&&e.y===o.y)&&this.processBorderOverlap(e,o),o.x<0!=e.x<0&&this.addBorderIntersection(0,Hr(o.y,e.y,(0-o.x)/(e.x-o.x))),o.x>dr!=e.x>dr&&this.addBorderIntersection(1,Hr(o.y,e.y,(dr-o.x)/(e.x-o.x))),o.y<0!=e.y<0&&this.addBorderIntersection(2,Hr(o.x,e.x,(0-o.y)/(e.y-o.y))),o.y>dr!=e.y>dr&&this.addBorderIntersection(3,Hr(o.x,e.x,(dr-o.y)/(e.y-o.y)))}addBorderIntersection(e,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const l=this.borders[e];o<l[0]&&(l[0]=o),o>l[1]&&(l[1]=o)}processBorderOverlap(e,o){if(e.x===o.x){if(e.y===o.y)return;const l=0===e.x?0:1;this.addBorderIntersection(l,o.y),this.addBorderIntersection(l,e.y)}else{const l=0===e.y?2:3;this.addBorderIntersection(l,o.x),this.addBorderIntersection(l,e.x)}}centroid(){const e=this.polyCount.reduce((o,l)=>o+l.edges,0);return 0!==e?this.acc.div(e)._round():new et(0,0)}span(){return new et(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,o)=>e+ +(o[0]!==Number.MAX_VALUE),0)}}class hd{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Fn,this.centroidVertexArray=new v,this.indexArray=new Qi,this.programConfigurations=new Ql(e.layers,e.zoom),this.segments=new na,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.enableTerrain=e.enableTerrain}populate(e,o,l,h){this.features=[],this.hasPattern=S0("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(p){const g=Math.exp(Math.PI*(1-p.y/(1<<p.z)*2));return 80150034*g/(g*g+1)/dr/(1<<p.z)}(l),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:p,id:g,index:x,sourceLayerIndex:w}of e){const T=this.layers[0]._featureFilter.needGeometry,P=qu(p,T);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),P,l))continue;const O={id:g,sourceLayerIndex:w,index:x,geometry:T?P.geometry:$c(p,l,h),properties:p.properties,type:p.type,patterns:{}},k=this.layoutVertexArray.length;this.hasPattern?this.features.push(A0("fill-extrusion",this.layers,O,this.zoom,o)):this.addFeature(O,O.geometry,x,l,{},o.availableImages,h),o.featureIndex.insert(p,O.geometry,x,w,this.index,k)}this.sortBorders()}addFeatures(e,o,l,h,p){for(const g of this.features){const{geometry:x}=g;this.addFeature(g,x,g.index,o,l,h,p)}this.sortBorders()}update(e,o,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,P0),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,x2.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,r1.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,o,l,h,p,g,x){const w=[new et(0,0),new et(dr,dr)],T=x.projection,P="globe"===T.name,O=this.enableTerrain&&!P?new w2:null,k="Polygon"===ud[e.type];P&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new ri);const j=D0(o,500);for(let tt=j.length-1;tt>=0;tt--){const _t=j[tt];(0===_t.length||(q=_t[0]).every(rt=>rt.x<=0)||q.every(rt=>rt.x>=dr)||q.every(rt=>rt.y<=0)||q.every(rt=>rt.y>=dr))&&j.splice(tt,1)}var q;let ue;if(P)ue=E2(j,w,h);else{ue=[];for(const tt of j)ue.push({polygon:tt,bounds:w})}const Be=k?this.edgeRadius:0;for(const{polygon:tt,bounds:_t}of ue){let rt=0,Dt=0;for(const Vt of tt)k&&!Vt[0].equals(Vt[Vt.length-1])&&Vt.push(Vt[0]),Dt+=k?Vt.length-1:Vt.length;const Rt=this.segments.prepareSegment((k?5:4)*Dt,this.layoutVertexArray,this.indexArray);if(k){const Vt=[],bn=[];rt=Rt.vertexLength;for(const Vn of tt){let hi,En;Vn.length&&Vn!==tt[0]&&bn.push(Vt.length/2),hi=Vn[1].sub(Vn[0])._perp()._unit();for(let Kn=1;Kn<Vn.length;Kn++){const Gn=Vn[Kn],oi=Vn[Kn===Vn.length-1?1:Kn+1];let{x:pi,y:kn}=Gn;if(Be){En=oi.sub(Gn)._perp()._unit();const Ii=hi.add(En)._unit(),qi=Be*Math.min(4,1/(hi.x*Ii.x+hi.y*Ii.y));pi+=qi*Ii.x,kn+=qi*Ii.y,hi=En}Wc(this.layoutVertexArray,pi,kn,0,0,1,1,0),Rt.vertexLength++,Vt.push(Gn.x,Gn.y),P&&a1(this.layoutVertexExtArray,T.projectTilePoint(pi,kn,h),T.upVector(h,pi,kn))}}const _n=t1(Vt,bn);for(let Vn=0;Vn<_n.length;Vn+=3)this.indexArray.emplaceBack(rt+_n[Vn],rt+_n[Vn+2],rt+_n[Vn+1]),Rt.primitiveLength++}for(const Vt of tt){O&&Vt.length&&O.startRing(Vt[0]);let bn,_n,Vn,hi=Vt.length>4&&dd(Vt[Vt.length-2],Vt[0],Vt[1]),En=Be?L0(Vt[Vt.length-2],Vt[0],Vt[1],Be):0;_n=Vt[1].sub(Vt[0])._perp()._unit();let Kn=!0;for(let Gn=1,oi=0;Gn<Vt.length;Gn++){let pi=Vt[Gn-1],kn=Vt[Gn];const Ii=Vt[Gn===Vt.length-1?1:Gn+1];if(O&&k&&O.currentPolyCount.top++,F0(kn,pi,_t)){Be&&(_n=Ii.sub(kn)._perp()._unit(),Kn=!Kn);continue}O&&O.append(kn,pi);const qi=kn.sub(pi)._perp(),Li=qi.x/(Math.abs(qi.x)+Math.abs(qi.y)),Xr=qi.y>0?1:0,yi=pi.dist(kn);if(oi+yi>32768&&(oi=0),Be){Vn=Ii.sub(kn)._perp()._unit();let Qr=R0(pi,kn,Ii,l1(_n,Vn),Be);isNaN(Qr)&&(Qr=0);const zr=kn.sub(pi)._unit();pi=pi.add(zr.mult(En))._round(),kn=kn.add(zr.mult(-Qr))._round(),En=Qr,_n=Vn}const gr=Rt.vertexLength,jr=Vt.length>4&&dd(pi,kn,Ii);let zo=Cu(oi,hi,Kn);if(Wc(this.layoutVertexArray,pi.x,pi.y,Li,Xr,0,0,zo),Wc(this.layoutVertexArray,pi.x,pi.y,Li,Xr,0,1,zo),oi+=yi,zo=Cu(oi,jr,!Kn),hi=jr,Wc(this.layoutVertexArray,kn.x,kn.y,Li,Xr,0,0,zo),Wc(this.layoutVertexArray,kn.x,kn.y,Li,Xr,0,1,zo),Rt.vertexLength+=4,this.indexArray.emplaceBack(gr+0,gr+1,gr+2),this.indexArray.emplaceBack(gr+1,gr+3,gr+2),Rt.primitiveLength+=2,Be){const Qr=rt+(1===Gn?Vt.length-2:Gn-2),zr=1===Gn?rt:Qr+1;if(this.indexArray.emplaceBack(gr+1,Qr,gr+3),this.indexArray.emplaceBack(Qr,zr,gr+3),Rt.primitiveLength+=2,void 0===bn&&(bn=gr),!F0(Ii,Vt[Gn],_t)){const ws=Gn===Vt.length-1?bn:Rt.vertexLength;this.indexArray.emplaceBack(gr+2,gr+3,ws),this.indexArray.emplaceBack(gr+3,ws+1,ws),this.indexArray.emplaceBack(gr+3,zr,ws+1),Rt.primitiveLength+=3}Kn=!Kn}if(P){const Qr=this.layoutVertexExtArray,zr=T.projectTilePoint(pi.x,pi.y,h),ws=T.projectTilePoint(kn.x,kn.y,h),to=T.upVector(h,pi.x,pi.y),Wr=T.upVector(h,kn.x,kn.y);a1(Qr,zr,to),a1(Qr,zr,to),a1(Qr,ws,Wr),a1(Qr,ws,Wr)}}k&&(rt+=Vt.length-1)}}if(O&&O.polyCount.length>0){if(O.borders){O.vertexArrayOffset=this.centroidVertexArray.length;const tt=O.borders,_t=this.featuresOnBorder.push(O)-1;for(let rt=0;rt<4;rt++)tt[rt][0]!==Number.MAX_VALUE&&this.borders[rt].push(_t)}this.encodeCentroid(O.borders?void 0:O.centroid(),O)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,p,g,h)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((o,l)=>this.featuresOnBorder[o].borders[e][0]-this.featuresOnBorder[l].borders[e][0])}encodeCentroid(e,o,l=!0){let h,p;if(e)if(0!==e.y){const x=o.span()._mult(this.tileToMeter);h=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(x.x/10)),p=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(x.y/10))}else h=Math.ceil(7*(e.x+450)),p=0;else h=0,p=+l;let g=l?this.centroidVertexArray.length:o.vertexArrayOffset;for(const x of o.polyCount){l&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*x.edges+x.top);for(let w=0;w<x.top;w++)this.centroidVertexArray.emplace(g++,h,p);for(let w=0;w<2*x.edges;w++)this.centroidVertexArray.emplace(g++,0,p),this.centroidVertexArray.emplace(g++,h,p)}}}function l1(i,e){const o=i.add(e)._unit();return i.x*o.x+i.y*o.y}function L0(i,e,o,l){const h=e.sub(i)._perp()._unit(),p=o.sub(e)._perp()._unit();return R0(i,e,o,l1(h,p),l)}function R0(i,e,o,l,h){const p=Math.sqrt(1-l*l);return Math.min(i.dist(e)/3,e.dist(o)/3,h*p/l)}function F0(i,e,o){return i.x<o[0].x&&e.x<o[0].x||i.x>o[1].x&&e.x>o[1].x||i.y<o[0].y&&e.y<o[0].y||i.y>o[1].y&&e.y>o[1].y}function dd(i,e,o){if(i.x<0||i.x>=dr||e.x<0||e.x>=dr||o.x<0||o.x>=dr)return!1;const l=o.sub(e),h=l.perp(),p=i.sub(e);return(l.x*p.x+l.y*p.y)/Math.sqrt((l.x*l.x+l.y*l.y)*(p.x*p.x+p.y*p.y))>-.866&&h.x*p.x+h.y*p.y<0}function Cu(i,e,o){const l=e?2|i:-3&i;return o?1|l:-2&l}function M2(){const i=Math.PI/32,e=Math.tan(i),o=G1;return o*Math.sqrt(1+2*e*e)-o}function E2(i,e,o){const l=1<<o.z,h=Ea(o.x/l),p=Ea((o.x+1)/l),g=dl(o.y/l),x=dl((o.y+1)/l);return function(w,T,P,O,k=0,j){const q=[];if(!w.length||!P||!O)return q;const ue=(Vt,bn)=>{for(const _n of Vt)q.push({polygon:_n,bounds:bn})},Be=Math.ceil(Math.log2(P)),tt=Math.ceil(Math.log2(O)),_t=Be-tt,rt=[];for(let Vt=0;Vt<Math.abs(_t);Vt++)rt.push(_t>0?0:1);for(let Vt=0;Vt<Math.min(Be,tt);Vt++)rt.push(0),rt.push(1);let Dt=w;if(Dt=s1(Dt,T[0].y-k,T[1].y+k,1),Dt=s1(Dt,T[0].x-k,T[1].x+k,0),!Dt.length)return q;const Rt=[];for(rt.length?Rt.push({polygons:Dt,bounds:T,depth:0}):ue(Dt,T);Rt.length;){const Vt=Rt.pop(),bn=Vt.depth,_n=rt[bn],Vn=Vt.bounds[0],hi=Vt.bounds[1],En=0===_n?Vn.x:Vn.y,Kn=0===_n?hi.x:hi.y,Gn=j?j(_n,En,Kn):.5*(En+Kn),oi=s1(Vt.polygons,En-k,Gn+k,_n),pi=s1(Vt.polygons,Gn-k,Kn+k,_n);if(oi.length){const kn=[Vn,new et(0===_n?Gn:hi.x,1===_n?Gn:hi.y)];rt.length>bn+1?Rt.push({polygons:oi,bounds:kn,depth:bn+1}):ue(oi,kn)}if(pi.length){const kn=[new et(0===_n?Gn:Vn.x,1===_n?Gn:Vn.y),hi];rt.length>bn+1?Rt.push({polygons:pi,bounds:kn,depth:bn+1}):ue(pi,kn)}}return q}(i,e,Math.ceil((p-h)/11.25),Math.ceil((g-x)/11.25),1,(w,T,P)=>{if(0===w)return.5*(T+P);{const O=dl((o.y+T/dr)/l);return(Yc(.5*(dl((o.y+P/dr)/l)+O))*l-o.y)*dr}})}$i(hd,"FillExtrusionBucket",{omit:["layers","features"]}),$i(w2,"PartMetadata");const r3=new Mt({"fill-extrusion-edge-radius":new Ee(ht["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var o3={paint:new Mt({"fill-extrusion-opacity":new Ee(ht["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qe(ht["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ee(ht["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ee(ht["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new qe(ht["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new qe(ht["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qe(ht["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ee(ht["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ee(ht["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ee(ht["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Ee(ht["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:r3};function C2(i,e,o){var l=2*Math.PI*6378137/256/Math.pow(2,o);return[i*l-2*Math.PI*6378137/2,e*l-2*Math.PI*6378137/2]}class Ec{constructor(e,o,l){this.z=e,this.x=o,this.y=l,this.key=c1(0,e,e,o,l)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,o){const l=(g=this.y,x=this.z,w=C2(256*(p=this.x),256*(g=Math.pow(2,x)-g-1),x),T=C2(256*(p+1),256*(g+1),x),w[0]+","+w[1]+","+T[0]+","+T[1]),h=function(p,g,x){let w,T="";for(let P=p;P>0;P--)w=1<<P-1,T+=(g&w?1:0)+(x&w?2:0);return T}(this.z,this.x,this.y);var p,g,x,w,T;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===o?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",l)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ju{constructor(e,o){this.wrap=e,this.canonical=o,this.key=c1(e,o.z,o.z,o.x,o.y)}}class Ll{constructor(e,o,l,h,p){this.overscaledZ=e,this.wrap=o,this.canonical=new Ec(l,+h,+p),this.key=0===o&&e===l?this.canonical.key:c1(o,e,l,h,p)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const o=this.canonical.z-e;return e>this.canonical.z?new Ll(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ll(e,this.wrap,e,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(e,o=!0){if(this.overscaledZ===e&&o)return this.key;if(e>this.canonical.z)return c1(this.wrap*+o,e,this.canonical.z,this.canonical.x,this.canonical.y);{const l=this.canonical.z-e;return c1(this.wrap*+o,e,e,this.canonical.x>>l,this.canonical.y>>l)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const o=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>o&&e.canonical.y===this.canonical.y>>o}children(e){if(this.overscaledZ>=e)return[new Ll(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,l=2*this.canonical.x,h=2*this.canonical.y;return[new Ll(o,this.wrap,o,l,h),new Ll(o,this.wrap,o,l+1,h),new Ll(o,this.wrap,o,l,h+1),new Ll(o,this.wrap,o,l+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ll(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ll(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ju(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function c1(i,e,o,l,h){const p=1<<Math.min(o,22);let g=p*(h%p)+l%p;return i&&o<22&&(g+=p*p*((i<0?-2*i-1:2*i)%(1<<2*(22-o)))),16*(32*g+o)+(e-o)}$i(Ec,"CanonicalTileID"),$i(Ll,"OverscaledTileID",{omit:["projMatrix"]});class Mh extends et{constructor(e,o,l){super(e,o),this.z=l}}function u1(i,e){return i.x*e.x+i.y*e.y}function T2(i,e){if(1===i.length){let o=0;const l=e[o++];let h;for(;!h||l.equals(h);)if(h=e[o++],!h)return 1/0;for(;o<e.length;o++){const p=e[o],g=i[0],x=h.sub(l),w=p.sub(l),T=g.sub(l),P=u1(x,x),O=u1(x,w),k=u1(w,w),j=u1(T,x),q=u1(T,w),ue=P*k-O*O,Be=(k*j-O*q)/ue,tt=(P*q-O*j)/ue,_t=l.z*(1-Be-tt)+h.z*Be+p.z*tt;if(isFinite(_t))return _t}return 1/0}{let o=1/0;for(const l of e)o=Math.min(o,l.z);return o}}function D2(i,e,o,l,h,p,g,x){const w=g*h.getElevationAt(i,e,!0,!0),T=0!==p[0],P=T?0===p[1]?g*(p[0]/7-450):g*function(O,k,j){const q=Math.floor(k[0]/8),ue=Math.floor(k[1]/8),Be=10*(k[0]-8*q),tt=10*(k[1]-8*ue),_t=O.getElevationAt(q,ue,!0,!0),rt=O.getMeterToDEM(j),Dt=Math.floor(.5*(Be*rt-1)),Rt=Math.floor(.5*(tt*rt-1)),Vt=O.tileCoordToPixel(q,ue),bn=2*Dt+1,_n=2*Rt+1,Vn=(qi=bn,Li=_n,[(pi=O).getElevationAtPixel(kn=Vt.x-Dt,Ii=Vt.y-Rt,!0),pi.getElevationAtPixel(kn+Li,Ii,!0),pi.getElevationAtPixel(kn,Ii+Li,!0),pi.getElevationAtPixel(kn+qi,Ii+Li,!0)]),hi=Math.abs(Vn[0]-Vn[1]),En=Math.abs(Vn[2]-Vn[3]),Kn=Math.abs(Vn[0]-Vn[2])+Math.abs(Vn[1]-Vn[3]),Gn=Math.min(.25,.5*rt*(hi+En)/bn),oi=Math.min(.25,.5*rt*Kn/_n);var pi,kn,Ii,qi,Li;return _t+Math.max(Gn*Be,oi*tt)}(h,p,x):w;return{base:w+(0===o)?-1:o,top:T?Math.max(P+l,w+o+2):w+l}}const S2=Zt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:s3}=S2,a3=Zt([{name:"a_packed",components:4,type:"Float32"}]),{members:l3}=a3,c3=o1.types,fd=Math.cos(Math.PI/180*37.5);class Cc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new gn,this.layoutVertexArray2=new ai,this.indexArray=new Qi,this.programConfigurations=new Ql(e.layers,e.zoom),this.segments=new na,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,l,h){this.hasPattern=S0("line",this.layers,o);const p=this.layers[0].layout.get("line-sort-key"),g=[];for(const{feature:P,id:O,index:k,sourceLayerIndex:j}of e){const q=this.layers[0]._featureFilter.needGeometry,ue=qu(P,q);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),ue,l))continue;const Be=p?p.evaluate(ue,{},l):void 0,tt={id:O,properties:P.properties,type:P.type,sourceLayerIndex:j,index:k,geometry:q?ue.geometry:$c(P,l,h),patterns:{},sortKey:Be};g.push(tt)}p&&g.sort((P,O)=>P.sortKey-O.sortKey);const{lineAtlas:x,featureIndex:w}=o,T=this.addConstantDashes(x);for(const P of g){const{geometry:O,index:k,sourceLayerIndex:j}=P;if(T&&this.addFeatureDashes(P,x),this.hasPattern){const q=A0("line",this.layers,P,this.zoom,o);this.patternFeatures.push(q)}else this.addFeature(P,O,k,l,x.positions,o.availableImages);w.insert(e[k].feature,O,k,j,this.index)}}addConstantDashes(e){let o=!1;for(const l of this.layers){const h=l.paint.get("line-dasharray").value,p=l.layout.get("line-cap").value;if("constant"!==h.kind||"constant"!==p.kind)o=!0;else{const g=p.value,x=h.value;if(!x)continue;e.addDash(x,g)}}return o}addFeatureDashes(e,o){const l=this.zoom;for(const h of this.layers){const p=h.paint.get("line-dasharray").value,g=h.layout.get("line-cap").value;if("constant"===p.kind&&"constant"===g.kind)continue;let x,w;if("constant"===p.kind){if(x=p.value,!x)continue}else x=p.evaluate({zoom:l},e);w="constant"===g.kind?g.value:g.evaluate({zoom:l},e),o.addDash(x,w),e.patterns[h.id]=o.getKey(x,w)}}update(e,o,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,l,h)}addFeatures(e,o,l,h,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,o,l,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,l3)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,s3),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,o,l,h,p,g){const x=this.layers[0].layout,w=x.get("line-join").evaluate(e,{}),T=x.get("line-cap").evaluate(e,{}),P=x.get("line-miter-limit"),O=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const k of o)this.addLine(k,e,w,T,P,O);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,p,g,h)}addLine(e,o,l,h,p,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let tt=0;tt<e.length-1;tt++)this.totalDistance+=e[tt].dist(e[tt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x="Polygon"===c3[o.type];let w=e.length;for(;w>=2&&e[w-1].equals(e[w-2]);)w--;let T=0;for(;T<w-1&&e[T].equals(e[T+1]);)T++;if(w<(x?3:2))return;"bevel"===l&&(p=1.05);const P=this.overscaling<=16?15*dr/(512*this.overscaling):0,O=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let k,j,q,ue,Be;this.e1=this.e2=-1,x&&(k=e[w-2],Be=e[T].sub(k)._unit()._perp());for(let tt=T;tt<w;tt++){if(q=tt===w-1?x?e[T+1]:void 0:e[tt+1],q&&e[tt].equals(q))continue;Be&&(ue=Be),k&&(j=k),k=e[tt],Be=q?q.sub(k)._unit()._perp():ue,ue=ue||Be;let _t=ue.add(Be);0===_t.x&&0===_t.y||_t._unit();const rt=ue.x*Be.x+ue.y*Be.y,Dt=_t.x*Be.x+_t.y*Be.y,Rt=0!==Dt?1/Dt:1/0,Vt=2*Math.sqrt(2-2*Dt),bn=Dt<fd&&j&&q,_n=ue.x*Be.y-ue.y*Be.x>0;if(bn&&tt>T){const En=k.dist(j);if(En>2*P){const Kn=k.sub(k.sub(j)._mult(P/En)._round());this.updateDistance(j,Kn),this.addCurrentVertex(Kn,ue,0,0,O),j=Kn}}const Vn=j&&q;let hi=Vn?l:x?"butt":h;if(Vn&&"round"===hi&&(Rt<g?hi="miter":Rt<=2&&(hi="fakeround")),"miter"===hi&&Rt>p&&(hi="bevel"),"bevel"===hi&&(Rt>2&&(hi="flipbevel"),Rt<p&&(hi="miter")),j&&this.updateDistance(j,k),"miter"===hi)_t._mult(Rt),this.addCurrentVertex(k,_t,0,0,O);else if("flipbevel"===hi){if(Rt>100)_t=Be.mult(-1);else{const En=Rt*ue.add(Be).mag()/ue.sub(Be).mag();_t._perp()._mult(En*(_n?-1:1))}this.addCurrentVertex(k,_t,0,0,O),this.addCurrentVertex(k,_t.mult(-1),0,0,O)}else if("bevel"===hi||"fakeround"===hi){const En=-Math.sqrt(Rt*Rt-1),Kn=_n?En:0,Gn=_n?0:En;if(j&&this.addCurrentVertex(k,ue,Kn,Gn,O),"fakeround"===hi){const oi=Math.round(180*Vt/Math.PI/20);for(let pi=1;pi<oi;pi++){let kn=pi/oi;if(.5!==kn){const qi=kn-.5;kn+=kn*qi*(kn-1)*((1.0904+rt*(rt*(3.55645-1.43519*rt)-3.2452))*qi*qi+(.848013+rt*(.215638*rt-1.06021)))}const Ii=Be.sub(ue)._mult(kn)._add(ue)._unit()._mult(_n?-1:1);this.addHalfVertex(k,Ii.x,Ii.y,!1,_n,0,O)}}q&&this.addCurrentVertex(k,Be,-Kn,-Gn,O)}else if("butt"===hi)this.addCurrentVertex(k,_t,0,0,O);else if("square"===hi){const En=j?1:-1;j||this.addCurrentVertex(k,_t,En,En,O),this.addCurrentVertex(k,_t,0,0,O),j&&this.addCurrentVertex(k,_t,En,En,O)}else"round"===hi&&(j&&(this.addCurrentVertex(k,ue,0,0,O),this.addCurrentVertex(k,ue,1,1,O,!0)),q&&(this.addCurrentVertex(k,Be,-1,-1,O,!0),this.addCurrentVertex(k,Be,0,0,O)));if(bn&&tt<w-1){const En=k.dist(q);if(En>2*P){const Kn=k.add(q.sub(k)._mult(P/En)._round());this.updateDistance(k,Kn),this.addCurrentVertex(Kn,Be,0,0,O),k=Kn}}}}addCurrentVertex(e,o,l,h,p,g=!1){const x=o.y*h-o.x,w=-o.y-o.x*h;this.addHalfVertex(e,o.x+o.y*l,o.y-o.x*l,g,!1,l,p),this.addHalfVertex(e,x,w,g,!0,-h,p)}addHalfVertex({x:e,y:o},l,h,p,g,x,w){this.layoutVertexArray.emplaceBack((e<<1)+(p?1:0),(o<<1)+(g?1:0),Math.round(63*l)+128,Math.round(63*h)+128,1+(0===x?0:x<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const T=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),w.primitiveLength++),g?this.e2=T:this.e1=T}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,o){this.distance+=e.dist(o),this.updateScaledDistance()}}$i(Cc,"LineBucket",{omit:["layers","patternFeatures"]});const h1=new Mt({"line-cap":new qe(ht.layout_line["line-cap"]),"line-join":new qe(ht.layout_line["line-join"]),"line-miter-limit":new Ee(ht.layout_line["line-miter-limit"]),"line-round-limit":new Ee(ht.layout_line["line-round-limit"]),"line-sort-key":new qe(ht.layout_line["line-sort-key"])});var N0={paint:new Mt({"line-opacity":new qe(ht.paint_line["line-opacity"]),"line-color":new qe(ht.paint_line["line-color"]),"line-translate":new Ee(ht.paint_line["line-translate"]),"line-translate-anchor":new Ee(ht.paint_line["line-translate-anchor"]),"line-width":new qe(ht.paint_line["line-width"]),"line-gap-width":new qe(ht.paint_line["line-gap-width"]),"line-offset":new qe(ht.paint_line["line-offset"]),"line-blur":new qe(ht.paint_line["line-blur"]),"line-dasharray":new qe(ht.paint_line["line-dasharray"]),"line-pattern":new qe(ht.paint_line["line-pattern"]),"line-gradient":new yt(ht.paint_line["line-gradient"]),"line-trim-offset":new Ee(ht.paint_line["line-trim-offset"])}),layout:h1};const V0=new class extends qe{possiblyEvaluate(i,e){return e=new U(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(i,e)}evaluate(i,e,o,l){return e=$n({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(i,e,o,l)}}(N0.paint.properties["line-width"].specification);function B0(i,e){return e>0?e+2*i:i}V0.useIntegerZoom=!0;const B8=Zt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),u3=Zt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),H8=Zt([{name:"a_projected_pos",components:4,type:"Float32"}],4);Zt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const H0=Zt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),U0=Zt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Zt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const h3=Zt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),U8=Zt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Zt([{name:"triangle",components:3,type:"Uint16"}]),Zt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Zt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Zt([{type:"Float32",name:"offsetX"}]),Zt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var $a=24;const Oc=128;function j0(i,e){const{expression:o}=e;if("constant"===o.kind)return{kind:"constant",layoutSize:o.evaluate(new U(i+1))};if("source"===o.kind)return{kind:"source"};{const{zoomStops:l,interpolationType:h}=o;let p=0;for(;p<l.length&&l[p]<=i;)p++;p=Math.max(0,p-1);let g=p;for(;g<l.length&&l[g]<i+1;)g++;g=Math.min(l.length-1,g);const x=l[p],w=l[g];return"composite"===o.kind?{kind:"composite",minZoom:x,maxZoom:w,interpolationType:h}:{kind:"camera",minZoom:x,maxZoom:w,minSize:o.evaluate(new U(x)),maxSize:o.evaluate(new U(w)),interpolationType:h}}}function pd(i,{uSize:e,uSizeT:o},{lowerSize:l,upperSize:h}){return"source"===i.kind?l/Oc:"composite"===i.kind?Hr(l/Oc,h/Oc,o):e}function Eh(i,e){let o=0,l=0;if("constant"===i.kind)l=i.layoutSize;else if("source"!==i.kind){const{interpolationType:h,minZoom:p,maxZoom:g}=i,x=h?an(Pa.interpolationFactor(h,e,p,g),0,1):0;"camera"===i.kind?l=Hr(i.minSize,i.maxSize,x):o=x}return{uSizeT:o,uSize:l}}var d3=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Oc,evaluateSizeForFeature:pd,evaluateSizeForZoom:Eh,getSizeData:j0});function Y0(i,e,o){return i.sections.forEach(l=>{l.text=function(h,p,g){const x=p.layout.get("text-transform").evaluate(g,{});return"uppercase"===x?h=h.toLocaleUpperCase():"lowercase"===x&&(h=h.toLocaleLowerCase()),z.applyArabicShaping&&(h=z.applyArabicShaping(h)),h}(l.text,e,o)}),i}const Ch={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function f3(i){return"\ufe36"===i||"\ufe48"===i||"\ufe38"===i||"\ufe44"===i||"\ufe42"===i||"\ufe3e"===i||"\ufe3c"===i||"\ufe3a"===i||"\ufe18"===i||"\ufe40"===i||"\ufe10"===i||"\ufe13"===i||"\ufe14"===i||"\uff40"===i||"\uffe3"===i||"\ufe11"===i||"\ufe12"===i}function p3(i){return"\ufe35"===i||"\ufe47"===i||"\ufe37"===i||"\ufe43"===i||"\ufe41"===i||"\ufe3d"===i||"\ufe3b"===i||"\ufe39"===i||"\ufe17"===i||"\ufe3f"===i}var $0=qo,d1=function(i,e,o,l,h){var p,g,x=8*h-l-1,w=(1<<x)-1,T=w>>1,P=-7,O=o?h-1:0,k=o?-1:1,j=i[e+O];for(O+=k,p=j&(1<<-P)-1,j>>=-P,P+=x;P>0;p=256*p+i[e+O],O+=k,P-=8);for(g=p&(1<<-P)-1,p>>=-P,P+=l;P>0;g=256*g+i[e+O],O+=k,P-=8);if(0===p)p=1-T;else{if(p===w)return g?NaN:1/0*(j?-1:1);g+=Math.pow(2,l),p-=T}return(j?-1:1)*g*Math.pow(2,p-l)},G0=function(i,e,o,l,h,p){var g,x,w,T=8*p-h-1,P=(1<<T)-1,O=P>>1,k=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,j=l?0:p-1,q=l?1:-1,ue=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(x=isNaN(e)?1:0,g=P):(g=Math.floor(Math.log(e)/Math.LN2),e*(w=Math.pow(2,-g))<1&&(g--,w*=2),(e+=g+O>=1?k/w:k*Math.pow(2,1-O))*w>=2&&(g++,w/=2),g+O>=P?(x=0,g=P):g+O>=1?(x=(e*w-1)*Math.pow(2,h),g+=O):(x=e*Math.pow(2,O-1)*Math.pow(2,h),g=0));h>=8;i[o+j]=255&x,j+=q,x/=256,h-=8);for(g=g<<h|x,T+=h;T>0;i[o+j]=255&g,j+=q,g/=256,T-=8);i[o+j-q]|=128*ue};function qo(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}qo.Varint=0,qo.Fixed64=1,qo.Bytes=2,qo.Fixed32=5;var W0=4294967296,Tu=1/W0,K0=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function ou(i){return i.type===qo.Bytes?i.readVarint()+i.pos:i.pos+1}function q0(i,e,o){var l=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));o.realloc(l);for(var h=o.pos-1;h>=i;h--)o.buf[h+l]=o.buf[h]}function m3(i,e){for(var o=0;o<i.length;o++)e.writeVarint(i[o])}function g3(i,e){for(var o=0;o<i.length;o++)e.writeSVarint(i[o])}function v3(i,e){for(var o=0;o<i.length;o++)e.writeFloat(i[o])}function _3(i,e){for(var o=0;o<i.length;o++)e.writeDouble(i[o])}function A2(i,e){for(var o=0;o<i.length;o++)e.writeBoolean(i[o])}function j8(i,e){for(var o=0;o<i.length;o++)e.writeFixed32(i[o])}function Y8(i,e){for(var o=0;o<i.length;o++)e.writeSFixed32(i[o])}function f1(i,e){for(var o=0;o<i.length;o++)e.writeFixed64(i[o])}function y3(i,e){for(var o=0;o<i.length;o++)e.writeSFixed64(i[o])}function md(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+16777216*i[e+3]}function Th(i,e,o){i[o]=e,i[o+1]=e>>>8,i[o+2]=e>>>16,i[o+3]=e>>>24}function Z0(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}qo.prototype={destroy:function(){this.buf=null},readFields:function(i,e,o){for(o=o||this.length;this.pos<o;){var l=this.readVarint(),h=l>>3,p=this.pos;this.type=7&l,i(h,e,this),this.pos===p&&this.skip(l)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=md(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Z0(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=md(this.buf,this.pos)+md(this.buf,this.pos+4)*W0;return this.pos+=8,i},readSFixed64:function(){var i=md(this.buf,this.pos)+Z0(this.buf,this.pos+4)*W0;return this.pos+=8,i},readFloat:function(){var i=d1(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=d1(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e,o,l=this.buf;return e=127&(o=l[this.pos++]),o<128?e:(e|=(127&(o=l[this.pos++]))<<7,o<128?e:(e|=(127&(o=l[this.pos++]))<<14,o<128?e:(e|=(127&(o=l[this.pos++]))<<21,o<128?e:function(h,p,g){var x,w,T=g.buf;if(x=(112&(w=T[g.pos++]))>>4,w<128||(x|=(127&(w=T[g.pos++]))<<3,w<128)||(x|=(127&(w=T[g.pos++]))<<10,w<128)||(x|=(127&(w=T[g.pos++]))<<17,w<128)||(x|=(127&(w=T[g.pos++]))<<24,w<128)||(x|=(1&(w=T[g.pos++]))<<31,w<128))return function Du(i,e,o){return o?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}(h,x,p);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(o=l[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=12&&K0?K0.decode(this.buf.subarray(e,i)):function(o,l,h){for(var p="",g=l;g<h;){var x,w,T,P=o[g],O=null,k=P>239?4:P>223?3:P>191?2:1;if(g+k>h)break;1===k?P<128&&(O=P):2===k?128==(192&(x=o[g+1]))&&(O=(31&P)<<6|63&x)<=127&&(O=null):3===k?(w=o[g+2],128==(192&(x=o[g+1]))&&128==(192&w)&&((O=(15&P)<<12|(63&x)<<6|63&w)<=2047||O>=55296&&O<=57343)&&(O=null)):4===k&&(w=o[g+2],T=o[g+3],128==(192&(x=o[g+1]))&&128==(192&w)&&128==(192&T)&&((O=(15&P)<<18|(63&x)<<12|(63&w)<<6|63&T)<=65535||O>=1114112)&&(O=null)),null===O?(O=65533,k=1):O>65535&&(O-=65536,p+=String.fromCharCode(O>>>10&1023|55296),O=56320|1023&O),p+=String.fromCharCode(O),g+=k}return p}(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==qo.Bytes)return i.push(this.readVarint(e));var o=ou(this);for(i=i||[];this.pos<o;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==qo.Bytes)return i.push(this.readSVarint());var e=ou(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==qo.Bytes)return i.push(this.readBoolean());var e=ou(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==qo.Bytes)return i.push(this.readFloat());var e=ou(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==qo.Bytes)return i.push(this.readDouble());var e=ou(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==qo.Bytes)return i.push(this.readFixed32());var e=ou(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==qo.Bytes)return i.push(this.readSFixed32());var e=ou(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==qo.Bytes)return i.push(this.readFixed64());var e=ou(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==qo.Bytes)return i.push(this.readSFixed64());var e=ou(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=7&i;if(e===qo.Varint)for(;this.buf[this.pos++]>127;);else if(e===qo.Bytes)this.pos=this.readVarint()+this.pos;else if(e===qo.Fixed32)this.pos+=4;else{if(e!==qo.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var o=new Uint8Array(e);o.set(this.buf),this.buf=o,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Th(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Th(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Th(this.buf,-1&i,this.pos),Th(this.buf,Math.floor(i*Tu),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Th(this.buf,-1&i,this.pos),Th(this.buf,Math.floor(i*Tu),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(e,o){var l,h,p,x;if(e>=0?(l=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(l=~(-e%4294967296))?l=l+1|0:(l=0,h=h+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),p=l,(x=o).buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,x.buf[x.pos]=127&(p>>>=7),function(p,g){var x=(7&p)<<4;g.buf[g.pos++]|=x|((p>>>=3)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p)))))}(h,o)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var e=this.pos;this.pos=function(l,h,p){for(var g,x,w=0;w<h.length;w++){if((g=h.charCodeAt(w))>55295&&g<57344){if(!x){g>56319||w+1===h.length?(l[p++]=239,l[p++]=191,l[p++]=189):x=g;continue}if(g<56320){l[p++]=239,l[p++]=191,l[p++]=189,x=g;continue}g=x-55296<<10|g-56320|65536,x=null}else x&&(l[p++]=239,l[p++]=191,l[p++]=189,x=null);g<128?l[p++]=g:(g<2048?l[p++]=g>>6|192:(g<65536?l[p++]=g>>12|224:(l[p++]=g>>18|240,l[p++]=g>>12&63|128),l[p++]=g>>6&63|128),l[p++]=63&g|128)}return p}(this.buf,i,this.pos);var o=this.pos-e;o>=128&&q0(e,o,this),this.pos=e-1,this.writeVarint(o),this.pos+=o},writeFloat:function(i){this.realloc(4),G0(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),G0(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var o=0;o<e;o++)this.buf[this.pos++]=i[o]},writeRawMessage:function(i,e){this.pos++;var o=this.pos;i(e,this);var l=this.pos-o;l>=128&&q0(o,l,this),this.pos=o-1,this.writeVarint(l),this.pos+=l},writeMessage:function(i,e,o){this.writeTag(i,qo.Bytes),this.writeRawMessage(e,o)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,m3,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,g3,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,A2,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,v3,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,_3,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,j8,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,Y8,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,f1,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,y3,e)},writeBytesField:function(i,e){this.writeTag(i,qo.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,qo.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,qo.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,qo.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,qo.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,qo.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,qo.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,qo.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,qo.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,qo.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,!!e)}};var p1=bt($0);const X0=3;function x3(i,e,o){e.glyphs=[],1===i&&o.readMessage(b3,e)}function b3(i,e,o){if(3===i){const{id:l,bitmap:h,width:p,height:g,left:x,top:w,advance:T}=o.readMessage(w3,{});e.glyphs.push({id:l,bitmap:new iu({width:p+2*X0,height:g+2*X0},h),metrics:{width:p,height:g,left:x,top:w,advance:T}})}else 4===i?e.ascender=o.readSVarint():5===i&&(e.descender=o.readSVarint())}function w3(i,e,o){1===i?e.id=o.readVarint():2===i?e.bitmap=o.readBytes():3===i?e.width=o.readVarint():4===i?e.height=o.readVarint():5===i?e.left=o.readSVarint():6===i?e.top=o.readSVarint():7===i&&(e.advance=o.readVarint())}const P2=X0;function m1(i){let e=0,o=0;for(const g of i)e+=g.w*g.h,o=Math.max(o,g.w);i.sort((g,x)=>x.h-g.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),o),h:1/0}];let h=0,p=0;for(const g of i)for(let x=l.length-1;x>=0;x--){const w=l[x];if(!(g.w>w.w||g.h>w.h)){if(g.x=w.x,g.y=w.y,p=Math.max(p,g.y+g.h),h=Math.max(h,g.x+g.w),g.w===w.w&&g.h===w.h){const T=l.pop();x<l.length&&(l[x]=T)}else g.h===w.h?(w.x+=g.w,w.w-=g.w):g.w===w.w?(w.y+=g.h,w.h-=g.h):(l.push({x:w.x+g.w,y:w.y,w:w.w-g.w,h:g.h}),w.y+=g.h,w.h-=g.h);break}}return{w:h,h:p,fill:e/(h*p)||0}}const ec=1;class z2{constructor(e,{pixelRatio:o,version:l,stretchX:h,stretchY:p,content:g}){this.paddedRect=e,this.pixelRatio=o,this.stretchX=h,this.stretchY=p,this.content=g,this.version=l}get tl(){return[this.paddedRect.x+ec,this.paddedRect.y+ec]}get br(){return[this.paddedRect.x+this.paddedRect.w-ec,this.paddedRect.y+this.paddedRect.h-ec]}get displaySize(){return[(this.paddedRect.w-2*ec)/this.pixelRatio,(this.paddedRect.h-2*ec)/this.pixelRatio]}}class gd{constructor(e,o){const l={},h={};this.haveRenderCallbacks=[];const p=[];this.addImages(e,l,p),this.addImages(o,h,p);const{w:g,h:x}=m1(p),w=new Gl({width:g||1,height:x||1});for(const T in e){const P=e[T],O=l[T].paddedRect;Gl.copy(P.data,w,{x:0,y:0},{x:O.x+ec,y:O.y+ec},P.data)}for(const T in o){const P=o[T],O=h[T].paddedRect,k=O.x+ec,j=O.y+ec,q=P.data.width,ue=P.data.height;Gl.copy(P.data,w,{x:0,y:0},{x:k,y:j},P.data),Gl.copy(P.data,w,{x:0,y:ue-1},{x:k,y:j-1},{width:q,height:1}),Gl.copy(P.data,w,{x:0,y:0},{x:k,y:j+ue},{width:q,height:1}),Gl.copy(P.data,w,{x:q-1,y:0},{x:k-1,y:j},{width:1,height:ue}),Gl.copy(P.data,w,{x:0,y:0},{x:k+q,y:j},{width:1,height:ue})}this.image=w,this.iconPositions=l,this.patternPositions=h}addImages(e,o,l){for(const h in e){const p=e[h],g={x:0,y:0,w:p.data.width+2*ec,h:p.data.height+2*ec};l.push(g),o[h]=new z2(g,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,o){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(l=>e.hasImage(l)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in e.updatedImages)this.patchUpdatedImage(this.iconPositions[l],e.getImage(l),o),this.patchUpdatedImage(this.patternPositions[l],e.getImage(l),o)}patchUpdatedImage(e,o,l){if(!e||!o||e.version===o.version)return;e.version=o.version;const[h,p]=e.tl;l.update(o.data,void 0,{x:h,y:p})}}$i(z2,"ImagePosition"),$i(gd,"ImageAtlas");const Tc={horizontal:1,vertical:2,horizontalOnly:3},M3=-17;class vd{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,o){const l=new vd;return l.scale=e||1,l.fontStack=o,l}static forImage(e){const o=new vd;return o.imageName=e,o}}class g1{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,o){const l=new g1;for(let h=0;h<e.sections.length;h++){const p=e.sections[h];p.image?l.addImageSection(p):l.addTextSection(p,o)}return l}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(o,l){let h="";for(let p=0;p<o.length;p++){const g=o.charCodeAt(p+1)||null,x=o.charCodeAt(p-1)||null;h+=!l&&(g&&Vu(g)&&!Ch[o[p+1]]||x&&Vu(x)&&!Ch[o[p-1]])||!Ch[o[p]]?o[p]:Ch[o[p]]}return h}(this.text,e)}trim(){let e=0;for(let l=0;l<this.text.length&&_d[this.text.charCodeAt(l)];l++)e++;let o=this.text.length;for(let l=this.text.length-1;l>=0&&l>=e&&_d[this.text.charCodeAt(l)];l--)o--;this.text=this.text.substring(e,o),this.sectionIndex=this.sectionIndex.slice(e,o)}substring(e,o){const l=new g1;return l.text=this.text.substring(e,o),l.sectionIndex=this.sectionIndex.slice(e,o),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,o)=>Math.max(e,this.sections[o].scale),0)}addTextSection(e,o){this.text+=e.text,this.sections.push(vd.forText(e.scale,e.fontStack||o));const l=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(l)}addImageSection(e){const o=e.image?e.image.name:"";if(0===o.length)return void Si("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(vd.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Si("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function I2(i,e,o,l,h,p,g,x,w,T,P,O,k,j,q){const ue=g1.fromFeature(i,h);O===Tc.vertical&&ue.verticalizePunctuation(k);let Be=[];const tt=function(Vt,bn,_n,Vn,hi,En){if(!Vt)return[];const Kn=[],Gn=function(Ii,qi,Li,Xr,yi,gr){let jr=0;for(let zo=0;zo<Ii.length();zo++){const Qr=Ii.getSection(zo);jr+=v1(Ii.getCharCode(zo),Qr,Xr,yi,qi,gr)}return jr/Math.max(1,Math.ceil(jr/Li))}(Vt,bn,_n,Vn,hi,En),oi=Vt.text.indexOf("\u200b")>=0;let pi=0;for(let Ii=0;Ii<Vt.length();Ii++){const qi=Vt.getSection(Ii),Li=Vt.getCharCode(Ii);if(_d[Li]||(pi+=v1(Li,qi,Vn,hi,bn,En)),Ii<Vt.length()-1){const Xr=!((kn=Li)<11904||!(Ti["Bopomofo Extended"](kn)||Ti.Bopomofo(kn)||Ti["CJK Compatibility Forms"](kn)||Ti["CJK Compatibility Ideographs"](kn)||Ti["CJK Compatibility"](kn)||Ti["CJK Radicals Supplement"](kn)||Ti["CJK Strokes"](kn)||Ti["CJK Symbols and Punctuation"](kn)||Ti["CJK Unified Ideographs Extension A"](kn)||Ti["CJK Unified Ideographs"](kn)||Ti["Enclosed CJK Letters and Months"](kn)||Ti["Halfwidth and Fullwidth Forms"](kn)||Ti.Hiragana(kn)||Ti["Ideographic Description Characters"](kn)||Ti["Kangxi Radicals"](kn)||Ti["Katakana Phonetic Extensions"](kn)||Ti.Katakana(kn)||Ti["Vertical Forms"](kn)||Ti["Yi Radicals"](kn)||Ti["Yi Syllables"](kn)));(yd[Li]||Xr||qi.imageName)&&Kn.push(Q0(Ii+1,pi,Gn,Kn,k2(Li,Vt.getCharCode(Ii+1),Xr&&oi),!1))}}var kn;return J0(Q0(Vt.length(),pi,Gn,Kn,0,!0))}(ue,T,p,e,l,j),{processBidirectionalText:_t,processStyledBidirectionalText:rt}=z;if(_t&&1===ue.sections.length){const Vt=_t(ue.toString(),tt);for(const bn of Vt){const _n=new g1;_n.text=bn,_n.sections=ue.sections;for(let Vn=0;Vn<bn.length;Vn++)_n.sectionIndex.push(0);Be.push(_n)}}else if(rt){const Vt=rt(ue.text,ue.sectionIndex,tt);for(const bn of Vt){const _n=new g1;_n.text=bn[0],_n.sectionIndex=bn[1],_n.sections=ue.sections,Be.push(_n)}}else Be=function(Vt,bn){const _n=[],Vn=Vt.text;let hi=0;for(const En of bn)_n.push(Vt.substring(hi,En)),hi=En;return hi<Vn.length&&_n.push(Vt.substring(hi,Vn.length)),_n}(ue,tt);const Dt=[],Rt={positionedLines:Dt,text:ue.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:O,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Vt,bn,_n,Vn,hi,En,Kn,Gn,oi,pi,kn,Ii){let qi=0,Li=0,Xr=0;const yi="right"===Gn?1:"left"===Gn?0:.5;let gr=!1;for(const to of hi){const Wr=to.getSections();for(const Ho of Wr){if(Ho.imageName)continue;const fs=bn[Ho.fontStack];if(fs&&(gr=void 0!==fs.ascender&&void 0!==fs.descender,!gr))break}if(!gr)break}let jr=0;for(const to of hi){to.trim();const Wr=to.getMaxScale(),Ho=(Wr-1)*$a,fs={positionedGlyphs:[],lineOffset:0};Vt.positionedLines[jr]=fs;const ns=fs.positionedGlyphs;let Zo=0;if(!to.length()){Li+=En,++jr;continue}let Gs=0,ra=0;for(let is=0;is<to.length();is++){const La=to.getSection(is),pa=to.getSectionIndex(is),Ws=to.getCharCode(is);let Oo=La.scale,ma=null,ps=null,ql=null,As=$a,Ra=0;const il=!(oi===Tc.horizontal||!kn&&!pu(Ws)||kn&&(_d[Ws]||(zo=Ws,Ti.Arabic(zo)||Ti["Arabic Supplement"](zo)||Ti["Arabic Extended-A"](zo)||Ti["Arabic Presentation Forms-A"](zo)||Ti["Arabic Presentation Forms-B"](zo))));if(La.imageName){const Rl=Vn[La.imageName];if(!Rl)continue;ql=La.imageName,Vt.iconsInText=Vt.iconsInText||!0,ps=Rl.paddedRect;const rl=Rl.displaySize;Oo=Oo*$a/Ii,ma={width:rl[0],height:rl[1],left:ec,top:-P2,advance:il?rl[1]:rl[0],localGlyph:!1},Ra=gr?-ma.height*Oo:M3+Wr*$a-rl[1]*Oo,As=ma.advance;const Vc=(il?rl[0]:rl[1])*Oo-$a*Wr;Vc>0&&Vc>Zo&&(Zo=Vc)}else{const Rl=_n[La.fontStack];if(!Rl)continue;Rl[Ws]&&(ps=Rl[Ws]);const rl=bn[La.fontStack];if(!rl)continue;const Vc=rl.glyphs[Ws];if(!Vc)continue;if(ma=Vc.metrics,As=8203!==Ws?$a:0,gr){const jd=void 0!==rl.ascender?Math.abs(rl.ascender):0,Yd=void 0!==rl.descender?Math.abs(rl.descender):0,Ou=(jd+Yd)*Oo;Gs<Ou&&(Gs=Ou,ra=(jd-Yd)/2*Oo),Ra=-jd*Oo}else Ra=M3+(Wr-Oo)*$a}il?(Vt.verticalizable=!0,ns.push({glyph:Ws,imageName:ql,x:qi,y:Li+Ra,vertical:il,scale:Oo,localGlyph:ma.localGlyph,fontStack:La.fontStack,sectionIndex:pa,metrics:ma,rect:ps}),qi+=As*Oo+pi):(ns.push({glyph:Ws,imageName:ql,x:qi,y:Li+Ra,vertical:il,scale:Oo,localGlyph:ma.localGlyph,fontStack:La.fontStack,sectionIndex:pa,metrics:ma,rect:ps}),qi+=ma.advance*Oo+pi)}0!==ns.length&&(Xr=Math.max(qi-pi,Xr),gr?t4(ns,yi,Zo,ra,En*Wr/2):t4(ns,yi,Zo,0,En/2)),qi=0;const Ta=En*Wr+Zo;fs.lineOffset=Math.max(Zo,Ho),Li+=Ta,++jr}var zo;const Qr=Li,{horizontalAlign:zr,verticalAlign:ws}=e4(Kn);(function(to,Wr,Ho,fs,ns,Zo){const Gs=(Wr-Ho)*ns,ra=-Zo*fs;for(const Ta of to)for(const is of Ta.positionedGlyphs)is.x+=Gs,is.y+=ra})(Vt.positionedLines,yi,zr,ws,Xr,Qr),Vt.top+=-ws*Qr,Vt.bottom=Vt.top+Qr,Vt.left+=-zr*Xr,Vt.right=Vt.left+Xr,Vt.hasBaseline=gr}(Rt,e,o,l,Be,g,x,w,O,T,k,q),!function(Vt){for(const bn of Vt)if(0!==bn.positionedGlyphs.length)return!1;return!0}(Dt)&&Rt}const _d={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},yd={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function v1(i,e,o,l,h,p){if(e.imageName){const g=l[e.imageName];return g?g.displaySize[0]*e.scale*$a/p+h:0}{const g=o[e.fontStack],x=g&&g.glyphs[i];return x?x.metrics.advance*e.scale+h:0}}function xd(i,e,o,l){const h=Math.pow(i-e,2);return l?i<e?h/2:2*h:h+Math.abs(o)*o}function k2(i,e,o){let l=0;return 10===i&&(l-=1e4),o&&(l+=150),40!==i&&65288!==i||(l+=50),41!==e&&65289!==e||(l+=50),l}function Q0(i,e,o,l,h,p){let g=null,x=xd(e,o,h,p);for(const w of l){const T=xd(e-w.x,o,h,p)+w.badness;T<=x&&(g=w,x=T)}return{index:i,x:e,priorBreak:g,badness:x}}function J0(i){return i?J0(i.priorBreak).concat(i.index):[]}function e4(i){let e=.5,o=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:e,verticalAlign:o}}function t4(i,e,o,l,h){if(!(e||o||l||h))return;const p=i.length-1,g=i[p],x=(g.x+g.metrics.advance*g.scale)*e;for(let w=0;w<=p;w++)i[w].x-=x,i[w].y+=o+l+h}function Dh(i,e,o){const{horizontalAlign:l,verticalAlign:h}=e4(o),p=e[0]-i.displaySize[0]*l,g=e[1]-i.displaySize[1]*h;return{image:i,top:g,bottom:g+i.displaySize[1],left:p,right:p+i.displaySize[0]}}function tc(i,e,o,l,h,p){const g=i.image;let x;if(g.content){const Be=g.content,tt=g.pixelRatio||1;x=[Be[0]/tt,Be[1]/tt,g.displaySize[0]-Be[2]/tt,g.displaySize[1]-Be[3]/tt]}const w=e.left*p,T=e.right*p;let P,O,k,j;"width"===o||"both"===o?(j=h[0]+w-l[3],O=h[0]+T+l[1]):(j=h[0]+(w+T-g.displaySize[0])/2,O=j+g.displaySize[0]);const q=e.top*p,ue=e.bottom*p;return"height"===o||"both"===o?(P=h[1]+q-l[0],k=h[1]+ue+l[2]):(P=h[1]+(q+ue-g.displaySize[1])/2,k=P+g.displaySize[1]),{image:g,top:P,right:O,bottom:k,left:j,collisionPadding:x}}class nl extends et{constructor(e,o,l,h,p){super(e,o),this.angle=h,this.z=l,void 0!==p&&(this.segment=p)}clone(){return new nl(this.x,this.y,this.z,this.angle,this.segment)}}function n4(i,e,o,l,h){if(void 0===e.segment)return!0;let p=e,g=e.segment+1,x=0;for(;x>-o/2;){if(g--,g<0)return!1;x-=i[g].dist(p),p=i[g]}x+=i[g].dist(i[g+1]),g++;const w=[];let T=0;for(;x<o/2;){const P=i[g],O=i[g+1];if(!O)return!1;let k=i[g-1].angleTo(P)-P.angleTo(O);for(k=Math.abs((k+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:x,angleDelta:k}),T+=k;x-w[0].distance>l;)T-=w.shift().angleDelta;if(T>h)return!1;g++,x+=P.dist(O)}return!0}function E3(i){let e=0;for(let o=0;o<i.length-1;o++)e+=i[o].dist(i[o+1]);return e}function O2(i,e,o){return i?.6*e*o:0}function C3(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function $8(i,e,o,l,h,p){const g=O2(o,h,p),x=C3(o,l)*p;let w=0;const T=E3(i)/2;for(let P=0;P<i.length-1;P++){const O=i[P],k=i[P+1],j=O.dist(k);if(w+j>T){const q=(T-w)/j,ue=Hr(O.x,k.x,q),Be=Hr(O.y,k.y,q),tt=new nl(ue,Be,0,k.angleTo(O),P);return!g||n4(i,tt,x,g,e)?tt:void 0}w+=j}}function L2(i,e,o,l,h,p,g,x,w){const T=O2(l,p,g),P=C3(l,h),O=P*g,k=0===i[0].x||i[0].x===w||0===i[0].y||i[0].y===w;return e-O<e/4&&(e=O+e/4),i4(i,k?e/2*x%e:(P/2+2*p)*g*x%e,e,T,o,O,k,!1,w)}function i4(i,e,o,l,h,p,g,x,w){const T=p/2,P=E3(i);let O=0,k=e-o,j=[];for(let q=0;q<i.length-1;q++){const ue=i[q],Be=i[q+1],tt=ue.dist(Be),_t=Be.angleTo(ue);for(;k+o<O+tt;){k+=o;const rt=(k-O)/tt,Dt=Hr(ue.x,Be.x,rt),Rt=Hr(ue.y,Be.y,rt);if(Dt>=0&&Dt<w&&Rt>=0&&Rt<w&&k-T>=0&&k+T<=P){const Vt=new nl(Dt,Rt,0,_t,q);Vt._round(),l&&!n4(i,Vt,p,l,h)||j.push(Vt)}}O+=tt}return x||j.length||g||(j=i4(i,O/2,o,l,h,p,g,!0,w)),j}function T3(i,e,o,l,h){const p=[];for(let g=0;g<i.length;g++){const x=i[g];let w;for(let T=0;T<x.length-1;T++){let P=x[T],O=x[T+1];P.x<e&&O.x<e||(P.x<e?P=new et(e,P.y+(e-P.x)/(O.x-P.x)*(O.y-P.y))._round():O.x<e&&(O=new et(e,P.y+(e-P.x)/(O.x-P.x)*(O.y-P.y))._round()),P.y<o&&O.y<o||(P.y<o?P=new et(P.x+(o-P.y)/(O.y-P.y)*(O.x-P.x),o)._round():O.y<o&&(O=new et(P.x+(o-P.y)/(O.y-P.y)*(O.x-P.x),o)._round()),P.x>=l&&O.x>=l||(P.x>=l?P=new et(l,P.y+(l-P.x)/(O.x-P.x)*(O.y-P.y))._round():O.x>=l&&(O=new et(l,P.y+(l-P.x)/(O.x-P.x)*(O.y-P.y))._round()),P.y>=h&&O.y>=h||(P.y>=h?P=new et(P.x+(h-P.y)/(O.y-P.y)*(O.x-P.x),h)._round():O.y>=h&&(O=new et(P.x+(h-P.y)/(O.y-P.y)*(O.x-P.x),h)._round()),w&&P.equals(w[w.length-1])||(w=[P],p.push(w)),w.push(O)))))}}return p}$i(nl,"Anchor");const Su=1e20;function bd(i,e,o,l,h,p,g,x,w){for(let T=e;T<e+l;T++)wd(i,o*p+T,p,h,g,x,w);for(let T=o;T<o+h;T++)wd(i,T*p+e,1,l,g,x,w)}function wd(i,e,o,l,h,p,g){p[0]=0,g[0]=-Su,g[1]=Su,h[0]=i[e];for(let x=1,w=0,T=0;x<l;x++){h[x]=i[e+x*o];const P=x*x;do{const O=p[w];T=(h[x]-h[O]+P-O*O)/(x-O)/2}while(T<=g[w]&&--w>-1);w++,p[w]=x,g[w]=T,g[w+1]=Su}for(let x=0,w=0;x<l;x++){for(;g[w+1]<x;)w++;const T=p[w],P=x-T;i[e+x*o]=h[T]+P*P}}const Lc=2,Au={none:0,ideographs:1,all:2};class Pu{constructor(e,o,l){this.requestManager=e,this.localGlyphMode=o,this.localFontFamily=l,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,o){const l=[];for(const h in e)for(const p of e[h])l.push({stack:h,id:p});di(l,({stack:h,id:p},g)=>{let x=this.entries[h];x||(x=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=x.glyphs[p];if(void 0!==w)return void g(null,{stack:h,id:p,glyph:w});if(w=this._tinySDF(x,h,p),w)return x.glyphs[p]=w,void g(null,{stack:h,id:p,glyph:w});const T=Math.floor(p/256);if(256*T>65535)return void g(new Error("glyphs > 65535 not supported"));if(x.ranges[T])return void g(null,{stack:h,id:p,glyph:w});let P=x.requests[T];P||(P=x.requests[T]=[],Pu.loadGlyphRange(h,T,this.url,this.requestManager,(O,k)=>{if(k){x.ascender=k.ascender,x.descender=k.descender;for(const j in k.glyphs)this._doesCharSupportLocalGlyph(+j)||(x.glyphs[+j]=k.glyphs[+j]);x.ranges[T]=!0}for(const j of P)j(O,k);delete x.requests[T]})),P.push((O,k)=>{O?g(O):k&&g(null,{stack:h,id:p,glyph:k.glyphs[p]||null})})},(h,p)=>{if(h)o(h);else if(p){const g={};for(const{stack:x,id:w,glyph:T}of p)void 0===g[x]&&(g[x]={}),void 0===g[x].glyphs&&(g[x].glyphs={}),g[x].glyphs[w]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics},g[x].ascender=this.entries[x].ascender,g[x].descender=this.entries[x].descender;o(null,g)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Au.none&&(this.localGlyphMode===Au.all?!!this.localFontFamily:!!this.localFontFamily&&(Ti["CJK Unified Ideographs"](e)||Ti["Hangul Syllables"](e)||Ti.Hiragana(e)||Ti.Katakana(e)||Ti["CJK Symbols and Punctuation"](e)))}_tinySDF(e,o,l){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let p=e.tinySDF;if(!p){let ue="400";/bold/i.test(o)?ue="900":/medium/i.test(o)?ue="500":/light/i.test(o)&&(ue="200"),p=e.tinySDF=new Pu.TinySDF({fontFamily:h,fontWeight:ue,fontSize:24*Lc,buffer:3*Lc,radius:8*Lc}),p.fontWeight=ue}if(this.localGlyphs[p.fontWeight][l])return this.localGlyphs[p.fontWeight][l];const g=String.fromCharCode(l),{data:x,width:w,height:T,glyphWidth:P,glyphHeight:O,glyphLeft:k,glyphTop:j,glyphAdvance:q}=p.draw(g);return this.localGlyphs[p.fontWeight][l]={id:l,bitmap:new iu({width:w,height:T},x),metrics:{width:P/Lc,height:O/Lc,left:k/Lc,top:j/Lc-27,advance:q/Lc,localGlyph:!0}}}}Pu.loadGlyphRange=function(i,e,o,l,h){const p=256*e,g=p+255,x=l.transformRequest(l.normalizeGlyphsURL(o).replace("{fontstack}",i).replace("{range}",`${p}-${g}`),hn.Glyphs);bi(x,(w,T)=>{if(w)h(w);else if(T){const P={},O=new p1(T).readFields(x3,{});for(const k of O.glyphs)P[k.id]=k;h(null,{glyphs:P,ascender:O.ascender,descender:O.descender})}})},Pu.TinySDF=class{constructor({fontSize:i=24,buffer:e=3,radius:o=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:p="normal",fontStyle:g="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=o;const x=this.size=i+4*e,w=this._createCanvas(x),T=this.ctx=w.getContext("2d",{willReadFrequently:!0});T.font=`${g} ${p} ${i}px ${h}`,T.textBaseline="alphabetic",T.textAlign="left",T.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(i){const e=document.createElement("canvas");return e.width=e.height=i,e}draw(i){const{width:e,actualBoundingBoxAscent:o,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:p}=this.ctx.measureText(i),g=Math.ceil(o),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-h))),w=Math.min(this.size-this.buffer,g+Math.ceil(l)),T=x+2*this.buffer,P=w+2*this.buffer,O=Math.max(T*P,0),k=new Uint8ClampedArray(O),j={data:k,width:T,height:P,glyphWidth:x,glyphHeight:w,glyphTop:g,glyphLeft:0,glyphAdvance:e};if(0===x||0===w)return j;const{ctx:q,buffer:ue,gridInner:Be,gridOuter:tt}=this;q.clearRect(ue,ue,x,w),q.fillText(i,ue,ue+g);const _t=q.getImageData(ue,ue,x,w);tt.fill(Su,0,O),Be.fill(0,0,O);for(let rt=0;rt<w;rt++)for(let Dt=0;Dt<x;Dt++){const Rt=_t.data[4*(rt*x+Dt)+3]/255;if(0===Rt)continue;const Vt=(rt+ue)*T+Dt+ue;if(1===Rt)tt[Vt]=0,Be[Vt]=Su;else{const bn=.5-Rt;tt[Vt]=bn>0?bn*bn:0,Be[Vt]=bn<0?bn*bn:0}}bd(tt,0,0,T,P,T,this.f,this.v,this.z),bd(Be,ue,ue,x,w,T,this.f,this.v,this.z);for(let rt=0;rt<O;rt++){const Dt=Math.sqrt(tt[rt])-Math.sqrt(Be[rt]);k[rt]=Math.round(255-255*(Dt/this.radius+this.cutoff))}return j}};const su=ec;function Md(i,e,o,l){const h=[],p=i.image,g=p.pixelRatio,x=p.paddedRect.w-2*su,w=p.paddedRect.h-2*su,T=i.right-i.left,P=i.bottom-i.top,O=p.stretchX||[[0,x]],k=p.stretchY||[[0,w]],j=(En,Kn)=>En+Kn[1]-Kn[0],q=O.reduce(j,0),ue=k.reduce(j,0),Be=x-q,tt=w-ue;let _t=0,rt=q,Dt=0,Rt=ue,Vt=0,bn=Be,_n=0,Vn=tt;if(p.content&&l){const En=p.content;_t=eh(O,0,En[0]),Dt=eh(k,0,En[1]),rt=eh(O,En[0],En[2]),Rt=eh(k,En[1],En[3]),Vt=En[0]-_t,_n=En[1]-Dt,bn=En[2]-En[0]-rt,Vn=En[3]-En[1]-Rt}const hi=(En,Kn,Gn,oi)=>{const pi=Ed(En.stretch-_t,rt,T,i.left),kn=_1(En.fixed-Vt,bn,En.stretch,q),Ii=Ed(Kn.stretch-Dt,Rt,P,i.top),qi=_1(Kn.fixed-_n,Vn,Kn.stretch,ue),Li=Ed(Gn.stretch-_t,rt,T,i.left),Xr=_1(Gn.fixed-Vt,bn,Gn.stretch,q),yi=Ed(oi.stretch-Dt,Rt,P,i.top),gr=_1(oi.fixed-_n,Vn,oi.stretch,ue),jr=new et(pi,Ii),zo=new et(Li,Ii),Qr=new et(Li,yi),zr=new et(pi,yi),ws=new et(kn/g,qi/g),to=new et(Xr/g,gr/g),Wr=e*Math.PI/180;if(Wr){const ns=Math.sin(Wr),Zo=Math.cos(Wr),Gs=[Zo,-ns,ns,Zo];jr._matMult(Gs),zo._matMult(Gs),zr._matMult(Gs),Qr._matMult(Gs)}const Ho=En.stretch+En.fixed,fs=Kn.stretch+Kn.fixed;return{tl:jr,tr:zo,bl:zr,br:Qr,tex:{x:p.paddedRect.x+su+Ho,y:p.paddedRect.y+su+fs,w:Gn.stretch+Gn.fixed-Ho,h:oi.stretch+oi.fixed-fs},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ws,pixelOffsetBR:to,minFontScaleX:bn/g/T,minFontScaleY:Vn/g/P,isSDF:o}};if(l&&(p.stretchX||p.stretchY)){const En=R2(O,Be,q),Kn=R2(k,tt,ue);for(let Gn=0;Gn<En.length-1;Gn++){const oi=En[Gn],pi=En[Gn+1];for(let kn=0;kn<Kn.length-1;kn++)h.push(hi(oi,Kn[kn],pi,Kn[kn+1]))}}else h.push(hi({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:w+1}));return h}function eh(i,e,o){let l=0;for(const h of i)l+=Math.max(e,Math.min(o,h[1]))-Math.max(e,Math.min(o,h[0]));return l}function R2(i,e,o){const l=[{fixed:-su,stretch:0}];for(const[h,p]of i){const g=l[l.length-1];l.push({fixed:h-g.stretch,stretch:g.stretch}),l.push({fixed:h-g.stretch,stretch:g.stretch+(p-h)})}return l.push({fixed:e+su,stretch:o}),l}function Ed(i,e,o,l){return i/e*o+l}function _1(i,e,o,l){return i-e*o/l}function D3(i,e,o,l){const h=e+i.positionedLines[l].lineOffset;return 0===l?o+h/2:o+(h+(e+i.positionedLines[l-1].lineOffset))/2}class S3{constructor(e=[],o=A3){if(this.data=e,this.length=this.data.length,this.compare=o,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:o,compare:l}=this,h=o[e];for(;e>0;){const p=e-1>>1,g=o[p];if(l(h,g)>=0)break;o[e]=g,e=p}o[e]=h}_down(e){const{data:o,compare:l}=this,h=this.length>>1,p=o[e];for(;e<h;){let g=1+(e<<1),x=o[g];const w=g+1;if(w<this.length&&l(o[w],x)<0&&(g=w,x=o[w]),l(x,p)>=0)break;o[e]=x,e=g}o[e]=p}}function A3(i,e){return i<e?-1:i>e?1:0}function F2(i,e=1,o=!1){let l=1/0,h=1/0,p=-1/0,g=-1/0;const x=i[0];for(let j=0;j<x.length;j++){const q=x[j];(!j||q.x<l)&&(l=q.x),(!j||q.y<h)&&(h=q.y),(!j||q.x>p)&&(p=q.x),(!j||q.y>g)&&(g=q.y)}const w=Math.min(p-l,g-h);let T=w/2;const P=new S3([],y1);if(0===w)return new et(l,h);for(let j=l;j<p;j+=w)for(let q=h;q<g;q+=w)P.push(new au(j+T,q+T,T,i));let O=function(j){let q=0,ue=0,Be=0;const tt=j[0];for(let _t=0,rt=tt.length,Dt=rt-1;_t<rt;Dt=_t++){const Rt=tt[_t],Vt=tt[Dt],bn=Rt.x*Vt.y-Vt.x*Rt.y;ue+=(Rt.x+Vt.x)*bn,Be+=(Rt.y+Vt.y)*bn,q+=3*bn}return new au(ue/q,Be/q,0,j)}(i),k=P.length;for(;P.length;){const j=P.pop();(j.d>O.d||!O.d)&&(O=j,o&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,k)),j.max-O.d<=e||(T=j.h/2,P.push(new au(j.p.x-T,j.p.y-T,T,i)),P.push(new au(j.p.x+T,j.p.y-T,T,i)),P.push(new au(j.p.x-T,j.p.y+T,T,i)),P.push(new au(j.p.x+T,j.p.y+T,T,i)),k+=4)}return o&&(console.log(`num probes: ${k}`),console.log(`best distance: ${O.d}`)),O.p}function y1(i,e){return e.max-i.max}class au{constructor(e,o,l,h){this.p=new et(e,o),this.h=l,this.d=function(p,g){let x=!1,w=1/0;for(let T=0;T<g.length;T++){const P=g[T];for(let O=0,k=P.length,j=k-1;O<k;j=O++){const q=P[O],ue=P[j];q.y>p.y!=ue.y>p.y&&p.x<(ue.x-q.x)*(p.y-q.y)/(ue.y-q.y)+q.x&&(x=!x),w=Math.min(w,y0(p,q,ue))}}return(x?1:-1)*Math.sqrt(w)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}}const zu=7,r4=Number.POSITIVE_INFINITY,P3=Math.sqrt(2);function Cd(i,[e,o]){let l=0,h=0;if(o===r4){e<0&&(e=0);const p=e/P3;switch(i){case"top-right":case"top-left":h=p-zu;break;case"bottom-right":case"bottom-left":h=-p+zu;break;case"bottom":h=-e+zu;break;case"top":h=e-zu}switch(i){case"top-right":case"bottom-right":l=-p;break;case"top-left":case"bottom-left":l=p;break;case"left":l=e;break;case"right":l=-e}}else{switch(e=Math.abs(e),o=Math.abs(o),i){case"top-right":case"top-left":case"top":h=o-zu;break;case"bottom-right":case"bottom-left":case"bottom":h=-o+zu}switch(i){case"top-right":case"bottom-right":case"right":l=-e;break;case"top-left":case"bottom-left":case"left":l=e}}return[l,h]}function N2(i,e,o,l,h,p,g,x,w,T){i.createArrays(),i.tilePixelRatio=dr/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const P=i.layers[0].layout,O=i.layers[0]._unevaluatedLayout._values,k={};if("composite"===i.textSizeData.kind){const{minZoom:ue,maxZoom:Be}=i.textSizeData;k.compositeTextSizes=[O["text-size"].possiblyEvaluate(new U(ue),x),O["text-size"].possiblyEvaluate(new U(Be),x)]}if("composite"===i.iconSizeData.kind){const{minZoom:ue,maxZoom:Be}=i.iconSizeData;k.compositeIconSizes=[O["icon-size"].possiblyEvaluate(new U(ue),x),O["icon-size"].possiblyEvaluate(new U(Be),x)]}k.layoutTextSize=O["text-size"].possiblyEvaluate(new U(w+1),x),k.layoutIconSize=O["icon-size"].possiblyEvaluate(new U(w+1),x),k.textMaxSize=O["text-size"].possiblyEvaluate(new U(18),x);const j="map"===P.get("text-rotation-alignment")&&"point"!==P.get("symbol-placement"),q=P.get("text-size");for(const ue of i.features){const Be=P.get("text-font").evaluate(ue,{},x).join(","),tt=q.evaluate(ue,{},x),_t=k.layoutTextSize.evaluate(ue,{},x),rt=(k.layoutIconSize.evaluate(ue,{},x),{horizontal:{},vertical:void 0}),Dt=ue.text;let Rt,Vt=[0,0];if(Dt){const Vn=Dt.toString(),hi=P.get("text-letter-spacing").evaluate(ue,{},x)*$a,En=P.get("text-line-height").evaluate(ue,{},x)*$a,Kn=Bh(Vn)?hi:0,Gn=P.get("text-anchor").evaluate(ue,{},x),oi=P.get("text-variable-anchor");if(!oi){const Li=P.get("text-radial-offset").evaluate(ue,{},x);Vt=Li?Cd(Gn,[Li*$a,r4]):P.get("text-offset").evaluate(ue,{},x).map(Xr=>Xr*$a)}let pi=j?"center":P.get("text-justify").evaluate(ue,{},x);const kn="point"===P.get("symbol-placement"),Ii=kn?P.get("text-max-width").evaluate(ue,{},x)*$a:1/0,qi=Li=>{i.allowVerticalPlacement&&Nu(Vn)&&(rt.vertical=I2(Dt,e,o,h,Be,Ii,En,Gn,Li,Kn,Vt,Tc.vertical,!0,_t,tt))};if(!j&&oi){const Li="auto"===pi?oi.map(yi=>lu(yi)):[pi];let Xr=!1;for(let yi=0;yi<Li.length;yi++){const gr=Li[yi];if(!rt.horizontal[gr])if(Xr)rt.horizontal[gr]=rt.horizontal[0];else{const jr=I2(Dt,e,o,h,Be,Ii,En,"center",gr,Kn,Vt,Tc.horizontal,!1,_t,tt);jr&&(rt.horizontal[gr]=jr,Xr=1===jr.positionedLines.length)}}qi("left")}else{if("auto"===pi&&(pi=lu(Gn)),kn||P.get("text-writing-mode").indexOf("horizontal")>=0||!Nu(Vn)){const Li=I2(Dt,e,o,h,Be,Ii,En,Gn,pi,Kn,Vt,Tc.horizontal,!1,_t,tt);Li&&(rt.horizontal[pi]=Li)}qi(kn?"left":pi)}}let bn=!1;if(ue.icon&&ue.icon.name){const Vn=l[ue.icon.name];Vn&&(Rt=Dh(h[ue.icon.name],P.get("icon-offset").evaluate(ue,{},x),P.get("icon-anchor").evaluate(ue,{},x)),bn=Vn.sdf,void 0===i.sdfIcons?i.sdfIcons=Vn.sdf:i.sdfIcons!==Vn.sdf&&Si("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Vn.pixelRatio!==i.pixelRatio||0!==P.get("icon-rotate").constantOr(1))&&(i.iconsNeedLinear=!0))}const _n=x1(rt.horizontal)||rt.vertical;i.iconsInText||(i.iconsInText=!!_n&&_n.iconsInText),(_n||Rt)&&V2(i,ue,rt,Rt,l,k,_t,0,Vt,bn,g,x,T)}p&&i.generateCollisionDebugBuffers(w,i.collisionBoxArray)}function lu(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function V2(i,e,o,l,h,p,g,x,w,T,P,O,k){let j=p.textMaxSize.evaluate(e,{},O);void 0===j&&(j=g);const q=i.layers[0].layout,ue=q.get("icon-offset").evaluate(e,{},O),Be=x1(o.horizontal)||o.vertical,tt="globe"===k.name,_t=$a,rt=g/_t,Dt=i.tilePixelRatio*j/_t,Rt=(Gn=i.overscaling,i.zoom>18&&Gn>2&&(Gn>>=1),Math.max(dr/(512*Gn),1)*q.get("symbol-spacing")),Vt=q.get("text-padding")*i.tilePixelRatio,bn=q.get("icon-padding")*i.tilePixelRatio,_n=je(q.get("text-max-angle")),Vn="map"===q.get("text-rotation-alignment")&&"point"!==q.get("symbol-placement"),hi="map"===q.get("icon-rotation-alignment")&&"point"!==q.get("symbol-placement"),En=q.get("symbol-placement"),Kn=Rt/2;var Gn;const oi=q.get("icon-text-fit");let pi;l&&"none"!==oi&&(i.allowVerticalPlacement&&o.vertical&&(pi=tc(l,o.vertical,oi,q.get("icon-text-fit-padding"),ue,rt)),Be&&(l=tc(l,Be,oi,q.get("icon-text-fit-padding"),ue,rt)));const kn=(Ii,qi,Li)=>{if(qi.x<0||qi.x>=dr||qi.y<0||qi.y>=dr)return;let Xr=null;if(tt){const{x:yi,y:gr,z:jr}=k.projectTilePoint(qi.x,qi.y,Li);Xr={anchor:new nl(yi,gr,jr,0,void 0),up:k.upVector(Li,qi.x,qi.y)}}!function(yi,gr,jr,zo,Qr,zr,ws,to,Wr,Ho,fs,ns,Zo,Gs,ra,Ta,is,La,pa,Ws,Oo,ma,ps,ql,As){const Ra=yi.addToLineVertexArray(gr,zo);let il,Rl,rl,Vc,jd,Yd,Ou,df=0,U3=0,j3=0,Y3=0,$d=-1,$3=-1;const Xc={};let Qc=Gt("");const ah=jr?jr.anchor:gr;let ff=0,G3=0;if(void 0===Wr._unevaluatedLayout.getValue("text-radial-offset")?[ff,G3]=Wr.layout.get("text-offset").evaluate(Oo,{},As).map(uc=>uc*$a):(ff=Wr.layout.get("text-radial-offset").evaluate(Oo,{},As)*$a,G3=r4),yi.allowVerticalPlacement&&Qr.vertical){const uc=Qr.vertical;if(ra)Yd=Dd(uc),to&&(Ou=Dd(to));else{const hc=Wr.layout.get("text-rotate").evaluate(Oo,{},As)+90;rl=Td(Ho,ah,gr,fs,ns,Zo,uc,Gs,hc,Ta),to&&(Vc=Td(Ho,ah,gr,fs,ns,Zo,to,La,hc))}}if(zr){const uc=Wr.layout.get("icon-rotate").evaluate(Oo,{},As),hc="none"!==Wr.layout.get("icon-text-fit"),Vh=Md(zr,uc,ps,hc),y4=to?Md(to,uc,ps,hc):void 0;Rl=Td(Ho,ah,gr,fs,ns,Zo,zr,La,uc),df=4*Vh.length;const gf=yi.iconSizeData;let lh=null;"source"===gf.kind?(lh=[Oc*Wr.layout.get("icon-size").evaluate(Oo,{},As)],lh[0]>Iu&&Si(`${yi.layerIds[0]}: Value for "icon-size" is >= ${th}. Reduce your "icon-size".`)):"composite"===gf.kind&&(lh=[Oc*ma.compositeIconSizes[0].evaluate(Oo,{},As),Oc*ma.compositeIconSizes[1].evaluate(Oo,{},As)],(lh[0]>Iu||lh[1]>Iu)&&Si(`${yi.layerIds[0]}: Value for "icon-size" is >= ${th}. Reduce your "icon-size".`)),yi.addSymbols(yi.icon,Vh,lh,Ws,pa,Oo,!1,jr,gr,Ra.lineStartIndex,Ra.lineLength,-1,ql,As),$d=yi.icon.placedSymbolArray.length-1,y4&&(U3=4*y4.length,yi.addSymbols(yi.icon,y4,lh,Ws,pa,Oo,Tc.vertical,jr,gr,Ra.lineStartIndex,Ra.lineLength,-1,ql,As),$3=yi.icon.placedSymbolArray.length-1)}for(const uc in Qr.horizontal){const hc=Qr.horizontal[uc];il||(Qc=Gt(hc.text),ra?jd=Dd(hc):il=Td(Ho,ah,gr,fs,ns,Zo,hc,Gs,Wr.layout.get("text-rotate").evaluate(Oo,{},As),Ta));const Vh=1===hc.positionedLines.length;if(j3+=z3(yi,jr,gr,hc,ws,Wr,ra,Oo,Ta,Ra,Qr.vertical?Tc.horizontal:Tc.horizontalOnly,Vh?Object.keys(Qr.horizontal):[uc],Xc,$d,ma,ql,As),Vh)break}Qr.vertical&&(Y3+=z3(yi,jr,gr,Qr.vertical,ws,Wr,ra,Oo,Ta,Ra,Tc.vertical,["vertical"],Xc,$3,ma,ql,As));let Vs=-1;const pf=(uc,hc)=>uc?Math.max(uc,hc):hc;Vs=pf(jd,Vs),Vs=pf(Yd,Vs),Vs=pf(Ou,Vs);const mf=Vs>-1?1:0;yi.glyphOffsetArray.length>=Kc.MAX_GLYPHS&&Si("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Oo.sortKey&&yi.addToSortKeyRanges(yi.symbolInstances.length,Oo.sortKey),yi.symbolInstances.emplaceBack(ah.x,ah.y,ah.z,gr.x,gr.y,Xc.right>=0?Xc.right:-1,Xc.center>=0?Xc.center:-1,Xc.left>=0?Xc.left:-1,Xc.vertical>=0?Xc.vertical:-1,$d,$3,Qc,void 0!==il?il:yi.collisionBoxArray.length,void 0!==il?il+1:yi.collisionBoxArray.length,void 0!==rl?rl:yi.collisionBoxArray.length,void 0!==rl?rl+1:yi.collisionBoxArray.length,void 0!==Rl?Rl:yi.collisionBoxArray.length,void 0!==Rl?Rl+1:yi.collisionBoxArray.length,Vc||yi.collisionBoxArray.length,Vc?Vc+1:yi.collisionBoxArray.length,fs,j3,Y3,df,U3,mf,0,ff,G3,Vs)}(i,qi,Xr,Ii,o,l,h,pi,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,Vt,Vn,w,0,bn,hi,ue,e,p,T,P,O)};if("line"===En)for(const Ii of T3(e.geometry,0,0,dr,dr)){const qi=L2(Ii,Rt,_n,o.vertical||Be,l,_t,Dt,i.overscaling,dr);for(const Li of qi)Be&&B2(i,Be.text,Kn,Li)||kn(Ii,Li,O)}else if("line-center"===En){for(const Ii of e.geometry)if(Ii.length>1){const qi=$8(Ii,_n,o.vertical||Be,l,_t,Dt);qi&&kn(Ii,qi,O)}}else if("Polygon"===e.type)for(const Ii of D0(e.geometry,0)){const qi=F2(Ii,16);kn(Ii[0],new nl(qi.x,qi.y,0,0,void 0),O)}else if("LineString"===e.type)for(const Ii of e.geometry)kn(Ii,new nl(Ii[0].x,Ii[0].y,0,0,void 0),O);else if("Point"===e.type)for(const Ii of e.geometry)for(const qi of Ii)kn([qi],new nl(qi.x,qi.y,0,0,void 0),O)}const th=255,Iu=th*Oc;function z3(i,e,o,l,h,p,g,x,w,T,P,O,k,j,q,ue,Be){const tt=function(Dt,Rt,Vt,bn,_n,Vn,hi,En){const Kn=[];if(0===Rt.positionedLines.length)return Kn;const Gn=bn.layout.get("text-rotate").evaluate(Vn,{})*Math.PI/180,oi=function(Li){const Xr=Li[0],yi=Li[1],gr=Xr*yi;return gr>0?[Xr,-yi]:gr<0?[-Xr,yi]:0===Xr?[yi,Xr]:[yi,-Xr]}(Vt);let pi=Math.abs(Rt.top-Rt.bottom);for(const Li of Rt.positionedLines)pi-=Li.lineOffset;const kn=Rt.positionedLines.length,Ii=pi/kn;let qi=Rt.top-Vt[1];for(let Li=0;Li<kn;++Li){const Xr=Rt.positionedLines[Li];qi=D3(Rt,Ii,qi,Li);for(const yi of Xr.positionedGlyphs){if(!yi.rect)continue;const gr=yi.rect||{};let jr=P2+1,zo=!0,Qr=1,zr=0;if(yi.imageName){const ps=hi[yi.imageName];if(!ps)continue;if(ps.sdf){Si("SDF images are not supported in formatted text and will be ignored.");continue}zo=!1,Qr=ps.pixelRatio,jr=ec/Qr}const ws=(_n||En)&&yi.vertical,to=yi.metrics.advance*yi.scale/2,Wr=yi.metrics,Ho=yi.rect;if(null===Ho)continue;En&&Rt.verticalizable&&(zr=yi.imageName?to-yi.metrics.width*yi.scale/2:0);const fs=_n?[yi.x+to,yi.y]:[0,0];let ns=[0,0],Zo=[0,0],Gs=!1;_n||(ws?(Zo=[yi.x+to+oi[0],yi.y+oi[1]-zr],Gs=!0):ns=[yi.x+to+Vt[0],yi.y+Vt[1]-zr]);const ra=Ho.w*yi.scale/(Qr*(yi.localGlyph?Lc:1)),Ta=Ho.h*yi.scale/(Qr*(yi.localGlyph?Lc:1));let is,La,pa,Ws;if(ws){const ps=yi.y-qi,ql=new et(-to,to-ps),As=-Math.PI/2,Ra=new et(...Zo);is=new et(-to+ns[0],ns[1]),is._rotateAround(As,ql)._add(Ra),is.x+=-ps+to,is.y-=(Wr.left-jr)*yi.scale;const il=yi.imageName?Wr.advance*yi.scale:$a*yi.scale,Rl=String.fromCharCode(yi.glyph);f3(Rl)?is.x+=(1-jr)*yi.scale:p3(Rl)?is.x+=il-Wr.height*yi.scale+(-jr-1)*yi.scale:is.x+=yi.imageName||Wr.width+2*jr===Ho.w&&Wr.height+2*jr===Ho.h?(il-Ta)/2:(il-(Wr.height+2*jr)*yi.scale)/2,La=new et(is.x,is.y-ra),pa=new et(is.x+Ta,is.y),Ws=new et(is.x+Ta,is.y-ra)}else{const ps=(Wr.left-jr)*yi.scale-to+ns[0],ql=(-Wr.top-jr)*yi.scale+ns[1],As=ps+ra,Ra=ql+Ta;is=new et(ps,ql),La=new et(As,ql),pa=new et(ps,Ra),Ws=new et(As,Ra)}if(Gn){let ps;ps=_n?new et(0,0):Gs?new et(oi[0],oi[1]):new et(Vt[0],Vt[1]),is._rotateAround(Gn,ps),La._rotateAround(Gn,ps),pa._rotateAround(Gn,ps),Ws._rotateAround(Gn,ps)}const Oo=new et(0,0),ma=new et(0,0);Kn.push({tl:is,tr:La,bl:pa,br:Ws,tex:gr,writingMode:Rt.writingMode,glyphOffset:fs,sectionIndex:yi.sectionIndex,isSDF:zo,pixelOffsetTL:Oo,pixelOffsetBR:ma,minFontScaleX:0,minFontScaleY:0})}}return Kn}(0,l,w,p,g,x,h,i.allowVerticalPlacement),_t=i.textSizeData;let rt=null;"source"===_t.kind?(rt=[Oc*p.layout.get("text-size").evaluate(x,{},Be)],rt[0]>Iu&&Si(`${i.layerIds[0]}: Value for "text-size" is >= ${th}. Reduce your "text-size".`)):"composite"===_t.kind&&(rt=[Oc*q.compositeTextSizes[0].evaluate(x,{},Be),Oc*q.compositeTextSizes[1].evaluate(x,{},Be)],(rt[0]>Iu||rt[1]>Iu)&&Si(`${i.layerIds[0]}: Value for "text-size" is >= ${th}. Reduce your "text-size".`)),i.addSymbols(i.text,tt,rt,w,g,x,P,e,o,T.lineStartIndex,T.lineLength,j,ue,Be);for(const Dt of O)k[Dt]=i.text.placedSymbolArray.length-1;return 4*tt.length}function x1(i){for(const e in i)return i[e];return null}function Td(i,e,o,l,h,p,g,x,w,T){let P=g.top,O=g.bottom,k=g.left,j=g.right;const q=g.collisionPadding;if(q&&(k-=q[0],P-=q[1],j+=q[2],O+=q[3]),w){const ue=new et(k,P),Be=new et(j,P),tt=new et(k,O),_t=new et(j,O),rt=je(w);let Dt=new et(0,0);T&&(Dt=new et(T[0],T[1])),ue._rotateAround(rt,Dt),Be._rotateAround(rt,Dt),tt._rotateAround(rt,Dt),_t._rotateAround(rt,Dt),k=Math.min(ue.x,Be.x,tt.x,_t.x),j=Math.max(ue.x,Be.x,tt.x,_t.x),P=Math.min(ue.y,Be.y,tt.y,_t.y),O=Math.max(ue.y,Be.y,tt.y,_t.y)}return i.emplaceBack(e.x,e.y,e.z,o.x,o.y,k,P,j,O,x,l,h,p),i.length-1}function Dd(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const e=i.bottom-i.top;return e>0?Math.max(10,e):null}function B2(i,e,o,l){const h=i.compareText;if(e in h){const p=h[e];for(let g=p.length-1;g>=0;g--)if(l.dist(p[g])<o)return!0}else h[e]=[];return h[e].push(l),!1}function o4(i,e){const o=i.fovAboveCenter,l=i.elevation?i.elevation.getMinElevationBelowMSL()*e:0,h=(i._camera.position[2]*i.worldSize-l)/Math.cos(i._pitch),p=Math.sin(o)*h/Math.sin(Math.max(Math.PI/2-i._pitch-o,.01)),g=Math.sin(i._pitch)*p+h;return Math.min(1.01*g,h*(1/i._horizonShift))}function cu(i,e){if(!e.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:e};const o=Math.pow(2,-i.z),l=i.x*o,h=(i.x+1)*o,p=i.y*o,g=(i.y+1)*o,x=Ea(l),w=Ea(h),T=dl(p),P=dl(g),O=e.project(x,T),k=e.project(w,T),j=e.project(w,P),q=e.project(x,P);let ue=Math.min(O.x,k.x,j.x,q.x),Be=Math.min(O.y,k.y,j.y,q.y),tt=Math.max(O.x,k.x,j.x,q.x),_t=Math.max(O.y,k.y,j.y,q.y);const rt=o/16;function Dt(Vt,bn,_n,Vn,hi,En){const Kn=(_n+hi)/2,Gn=(Vn+En)/2,oi=e.project(Ea(Kn),dl(Gn)),pi=Math.max(0,ue-oi.x,Be-oi.y,oi.x-tt,oi.y-_t);ue=Math.min(ue,oi.x),tt=Math.max(tt,oi.x),Be=Math.min(Be,oi.y),_t=Math.max(_t,oi.y),pi>rt&&(Dt(Vt,oi,_n,Vn,Kn,Gn),Dt(oi,bn,Kn,Gn,hi,En))}Dt(O,k,l,p,h,p),Dt(k,j,h,p,h,g),Dt(j,q,h,g,l,g),Dt(q,O,l,g,l,p),ue-=rt,Be-=rt,tt+=rt,_t+=rt;const Rt=1/Math.max(tt-ue,_t-Be);return{scale:Rt,x:ue*Rt,y:Be*Rt,x2:tt*Rt,y2:_t*Rt,projection:e}}const H2=oc(new Float32Array(16));class Rc{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,o){return{x:0,y:0,z:0}}unproject(e,o){return new Po(0,0)}projectTilePoint(e,o,l){return{x:e,y:o,z:0}}locationPoint(e,o,l=!0){return e._coordinatePoint(e.locationCoordinate(o),l)}pixelsPerMeter(e,o){return lc(1,e)*o}pixelSpaceConversion(e,o,l){return 1}farthestPixelDistance(e){return o4(e,e.pixelsPerMeter)}pointCoordinate(e,o,l,h){const p=e.horizonLineFromTop(!1),g=new et(o,Math.max(p,l));return e.rayIntersectionCoordinate(e.pointRayIntersection(g,h))}pointCoordinate3D(e,o,l){const h=new et(o,l);if(e.elevation)return e.elevation.pointCoordinate(h);{const p=this.pointCoordinate(e,h.x,h.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(e,o){if(e.elevation)return!this.pointCoordinate3D(e,o.x,o.y);const l=e.horizonLineFromTop();return o.y<l}createInversionMatrix(e,o){return H2}createTileMatrix(e,o,l){let h,p,g;const x=l.canonical,w=oc(new Float64Array(16));if(this.isReprojectedInTileSpace){const T=cu(x,this);h=1,p=T.x+l.wrap*T.scale,g=T.y,vc(w,w,[h/T.scale,h/T.scale,e.pixelsPerMeter/o])}else h=o/e.zoomScale(x.z),p=(x.x+Math.pow(2,x.z)*l.wrap)*h,g=x.y*h;return jh(w,w,[p,g,0]),vc(w,w,[h/dr,h/dr,1]),w}upVector(e,o,l){return[0,0,1]}upVectorScale(e,o,l){return{metersToTile:1}}}class b1 extends Rc{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[o,l]=this.parallels=e.parallels||[29.5,45.5],h=Math.sin(je(o));this.n=(h+Math.sin(je(l)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(e,o){const{n:l,c:h,r0:p}=this,g=je(e-this.center[0]),x=je(o),w=Math.sqrt(h-2*l*Math.sin(x))/l;return{x:w*Math.sin(g*l),y:w*Math.cos(g*l)-p,z:0}}unproject(e,o){const{n:l,c:h,r0:p}=this,g=p+o;let x=Math.atan2(e,Math.abs(g))*Math.sign(g);g*l<0&&(x-=Math.PI*Math.sign(e)*Math.sign(g));const w=je(this.center[0])*l;x=nn(x,-Math.PI-w,Math.PI-w);const T=an(At(x/l)+this.center[0],-180,180),P=Math.asin(an((h-(e*e+g*g)*l*l)/(2*l),-1,1)),O=an(At(P),-Ca,Ca);return new Po(T,O)}}const Sh=1.340264,nh=-.081106,uu=893e-6,Ah=.003796,Ph=Math.sqrt(3)/2;class Sd extends Rc{project(e,o){o=o/180*Math.PI,e=e/180*Math.PI;const l=Math.asin(Ph*Math.sin(o)),h=l*l,p=h*h*h;return{x:.5*(e*Math.cos(l)/(Ph*(Sh+3*nh*h+p*(7*uu+9*Ah*h)))/Math.PI+.5),y:1-.5*(l*(Sh+nh*h+p*(uu+Ah*h))/Math.PI+1),z:0}}unproject(e,o){e=(2*e-.5)*Math.PI;let l=o=(2*(1-o)-1)*Math.PI,h=l*l,p=h*h*h;for(let P,O,k,j=0;j<12&&(O=l*(Sh+nh*h+p*(uu+Ah*h))-o,k=Sh+3*nh*h+p*(7*uu+9*Ah*h),P=O/k,l=an(l-P,-Math.PI/3,Math.PI/3),h=l*l,p=h*h*h,!(Math.abs(P)<1e-12));++j);const g=Ph*e*(Sh+3*nh*h+p*(7*uu+9*Ah*h))/Math.cos(l),x=Math.asin(Math.sin(l)/Ph),w=an(180*g/Math.PI,-180,180),T=an(180*x/Math.PI,-Ca,Ca);return new Po(w,T)}}class I3 extends Rc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,o){return{x:.5+e/360,y:.5-o/360,z:0}}unproject(e,o){const l=360*(e-.5),h=an(360*(.5-o),-Ca,Ca);return new Po(l,h)}}const ih=Math.PI/2;function Ad(i){return Math.tan((ih+i)/2)}class k3 extends Rc{constructor(e){super(e),this.center=e.center||[0,30];const[o,l]=this.parallels=e.parallels||[30,30];let h=je(o),p=je(l);this.southernCenter=h+p<0,this.southernCenter&&(h=-h,p=-p);const g=Math.cos(h),x=Ad(h);this.n=h===p?Math.sin(h):Math.log(g/Math.cos(p))/Math.log(Ad(p)/x),this.f=g*Math.pow(Ad(h),this.n)/this.n}project(e,o){o=je(o),this.southernCenter&&(o=-o),e=je(e-this.center[0]);const l=1e-6,{n:h,f:p}=this;p>0?o<-ih+l&&(o=-ih+l):o>ih-l&&(o=ih-l);const g=p/Math.pow(Ad(o),h);let x=g*Math.sin(h*e),w=p-g*Math.cos(h*e);return x=.5*(x/Math.PI+.5),w=.5*(w/Math.PI+.5),{x,y:this.southernCenter?w:1-w,z:0}}unproject(e,o){e=(2*e-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:l,f:h}=this,p=h-o,g=Math.sign(p),x=Math.sign(l)*Math.sqrt(e*e+p*p);let w=Math.atan2(e,Math.abs(p))*g;p*l<0&&(w-=Math.PI*Math.sign(e)*g);const T=an(At(w/l)+this.center[0],-180,180),P=an(At(2*Math.atan(Math.pow(h/x,1/l))-ih),-Ca,Ca);return new Po(T,this.southernCenter?-P:P)}}class U2 extends Rc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,o){return{x:wc(e),y:Yc(o),z:0}}unproject(e,o){const l=Ea(e),h=dl(o);return new Po(l,h)}}const s4=je(Ca);class j2 extends Rc{project(e,o){const l=(o=je(o))*o,h=l*l;return{x:.5*((e=je(e))*(.8707-.131979*l+h*(h*(.003971*l-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+l*(.015085+h*(.028874*l-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(e,o){e=(2*e-.5)*Math.PI;let l=o=(2*(1-o)-1)*Math.PI,h=25,p=0,g=l*l;do{g=l*l;const T=g*g;p=(l*(1.007226+g*(.015085+T*(.028874*g-.044475-.005916*T)))-o)/(1.007226+g*(.045255+T*(.259866*g-.311325-.005916*11*T))),l=an(l-p,-s4,s4)}while(Math.abs(p)>1e-6&&--h>0);g=l*l;const x=an(At(e/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),w=At(l);return new Po(x,w)}}const co=je(Ca);class Y2 extends Rc{project(e,o){o=je(o),e=je(e);const l=Math.cos(o),h=2/Math.PI,p=Math.acos(l*Math.cos(e/2)),g=Math.sin(p)/p,x=.5*(e*h+2*l*Math.sin(e/2)/g)||0,w=.5*(o+Math.sin(o)/g)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(w/Math.PI+1),z:0}}unproject(e,o){let l=e=(2*e-.5)*Math.PI,h=o=(2*(1-o)-1)*Math.PI,p=25;const g=1e-6;let x=0,w=0;do{const T=Math.cos(h),P=Math.sin(h),O=2*P*T,k=P*P,j=T*T,q=Math.cos(l/2),ue=Math.sin(l/2),Be=2*q*ue,tt=ue*ue,_t=1-j*q*q,rt=_t?1/_t:0,Dt=_t?Math.acos(T*q)*Math.sqrt(1/_t):0,Rt=.5*(2*Dt*T*ue+2*l/Math.PI)-e,Vt=.5*(Dt*P+h)-o,bn=.5*rt*(j*tt+Dt*T*q*k)+1/Math.PI,_n=rt*(Be*O/4-Dt*P*ue),Vn=.125*rt*(O*ue-Dt*P*j*Be),hi=.5*rt*(k*q+Dt*tt*T)+.5,En=_n*Vn-hi*bn;x=(Vt*_n-Rt*hi)/En,w=(Rt*Vn-Vt*bn)/En,l=an(l-x,-Math.PI,Math.PI),h=an(h-w,-co,co)}while((Math.abs(x)>g||Math.abs(w)>g)&&--p>0);return new Po(At(l),At(h))}}class a4 extends Rc{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(je(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,o){const{scale:l,cosPhi:h}=this;return{x:je(e)*h*l+.5,y:-Math.sin(je(o))/h*l+.5,z:0}}unproject(e,o){const{scale:l,cosPhi:h}=this,p=-(o-.5)/l,g=an(At((e-.5)/l)/h,-180,180),x=Math.asin(an(p*h,-1,1)),w=an(At(x),-Ca,Ca);return new Po(g,w)}}class zh extends U2{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,o,l){const h=mh(e,o,l);return ia(h,h,ac(jc(l))),{x:h[0],y:h[1],z:h[2]}}locationPoint(e,o){const l=Kh(o.lat,o.lng),h=Tl([],l),p=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(o),e._centerAltitude):e._centerAltitude;fh(l,l,h,lc(1,0)*dr*p);const g=oc(new Float64Array(16));return mu(g,e.pixelMatrix,e.globeMatrix),ia(l,l,g),new et(l[0],l[1])}pixelsPerMeter(e,o){return lc(1,0)*o}pixelSpaceConversion(e,o,l){const h=lc(1,e)*o,p=Hr(lc(1,45)*o,h,l);return this.pixelsPerMeter(e,o)/p}createTileMatrix(e,o,l){const h=Y1(jc(l.canonical));return mu(new Float64Array(16),e.globeMatrix,h)}createInversionMatrix(e,o){const{center:l}=e,h=ac(jc(o));return L1(h,h,je(l.lng)),Hu(h,h,je(l.lat)),vc(h,h,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(e,o,l,h){return Q4(e,o,l,!0)||new Ku(0,0)}pointCoordinate3D(e,o,l){const h=this.pointCoordinate(e,o,l,0);return[h.x,h.y,h.z]}isPointAboveHorizon(e,o){return!Q4(e,o.x,o.y,!1)}farthestPixelDistance(e){const o=function(h,p){const g=h.cameraToCenterDistance,x=h._centerAltitude*p,w=h._camera,T=h._camera.forward(),P=sc([],_c([],T,-g),[0,0,x]),O=h.worldSize/(2*Math.PI),k=[0,0,-O],j=h.width/h.height,q=Math.tan(h.fovAboveCenter),ue=_c([],w.up(),q),Be=_c([],w.right(),q*j),tt=Tl([],sc([],sc([],T,ue),Be)),_t=[];let rt;if(new yu(P,tt).closestPointOnSphere(k,O,_t)){const Dt=sc([],_t,k),Rt=bc([],Dt,P);rt=Math.cos(h.fovAboveCenter)*F1(Rt)}else{const Dt=bc([],P,k),Rt=bc([],k,P);Tl(Rt,Rt);const Vt=F1(Dt)-O;rt=Math.sqrt(Vt*(Vt+2*O));const bn=Math.acos(rt/(O+Vt))-Math.acos(yc(T,Rt));rt*=Math.cos(bn)}return 1.01*rt}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),l=gh(e.zoom);if(l>0){const h=o4(e,lc(1,e.center.lat)*e.worldSize),p=e.worldSize/(2*Math.PI),g=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Hr(o,h+p*(1-Math.cos(g)),Math.pow(l,10))}return o}upVector(e,o,l){return mh(o,l,e,1)}upVectorScale(e){return{metersToTile:B1(f0(jc(e)))}}}function l4(i){const e=i.parallels,o=!!e&&Math.abs(e[0]+e[1])<.01;switch(i.name){case"mercator":return new U2(i);case"equirectangular":return new I3(i);case"naturalEarth":return new j2(i);case"equalEarth":return new Sd(i);case"winkelTripel":return new Y2(i);case"albers":return o?new a4(i):new b1(i);case"lambertConformalConic":return o?new a4(i):new k3(i);case"globe":return new zh(i)}throw new Error(`Invalid projection name: ${i.name}`)}const $2=o1.types,O3=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function rh(i,e,o,l,h,p,g,x,w,T,P,O,k){const j=x?Math.min(Iu,Math.round(x[0])):0,q=x?Math.min(Iu,Math.round(x[1])):0;i.emplaceBack(e,o,Math.round(32*l),Math.round(32*h),p,g,(j<<1)+(w?1:0),q,16*T,16*P,256*O,256*k)}function hu(i,e,o,l,h,p,g){i.emplaceBack(e,o,l,h,p,g)}function Ih(i,e,o,l,h){i.emplaceBack(e,o,l,h),i.emplaceBack(e,o,l,h),i.emplaceBack(e,o,l,h),i.emplaceBack(e,o,l,h)}function w1(i){for(const e of i.sections)if(B(e.text))return!0;return!1}class Pd{constructor(e){this.layoutVertexArray=new Qn,this.indexArray=new Qi,this.programConfigurations=e,this.segments=new na,this.dynamicLayoutVertexArray=new ai,this.opacityVertexArray=new tr,this.placedSymbolArray=new js,this.globeExtVertexArray=new fi}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,o,l,h){this.isEmpty()||(l&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,B8.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,H8.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,O3,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,u3.members,!0)),this.opacityVertexBuffer.itemSize=1),(l||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}$i(Pd,"SymbolBuffers");class M1{constructor(e,o,l){this.layoutVertexArray=new e,this.layoutAttributes=o,this.indexArray=new l,this.segments=new na,this.collisionVertexArray=new Ur,this.collisionVertexArrayExt=new Zr}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,H0.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,U0.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}$i(M1,"CollisionBuffers");class Kc{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(g=>g.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=oc([]),this.placementViewportMatrix=oc([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=j0(this.zoom,o["text-size"]),this.iconSizeData=j0(this.zoom,o["icon-size"]);const l=this.layers[0].layout,h=l.get("symbol-sort-key"),p=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==p&&void 0!==h.constantOr(1),this.sortFeaturesByY=("viewport-y"===p||"auto"===p&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=l.get("text-writing-mode").map(g=>Tc[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Pd(new Ql(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Pd(new Ql(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Vr,this.lineVertexArray=new nu,this.symbolInstances=new Mn}calculateGlyphDependencies(e,o,l,h,p){for(let g=0;g<e.length;g++)if(o[e.charCodeAt(g)]=!0,h&&p){const x=Ch[e.charAt(g)];x&&(o[x.charCodeAt(0)]=!0)}}populate(e,o,l,h){const p=this.layers[0],g=p.layout,x="globe"===this.projection.name,w=g.get("text-font"),T=g.get("text-field"),P=g.get("icon-image"),O=("constant"!==T.value.kind||T.value.value instanceof gs&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&("constant"!==w.value.kind||w.value.value.length>0),k="constant"!==P.value.kind||!!P.value.value||Object.keys(P.parameters).length>0,j=g.get("symbol-sort-key");if(this.features=[],!O&&!k)return;const q=o.iconDependencies,ue=o.glyphDependencies,Be=o.availableImages,tt=new U(this.zoom);for(const{feature:_t,id:rt,index:Dt,sourceLayerIndex:Rt}of e){const Vt=p._featureFilter.needGeometry,bn=qu(_t,Vt);if(!p._featureFilter.filter(tt,bn,l))continue;if(Vt||(bn.geometry=$c(_t,l,h)),x&&1!==_t.type&&l.z<=5){const En=bn.geometry,Kn=.98078528056,Gn=(oi,pi)=>yc(mh(oi.x,oi.y,l,1),mh(pi.x,pi.y,l,1))<Kn;for(let oi=0;oi<En.length;oi++)En[oi]=p0(En[oi],Gn)}let _n,Vn;if(O){const En=p.getValueAndResolveTokens("text-field",bn,l,Be),Kn=gs.factory(En);w1(Kn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===b()||this.hasRTLText&&z.isParsed())&&(_n=Y0(Kn,p,bn))}if(k){const En=p.getValueAndResolveTokens("icon-image",bn,l,Be);Vn=En instanceof $o?En:$o.fromString(En)}if(!_n&&!Vn)continue;const hi=this.sortFeaturesByKey?j.evaluate(bn,{},l):void 0;if(this.features.push({id:rt,text:_n,icon:Vn,index:Dt,sourceLayerIndex:Rt,geometry:bn.geometry,properties:_t.properties,type:$2[_t.type],sortKey:hi}),Vn&&(q[Vn.name]=!0),_n){const En=w.evaluate(bn,{},l).join(","),Kn="map"===g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Tc.vertical)>=0;for(const Gn of _n.sections)if(Gn.image)q[Gn.image.name]=!0;else{const oi=Nu(_n.toString()),pi=Gn.fontStack||En,kn=ue[pi]=ue[pi]||{};this.calculateGlyphDependencies(Gn.text,kn,Kn,this.allowVerticalPlacement,oi)}}}"line"===g.get("symbol-placement")&&(this.features=function(_t){const rt={},Dt={},Rt=[];let Vt=0;function bn(En){Rt.push(_t[En]),Vt++}function _n(En,Kn,Gn){const oi=Dt[En];return delete Dt[En],Dt[Kn]=oi,Rt[oi].geometry[0].pop(),Rt[oi].geometry[0]=Rt[oi].geometry[0].concat(Gn[0]),oi}function Vn(En,Kn,Gn){const oi=rt[Kn];return delete rt[Kn],rt[En]=oi,Rt[oi].geometry[0].shift(),Rt[oi].geometry[0]=Gn[0].concat(Rt[oi].geometry[0]),oi}function hi(En,Kn,Gn){const oi=Gn?Kn[0][Kn[0].length-1]:Kn[0][0];return`${En}:${oi.x}:${oi.y}`}for(let En=0;En<_t.length;En++){const Kn=_t[En],Gn=Kn.geometry,oi=Kn.text?Kn.text.toString():null;if(!oi){bn(En);continue}const pi=hi(oi,Gn),kn=hi(oi,Gn,!0);if(pi in Dt&&kn in rt&&Dt[pi]!==rt[kn]){const Ii=Vn(pi,kn,Gn),qi=_n(pi,kn,Rt[Ii].geometry);delete rt[pi],delete Dt[kn],Dt[hi(oi,Rt[qi].geometry,!0)]=qi,Rt[Ii].geometry=null}else pi in Dt?_n(pi,kn,Gn):kn in rt?Vn(pi,kn,Gn):(bn(En),rt[pi]=Vt-1,Dt[kn]=Vt-1)}return Rt.filter(En=>En.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((_t,rt)=>_t.sortKey-rt.sortKey)}update(e,o,l,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,o,this.layers,l,h),this.icon.programConfigurations.updatePaintArrays(e,o,this.layers,l,h))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=l4(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,o){const l=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:h,y:p}of o)this.lineVertexArray.emplaceBack(h,p);return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(e,o,l,h,p,g,x,w,T,P,O,k,j,q){const ue=e.indexArray,Be=e.layoutVertexArray,tt=e.globeExtVertexArray,_t=e.segments.prepareSegment(4*o.length,Be,ue,this.canOverlap?g.sortKey:void 0),rt=this.glyphOffsetArray.length,Dt=_t.vertexLength,Rt=this.allowVerticalPlacement&&x===Tc.vertical?Math.PI/2:0,Vt=g.text&&g.text.sections;for(let _n=0;_n<o.length;_n++){const{tl:Vn,tr:hi,bl:En,br:Kn,tex:Gn,pixelOffsetTL:oi,pixelOffsetBR:pi,minFontScaleX:kn,minFontScaleY:Ii,glyphOffset:qi,isSDF:Li,sectionIndex:Xr}=o[_n],yi=_t.vertexLength,gr=qi[1];if(rh(Be,T.x,T.y,Vn.x,gr+Vn.y,Gn.x,Gn.y,l,Li,oi.x,oi.y,kn,Ii),rh(Be,T.x,T.y,hi.x,gr+hi.y,Gn.x+Gn.w,Gn.y,l,Li,pi.x,oi.y,kn,Ii),rh(Be,T.x,T.y,En.x,gr+En.y,Gn.x,Gn.y+Gn.h,l,Li,oi.x,pi.y,kn,Ii),rh(Be,T.x,T.y,Kn.x,gr+Kn.y,Gn.x+Gn.w,Gn.y+Gn.h,l,Li,pi.x,pi.y,kn,Ii),w){const{x:jr,y:zo,z:Qr}=w.anchor,[zr,ws,to]=w.up;hu(tt,jr,zo,Qr,zr,ws,to),hu(tt,jr,zo,Qr,zr,ws,to),hu(tt,jr,zo,Qr,zr,ws,to),hu(tt,jr,zo,Qr,zr,ws,to),Ih(e.dynamicLayoutVertexArray,jr,zo,Qr,Rt)}else Ih(e.dynamicLayoutVertexArray,T.x,T.y,T.z,Rt);ue.emplaceBack(yi,yi+1,yi+2),ue.emplaceBack(yi+1,yi+2,yi+3),_t.vertexLength+=4,_t.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(qi[0]),_n!==o.length-1&&Xr===o[_n+1].sectionIndex||e.programConfigurations.populatePaintArrays(Be.length,g,g.index,{},j,q,Vt&&Vt[Xr])}const bn=w?w.anchor:T;e.placedSymbolArray.emplaceBack(bn.x,bn.y,bn.z,T.x,T.y,rt,this.glyphOffsetArray.length-rt,Dt,P,O,T.segment,l?l[0]:0,l?l[1]:0,h[0],h[1],x,0,!1,0,k,0)}_commitLayoutVertex(e,o,l,h,p,g,x){e.emplaceBack(o,l,h,p,g,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(e,o,l,h,p,g,x){const w=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),T=w.vertexLength,P=x.tileAnchorX,O=x.tileAnchorY;for(let j=0;j<4;j++)l.collisionVertexArray.emplaceBack(0,0,0,0);l.collisionVertexArrayExt.emplaceBack(o,-e.padding,-e.padding),l.collisionVertexArrayExt.emplaceBack(o,e.padding,-e.padding),l.collisionVertexArrayExt.emplaceBack(o,e.padding,e.padding),l.collisionVertexArrayExt.emplaceBack(o,-e.padding,e.padding),this._commitLayoutVertex(l.layoutVertexArray,h,p,g,P,O,new et(e.x1,e.y1)),this._commitLayoutVertex(l.layoutVertexArray,h,p,g,P,O,new et(e.x2,e.y1)),this._commitLayoutVertex(l.layoutVertexArray,h,p,g,P,O,new et(e.x2,e.y2)),this._commitLayoutVertex(l.layoutVertexArray,h,p,g,P,O,new et(e.x1,e.y2)),w.vertexLength+=4;const k=l.indexArray;k.emplaceBack(T,T+1),k.emplaceBack(T+1,T+2),k.emplaceBack(T+2,T+3),k.emplaceBack(T+3,T),w.primitiveLength+=4}_addTextDebugCollisionBoxes(e,o,l,h,p,g){for(let x=h;x<p;x++){const w=l.get(x),T=this.getSymbolInstanceTextSize(e,g,o,x);this._addCollisionDebugVertices(w,T,this.textCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(e,o,l,h,p,g){for(let x=h;x<p;x++){const w=l.get(x),T=this.getSymbolInstanceIconSize(e,o,g.placedIconSymbolIndex);this._addCollisionDebugVertices(w,T,this.iconCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,g)}}generateCollisionDebugBuffers(e,o){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new M1(Vi,h3.members,Ma),this.iconCollisionBox=new M1(Vi,h3.members,Ma);const l=Eh(this.iconSizeData,e),h=Eh(this.textSizeData,e);for(let p=0;p<this.symbolInstances.length;p++){const g=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(h,e,o,g.textBoxStartIndex,g.textBoxEndIndex,g),this._addTextDebugCollisionBoxes(h,e,o,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._addIconDebugCollisionBoxes(l,e,o,g.iconBoxStartIndex,g.iconBoxEndIndex,g),this._addIconDebugCollisionBoxes(l,e,o,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g)}}getSymbolInstanceTextSize(e,o,l,h){const p=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:h),g=pd(this.textSizeData,e,p)/$a;return this.tilePixelRatio*g}getSymbolInstanceIconSize(e,o,l){const h=this.icon.placedSymbolArray.get(l),p=pd(this.iconSizeData,e,h);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(e,o,l){e.emplaceBack(o,-l,-l),e.emplaceBack(o,l,-l),e.emplaceBack(o,l,l),e.emplaceBack(o,-l,l)}_updateTextDebugCollisionBoxes(e,o,l,h,p,g){for(let x=h;x<p;x++){const w=l.get(x),T=this.getSymbolInstanceTextSize(e,g,o,x);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,T,w.padding)}}_updateIconDebugCollisionBoxes(e,o,l,h,p,g){for(let x=h;x<p;x++){const w=l.get(x),T=this.getSymbolInstanceIconSize(e,o,g);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,T,w.padding)}}updateCollisionDebugBuffers(e,o){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const l=Eh(this.iconSizeData,e),h=Eh(this.textSizeData,e);for(let p=0;p<this.symbolInstances.length;p++){const g=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(h,e,o,g.textBoxStartIndex,g.textBoxEndIndex,g),this._updateTextDebugCollisionBoxes(h,e,o,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._updateIconDebugCollisionBoxes(l,e,o,g.iconBoxStartIndex,g.iconBoxEndIndex,g.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(l,e,o,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,o,l,h,p,g,x,w,T){const P={};if(o<l){const{x1:O,y1:k,x2:j,y2:q,padding:ue,projectedAnchorX:Be,projectedAnchorY:tt,projectedAnchorZ:_t,tileAnchorX:rt,tileAnchorY:Dt,featureIndex:Rt}=e.get(o);P.textBox={x1:O,y1:k,x2:j,y2:q,padding:ue,projectedAnchorX:Be,projectedAnchorY:tt,projectedAnchorZ:_t,tileAnchorX:rt,tileAnchorY:Dt},P.textFeatureIndex=Rt}if(h<p){const{x1:O,y1:k,x2:j,y2:q,padding:ue,projectedAnchorX:Be,projectedAnchorY:tt,projectedAnchorZ:_t,tileAnchorX:rt,tileAnchorY:Dt,featureIndex:Rt}=e.get(h);P.verticalTextBox={x1:O,y1:k,x2:j,y2:q,padding:ue,projectedAnchorX:Be,projectedAnchorY:tt,projectedAnchorZ:_t,tileAnchorX:rt,tileAnchorY:Dt},P.verticalTextFeatureIndex=Rt}if(g<x){const{x1:O,y1:k,x2:j,y2:q,padding:ue,projectedAnchorX:Be,projectedAnchorY:tt,projectedAnchorZ:_t,tileAnchorX:rt,tileAnchorY:Dt,featureIndex:Rt}=e.get(g);P.iconBox={x1:O,y1:k,x2:j,y2:q,padding:ue,projectedAnchorX:Be,projectedAnchorY:tt,projectedAnchorZ:_t,tileAnchorX:rt,tileAnchorY:Dt},P.iconFeatureIndex=Rt}if(w<T){const{x1:O,y1:k,x2:j,y2:q,padding:ue,projectedAnchorX:Be,projectedAnchorY:tt,projectedAnchorZ:_t,tileAnchorX:rt,tileAnchorY:Dt,featureIndex:Rt}=e.get(w);P.verticalIconBox={x1:O,y1:k,x2:j,y2:q,padding:ue,projectedAnchorX:Be,projectedAnchorY:tt,projectedAnchorZ:_t,tileAnchorX:rt,tileAnchorY:Dt},P.verticalIconFeatureIndex=Rt}return P}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const l=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,o){const l=e.placedSymbolArray.get(o),h=l.vertexStartIndex+4*l.numGlyphs;for(let p=l.vertexStartIndex;p<h;p+=4)e.indexArray.emplaceBack(p,p+1,p+2),e.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const o=Math.sin(e),l=Math.cos(e),h=[],p=[],g=[];for(let x=0;x<this.symbolInstances.length;++x){g.push(x);const w=this.symbolInstances.get(x);h.push(0|Math.round(o*w.tileAnchorX+l*w.tileAnchorY)),p.push(w.featureIndex)}return g.sort((x,w)=>h[x]-h[w]||p[w]-p[x]),g}addToSortKeyRanges(e,o){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===o?l.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const l=this.symbolInstances.get(o);this.featureSortOrder.push(l.featureIndex);const{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:w,verticalPlacedIconSymbolIndex:T}=l;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),p>=0&&p!==h&&this.addIndicesForPlacedSymbol(this.text,p),g>=0&&g!==p&&g!==h&&this.addIndicesForPlacedSymbol(this.text,g),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),w>=0&&this.addIndicesForPlacedSymbol(this.icon,w),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}$i(Kc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Kc.MAX_GLYPHS=65535,Kc.addDynamicAttributes=Ih;const c4=new Mt({"symbol-placement":new Ee(ht.layout_symbol["symbol-placement"]),"symbol-spacing":new Ee(ht.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ee(ht.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new qe(ht.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ee(ht.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ee(ht.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ee(ht.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ee(ht.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ee(ht.layout_symbol["icon-rotation-alignment"]),"icon-size":new qe(ht.layout_symbol["icon-size"]),"icon-text-fit":new Ee(ht.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ee(ht.layout_symbol["icon-text-fit-padding"]),"icon-image":new qe(ht.layout_symbol["icon-image"]),"icon-rotate":new qe(ht.layout_symbol["icon-rotate"]),"icon-padding":new Ee(ht.layout_symbol["icon-padding"]),"icon-keep-upright":new Ee(ht.layout_symbol["icon-keep-upright"]),"icon-offset":new qe(ht.layout_symbol["icon-offset"]),"icon-anchor":new qe(ht.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ee(ht.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ee(ht.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ee(ht.layout_symbol["text-rotation-alignment"]),"text-field":new qe(ht.layout_symbol["text-field"]),"text-font":new qe(ht.layout_symbol["text-font"]),"text-size":new qe(ht.layout_symbol["text-size"]),"text-max-width":new qe(ht.layout_symbol["text-max-width"]),"text-line-height":new qe(ht.layout_symbol["text-line-height"]),"text-letter-spacing":new qe(ht.layout_symbol["text-letter-spacing"]),"text-justify":new qe(ht.layout_symbol["text-justify"]),"text-radial-offset":new qe(ht.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ee(ht.layout_symbol["text-variable-anchor"]),"text-anchor":new qe(ht.layout_symbol["text-anchor"]),"text-max-angle":new Ee(ht.layout_symbol["text-max-angle"]),"text-writing-mode":new Ee(ht.layout_symbol["text-writing-mode"]),"text-rotate":new qe(ht.layout_symbol["text-rotate"]),"text-padding":new Ee(ht.layout_symbol["text-padding"]),"text-keep-upright":new Ee(ht.layout_symbol["text-keep-upright"]),"text-transform":new qe(ht.layout_symbol["text-transform"]),"text-offset":new qe(ht.layout_symbol["text-offset"]),"text-allow-overlap":new Ee(ht.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ee(ht.layout_symbol["text-ignore-placement"]),"text-optional":new Ee(ht.layout_symbol["text-optional"])});var zd={paint:new Mt({"icon-opacity":new qe(ht.paint_symbol["icon-opacity"]),"icon-color":new qe(ht.paint_symbol["icon-color"]),"icon-halo-color":new qe(ht.paint_symbol["icon-halo-color"]),"icon-halo-width":new qe(ht.paint_symbol["icon-halo-width"]),"icon-halo-blur":new qe(ht.paint_symbol["icon-halo-blur"]),"icon-translate":new Ee(ht.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ee(ht.paint_symbol["icon-translate-anchor"]),"text-opacity":new qe(ht.paint_symbol["text-opacity"]),"text-color":new qe(ht.paint_symbol["text-color"],{runtimeType:ur,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new qe(ht.paint_symbol["text-halo-color"]),"text-halo-width":new qe(ht.paint_symbol["text-halo-width"]),"text-halo-blur":new qe(ht.paint_symbol["text-halo-blur"]),"text-translate":new Ee(ht.paint_symbol["text-translate"]),"text-translate-anchor":new Ee(ht.paint_symbol["text-translate-anchor"])}),layout:c4};class Id{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Mr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(e.formattedSection))return o.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}$i(Id,"FormatSectionOverride",{omit:["defaultValue"]});class kd extends Ic{constructor(e){super(e,zd)}recalculate(e,o){super.recalculate(e,o),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const l=this.layout.get("text-writing-mode");if(l){const h=[];for(const p of l)h.indexOf(p)<0&&h.push(p);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,o,l,h){const p=this.layout.get(e).evaluate(o,{},l,h),g=this._unevaluatedLayout._values[e];return g.isDataDriven()||L(g.value)||!p?p:(x=o.properties,p.replace(/{([^{}]+)}/g,(T,P)=>P in x?String(x[P]):""));var x}createBucket(e){return new Kc(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of zd.paint.overridableProperties){if(!kd.hasPaintOverride(this.layout,e))continue;const o=this.paint.get(e),l=new Id(o),h=new ei(l,o.property.specification);let p=null;p="constant"===o.value.kind||"source"===o.value.kind?new X("source",h):new pe("composite",h,o.value.zoomStops,o.value._interpolationType),this.paint._values[e]=new it(o.property,p,o.parameters)}}_handleOverridablePaintPropertyUpdate(e,o,l){return!(!this.layout||o.isDataDriven()||l.isDataDriven())&&kd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,o){const l=e.get("text-field"),h=zd.paint.properties[o];let p=!1;const g=x=>{for(const w of x)if(h.overrides&&h.overrides.hasOverride(w))return void(p=!0)};if("constant"===l.value.kind&&l.value.value instanceof gs)g(l.value.value.sections);else if("source"===l.value.kind){const x=T=>{p||(T instanceof Io&&xo(T.value)===mr?g(T.value.sections):T instanceof vo?g(T.sections):T.eachChild(x))},w=l.value;w._styleExpression&&x(w._styleExpression.expression)}return p}getProgramConfiguration(e){return new Ml(this,e)}}var L3={paint:new Mt({"background-color":new Ee(ht.paint_background["background-color"]),"background-pattern":new Ee(ht.paint_background["background-pattern"]),"background-opacity":new Ee(ht.paint_background["background-opacity"])})},R3={paint:new Mt({"raster-opacity":new Ee(ht.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ee(ht.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ee(ht.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ee(ht.paint_raster["raster-brightness-max"]),"raster-saturation":new Ee(ht.paint_raster["raster-saturation"]),"raster-contrast":new Ee(ht.paint_raster["raster-contrast"]),"raster-resampling":new Ee(ht.paint_raster["raster-resampling"]),"raster-fade-duration":new Ee(ht.paint_raster["raster-fade-duration"])})};class G2 extends Ic{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var F3={paint:new Mt({"sky-type":new Ee(ht.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ee(ht.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ee(ht.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ee(ht.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ee(ht.paint_sky["sky-gradient-radius"]),"sky-gradient":new yt(ht.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ee(ht.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ee(ht.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ee(ht.paint_sky["sky-opacity"])})};function u4(i,e,o){const l=[0,0,1],h=a0([]);return $h(h,h,o?-je(i)+Math.PI:je(i)),Z4(h,h,-je(e)),Yh(l,l,h),Tl(l,l)}const N3={circle:class extends Ic{constructor(i){super(i,h2)}createBucket(i){return new _h(i)}queryRadius(i){const e=i;return yh("circle-radius",this,e)+yh("circle-stroke-width",this,e)+Z1(this.paint.get("circle-translate"))}queryIntersectsFeature(i,e,o,l,h,p,g,x){const w=c2(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),T=this.paint.get("circle-radius").evaluate(e,o)+this.paint.get("circle-stroke-width").evaluate(e,o);return b0(i,l,p,g,x,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),w,T)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new Ml(this,i)}},heatmap:class extends Ic{createBucket(i){return new M0(i)}constructor(i){super(i,L8),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){"heatmap-color"===i&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Q1({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return yh("heatmap-radius",this,i)}queryIntersectsFeature(i,e,o,l,h,p,g,x){const w=this.paint.get("heatmap-radius").evaluate(e,o);return b0(i,l,p,g,x,!0,!0,new et(0,0),w)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new Ml(this,i)}},hillshade:class extends Ic{constructor(i){super(i,Wf)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Ic{constructor(i){super(i,e3)}getProgramIds(){const i=this.paint.get("fill-pattern"),e=i&&i.constantOr(1),o=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getProgramConfiguration(i){return new Ml(this,i)}recalculate(i,e){super.recalculate(i,e);const o=this.paint._values["fill-outline-color"];"constant"===o.value.kind&&void 0===o.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new wh(i)}queryRadius(){return Z1(this.paint.get("fill-translate"))}queryIntersectsFeature(i,e,o,l,h,p){return!i.queryGeometry.isAboveHorizon&&Al(l2(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),l)}isTileClipped(){return!0}},"fill-extrusion":class extends Ic{constructor(i){super(i,o3)}createBucket(i){return new hd(i)}queryRadius(){return Z1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new Ml(this,i)}queryIntersectsFeature(i,e,o,l,h,p,g,x,w){const T=c2(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),P=this.paint.get("fill-extrusion-height").evaluate(e,o),O=this.paint.get("fill-extrusion-base").evaluate(e,o),k=[0,0],j=x&&p.elevation,q=p.elevation?p.elevation.exaggeration():1,ue=i.tile.getBucket(this);if(j&&ue instanceof hd){const Dt=ue.centroidVertexArray,Rt=w+1;Rt<Dt.length&&(k[0]=Dt.geta_centroid_pos0(Rt),k[1]=Dt.geta_centroid_pos1(Rt))}if(0===k[0]&&1===k[1])return!1;"globe"===p.projection.name&&(l=E2([l],[new et(0,0),new et(dr,dr)],i.tileID.canonical).map(Dt=>Dt.polygon).flat());const Be=j?x:null,[tt,_t]=(Rt=l,Vt=O,bn=P,_n=T,Vn=g,hi=Be,En=k,Kn=q,Gn=p.center.lat,"globe"===(Dt=p).projection.name?function(pi,kn,Ii,qi,Li,Xr,yi,gr,jr,zo,Qr){const zr=[],ws=[],to=pi.projection.upVectorScale(Qr,pi.center.lat,pi.worldSize).metersToTile,Wr=[0,0,0,1],Ho=[0,0,0,1],fs=(Zo,Gs,ra,Ta)=>{Zo[0]=Gs,Zo[1]=ra,Zo[2]=Ta,Zo[3]=1},ns=M2();Ii>0&&(Ii+=ns),qi+=ns;for(const Zo of kn){const Gs=[],ra=[];for(const Ta of Zo){const is=Ta.x+Li.x,La=Ta.y+Li.y,pa=pi.projection.projectTilePoint(is,La,Qr),Ws=pi.projection.upVector(Qr,Ta.x,Ta.y);let Oo=Ii,ma=qi;if(yi){const ps=D2(is,La,Ii,qi,yi,gr,jr,zo);Oo+=ps.base,ma+=ps.top}0!==Ii?fs(Wr,pa.x+Ws[0]*to*Oo,pa.y+Ws[1]*to*Oo,pa.z+Ws[2]*to*Oo):fs(Wr,pa.x,pa.y,pa.z),fs(Ho,pa.x+Ws[0]*to*ma,pa.y+Ws[1]*to*ma,pa.z+Ws[2]*to*ma),ia(Wr,Wr,Xr),ia(Ho,Ho,Xr),Gs.push(new Mh(Wr[0],Wr[1],Wr[2])),ra.push(new Mh(Ho[0],Ho[1],Ho[2]))}zr.push(Gs),ws.push(ra)}return[zr,ws]}(Dt,Rt,Vt,bn,_n,Vn,hi,En,Kn,Gn,i.tileID.canonical):hi?function(pi,kn,Ii,qi,Li,Xr,yi,gr,jr){const zo=[],Qr=[],zr=[0,0,0,1];for(const ws of pi){const to=[],Wr=[];for(const Ho of ws){const fs=Ho.x+qi.x,ns=Ho.y+qi.y,Zo=D2(fs,ns,kn,Ii,Xr,yi,gr,jr);zr[0]=fs,zr[1]=ns,zr[2]=Zo.base,zr[3]=1,_u(zr,zr,Li),zr[3]=Math.max(zr[3],1e-5);const Gs=new Mh(zr[0]/zr[3],zr[1]/zr[3],zr[2]/zr[3]);zr[0]=fs,zr[1]=ns,zr[2]=Zo.top,zr[3]=1,_u(zr,zr,Li),zr[3]=Math.max(zr[3],1e-5);const ra=new Mh(zr[0]/zr[3],zr[1]/zr[3],zr[2]/zr[3]);to.push(Gs),Wr.push(ra)}zo.push(to),Qr.push(Wr)}return[zo,Qr]}(Rt,Vt,bn,_n,Vn,hi,En,Kn,Gn):function(pi,kn,Ii,qi,Li){const Xr=[],yi=[],gr=Li[8]*kn,jr=Li[9]*kn,zo=Li[10]*kn,Qr=Li[11]*kn,zr=Li[8]*Ii,ws=Li[9]*Ii,to=Li[10]*Ii,Wr=Li[11]*Ii;for(const Ho of pi){const fs=[],ns=[];for(const Zo of Ho){const Gs=Zo.x+qi.x,ra=Zo.y+qi.y,Ta=Li[0]*Gs+Li[4]*ra+Li[12],is=Li[1]*Gs+Li[5]*ra+Li[13],La=Li[2]*Gs+Li[6]*ra+Li[14],pa=Li[3]*Gs+Li[7]*ra+Li[15],Ws=Ta+gr,Oo=is+jr,ma=La+zo,ps=Math.max(pa+Qr,1e-5),ql=Ta+zr,As=is+ws,Ra=La+to,il=Math.max(pa+Wr,1e-5);fs.push(new Mh(Ws/ps,Oo/ps,ma/ps)),ns.push(new Mh(ql/il,As/il,Ra/il))}Xr.push(fs),yi.push(ns)}return[Xr,yi]}(Rt,Vt,bn,_n,Vn)),rt=i.queryGeometry;var Dt,Rt,Vt,bn,_n,Vn,hi,En,Kn,Gn;return function(Dt,Rt,Vt){let bn=1/0;Al(Vt,Rt)&&(bn=T2(Vt,Rt[0]));for(let _n=0;_n<Rt.length;_n++){const Vn=Rt[_n],hi=Dt[_n];for(let En=0;En<Vn.length-1;En++){const Kn=Vn[En],Gn=[Kn,Vn[En+1],hi[En+1],hi[En],Kn];g0(Vt,Gn)&&(bn=Math.min(bn,T2(Vt,Gn)))}}return bn!==1/0&&bn}(tt,_t,rt.isPointQuery()?rt.screenBounds:rt.screenGeometry)}},line:class extends Ic{constructor(i){super(i,N0),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if("line-gradient"===i){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Wo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(i,e){super.recalculate(i,e),this.paint._values["line-floorwidth"]=V0.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Cc(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new Ml(this,i)}queryRadius(i){const e=i,o=B0(yh("line-width",this,e),yh("line-gap-width",this,e)),l=yh("line-offset",this,e);return o/2+Math.abs(l)+Z1(this.paint.get("line-translate"))}queryIntersectsFeature(i,e,o,l,h,p){if(i.queryGeometry.isAboveHorizon)return!1;const g=l2(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),x=i.pixelToTileUnitsFactor/2*B0(this.paint.get("line-width").evaluate(e,o),this.paint.get("line-gap-width").evaluate(e,o)),w=this.paint.get("line-offset").evaluate(e,o);return w&&(l=function(T,P){const O=[],k=new et(0,0);for(let j=0;j<T.length;j++){const q=T[j],ue=[];for(let Be=0;Be<q.length;Be++){const tt=q[Be],_t=q[Be+1],rt=0===Be?k:tt.sub(q[Be-1])._unit()._perp(),Dt=Be===q.length-1?k:_t.sub(tt)._unit()._perp(),Rt=rt._add(Dt)._unit();Rt._mult(1/(Rt.x*Dt.x+Rt.y*Dt.y)),ue.push(Rt._mult(P)._add(tt))}O.push(ue)}return O}(l,w*i.pixelToTileUnitsFactor)),function(T,P,O){for(let k=0;k<P.length;k++){const j=P[k];if(T.length>=3)for(let q=0;q<j.length;q++)if(wu(T,j[q]))return!0;if(Xh(T,j,O))return!0}return!1}(g,l,x)}isTileClipped(){return!0}},symbol:kd,background:class extends Ic{constructor(i){super(i,L3)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ic{constructor(i){super(i,R3)}getProgramIds(){return["raster"]}},sky:class extends Ic{constructor(i){super(i,F3),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){"sky-gradient"===i?this._updateColorRamp():"sky-atmosphere-sun"!==i&&"sky-atmosphere-halo-color"!==i&&"sky-atmosphere-color"!==i&&"sky-atmosphere-sun-intensity"!==i||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Q1({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(i,e){if("atmosphere"===this.paint.get("sky-type")){const l=this.paint.get("sky-atmosphere-sun"),h=!l,p=i.style.light,g=p.properties.get("position");return h&&"viewport"===p.properties.get("anchor")&&Si("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?u4(g.azimuthal,90-g.polar,e):u4(l[0],90-l[1],e)}const o=this.paint.get("sky-gradient-center");return u4(o[0],90-o[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return"atmosphere"===i?["skyboxCapture","skybox"]:"gradient"===i?["skyboxGradient"]:null}}};class E1{constructor(e,o,l,h){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(o,h)}update(e,o,l){const{width:h,height:p}=e,{context:g}=this,{gl:x}=g,{HTMLImageElement:w,HTMLCanvasElement:T,HTMLVideoElement:P,ImageData:O,ImageBitmap:k}=se;if(x.bindTexture(x.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA&&(!o||!1!==o.premultiply)),l||this.size&&this.size[0]===h&&this.size[1]===p){const{x:j,y:q}=l||{x:0,y:0};e instanceof w||e instanceof T||e instanceof P||e instanceof O||k&&e instanceof k?x.texSubImage2D(x.TEXTURE_2D,0,j,q,x.RGBA,x.UNSIGNED_BYTE,e):x.texSubImage2D(x.TEXTURE_2D,0,j,q,h,p,x.RGBA,x.UNSIGNED_BYTE,e.data)}else this.size=[h,p],e instanceof w||e instanceof T||e instanceof P||e instanceof O||k&&e instanceof k?x.texImage2D(x.TEXTURE_2D,0,this.format,this.format,x.UNSIGNED_BYTE,e):x.texImage2D(x.TEXTURE_2D,0,this.format,h,p,0,this.format,x.UNSIGNED_BYTE,e.data);this.useMipmap=!!(o&&o.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(e,o){const{context:l}=this,{gl:h}=l;h.bindTexture(h.TEXTURE_2D,this.texture),e!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?e===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:e),this.filter=e),o!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,o),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class W2{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class h4{constructor(){this.tasks={},this.taskQueue=[],jn(["process"],this),this.invoker=new W2(this.process),this.nextId=0}add(e,o){const l=this.nextId++,h=function({type:p,isSymbolTile:g,zoom:x}){return x=x||0,"message"===p?0:"maybePrepare"!==p||g?"parseTile"!==p||g?"parseTile"===p&&g?300-x:"maybePrepare"===p&&g?400-x:500:200-x:100-x}(o);if(0===h){ji();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[l]={fn:e,metadata:o,priority:h,id:l},this.taskQueue.push(l),this.invoker.trigger(),{cancel:()=>{delete this.tasks[l]}}}process(){ji();try{if(this.taskQueue=this.taskQueue.filter(l=>!!this.tasks[l]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const o=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let e=null,o=1/0;for(let h=0;h<this.taskQueue.length;h++){const p=this.tasks[this.taskQueue[h]];p.priority<o&&(o=p.priority,e=h)}if(null===e)return null;const l=this.taskQueue[e];return this.taskQueue.splice(e,1),l}remove(){this.invoker.remove()}}class d4{constructor(e){this._stringToNumber={},this._numberToString=[];for(let o=0;o<e.length;o++){const l=e[o];this._stringToNumber[l]=o,this._numberToString[o]=l}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const V3=["tile","layer","source","sourceLayer","state"];class Wl{constructor(e,o,l,h,p){this.type="Feature",this._vectorTileFeature=e,this._z=o,this._x=l,this._y=h,this.properties=e.properties,this.id=p}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const o of V3)void 0!==this[o]&&(e[o]=this[o]);return e}}const oh=new Uint16Array(8184);for(let i=0;i<2046;i++){let e=i+2,o=0,l=0,h=0,p=0,g=0,x=0;for(1&e?h=p=g=32:o=l=x=32;(e>>=1)>1;){const T=o+h>>1,P=l+p>>1;1&e?(h=o,p=l,o=g,l=x):(o=h,l=p,h=g,p=x),g=T,x=P}const w=4*i;oh[w+0]=o,oh[w+1]=l,oh[w+2]=h,oh[w+3]=p}const Sc=new Uint16Array(2178),du=new Uint8Array(1089),Od=new Uint16Array(1089);function K2(i){return 0===i?-.03125:32===i?.03125:0}var f4=Zt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const p4={type:2,extent:dr,loadGeometry:()=>[[new et(0,0),new et(dr+1,0),new et(dr+1,dr+1),new et(0,dr+1),new et(0,0)]]};class m4{constructor(e,o,l,h,p){this.tileID=e,this.uid=Jt(),this.uses=0,this.tileSize=o,this.tileZoom=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(e){const o=e+this.timeAdded;o<mo.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=cu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,o,l){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,p){const g={};if(!p)return g;for(const x of h){const w=x.layerIds.map(T=>p.getLayer(T)).filter(Boolean);if(0!==w.length){x.layers=w,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(T=>w.filter(P=>P.id===T)[0]));for(const T of w)g[T.id]=x}}return g}(e.buckets,o.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const p=this.buckets[h];if(p instanceof Kc){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const p=this.buckets[h];if(p instanceof Kc&&p.hasRTLText){this.hasRTLText=!0,z.isLoading()||z.isLoaded()||"deferred"!==b()||S();break}}this.queryPadding=0;for(const h in this.buckets){const p=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(h).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Ko}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const h=this.buckets[l];h.uploadPending()&&h.upload(e)}const o=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new E1(e,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new E1(e,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new E1(e,this.lineAtlas.image,o.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,o,l,h,p,g,x,w){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:x,transform:g,params:p,tileTransform:this.tileTransform},e,o,l):{}}querySourceFeatures(e,o){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const h=l.loadVTLayers(),p=o?o.sourceLayer:"",g=h._geojsonTileLayer||h[p];if(!g)return;const x=In(o&&o.filter),{z:w,x:T,y:P}=this.tileID.canonical,O={z:w,x:T,y:P};for(let k=0;k<g.length;k++){const j=g.feature(k);if(x.needGeometry){const Be=qu(j,!0);if(!x.filter(new U(this.tileID.overscaledZ),Be,this.tileID.canonical))continue}else if(!x.filter(new U(this.tileID.overscaledZ),j))continue;const q=l.getId(j,p),ue=new Wl(j,w,T,P,q);ue.tile=O,e.push(ue)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const o=this.expirationTime;if(e.cacheControl){const l=Ln(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let h=!1;if(this.expirationTime>l)h=!1;else if(o)if(this.expirationTime<o)h=!0;else{const p=this.expirationTime-o;p?this.expirationTime=l+Math.max(p,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!o)return;const l=this.latestFeatureIndex.loadVTLayers(),h=o.style.listImages();for(const p in this.buckets){if(!o.style.hasLayer(p))continue;const g=this.buckets[p],x=g.layers[0].sourceLayer||"_geojsonTileLayer",w=l[x],T=e[x];if(!w||!T||0===Object.keys(T).length)continue;if(g.update(T,w,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),g instanceof Cc||g instanceof wh){const O=o.style._getSourceCache(g.layers[0].source);o._terrain&&o._terrain.enabled&&O&&g.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(O.id,this.tileID)}const P=o&&o.style&&o.style.getLayer(p);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(g)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<mo.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=mo.now()+e}setTexture(e,o){const l=o.context,h=l.gl;this.texture=this.texture||o.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new E1(l,e,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE))}setDependencies(e,o){const l={};for(const h of o)l[h]=!0;this.dependencies[e]=l}hasDependency(e,o){for(const l of e){const h=this.dependencies[l];if(h)for(const p of o)if(h[p])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,o){if(!o||"mercator"===o.name||this._tileDebugBuffer)return;const l=$c(p4,this.tileID.canonical,this.tileTransform)[0],h=new li,p=new bl;for(let g=0;g<l.length;g++){const{x,y:w}=l[g];h.emplaceBack(x,w),p.emplaceBack(g)}p.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(p),this._tileDebugBuffer=e.createVertexBuffer(h,Uc.members),this._tileDebugSegments=na.simpleSegment(0,0,h.length,p.length)}_makeTileBoundsBuffers(e,o){if(this._tileBoundsBuffer||!o||"mercator"===o.name)return;const l=$c(p4,this.tileID.canonical,this.tileTransform)[0];let h,p;if(this.isRaster){const g=function(x,w){const T=cu(x,w),P=Math.pow(2,x.z);for(let Be=0;Be<33;Be++)for(let tt=0;tt<33;tt++){const _t=Ea((x.x+(tt+K2(tt))/32)/P),rt=dl((x.y+(Be+K2(Be))/32)/P),Dt=w.project(_t,rt),Rt=33*Be+tt;Sc[2*Rt+0]=Math.round((Dt.x*T.scale-T.x)*dr),Sc[2*Rt+1]=Math.round((Dt.y*T.scale-T.y)*dr)}du.fill(0),Od.fill(0);for(let Be=2045;Be>=0;Be--){const tt=4*Be,_t=oh[tt+0],rt=oh[tt+1],Dt=oh[tt+2],Rt=oh[tt+3],Vt=_t+Dt>>1,bn=rt+Rt>>1,_n=Vt+bn-rt,Vn=bn+_t-Vt,hi=33*rt+_t,En=33*Rt+Dt,Kn=33*bn+Vt,Gn=Math.hypot((Sc[2*hi+0]+Sc[2*En+0])/2-Sc[2*Kn+0],(Sc[2*hi+1]+Sc[2*En+1])/2-Sc[2*Kn+1])>=16;du[Kn]=du[Kn]||(Gn?1:0),Be<1022&&(du[Kn]=du[Kn]||du[33*(rt+Vn>>1)+(_t+_n>>1)]||du[33*(Rt+Vn>>1)+(Dt+_n>>1)])}const O=new Fn,k=new Qi;let j=0;function q(Be,tt){const _t=33*tt+Be;return 0===Od[_t]&&(O.emplaceBack(Sc[2*_t+0],Sc[2*_t+1],Be*dr/32,tt*dr/32),Od[_t]=++j),Od[_t]-1}function ue(Be,tt,_t,rt,Dt,Rt){const Vt=Be+_t>>1,bn=tt+rt>>1;if(Math.abs(Be-Dt)+Math.abs(tt-Rt)>1&&du[33*bn+Vt])ue(Dt,Rt,Be,tt,Vt,bn),ue(_t,rt,Dt,Rt,Vt,bn);else{const _n=q(Be,tt),Vn=q(_t,rt),hi=q(Dt,Rt);k.emplaceBack(_n,Vn,hi)}}return ue(0,0,32,32,32,0),ue(32,32,0,0,0,32),{vertices:O,indices:k}}(this.tileID.canonical,o);h=g.vertices,p=g.indices}else{h=new Fn,p=new Qi;for(const{x,y:w}of l)h.emplaceBack(x,w,0,0);const g=t1(h.int16,void 0,4);for(let x=0;x<g.length;x+=3)p.emplaceBack(g[x],g[x+1],g[x+2])}this._tileBoundsBuffer=e.createVertexBuffer(h,f4.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(p),this._tileBoundsSegments=na.simpleSegment(0,0,h.length,p.length)}_makeGlobeTileDebugBuffers(e,o){const l=o.projection;if(!l||"globe"!==l.name||o.freezeTileCoverage)return;const h=this.tileID.canonical,p=ac(d0(h,o)),g=gh(o.zoom);let x;g>0&&(x=O1(new Float64Array(16),o.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,h,o,p,x,g),this._makeGlobeTileDebugTextBuffer(e,h,o,p,x,g)}_globePoint(e,o,l,h,p,g,x){let w=mh(e,o,l);if(g){const T=1<<l.z,P=wc(h.center.lng),O=Yc(h.center.lat),k=(l.x+.5)/T-P;let j=0;k>.5?j=-1:k<-.5&&(j=1);let q=(e/dr+l.x)/T+j,ue=(o/dr+l.y)/T;q=(q-P)*h._pixelsPerMercatorPixel+P,ue=(ue-O)*h._pixelsPerMercatorPixel+O;const Be=[q*h.worldSize,ue*h.worldSize,0];ia(Be,Be,g),w=xu(w,Be,x)}return ia(w,w,p)}_makeGlobeTileDebugBorderBuffer(e,o,l,h,p,g){const x=new li,w=new bl,T=new fn,P=(k,j,q,ue,Be)=>{const tt=(q-k)/(Be-1),_t=(ue-j)/(Be-1),rt=x.length;for(let Dt=0;Dt<Be;Dt++){const Rt=k+Dt*tt,Vt=j+Dt*_t;x.emplaceBack(Rt,Vt);const bn=this._globePoint(Rt,Vt,o,l,h,p,g);T.emplaceBack(bn[0],bn[1],bn[2]),w.emplaceBack(rt+Dt)}},O=dr;P(0,0,O,0,16),P(O,0,O,O,16),P(O,O,0,O,16),P(0,O,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(w),this._tileDebugBuffer=e.createVertexBuffer(x,Uc.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(T,c0.members),this._tileDebugSegments=na.simpleSegment(0,0,x.length,w.length)}_makeGlobeTileDebugTextBuffer(e,o,l,h,p,g){const x=dr/4,w=new li,T=new Qi,P=new fn,O=25;T.reserve(32),w.reserve(O),P.reserve(O);const k=(j,q)=>O*j+q;for(let j=0;j<O;j++){const q=j*x;for(let ue=0;ue<O;ue++){const Be=ue*x;w.emplaceBack(Be,q);const tt=this._globePoint(Be,q,o,l,h,p,g);P.emplaceBack(tt[0],tt[1],tt[2])}}for(let j=0;j<4;j++)for(let q=0;q<4;q++){const ue=k(j,q),Be=k(j,q+1),tt=k(j+1,q),_t=k(j+1,q+1);T.emplaceBack(ue,Be,tt),T.emplaceBack(tt,Be,_t)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(T),this._tileDebugTextBuffer=e.createVertexBuffer(w,Uc.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(P,c0.members),this._tileDebugTextSegments=na.simpleSegment(0,0,O,32)}}class B3{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,o,l){const h=String(o);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},$n(this.stateChanges[e][h],l),null===this.deletedStates[e]){this.deletedStates[e]={};for(const p in this.state[e])p!==h&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][h]){this.deletedStates[e][h]={};for(const p in this.state[e][h])l[p]||(this.deletedStates[e][h][p]=null)}else for(const p in l)this.deletedStates[e]&&this.deletedStates[e][h]&&null===this.deletedStates[e][h][p]&&delete this.deletedStates[e][h][p]}removeFeatureState(e,o,l){if(null===this.deletedStates[e])return;const h=String(o);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&void 0!==o)null!==this.deletedStates[e][h]&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][l]=null);else if(void 0!==o)if(this.stateChanges[e]&&this.stateChanges[e][h])for(l in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][l]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,o){const l=String(o),h=$n({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const p=this.deletedStates[e][o];if(null===p)return{};for(const g in p)delete h[g]}return h}initializeTileState(e,o){e.setFeatureState(this.state,o)}coalesceChanges(e,o){const l={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const p={};for(const g in this.stateChanges[h])this.state[h][g]||(this.state[h][g]={}),$n(this.state[h][g],this.stateChanges[h][g]),p[g]=this.state[h][g];l[h]=p}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const p={};if(null===this.deletedStates[h])for(const g in this.state[h])p[g]={},this.state[h][g]={};else for(const g in this.deletedStates[h]){if(null===this.deletedStates[h][g])this.state[h][g]={};else if(this.state[h][g])for(const x of Object.keys(this.deletedStates[h][g]))delete this.state[h][g][x];p[g]=this.state[h][g]}l[h]=l[h]||{},$n(l[h],p)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(l).length)for(const h in e)e[h].setFeatureState(l,o)}}class Ld{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,o){const l=this.toIdx(e,o);return{min:this.minimums[l],max:this.maximums[l]}}isLeaf(e,o){return this.leaves[this.toIdx(e,o)]}toIdx(e,o){return o*this.size+e}}function q2(i,e,o,l){let h=0,p=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(l[g])<1e-15){if(o[g]<i[g]||o[g]>e[g])return null}else{const x=1/l[g];let w=(i[g]-o[g])*x,T=(e[g]-o[g])*x;if(w>T){const P=w;w=T,T=P}if(w>h&&(h=w),T<p&&(p=T),h>p)return null}return h}function Z2(i,e,o,l,h,p,g,x,w,T,P){const O=l-i,k=h-e,j=p-o,q=g-i,ue=x-e,Be=w-o,tt=P[1]*Be-P[2]*ue,_t=P[2]*q-P[0]*Be,rt=P[0]*ue-P[1]*q,Dt=O*tt+k*_t+j*rt;if(Math.abs(Dt)<1e-15)return null;const Rt=1/Dt,Vt=T[0]-i,bn=T[1]-e,_n=T[2]-o,Vn=(Vt*tt+bn*_t+_n*rt)*Rt;if(Vn<0||Vn>1)return null;const hi=bn*j-_n*k,En=_n*O-Vt*j,Kn=Vt*k-bn*O,Gn=(P[0]*hi+P[1]*En+P[2]*Kn)*Rt;return Gn<0||Vn+Gn>1?null:(q*hi+ue*En+Be*Kn)*Rt}function X2(i,e,o){return(i-e)/(o-e)}function Q2(i,e,o,l,h,p,g,x,w){const T=1<<o,P=p-l,O=g-h,k=(i+1)/T*P+l,j=(e+0)/T*O+h,q=(e+1)/T*O+h;x[0]=(i+0)/T*P+l,x[1]=j,w[0]=k,w[1]=q}class J2{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(p){const g=Math.ceil(Math.log2(p.dim/8)),x=[];let w=Math.ceil(Math.pow(2,g));const T=1/w,P=(j,q,ue,Be,tt)=>{const _t=Be?1:0,rt=(j+1)*ue-_t,Dt=q*ue,Rt=(q+1)*ue-_t;tt[0]=j*ue,tt[1]=Dt,tt[2]=rt,tt[3]=Rt};let O=new Ld(w);const k=[];for(let j=0;j<w*w;j++){P(j%w,Math.floor(j/w),T,!1,k);const q=Zc(k[0],k[1],p),ue=Zc(k[2],k[1],p),Be=Zc(k[2],k[3],p),tt=Zc(k[0],k[3],p);O.minimums.push(Math.min(q,ue,Be,tt)),O.maximums.push(Math.max(q,ue,Be,tt)),O.leaves.push(1)}for(x.push(O),w/=2;w>=1;w/=2){const j=x[x.length-1];O=new Ld(w);for(let q=0;q<w*w;q++){P(q%w,Math.floor(q/w),2,!0,k);const ue=j.getElevation(k[0],k[1]),Be=j.getElevation(k[2],k[1]),tt=j.getElevation(k[2],k[3]),_t=j.getElevation(k[0],k[3]),rt=j.isLeaf(k[0],k[1]),Dt=j.isLeaf(k[2],k[1]),Rt=j.isLeaf(k[2],k[3]),Vt=j.isLeaf(k[0],k[3]),bn=Math.min(ue.min,Be.min,tt.min,_t.min),_n=Math.max(ue.max,Be.max,tt.max,_t.max),Vn=rt&&Dt&&Rt&&Vt;O.maximums.push(_n),O.minimums.push(bn),O.leaves.push(_n-bn<=5&&Vn?1:0)}x.push(O)}return x}(this.dem),l=o.length-1,h=o[l];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(o,0,0,l,0)}raycastRoot(e,o,l,h,p,g,x=1){return q2([e,o,-100],[l,h,this.maximums[0]*x],p,g)}raycast(e,o,l,h,p,g,x=1){if(!this.nodeCount)return null;const w=this.raycastRoot(e,o,l,h,p,g,x);if(null==w)return null;const T=[],P=[],O=[],k=[],j=[{idx:0,t:w,nodex:0,nodey:0,depth:0}];for(;j.length>0;){const{idx:q,t:ue,nodex:Be,nodey:tt,depth:_t}=j.pop();if(this.leaves[q]){Q2(Be,tt,_t,e,o,l,h,O,k);const Dt=1<<_t,Rt=(Be+0)/Dt,Vt=(Be+1)/Dt,bn=(tt+0)/Dt,_n=(tt+1)/Dt,Vn=Zc(Rt,bn,this.dem)*x,hi=Zc(Vt,bn,this.dem)*x,En=Zc(Vt,_n,this.dem)*x,Kn=Zc(Rt,_n,this.dem)*x,Gn=Z2(O[0],O[1],Vn,k[0],O[1],hi,k[0],k[1],En,p,g),oi=Z2(k[0],k[1],En,O[0],k[1],Kn,O[0],O[1],Vn,p,g),pi=Math.min(null!==Gn?Gn:Number.MAX_VALUE,null!==oi?oi:Number.MAX_VALUE);if(pi!==Number.MAX_VALUE)return pi;{const kn=fh([],p,g,ue);if(Fc(Vn,hi,Kn,En,X2(kn[0],O[0],k[0]),X2(kn[1],O[1],k[1]))>=kn[2])return ue}continue}let rt=0;for(let Dt=0;Dt<this._siblingOffset.length;Dt++){Q2((Be<<1)+this._siblingOffset[Dt][0],(tt<<1)+this._siblingOffset[Dt][1],_t+1,e,o,l,h,O,k),O[2]=-100,k[2]=this.maximums[this.childOffsets[q]+Dt]*x;const Rt=q2(O,k,p,g);if(null!=Rt){const Vt=Rt;T[Dt]=Vt;let bn=!1;for(let _n=0;_n<rt&&!bn;_n++)Vt>=T[P[_n]]&&(P.splice(_n,0,Dt),bn=!0);bn||(P[rt]=Dt),rt++}}for(let Dt=0;Dt<rt;Dt++){const Rt=P[Dt];j.push({idx:this.childOffsets[q]+Rt,t:T[Rt],nodex:(Be<<1)+this._siblingOffset[Rt][0],nodey:(tt<<1)+this._siblingOffset[Rt][1],depth:_t+1})}}return null}_addNode(e,o,l){return this.minimums.push(e),this.maximums.push(o),this.leaves.push(l),this.childOffsets.push(0),this.nodeCount++}_construct(e,o,l,h,p){if(1===e[h].isLeaf(o,l))return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const g=h-1,x=e[g];let w=0,T=0;for(let P=0;P<this._siblingOffset.length;P++){const O=2*o+this._siblingOffset[P][0],k=2*l+this._siblingOffset[P][1],j=x.getElevation(O,k),q=x.isLeaf(O,k),ue=this._addNode(j.min,j.max,q);q&&(w|=1<<P),T||(T=ue)}for(let P=0;P<this._siblingOffset.length;P++)w&1<<P||this._construct(e,2*o+this._siblingOffset[P][0],2*l+this._siblingOffset[P][1],g,T+P)}}function Fc(i,e,o,l,h,p){return Hr(Hr(i,o,p),Hr(e,l,p),h)}function Zc(i,e,o){const l=o.dim,h=an(i*l-.5,0,l-1),p=an(e*l-.5,0,l-1),g=Math.floor(h),x=Math.floor(p),w=Math.min(g+1,l-1),T=Math.min(x+1,l-1);return Fc(o.get(g,x),o.get(w,x),o.get(g,T),o.get(w,T),h-g,p-x)}const ef={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function H3(i,e,o){return(256*i*256+256*e+o)/10-1e4}function tf(i,e,o){return 256*i+e+o/256-32768}class C1{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,o,l,h=!1,p=!1){if(this.uid=e,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(l&&"mapbox"!==l&&"terrarium"!==l)return Si(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const g=this.dim=o.height-2,x=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.encoding=l||"mapbox",this.borderReady=h,!h){for(let w=0;w<g;w++)x[this._idx(-1,w)]=x[this._idx(0,w)],x[this._idx(g,w)]=x[this._idx(g-1,w)],x[this._idx(w,-1)]=x[this._idx(w,0)],x[this._idx(w,g)]=x[this._idx(w,g-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(g,-1)]=x[this._idx(g-1,0)],x[this._idx(-1,g)]=x[this._idx(0,g-1)],x[this._idx(g,g)]=x[this._idx(g-1,g-1)],p&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new J2(this)}get(e,o,l=!1){l&&(e=an(e,-1,this.dim),o=an(o,-1,this.dim));const h=4*this._idx(e,o);return("terrarium"===this.encoding?tf:H3)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(e){return ef[e]}get unpackVector(){return ef[this.encoding]}_idx(e,o){if(e<-1||e>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(e+1)}static pack(e,o){const l=[0,0,0,0],h=C1.getUnpackVector(o);let p=Math.floor((e+h[3])/h[2]);return l[2]=p%256,p=Math.floor(p/256),l[1]=p%256,p=Math.floor(p/256),l[0]=p,l}getPixels(){return new Gl({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,o,l){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=o*this.dim,p=o*this.dim+this.dim,g=l*this.dim,x=l*this.dim+this.dim;switch(o){case-1:h=p-1;break;case 1:p=h+1}switch(l){case-1:g=x-1;break;case 1:x=g+1}const w=-o*this.dim,T=-l*this.dim;for(let P=g;P<x;P++)for(let O=h;O<p;O++){const k=4*this._idx(O,P),j=4*this._idx(O+w,P+T);this.pixels[k+0]=e.pixels[j+0],this.pixels[k+1]=e.pixels[j+1],this.pixels[k+2]=e.pixels[j+2],this.pixels[k+3]=e.pixels[j+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}$i(C1,"DEMData"),$i(J2,"DemMinMaxQuadTree",{omit:["dem"]});class Rd{constructor(e,o){this.max=e,this.onRemove=o,this.reset()}reset(){for(const e in this.data)for(const o of this.data[e])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(e,o,l){const h=e.wrapped().key;void 0===this.data[h]&&(this.data[h]=[]);const p={value:o,timeout:void 0};if(void 0!==l&&(p.timeout=setTimeout(()=>{this.remove(e,p)},l)),this.data[h].push(p),this.order.push(h),this.order.length>this.max){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const o=this.data[e].shift();return o.timeout&&clearTimeout(o.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),o.value}getByKey(e){const o=this.data[e];return o?o[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,o){if(!this.has(e))return this;const l=e.wrapped().key,h=void 0===o?0:this.data[l].indexOf(o),p=this.data[l][h];return this.data[l].splice(h,1),p.timeout&&clearTimeout(p.timeout),0===this.data[l].length&&delete this.data[l],this.onRemove(p.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(e){const o=[];for(const l in this.data)for(const h of this.data[l])e(h.value)||o.push(h);for(const l of o)this.remove(l.value.tileID,l)}}class ku{constructor(e,o,l){this.func=e,this.mask=o,this.range=l}}ku.ReadOnly=!1,ku.ReadWrite=!0,ku.disabled=new ku(519,ku.ReadOnly,[0,1]);class Fd{constructor(e,o,l,h,p,g){this.test=e,this.ref=o,this.mask=l,this.fail=h,this.depthFail=p,this.pass=g}}Fd.disabled=new Fd({func:519,mask:0},0,0,7680,7680,7680);class Nc{constructor(e,o,l){this.blendFunction=e,this.blendColor=o,this.mask=l}}Nc.Replace=[1,0],Nc.disabled=new Nc(Nc.Replace,Rr.transparent,[!1,!1,!1,!1]),Nc.unblended=new Nc(Nc.Replace,Rr.transparent,[!0,!0,!0,!0]),Nc.alphaBlended=new Nc([1,771],Rr.transparent,[!0,!0,!0,!0]);class cc{constructor(e,o,l){this.enable=e,this.mode=o,this.frontFace=l}}cc.disabled=new cc(!1,1029,2305),cc.backCCW=new cc(!0,1029,2305),cc.backCW=new cc(!0,1029,2304),cc.frontCW=new cc(!0,1028,2304),cc.frontCCW=new cc(!0,1028,2305);class Kl extends Tt{constructor(e,o,l){super(),this.id=e,this._onlySymbols=l,o.on("data",h=>{"source"===h.dataType&&"metadata"===h.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===h.dataType&&"content"===h.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),o.on("error",()=>{this._sourceErrored=!0}),this._source=o,this._tiles={},this._cache=new Rd(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=o.minTileCacheSize,this._maxTileCacheSize=o.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new B3,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const o=this._tiles[e];if("loaded"!==o.state&&"errored"!==o.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,o){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,o)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const l=this._tiles[o];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Wn(this._tiles).map(e=>e.tileID).sort(rf).map(e=>e.key)}getRenderableIds(e){const o=[];for(const l in this._tiles)this._isIdRenderable(+l,e)&&o.push(this._tiles[l]);return e?o.sort((l,h)=>{const p=l.tileID,g=h.tileID,x=new et(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),w=new et(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-g.overscaledZ||w.y-x.y||w.x-x.x}).map(l=>l.tileID.key):o.map(l=>l.tileID).sort(rf).map(l=>l.key)}hasRenderableParent(e){const o=this.findLoadedParent(e,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(e,o){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(o||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,o){const l=this._tiles[e];l&&("loading"!==l.state&&(l.state=o),this._loadTile(l,this._tileLoaded.bind(this,l,e,o)))}_tileLoaded(e,o,l,h){if(h)if(e.state="errored",404!==h.status)this._source.fire(new Ft(h,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const p=this.map.painter.terrain;this.update(this.transform,p.getScaledDemTileSize(),!0),p.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=mo.now(),"expired"===l&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(o,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new nt("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const o=this.getRenderableIds();for(let h=0;h<o.length;h++){const p=o[h];if(e.neighboringTiles&&e.neighboringTiles[p]){const g=this.getTileByID(p);l(e,g),l(g,e)}}function l(h,p){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let g=p.tileID.canonical.x-h.tileID.canonical.x;const x=p.tileID.canonical.y-h.tileID.canonical.y,w=Math.pow(2,h.tileID.canonical.z),T=p.tileID.key;0===g&&0===x||Math.abs(x)>1||(Math.abs(g)>1&&(1===Math.abs(g+w)?g+=w:1===Math.abs(g-w)&&(g-=w)),p.dem&&h.dem&&(h.dem.backfillBorder(p.dem,g,x),h.neighboringTiles&&h.neighboringTiles[T]&&(h.neighboringTiles[T].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,o,l,h){for(const p in this._tiles){let g=this._tiles[p];if(h[p]||!g.hasData()||g.tileID.overscaledZ<=o||g.tileID.overscaledZ>l)continue;let x=g.tileID;for(;g&&g.tileID.overscaledZ>o+1;){const T=g.tileID.scaledTo(g.tileID.overscaledZ-1);g=this._tiles[T.key],g&&g.hasData()&&(x=T)}let w=x;for(;w.overscaledZ>o;)if(w=w.scaledTo(w.overscaledZ-1),e[w.key]){h[x.key]=x;break}}}findLoadedParent(e,o){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=o?l:null}for(let l=e.overscaledZ-1;l>=o;l--){const h=e.scaledTo(l),p=this._getLoadedTile(h);if(p)return p}}_getLoadedTile(e){const o=this._tiles[e.key];return o&&o.hasData()?o:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,o){o=o||this._source.tileSize;const l=Math.ceil(e.width/o)+1,h=Math.ceil(e.height/o)+1,p=Math.floor(l*h*5),g="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,p):p,x="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(x)}handleWrapJump(e){const o=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,o){const l={};for(const h in this._tiles){const p=this._tiles[h];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+o),l[p.tileID.key]=p}this._tiles=l;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(e,o,l){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!l)return;let h;this.updateCacheSize(e,o),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(x=>new Ll(x.canonical.z,x.wrap,x.canonical.z,x.canonical.x,x.canonical.y)):(h=e.coveringTiles({tileSize:o||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(x=>this._source.hasTile(x)))):h=[];const p=this._updateRetainedTiles(h);if(sf(this._source.type)&&0!==h.length){const x={},w={},T=Object.keys(p);for(const O of T){const k=p[O],j=this._tiles[O];if(!j||j.fadeEndTime&&j.fadeEndTime<=mo.now())continue;const q=this.findLoadedParent(k,Math.max(k.overscaledZ-Kl.maxOverzooming,this._source.minzoom));q&&(this._addTile(q.tileID),x[q.tileID.key]=q.tileID),w[O]=k}const P=h[h.length-1].overscaledZ;for(const O in this._tiles){const k=this._tiles[O];if(p[O]||!k.hasData())continue;let j=k.tileID;for(;j.overscaledZ>P;){j=j.scaledTo(j.overscaledZ-1);const q=this._tiles[j.key];if(q&&q.hasData()&&w[j.key]){p[O]=k.tileID;break}}}for(const O in x)p[O]||(this._coveredTiles[O]=!0,p[O]=x[O])}for(const x in p)this._tiles[x].clearFadeHold();const g=function(x,w){const T=[];for(const P in x)P in w||T.push(P);return T}(this._tiles,p);for(const x of g){const w=this._tiles[x];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(+x)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const o={};if(0===e.length)return o;const l={},h=e.reduce((T,P)=>Math.min(T,P.overscaledZ),1/0),p=e[0].overscaledZ,g=Math.max(p-Kl.maxOverzooming,this._source.minzoom),x=Math.max(p+Kl.maxUnderzooming,this._source.minzoom),w={};for(const T of e){const P=this._addTile(T);o[T.key]=T,P.hasData()||h<this._source.maxzoom&&(w[T.key]=T)}this._retainLoadedChildren(w,h,x,o);for(const T of e){let P=this._tiles[T.key];if(P.hasData())continue;if(T.canonical.z>=this._source.maxzoom){const k=T.children(this._source.maxzoom)[0],j=this.getTile(k);if(j&&j.hasData()){o[k.key]=k;continue}}else{const k=T.children(this._source.maxzoom);if(o[k[0].key]&&o[k[1].key]&&o[k[2].key]&&o[k[3].key])continue}let O=P.wasRequested();for(let k=T.overscaledZ-1;k>=g;--k){const j=T.scaledTo(k);if(l[j.key]||(l[j.key]=!0,P=this.getTile(j),!P&&O&&(P=this._addTile(j)),P&&(o[j.key]=j,O=P.wasRequested(),P.hasData())))break}}return o}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const o=[];let l,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}o.push(h.key);const p=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(p),l)break;h=p}for(const p of o)this._loadedParentTiles[p]=l}}_addTile(e){let o=this._tiles[e.key];if(o)return o;o=this._cache.getAndRemove(e),o&&(this._setTileReloadTimer(e.key,o),o.tileID=e,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,o)));const l=!!o;if(!l){const h=this.map?this.map.painter:null;o=new m4(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._loadTile(o,this._tileLoaded.bind(this,o,e.key,o.state))}return o?(o.uses++,this._tiles[e.key]=o,l||this._source.fire(new nt("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o):null}_setTileReloadTimer(e,o){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=o.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}_removeTile(e){const o=this._tiles[e];o&&(o.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),o.uses>0||(o.hasData()&&"reloading"!==o.state?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,o,l){const h=[],p=this.transform;if(!p)return h;const g="globe"===p.projection.name,x=wc(p.center.lng);for(const w in this._tiles){const T=this._tiles[w];if(l&&T.clearQueryDebugViz(),T.holdingForFade())continue;let P;if(g){const O=T.tileID.canonical;if(0===O.z){const k=[Math.abs(an(x,...sh(O,-1))-x),Math.abs(an(x,...sh(O,1))-x)];P=[0,2*k.indexOf(Math.min(...k))-1]}else{const k=[Math.abs(an(x,...sh(O,-1))-x),Math.abs(an(x,...sh(O,0))-x),Math.abs(an(x,...sh(O,1))-x)];P=[k.indexOf(Math.min(...k))-1]}}else P=[0];for(const O of P){const k=e.containsTile(T,p,o,O);k&&h.push(k)}}return h}getVisibleCoordinates(e){const o=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);for(const l of o)l.projMatrix=this.transform.calculateProjMatrix(l.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(sf(this._source.type))for(const e in this._tiles){const o=this._tiles[e];if(void 0!==o.fadeEndTime&&o.fadeEndTime>=mo.now())return!0}return!1}setFeatureState(e,o,l){this._state.updateState(e=e||"_geojsonTileLayer",o,l)}removeFeatureState(e,o,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",o,l)}getFeatureState(e,o){return this._state.getState(e=e||"_geojsonTileLayer",o)}setDependencies(e,o,l){const h=this._tiles[e];h&&h.setDependencies(o,l)}reloadTilesForDependencies(e,o){for(const l in this._tiles)this._tiles[l].hasDependency(e,o)&&this._reloadTile(+l,"reloading");this._cache.filter(l=>!l.hasDependency(e,o))}_preloadTiles(e,o){if(!this._sourceLoaded){const x=()=>{this._sourceLoaded&&(this._source.off("data",x),this._preloadTiles(e,o))};return void this._source.on("data",x)}const l=new Map,h=Array.isArray(e)?e:[e],p=this.map.painter.terrain,g=this.usedForTerrain&&p?p.getScaledDemTileSize():this._source.tileSize;for(const x of h){const w=x.coveringTiles({tileSize:g,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const T of w)l.set(T.key,T);this.usedForTerrain&&x.updateElevation(!1)}di(Array.from(l.values()),(x,w)=>{const T=new m4(x,this._source.tileSize*x.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(T,P=>{"raster-dem"===this._source.type&&T.dem&&this._backfillDEM(T),w(P,T)})},o)}}function rf(i,e){const o=Math.abs(2*i.wrap)-+(i.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||l-o||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x}function sf(i){return"raster"===i||"image"===i||"video"===i||"custom"===i}function sh(i,e){const o=1<<i.z;return[i.x/o+e,(i.x+1)/o+e]}Kl.maxOverzooming=10,Kl.maxUnderzooming=3;class Vd{constructor(e,o,l){this._demTile=e,this._dem=this._demTile.dem,this._scale=o,this._offset=l}static create(e,o,l){const h=l||e.findDEMTileFor(o);if(!h||!h.dem)return;const p=h.dem,g=h.tileID,x=1<<o.canonical.z-g.canonical.z;return new Vd(h,h.tileSize/dr/x,[(o.canonical.x/x-g.canonical.x)*p.dim,(o.canonical.y/x-g.canonical.y)*p.dim])}tileCoordToPixel(e,o){const l=o*this._scale+this._offset[1],h=Math.floor(e*this._scale+this._offset[0]),p=Math.floor(l);return new et(h,p)}getElevationAt(e,o,l,h){const p=e*this._scale+this._offset[0],g=o*this._scale+this._offset[1],x=Math.floor(p),w=Math.floor(g),T=this._dem;return h=!!h,l?Hr(Hr(T.get(x,w,h),T.get(x,w+1,h),g-w),Hr(T.get(x+1,w,h),T.get(x+1,w+1,h),g-w),p-x):T.get(x,w,h)}getElevationAtPixel(e,o,l){return this._dem.get(e,o,!!l)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*lc(1,e)*this._dem.stride}}class Oh{constructor(e,o){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new da(dr,16,0),this.featureIndexArray=new So,this.promoteId=o}insert(e,o,l,h,p,g=0){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,h,p,g);const w=this.grid;for(let T=0;T<o.length;T++){const P=o[T],O=[1/0,1/0,-1/0,-1/0];for(let k=0;k<P.length;k++){const j=P[k];O[0]=Math.min(O[0],j.x),O[1]=Math.min(O[1],j.y),O[2]=Math.max(O[2],j.x),O[3]=Math.max(O[3],j.y)}O[0]<dr&&O[1]<dr&&O[2]>=0&&O[3]>=0&&w.insert(x,O[0],O[1],O[2],O[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new cd(new p1(this.rawTileData)).layers,this.sourceLayerCoder=new d4(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,o,l,h){this.loadVTLayers();const p=e.params||{},g=In(p.filter),x=e.tileResult,w=e.transform,T=x.bufferedTilespaceBounds,P=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,(q,ue,Be,tt)=>s2(x.bufferedTilespaceGeometry,q,ue,Be,tt));P.sort(Lh);let O=null;w.elevation&&P.length>0&&(O=Vd.create(w.elevation,this.tileID));const k={};let j;for(let q=0;q<P.length;q++){const ue=P[q];if(ue===j)continue;j=ue;const Be=this.featureIndexArray.get(ue);let tt=null;this.loadMatchingFeature(k,Be,g,p.layers,p.availableImages,o,l,h,(_t,rt,Dt,Rt=0)=>(tt||(tt=$c(_t,this.tileID.canonical,e.tileTransform)),rt.queryIntersectsFeature(x,_t,Dt,tt,this.z,e.transform,e.pixelPosMatrix,O,Rt)))}return k}loadMatchingFeature(e,o,l,h,p,g,x,w,T){const{featureIndex:P,bucketIndex:O,sourceLayerIndex:k,layoutVertexArrayOffset:j}=o,q=this.bucketLayerIDs[O];if(h&&!function(_t,rt){for(let Dt=0;Dt<_t.length;Dt++)if(rt.indexOf(_t[Dt])>=0)return!0;return!1}(h,q))return;const ue=this.sourceLayerCoder.decode(k),Be=this.vtLayers[ue].feature(P);if(l.needGeometry){const _t=qu(Be,!0);if(!l.filter(new U(this.tileID.overscaledZ),_t,this.tileID.canonical))return}else if(!l.filter(new U(this.tileID.overscaledZ),Be))return;const tt=this.getId(Be,ue);for(let _t=0;_t<q.length;_t++){const rt=q[_t];if(h&&h.indexOf(rt)<0)continue;const Dt=g[rt];if(!Dt)continue;let Rt={};void 0!==tt&&w&&(Rt=w.getState(Dt.sourceLayer||"_geojsonTileLayer",tt));const Vt=$n({},x[rt]);Vt.paint=g4(Vt.paint,Dt.paint,Be,Rt,p),Vt.layout=g4(Vt.layout,Dt.layout,Be,Rt,p);const bn=!T||T(Be,Dt,Rt,j);if(!bn)continue;const _n=new Wl(Be,this.z,this.x,this.y,tt);_n.layer=Vt;let Vn=e[rt];void 0===Vn&&(Vn=e[rt]=[]),Vn.push({featureIndex:P,feature:_n,intersectionZ:bn})}}lookupSymbolFeatures(e,o,l,h,p,g,x,w){const T={};this.loadVTLayers();const P=In(p);for(const O of e)this.loadMatchingFeature(T,{bucketIndex:l,sourceLayerIndex:h,featureIndex:O,layoutVertexArrayOffset:0},P,g,x,w,o);return T}loadFeature(e){const{featureIndex:o,sourceLayerIndex:l}=e;this.loadVTLayers();const h=this.sourceLayerCoder.decode(l),p=this.vtFeatures[h];if(p[o])return p[o];const g=this.vtLayers[h].feature(o);return p[o]=g,g}hasLayer(e){for(const o of this.bucketLayerIDs)for(const l of o)if(e===l)return!0;return!1}getId(e,o){let l=e.id;if(this.promoteId){const h="string"==typeof this.promoteId?this.promoteId:this.promoteId[o];null!=h&&(l=e.properties[h]),"boolean"==typeof l&&(l=Number(l))}return l}}function g4(i,e,o,l,h){return zn(i,(p,g)=>{const x=e instanceof ft?e.get(g):null;return x&&x.evaluate?x.evaluate(o,l,h):x})}function Lh(i,e){return e-i}$i(Oh,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Rh{constructor(e,o){this.width=e,this.height=o,this.nextRow=0,this.image=new iu({width:e,height:o}),this.positions={},this.uploaded=!1}getDash(e,o){const l=this.getKey(e,o);return this.positions[l]}trim(){const e=this.width,o=this.height=pn(this.nextRow);this.image.resize({width:e,height:o})}getKey(e,o){return e.join(",")+o}getDashRanges(e,o,l){const h=[];let p=e.length%2==1?-e[e.length-1]*l:0,g=e[0]*l,x=!0;h.push({left:p,right:g,isDash:x,zeroLength:0===e[0]});let w=e[0];for(let T=1;T<e.length;T++){x=!x;const P=e[T];p=w*l,w+=P,g=w*l,h.push({left:p,right:g,isDash:x,zeroLength:0===P})}return h}addRoundDash(e,o,l){const h=o/2;for(let p=-l;p<=l;p++){const g=this.width*(this.nextRow+l+p);let x=0,w=e[x];for(let T=0;T<this.width;T++){T/w.right>1&&(w=e[++x]);const P=Math.abs(T-w.left),O=Math.abs(T-w.right),k=Math.min(P,O);let j;const q=p/l*(h+1);if(w.isDash){const ue=h-Math.abs(q);j=Math.sqrt(k*k+ue*ue)}else j=h-Math.sqrt(k*k+q*q);this.image.data[g+T]=Math.max(0,Math.min(255,j+128))}}}addRegularDash(e,o){for(let w=e.length-1;w>=0;--w){const T=e[w],P=e[w+1];T.zeroLength?e.splice(w,1):P&&P.isDash===T.isDash&&(P.left=T.left,e.splice(w,1))}const l=e[0],h=e[e.length-1];l.isDash===h.isDash&&(l.left=h.left-this.width,h.right=l.right+this.width);const p=this.width*this.nextRow;let g=0,x=e[g];for(let w=0;w<this.width;w++){w/x.right>1&&(x=e[++g]);const T=Math.abs(w-x.left),P=Math.abs(w-x.right),O=Math.min(T,P);this.image.data[p+w]=Math.max(0,Math.min(255,(x.isDash?O:-O)+o+128))}}addDash(e,o){const l=this.getKey(e,o);if(this.positions[l])return this.positions[l];const h="round"===o,p=h?7:0,g=2*p+1;if(this.nextRow+g>this.height)return Si("LineAtlas out of space"),null;0===e.length&&e.push(1);let x=0;for(let P=0;P<e.length;P++)e[P]<0&&(Si("Negative value is found in line dasharray, replacing values with 0"),e[P]=0),x+=e[P];if(0!==x){const P=this.width/x,O=this.getDashRanges(e,this.width,P);h?this.addRoundDash(O,P,p):this.addRegularDash(O,"square"===o?.5*P:0)}const w=this.nextRow+p;this.nextRow+=g;const T={tl:[w,p],br:[x,0]};return this.positions[l]=T,T}}$i(Rh,"LineAtlas");const Bd=1*Lc;class Fh{constructor(e){const o={},l=[];for(const x in e){const w=e[x],T=o[x]={};for(const P in w.glyphs){const O=w.glyphs[+P];if(!O||0===O.bitmap.width||0===O.bitmap.height)continue;const k=O.metrics.localGlyph?Bd:1,j={x:0,y:0,w:O.bitmap.width+2*k,h:O.bitmap.height+2*k};l.push(j),T[P]=j}}const{w:h,h:p}=m1(l),g=new iu({width:h||1,height:p||1});for(const x in e){const w=e[x];for(const T in w.glyphs){const P=w.glyphs[+T];if(!P||0===P.bitmap.width||0===P.bitmap.height)continue;const O=o[x][T],k=P.metrics.localGlyph?Bd:1;iu.copy(P.bitmap,g,{x:0,y:0},{x:O.x+k,y:O.y+k},P.bitmap)}}this.image=g,this.positions=o}}$i(Fh,"GlyphAtlas");class af{constructor(e){this.tileID=new Ll(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=cu(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,o,l,h,p){this.status="parsing",this.data=e,this.collisionBoxArray=new Ko;const g=new d4(Object.keys(e.layers).sort()),x=new Oh(this.tileID,this.promoteId);x.bucketLayerIDs=[];const w={},T=new Rh(256,256),P={featureIndex:x,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:T,availableImages:l},O=o.familiesBySource[this.source];for(const Rt in O){const Vt=e.layers[Rt];if(!Vt)continue;let bn=!1,_n=!1;for(const En of O[Rt])"symbol"===En[0].type?bn=!0:_n=!0;if(!0===this.isSymbolTile&&!bn||!1===this.isSymbolTile&&!_n)continue;1===Vt.version&&Si(`Vector tile source "${this.source}" layer "${Rt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Vn=g.encode(Rt),hi=[];for(let En=0;En<Vt.length;En++){const Kn=Vt.feature(En),Gn=x.getId(Kn,Rt);hi.push({feature:Kn,id:Gn,index:En,sourceLayerIndex:Vn})}for(const En of O[Rt]){const Kn=En[0];void 0!==this.isSymbolTile&&"symbol"===Kn.type!==this.isSymbolTile||Kn.minzoom&&this.zoom<Math.floor(Kn.minzoom)||Kn.maxzoom&&this.zoom>=Kn.maxzoom||"none"!==Kn.visibility&&(Hd(En,this.zoom,l),(w[Kn.id]=Kn.createBucket({index:x.bucketLayerIDs.length,layers:En,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Vn,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:l})).populate(hi,P,this.tileID.canonical,this.tileTransform),x.bucketLayerIDs.push(En.map(Gn=>Gn.id)))}}let k,j,q,ue;T.trim();const Be={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},tt=()=>{if(k)return p(k);if(j&&q&&ue){const Rt=new Fh(j),Vt=new gd(q,ue);for(const bn in w){const _n=w[bn];_n instanceof Kc?(Hd(_n.layers,this.zoom,l),N2(_n,j,Rt.positions,q,Vt.iconPositions,this.showCollisionBoxes,l,this.tileID.canonical,this.tileZoom,this.projection)):_n.hasPattern&&(_n instanceof Cc||_n instanceof wh||_n instanceof hd)&&(Hd(_n.layers,this.zoom,l),_n.addFeatures(P,this.tileID.canonical,Vt.patternPositions,l,this.tileTransform))}this.status="done",p(null,{buckets:Wn(w).filter(bn=>!bn.isEmpty()),featureIndex:x,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Rt.image,lineAtlas:T,imageAtlas:Vt,glyphMap:this.returnDependencies?j:null,iconMap:this.returnDependencies?q:null,glyphPositions:this.returnDependencies?Rt.positions:null})}},_t=zn(P.glyphDependencies,Rt=>Object.keys(Rt).map(Number));Object.keys(_t).length?h.send("getGlyphs",{uid:this.uid,stacks:_t},(Rt,Vt)=>{k||(k=Rt,j=Vt,tt())},void 0,!1,Be):j={};const rt=Object.keys(P.iconDependencies);rt.length?h.send("getImages",{icons:rt,source:this.source,tileID:this.tileID,type:"icons"},(Rt,Vt)=>{k||(k=Rt,q=Vt,tt())},void 0,!1,Be):q={};const Dt=Object.keys(P.patternDependencies);Dt.length?h.send("getImages",{icons:Dt,source:this.source,tileID:this.tileID,type:"patterns"},(Rt,Vt)=>{k||(k=Rt,ue=Vt,tt())},void 0,!1,Be):ue={},tt()}}function Hd(i,e,o){const l=new U(e);for(const h of i)h.recalculate(l,o)}class lf{constructor(e){this.entries={},this.scheduler=e}request(e,o,l,h){const p=this.entries[e]=this.entries[e]||{callbacks:[]};if(p.result){const[g,x]=p.result;return this.scheduler?this.scheduler.add(()=>{h(g,x)},o):h(g,x),()=>{}}return p.callbacks.push(h),p.cancel||(p.cancel=l((g,x)=>{p.result=[g,x];for(const w of p.callbacks)this.scheduler?this.scheduler.add(()=>{w(g,x)},o):w(g,x);setTimeout(()=>delete this.entries[e],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(g=>g!==h),p.callbacks.length||(p.cancel(),delete this.entries[e]))}}}function v4(i,e,o){const l=JSON.stringify(i.request);return i.data&&(this.deduped.entries[l]={result:[null,i.data]}),this.deduped.request(l,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},h=>{const p=bi(i.request,(g,x,w,T)=>{g?h(g):x&&h(null,{vectorTile:o?void 0:new cd(new p1(x)),rawData:x,cacheControl:w,expires:T})});return()=>{p.cancel(),h()}},e)}const cf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class _4{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,l]=new Uint8Array(e,0,2);if(219!==o)throw new Error("Data does not appear to be in a KDBush format.");const h=l>>4;if(1!==h)throw new Error(`Got v${h} data when expected v1.`);const p=cf[15&l];if(!p)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(e,2,1),[x]=new Uint32Array(e,4,1);return new _4(x,g,p,e)}constructor(e,o=64,l=Float64Array,h){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=l,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const p=cf.indexOf(this.ArrayType),g=2*e*this.ArrayType.BYTES_PER_ELEMENT,x=e*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-x%8)%8;if(p<0)throw new Error(`Unexpected typed array class: ${l}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+x+w,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+g+x+w),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+x+w,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+p]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=e)}add(e,o){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=e,this.coords[this._pos++]=o,l}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Ud(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,o,l,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:g,nodeSize:x}=this,w=[0,p.length-1,0],T=[];for(;w.length;){const P=w.pop()||0,O=w.pop()||0,k=w.pop()||0;if(O-k<=x){for(let Be=k;Be<=O;Be++){const tt=g[2*Be],_t=g[2*Be+1];tt>=e&&tt<=l&&_t>=o&&_t<=h&&T.push(p[Be])}continue}const j=k+O>>1,q=g[2*j],ue=g[2*j+1];q>=e&&q<=l&&ue>=o&&ue<=h&&T.push(p[j]),(0===P?e<=q:o<=ue)&&(w.push(k),w.push(j-1),w.push(1-P)),(0===P?l>=q:h>=ue)&&(w.push(j+1),w.push(O),w.push(1-P))}return T}within(e,o,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:p,nodeSize:g}=this,x=[0,h.length-1,0],w=[],T=l*l;for(;x.length;){const P=x.pop()||0,O=x.pop()||0,k=x.pop()||0;if(O-k<=g){for(let Be=k;Be<=O;Be++)hf(p[2*Be],p[2*Be+1],e,o)<=T&&w.push(h[Be]);continue}const j=k+O>>1,q=p[2*j],ue=p[2*j+1];hf(q,ue,e,o)<=T&&w.push(h[j]),(0===P?e-l<=q:o-l<=ue)&&(x.push(k),x.push(j-1),x.push(1-P)),(0===P?e+l>=q:o+l>=ue)&&(x.push(j+1),x.push(O),x.push(1-P))}return w}}function Ud(i,e,o,l,h,p){if(h-l<=o)return;const g=l+h>>1;Nh(i,e,g,l,h,p),Ud(i,e,o,l,g-1,1-p),Ud(i,e,o,g+1,h,1-p)}function Nh(i,e,o,l,h,p){for(;h>l;){if(h-l>600){const T=h-l+1,P=o-l+1,O=Math.log(T),k=.5*Math.exp(2*O/3),j=.5*Math.sqrt(O*k*(T-k)/T)*(P-T/2<0?-1:1);Nh(i,e,o,Math.max(l,Math.floor(o-P*k/T+j)),Math.min(h,Math.floor(o+(T-P)*k/T+j)),p)}const g=e[2*o+p];let x=l,w=h;for(T1(i,e,l,o),e[2*h+p]>g&&T1(i,e,l,h);x<w;){for(T1(i,e,x,w),x++,w--;e[2*x+p]<g;)x++;for(;e[2*w+p]>g;)w--}e[2*l+p]===g?T1(i,e,l,w):(w++,T1(i,e,w,h)),w<=o&&(l=w+1),o<=w&&(h=w-1)}}function T1(i,e,o,l){uf(i,o,l),uf(e,2*o,2*l),uf(e,2*o+1,2*l+1)}function uf(i,e,o){const l=i[e];i[e]=i[o],i[o]=l}function hf(i,e,o,l){const h=i-o,p=e-l;return h*h+p*p}a.ARRAY_TYPE=Cl,a.AUTH_ERR_MSG=Oe,a.Aabb=Dl,a.Actor=class{constructor(i,e,o){this.target=i,this.parent=e,this.mapId=o,this.callbacks={},this.cancelCallbacks={},jn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=ji()?i:se,this.scheduler=new h4}send(i,e,o,l,h=!1,p){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=p,this.callbacks[g]=o);const x=jt(this.globalScope)?void 0:[];return this.target.postMessage({id:g,type:i,hasCallback:!!o,targetMapId:l,mustQueue:h,sourceMapId:this.mapId,data:Xl(e,x)},x),{cancel:()=>{o&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}receive(i){const e=i.data,o=e.id;if(o&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const l=this.cancelCallbacks[o];delete this.cancelCallbacks[o],l&&l.cancel()}else if(e.mustQueue||ji()){const l=this.callbacks[o];this.cancelCallbacks[o]=this.scheduler.add(()=>this.processTask(o,e),l&&l.metadata||{type:"message"})}else this.processTask(o,e)}processTask(i,e){if("<response>"===e.type){const o=this.callbacks[i];delete this.callbacks[i],o&&(e.error?o(rc(e.error)):o(null,rc(e.data)))}else{const o=jt(this.globalScope)?void 0:[],l=e.hasCallback?(p,g)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:p?Xl(p):null,data:Xl(g,o)},o)}:p=>{},h=rc(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,h,l);else if(this.parent.getWorkerSource){const p=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,p[0],h.source)[p[1]](h,l)}else l(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=Ec,a.Color=Rr,a.ColorMode=Nc,a.CullFaceMode=cc,a.DEMData=C1,a.DataConstantProperty=Ee,a.DedupedRequest=lf,a.DepthMode=ku,a.EXTENT=dr,a.Elevation=class{isDataAvailableAtPoint(i){const e=this._source();if(this.isUsingMockSource()||!e||i.y<0||i.y>1)return!1;const o=e.getSource().maxzoom,l=1<<o,h=Math.floor(i.x),p=Math.floor((i.x-h)*l),g=Math.floor(i.y*l),x=this.findDEMTileFor(new Ll(o,h,o,p,g));return!(!x||!x.dem)}getAtPointOrZero(i,e=0){return this.getAtPoint(i,e)||0}getAtPoint(i,e,o=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const l=this._source();if(!l||i.y<0||i.y>1)return e;const h=l.getSource().maxzoom,p=1<<h,g=Math.floor(i.x),x=i.x-g,w=new Ll(h,g,h,Math.floor(x*p),Math.floor(i.y*p)),T=this.findDEMTileFor(w);if(!T||!T.dem)return e;const P=T.dem,O=1<<T.tileID.canonical.z,k=(x*O-T.tileID.canonical.x)*P.dim,j=(i.y*O-T.tileID.canonical.y)*P.dim,q=Math.floor(k),ue=Math.floor(j);return(o?this.exaggeration():1)*Hr(Hr(P.get(q,ue),P.get(q,ue+1),j-ue),Hr(P.get(q+1,ue),P.get(q+1,ue+1),j-ue),k-q)}getAtTileOffset(i,e,o){const l=1<<i.canonical.z;return this.getAtPointOrZero(new Ku(i.wrap+(i.canonical.x+e/dr)/l,(i.canonical.y+o/dr)/l))}getAtTileOffsetFunc(i,e,o,l){return h=>{const p=this.getAtTileOffset(i,h.x,h.y),g=l.upVector(i.canonical,h.x,h.y);return _c(g,g,p*l.upVectorScale(i.canonical,e,o).metersToTile),g}}getForTilePoints(i,e,o,l){if(this.isUsingMockSource())return!1;const h=Vd.create(this,i,l);return!!h&&(e.forEach(p=>{p[2]=this.exaggeration()*h.getElevationAt(p[0],p[1],o)}),!0)}getMinMaxForTile(i){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(i);if(!e||!e.dem)return null;const o=e.dem.tree,l=e.tileID,h=1<<i.canonical.z-l.canonical.z;let p=i.canonical.x/h-l.canonical.x,g=i.canonical.y/h-l.canonical.y,x=0;for(let w=0;w<i.canonical.z-l.canonical.z&&!o.leaves[x];w++){p*=2,g*=2;const T=2*Math.floor(g)+Math.floor(p);x=o.childOffsets[x]+T,p%=1,g%=1}return{min:this.exaggeration()*o.minimums[x],max:this.exaggeration()*o.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,e,o){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=Ft,a.EvaluationParameters=U,a.Event=nt,a.Evented=Tt,a.FillExtrusionBucket=hd,a.Frustum=u0,a.FrustumCorners=Oa,a.GLOBE_RADIUS=kc,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=X4,a.GLOBE_ZOOM_THRESHOLD_MIN=Gh,a.GlobeSharedBuffers=class{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.withSkirts.destroy(),i.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const i of this._wireframeSegments)i.destroy()}}_fillGridMeshWithLods(i,e){const o=new li,l=new Qi,h=[],p=i+1+2,g=e[0]+1,x=e[0]+1+(1+e.length),w=(T,P,O)=>{let k=T===p-1?T-2:0===T?T:T-1;return k+=O?24575:0,[k,P]};for(let T=0;T<p;++T)o.emplaceBack(...w(T,0,!0));for(let T=0;T<g;++T)for(let P=0;P<p;++P)o.emplaceBack(...w(P,T,(0===P||P===p-1)&&!0));for(let T=0;T<e.length;++T){const P=e[T];for(let O=0;O<p;++O)o.emplaceBack(...w(O,P,!0))}for(let T=0;T<e.length;++T){const P=l.length,O=e[T]+1+2,k=new Qi;for(let ue=0;ue<O-1;ue++){const Be=ue===O-2,tt=Be?p*(x-e.length+T-ue):p;for(let _t=0;_t<p-1;_t++){const rt=ue*p+_t;0===ue||Be||0===_t||_t===p-2?(k.emplaceBack(rt+1,rt,rt+tt),k.emplaceBack(rt+tt,rt+tt+1,rt+1)):(l.emplaceBack(rt+1,rt,rt+tt),l.emplaceBack(rt+tt,rt+tt+1,rt+1))}}const j=na.simpleSegment(0,P,o.length,l.length-P);for(let ue=0;ue<k.uint16.length;ue+=3)l.emplaceBack(k.uint16[ue],k.uint16[ue+1],k.uint16[ue+2]);const q=na.simpleSegment(0,P,o.length,l.length-P);h.push({withoutSkirts:j,withSkirts:q})}return{vertices:o,indices:l,segments:h}}_createGrid(i){const e=this._fillGridMeshWithLods(64,ph);this._gridSegments=e.segments,this._gridBuffer=i.createVertexBuffer(e.vertices,Uc.members),this._gridIndexBuffer=i.createIndexBuffer(e.indices,!0)}_createPoles(i){const e=new Qi;for(let h=0;h<=64;h++)e.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=i.createIndexBuffer(e,!0);const o=new Co,l=new Co;this._poleSegments=[];for(let h=0,p=0;h<Gh;h++){const g=360/(1<<h);o.emplaceBack(0,-kc,0,.5,0),l.emplaceBack(0,-kc,0,.5,1);for(let x=0;x<=64;x++){const w=x/64,T=Hr(0,g,w),[P,O,k]=hl(k8,O8,T,kc);o.emplaceBack(P,O,k,w,0),l.emplaceBack(P,O,k,w,1)}this._poleSegments.push(na.simpleSegment(p,0,66,64)),p+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(o,l0,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(l,l0,!1)}getGridBuffers(i,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[i].withSkirts:this._gridSegments[i].withoutSkirts]}getPoleBuffers(i){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}getWirefameBuffers(i,e){if(!this._wireframeSegments){const o=new Ma,l=64,h=l+1+2,p=1;this._wireframeSegments=[];for(let g=0,x=0;g<ph.length;g++){const w=ph[g];for(let P=p;P<w+p;P++)for(let O=p;O<l+p;O++){const k=P*h+O;o.emplaceBack(k,k+1),o.emplaceBack(k,k+h),o.emplaceBack(k,k+h+1)}const T=w*l*3;this._wireframeSegments.push(na.simpleSegment(0,x,(w+1)*h,T)),x+=T}this._wireframeIndexBuffer=i.createIndexBuffer(o)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},a.GlyphManager=Pu,a.ImagePosition=z2,a.KDBush=_4,a.LivePerformanceUtils=ms,a.LngLat=Po,a.LngLatBounds=El,a.LocalGlyphMode=Au,a.MAX_MERCATOR_LATITUDE=Ca,a.MercatorCoordinate=Ku,a.ONE_EM=$a,a.OverscaledTileID=Ll,a.PerformanceMarkers=Or,a.Point=et,a.Properties=Mt,a.RGBAImage=Gl,a.Ray=yu,a.RequestManager=class{constructor(i,e,o){this._transformRequestFn=i,this._customAccessToken=e,this._silenceAuthErrors=!!o,this._createSkuToken()}_createSkuToken(){const i=function(){let e="";for(let o=0;o<10;o++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ze,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,e){return this._transformRequestFn&&this._transformRequestFn(i,e)||{url:i}}normalizeStyleURL(i,e){if(!Ke(i))return i;const o=_e(i);return o.path=`/styles/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||e)}normalizeGlyphsURL(i,e){if(!Ke(i))return i;const o=_e(i);return o.path=`/fonts/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||e)}normalizeSourceURL(i,e,o,l){if(!Ke(i))return i;const h=_e(i);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),o&&h.params.push(`language=${o}`),l&&h.params.push(`worldview=${l}`),this._makeAPIURL(h,this._customAccessToken||e)}normalizeSpriteURL(i,e,o,l){const h=_e(i);return Ke(i)?(h.path=`/styles/v1${h.path}/sprite${e}${o}`,this._makeAPIURL(h,this._customAccessToken||l)):(h.path+=`${e}${o}`,re(h))}normalizeTileURL(i,e,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!Ke(i))return i;const l=_e(i);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||o&&"raster"!==l.authority&&512===o?"@2x":""}${fe.supported?".webp":"$1"}`),"raster"===l.authority?l.path=`/${ee.RASTER_URL_PREFIX}${l.path}`:(l.path=l.path.replace(/^.+\/v4\//,"/"),l.path=`/${ee.TILE_URL_VERSION}${l.path}`);const h=this._customAccessToken||function(p){for(const g of p){const x=g.match(/^access_token=(.*)$/);if(x)return x[1]}return null}(l.params)||ee.ACCESS_TOKEN;return ee.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&l.params.push(`sku=${this._skuToken}`),this._makeAPIURL(l,h)}canonicalizeTileURL(i,e){const o=_e(i);if(!o.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!o.path.match(/\.[\w]+$/))return i;let l="mapbox://";o.path.match(/^\/raster\/v1\//)?l+=`raster/${o.path.replace(`/${ee.RASTER_URL_PREFIX}/`,"")}`:l+=`tiles/${o.path.replace(`/${ee.TILE_URL_VERSION}/`,"")}`;let h=o.params;return e&&(h=h.filter(p=>!p.match(/^access_token=/))),h.length&&(l+=`?${h.join("&")}`),l}canonicalizeTileset(i,e){const o=!!e&&Ke(e),l=[];for(const h of i.tiles||[])Et(h)?l.push(this.canonicalizeTileURL(h,o)):l.push(h);return l}_makeAPIURL(i,e){const o="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",l=_e(ee.API_URL);if(i.protocol=l.protocol,i.authority=l.authority,"http"===i.protocol){const h=i.params.indexOf("secure");h>=0&&i.params.splice(h,1)}if("/"!==l.path&&(i.path=`${l.path}${i.path}`),!ee.REQUIRE_ACCESS_TOKEN)return re(i);if(e=e||ee.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${o}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${o}`)}return i.params=i.params.filter(h=>-1===h.indexOf("access_token")),i.params.push(`access_token=${e||""}`),re(i)}},a.ResourceType=hn,a.SegmentVector=na,a.SourceCache=Kl,a.StencilMode=Fd,a.StructArrayLayout1ui2=bl,a.StructArrayLayout2f1f2i16=or,a.StructArrayLayout2i4=li,a.StructArrayLayout2ui4=Ma,a.StructArrayLayout3f12=Zr,a.StructArrayLayout3ui6=Qi,a.StructArrayLayout4i8=Fn,a.StructArrayLayout5f20=Co,a.Texture=E1,a.Tile=m4,a.Transitionable=we,a.Uniform1f=Di,a.Uniform1i=class extends ui{constructor(i){super(i),this.current=0}set(i,e,o){this.fetchUniformLocation(i,e)&&this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},a.Uniform2f=class extends ui{constructor(i){super(i),this.current=[0,0]}set(i,e,o){this.fetchUniformLocation(i,e)&&(o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1])))}},a.Uniform3f=class extends ui{constructor(i){super(i),this.current=[0,0,0]}set(i,e,o){this.fetchUniformLocation(i,e)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2])))}},a.Uniform4f=Bi,a.UniformColor=Er,a.UniformMatrix2f=class extends ui{constructor(i){super(i),this.current=Bo}set(i,e,o){if(this.fetchUniformLocation(i,e))for(let l=0;l<4;l++)if(o[l]!==this.current[l]){this.current=o,this.gl.uniformMatrix2fv(this.location,!1,o);break}}},a.UniformMatrix3f=class extends ui{constructor(i){super(i),this.current=go}set(i,e,o){if(this.fetchUniformLocation(i,e))for(let l=0;l<9;l++)if(o[l]!==this.current[l]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}},a.UniformMatrix4f=class extends ui{constructor(i){super(i),this.current=lo}set(i,e,o){if(this.fetchUniformLocation(i,e)){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let l=1;l<16;l++)if(o[l]!==this.current[l]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}}},a.UnwrappedTileID=Ju,a.ValidationError=Xt,a.VectorTileFeature=o1,a.VectorTileWorkerSource=class extends Tt{constructor(i,e,o,l,h){super(),this.actor=i,this.layerIndex=e,this.availableImages=o,this.loadVectorData=h||v4,this.loading={},this.loaded={},this.deduped=new lf(i.scheduler),this.isSpriteLoaded=l,this.scheduler=i.scheduler}loadTile(i,e){const o=i.uid,l=i&&i.request,h=l&&l.collectResourceTiming,p=this.loading[o]=new af(i);p.abort=this.loadVectorData(i,(g,x)=>{const w=!this.loading[o];if(delete this.loading[o],w||g||!x)return p.status="done",w||(this.loaded[o]=p),e(g);const T=x.rawData,P={};x.expires&&(P.expires=x.expires),x.cacheControl&&(P.cacheControl=x.cacheControl),p.vectorTile=x.vectorTile||new cd(new p1(T));const O=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(k,j)=>{if(k||!j)return e(k);const q={};if(h){const ue=Xi(l);ue.length>0&&(q.resourceTiming=JSON.parse(JSON.stringify(ue)))}e(null,$n({rawTileData:T.slice(0)},j,P,q))})};this.isSpriteLoaded?O():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(O,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):O()}),this.loaded=this.loaded||{},this.loaded[o]=p})}reloadTile(i,e){const o=this.loaded,l=i.uid,h=this;if(o&&o[l]){const p=o[l];p.showCollisionBoxes=i.showCollisionBoxes,p.enableTerrain=!!i.enableTerrain,p.projection=i.projection,p.tileTransform=cu(i.tileID.canonical,i.projection);const g=(x,w)=>{const T=p.reloadCallback;T&&(delete p.reloadCallback,p.parse(p.vectorTile,h.layerIndex,this.availableImages,h.actor,T)),e(x,w)};"parsing"===p.status?p.reloadCallback=g:"done"===p.status&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,g):g())}}abortTile(i,e){const o=i.uid,l=this.loading[o];l&&(l.abort&&l.abort(),delete this.loading[o]),e()}removeTile(i,e){const o=this.loaded,l=i.uid;o&&o[l]&&delete o[l],e()}},a.WritingMode=Tc,a.ZoomDependentExpression=pe,a.add=sc,a.addDynamicAttributes=Ih,a.adjoint=function(i,e){var o=e[0],l=e[1],h=e[2],p=e[3],g=e[4],x=e[5],w=e[6],T=e[7],P=e[8];return i[0]=g*P-x*T,i[1]=h*T-l*P,i[2]=l*x-h*g,i[3]=x*w-p*P,i[4]=o*P-h*w,i[5]=h*p-o*x,i[6]=p*T-g*w,i[7]=l*w-o*T,i[8]=o*g-l*p,i},a.asyncAll=di,a.bezier=wn,a.bindAll=jn,a.boundsAttributes=f4,a.bufferConvexPolygon=function(i,e){const o=[];for(let l=0;l<i.length;l++){const h=nn(l-1,-1,i.length-1),p=nn(l+1,-1,i.length-1),g=i[l],x=i[p],w=i[h].sub(g).unit(),T=x.sub(g).unit(),P=T.angleWithSep(w.x,w.y),O=w.add(T).unit().mult(-1*e/Math.sin(P/2));o.push(g.add(O))}return o},a.cacheEntryPossiblyAdded=function(i){en++,en>st&&(i.getActor().send("enforceCacheSizeLimit",On),en=0)},a.calculateGlobeLabelMatrix=function(i,e){const{x:o,y:l}=i.point,h=Gu(o,l,i.worldSize/i._pixelsPerMercatorPixel,0,0);return mu(h,h,Y1(jc(e)))},a.calculateGlobeMatrix=function(i){const{x:e,y:o}=i.point,{lng:l,lat:h}=i._center;return Gu(e,o,i.worldSize,l,h)},a.calculateGlobeMercatorMatrix=function(i){const e=i.pixelsPerMeter,o=e/lc(1,i.center.lat),l=oc(new Float64Array(16));return jh(l,l,[i.point.x,i.point.y,0]),vc(l,l,[o,o,e]),Float32Array.from(l)},a.circumferenceAtLatitude=Wu,a.clamp=an,a.clearTileCache=function(i){if(!Ve())return;const e=se.caches.delete(Sn);i&&e.catch(i).then(()=>i())},a.clipLine=T3,a.clone=function(i){var e=new Cl(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},a.clone$1=ar,a.collisionCircleLayout=U8,a.config=ee,a.conjugate=function(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=e[3],i},a.create=function(){var i=new Cl(16);return Cl!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},a.create$1=Hh,a.createExpression=Me,a.createLayout=Zt,a.createStyleLayer=function(i){return"custom"===i.type?new G2(i):new N3[i.type](i)},a.cross=xc,a.degToRad=je,a.distance=function(i,e){return Math.hypot(e[0]-i[0],e[1]-i[1],e[2]-i[2])},a.div=function(i,e,o){return i[0]=e[0]/o[0],i[1]=e[1]/o[1],i[2]=e[2]/o[2],i},a.dot=yc,a.earthRadius=G1,a.ease=Rn,a.easeCubicInOut=St,a.ecefToLatLng=function([i,e,o]){const l=Math.hypot(i,e,o),h=Math.atan2(i,o),p=.5*Math.PI-Math.acos(-e/l);return new Po(At(h),At(p))},a.emitValidationErrors=wa,a.endsWith=Yn,a.enforceCacheSizeLimit=function(i){gt(),Xe&&Xe.then(e=>{e.keys().then(o=>{for(let l=0;l<o.length-i;l++)e.delete(o[l])})})},a.evaluateSizeForFeature=pd,a.evaluateSizeForZoom=Eh,a.evaluateVariableOffset=Cd,a.evented=y,a.exactEquals=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]},a.exactEquals$1=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]},a.exported=mo,a.exported$1=fe,a.extend=$n,a.extend$1=xn,a.fillExtrusionHeightLift=M2,a.filterObject=qn,a.fromMat4=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i},a.fromQuat=function(i,e){var o=e[0],l=e[1],h=e[2],p=e[3],g=o+o,x=l+l,w=h+h,T=o*g,P=l*g,O=l*x,k=h*g,j=h*x,q=h*w,ue=p*g,Be=p*x,tt=p*w;return i[0]=1-O-q,i[1]=P+tt,i[2]=k-Be,i[3]=0,i[4]=P-tt,i[5]=1-T-q,i[6]=j+ue,i[7]=0,i[8]=k+Be,i[9]=j-ue,i[10]=1-T-O,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},a.fromRotation=function(i,e){var o=Math.sin(e),l=Math.cos(e);return i[0]=l,i[1]=o,i[2]=0,i[3]=-o,i[4]=l,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},a.fromScaling=R1,a.furthestTileCorner=function(i){const e=Math.round((i+45+360)%360/90)%4;return Ze[e]},a.getAABBPointSquareDist=function(i,e,o){let l=0;for(let h=0;h<2;++h){const p=o?o[h]:0;i[h]>p&&(l+=(i[h]-p)*(i[h]-p)),e[h]<p&&(l+=(p-e[h])*(p-e[h]))}return l},a.getAnchorAlignment=e4,a.getAnchorJustification=lu,a.getBounds=function(i){let e=1/0,o=1/0,l=-1/0,h=-1/0;for(const p of i)e=Math.min(e,p.x),o=Math.min(o,p.y),l=Math.max(l,p.x),h=Math.max(h,p.y);return{min:new et(e,o),max:new et(l,h)}},a.getColumn=Ai,a.getDefaultExportFromCjs=bt,a.getGridMatrix=function(i,e,o,l){const h=e.getNorth(),p=e.getSouth(),g=e.getWest(),x=e.getEast(),w=1<<i.z,T=x-g,P=h-p,O=T/64,k=-P/ph[o],j=[0,O,0,k,0,0,h,g,0];if(i.z>0){const q=180/l;Uh(j,j,[q/T+1,0,0,0,q/P+1,0,-.5*q/O,.5*q/k,1])}return j[2]=w,j[5]=i.x,j[8]=i.y,j},a.getImage=dt,a.getJSON=function(i,e){return ti($n(i,{type:"json"}),e)},a.getLatitudinalLod=function(i){const e=Ca-5;i=an(i,-e,e)/e*90;const o=Math.pow(Math.abs(Math.sin(je(i))),3);return Math.round(o*(ph.length-1))},a.getMapSessionAPI=Ci,a.getPerformanceMeasurement=Xi,a.getProjection=l4,a.getRTLTextPluginStatus=b,a.getReferrer=Hi,a.getTilePoint=function(i,{x:e,y:o},l=0){return new et(((e-l)*i.scale-i.x)*dr,(o*i.scale-i.y)*dr)},a.getTileVec3=function(i,e,o=0){return gu(((e.x-o)*i.scale-i.x)*dr,(e.y*i.scale-i.y)*dr,qh(e.z,e.y))},a.getVideo=function(i,e){const o=se.document.createElement("video");o.muted=!0,o.onloadstart=function(){e(null,o)};for(let l=0;l<i.length;l++){const h=se.document.createElement("source");gi(i[l])||(o.crossOrigin="Anonymous"),h.src=i[l],o.appendChild(h)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(i){const e=[0,0,0],o=oc(new Float64Array(16));return mu(o,i.pixelMatrix,i.globeMatrix),ia(e,e,o),new et(e[0],e[1])},a.globeDenormalizeECEF=Y1,a.globeECEFOrigin=function(i,e){const o=[0,0,0];return ia(o,o,ac(jc(e.canonical))),ia(o,o,i),o},a.globeMetersToEcef=B1,a.globeNormalizeECEF=ac,a.globePixelsToTileUnits=function(i,e){return dr/(512*Math.pow(2,i))*f0(jc(e))},a.globePoleMatrixForTile=function(i,e,o){const l=oc(new Float64Array(16)),h=(e/(1<<i)-.5)*Math.PI*2;return L1(l,o.globeMatrix,h),Float32Array.from(l)},a.globeTileBounds=jc,a.globeTiltAtLngLat=e2,a.globeToMercatorTransition=gh,a.globeUseCustomAntiAliasing=function(i,e,o){const l=gh(o.zoom),h=i.style.map._antialias,p=!!e.extStandardDerivatives,g=e.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return 0===l&&!h&&!g&&p},a.identity=oc,a.identity$1=a0,a.invert=O1,a.isFullscreen=function(){return!!se.document.fullscreenElement||!!se.document.webkitFullscreenElement},a.isLngLatBehindGlobe=$1,a.isMapAuthenticated=function(i){return Do.has(i)},a.isMapboxURL=Ke,a.isSafariWithAntialiasingBug=function(i){const e=i.navigator?i.navigator.userAgent:null;return!!jt(i)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=dl,a.latLngToECEF=Kh,a.len=r0,a.length=F1,a.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},a.lngFromMercatorX=Ea,a.loadVectorTile=v4,a.makeRequest=ti,a.mapValue=function(i,e,o,l,h){return an((i-e)/(o-e)*(h-l)+l,l,h)},a.mercatorScale=n2,a.mercatorXfromLng=wc,a.mercatorYfromLat=Yc,a.mercatorZfromAltitude=lc,a.mul=Hf,a.mul$1=N1,a.multiply=mu,a.multiply$1=Uh,a.multiply$2=dh,a.nextPowerOfTwo=pn,a.normalize=Tl,a.normalize$1=Yu,a.normalize$2=o0,a.number=Hr,a.ortho=function(i,e,o,l,h,p,g){var x=1/(e-o),w=1/(l-h),T=1/(p-g);return i[0]=-2*x,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*w,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*T,i[11]=0,i[12]=(e+o)*x,i[13]=(h+l)*w,i[14]=(g+p)*T,i[15]=1,i},a.pbf=$0,a.perspective=function(i,e,o,l,h){var p,g=1/Math.tan(e/2);return i[0]=g/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=g,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,null!=h&&h!==1/0?(i[10]=(h+l)*(p=1/(l-h)),i[14]=2*h*l*p):(i[10]=-1,i[14]=-2*l),i},a.pick=function(i,e){const o={};for(let l=0;l<e.length;l++){const h=e[l];h in i&&(o[h]=i[h])}return o},a.plugin=z,a.pointGeometry=Yt,a.polesInViewport=function(i){const e=oc(new Float64Array(16));mu(e,i.pixelMatrix,i.globeMatrix);const o=[0,Jl,0],l=[0,$l,0];return ia(o,o,e),ia(l,l,e),[o[0]>0&&o[0]<=i.width&&o[1]>0&&o[1]<=i.height&&!$1(i,new Po(i.center.lat,90)),l[0]>0&&l[0]<=i.width&&l[1]>0&&l[1]<=i.height&&!$1(i,new Po(i.center.lat,-90))]},a.polygonContainsPoint=wu,a.polygonIntersectsBox=s2,a.polygonIntersectsPolygon=g0,a.polygonizeBounds=function(i,e,o=0,l=!0){const h=new et(o,o),p=i.sub(h),g=e.add(h),x=[p,new et(g.x,p.y),g,new et(p.x,g.y)];return l&&x.push(p.clone()),x},a.posAttributes=Uc,a.postMapLoadEvent=Cr,a.postPerformanceEvent=eo,a.postTurnstileEvent=xi,a.potpack=m1,a.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},a.radToDeg=At,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(i){return i({pluginStatus:d,pluginURL:r}),y.on("pluginStateChange",i),i},a.removeAuthState=function(i){Do.delete(i)},a.renderColorRamp=Q1,a.resample=Zh,a.rotateX=Hu,a.rotateX$1=Z4,a.rotateY=L1,a.rotateY$1=$h,a.rotateZ=function(i,e,o){var l=Math.sin(o),h=Math.cos(o),p=e[0],g=e[1],x=e[2],w=e[3],T=e[4],P=e[5],O=e[6],k=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=p*h+T*l,i[1]=g*h+P*l,i[2]=x*h+O*l,i[3]=w*h+k*l,i[4]=T*h-p*l,i[5]=P*h-g*l,i[6]=O*h-x*l,i[7]=k*h-w*l,i},a.rotateZ$1=function(i,e,o){o*=.5;var l=e[0],h=e[1],p=e[2],g=e[3],x=Math.sin(o),w=Math.cos(o);return i[0]=l*w+h*x,i[1]=h*w-l*x,i[2]=p*w+g*x,i[3]=g*w-p*x,i},a.scale=vc,a.scale$1=q4,a.scale$2=_c,a.scaleAndAdd=fh,a.set=function(i,e,o,l){return i[0]=e,i[1]=o,i[2]=l,i},a.setCacheLimits=function(i,e){On=i,st=e},a.setColumn=function(i,e,o){i[4*e+0]=o[0],i[4*e+1]=o[1],i[4*e+2]=o[2],i[4*e+3]=o[3]},a.setRTLTextPlugin=function(i,e,o=!1){if(d===$||d===me||d===We)throw new Error("setRTLTextPlugin cannot be called multiple times.");r=mo.resolveURL(i),d=$,kt=e,m(),o||S()},a.smoothstep=Un,a.spec=ht,a.squaredLength=function(i){var e=i[0],o=i[1],l=i[2];return e*e+o*o+l*l},a.storeAuthState=function(i,e){e?Do.add(i):Do.delete(i)},a.sub=bc,a.subtract=n0,a.symbolSize=d3,a.tileAABB=function(i,e,o,l,h,p,g,x,w){if("globe"===w.name)return function I8(i,e,o){const l=e/i.worldSize,h=i.globeMatrix;if(o.z<=1){const _n=jc(o).getCorners();return J4(_n,h,l),Dl.fromPoints(_n)}const p=Wh(o),g=U1(p);J4(g,h,l);const x=Number.MAX_VALUE,w=[-x,-x,-x],T=[x,x,x];if(p.contains(i.center)){for(const hi of g)Uu(T,T,hi),vu(w,w,hi);w[2]=0;const _n=i.point,Vn=[_n.x*l,_n.y*l,0];return Uu(T,T,Vn),vu(w,w,Vn),new Dl(T,w)}const P=[h[12]*l,h[13]*l,h[14]*l],O=p.getCenter(),k=an(i.center.lat,-Ca,Ca),j=an(O.lat,-Ca,Ca),q=wc(i.center.lng),ue=Yc(k);let Be=q-wc(O.lng);const tt=ue-Yc(j);Be>.5?Be-=1:Be<-.5&&(Be+=1);let _t=0;Math.abs(Be)>Math.abs(tt)?_t=Be>=0?1:3:(_t=tt>=0?0:2,fh(P,P,[h[4]*l,h[5]*l,h[6]*l],-Math.sin(je(tt>=0?p.getSouth():p.getNorth()))*kc));const rt=g[_t],Dt=g[(_t+1)%4],Rt=new Yf(rt,Dt,P),Vt=[H1(Rt,0)||rt[0],H1(Rt,1)||rt[1],H1(Rt,2)||rt[2]],bn=gh(i.zoom);if(bn>0){const _n=function({x:hi,y:En,z:Kn},Gn,oi,pi,kn){const Ii=1/(1<<Kn);let qi=hi*Ii,Li=qi+Ii,Xr=En*Ii,yi=Xr+Ii,gr=0;const jr=(qi+Li)/2-pi;return jr>.5?gr=-1:jr<-.5&&(gr=1),qi=((qi+gr)*Gn-(pi*=Gn))*oi+pi,Li=((Li+gr)*Gn-pi)*oi+pi,Xr=(Xr*Gn-(kn*=Gn))*oi+kn,yi=(yi*Gn-kn)*oi+kn,[[qi,yi,0],[Li,yi,0],[Li,Xr,0],[qi,Xr,0]]}(o,e,i._pixelsPerMercatorPixel,q,ue);for(let hi=0;hi<g.length;hi++)xu(g[hi],_n[hi],bn);const Vn=sc([],_n[_t],_n[(_t+1)%4]);_c(Vn,Vn,.5),xu(Vt,Vn,bn)}for(const _n of g)Uu(T,T,_n),vu(w,w,_n);return T[2]=Math.min(rt[2],Dt[2]),Uu(T,T,Vt),vu(w,w,Vt),new Dl(T,w)}(i,e,new Ec(o,l,h));const T=cu({z:o,x:l,y:h},w);return new Dl([(p+T.x/T.scale)*e,e*(T.y/T.scale),g],[(p+T.x2/T.scale)*e,e*(T.y2/T.scale),x])},a.tileCornersToBounds=Wh,a.tileTransform=cu,a.transformMat3=function(i,e,o){var l=e[0],h=e[1],p=e[2];return i[0]=l*o[0]+h*o[3]+p*o[6],i[1]=l*o[1]+h*o[4]+p*o[7],i[2]=l*o[2]+h*o[5]+p*o[8],i},a.transformMat4=ia,a.transformMat4$1=_u,a.transformQuat=Yh,a.transitionTileAABBinECEF=d0,a.translate=jh,a.transpose=function(i,e){if(i===e){var o=e[1],l=e[2],h=e[5];i[1]=e[3],i[2]=e[6],i[3]=o,i[5]=e[7],i[6]=l,i[7]=h}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8];return i},a.triggerPluginCompletionEvent=u,a.uniqueId=Jt,a.updateGlobeVertexNormal=function(i,e,o,l,h){const p=5*e+2;i.float32[p+0]=o,i.float32[p+1]=l,i.float32[p+2]=h},a.validateCustomStyleLayer=function(i){const e=[],o=i.id;return void 0===o&&e.push({message:`layers.${o}: missing required property "id"`}),void 0===i.render&&e.push({message:`layers.${o}: missing required method "render"`}),i.renderingMode&&"2d"!==i.renderingMode&&"3d"!==i.renderingMode&&e.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),e},a.validateFilter=i=>Jo(ic(i)),a.validateFog=i=>Jo(dc(i)),a.validateLayer=i=>Jo(ul(i)),a.validateLight=i=>Jo(Ss(i)),a.validateSource=i=>Jo(Fo(i)),a.validateStyle=pc,a.validateTerrain=i=>Jo(kr(i)),a.values=Wn,a.vectorTile=od,a.version=Fe,a.warnOnce=Si,a.window=se,a.wrap=nn}),C(0,function(a){function se(lt){if("number"==typeof lt||"boolean"==typeof lt||"string"==typeof lt||null==lt)return JSON.stringify(lt);if(Array.isArray(lt)){let Se="[";for(const dt of lt)Se+=`${se(dt)},`;return`${Se}]`}let Pe="{";for(const Se of Object.keys(lt).sort())Pe+=`${Se}:${se(lt[Se])},`;return`${Pe}}`}function Fe(lt){let Pe="";for(const Se of a.refProperties)Pe+=`/${se(lt[Se])}`;return Pe}class ve{constructor(Pe){this.keyCache={},Pe&&this.replace(Pe)}replace(Pe){this._layerConfigs={},this._layers={},this.update(Pe,[])}update(Pe,Se){for(const Oe of Pe)this._layerConfigs[Oe.id]=Oe,(this._layers[Oe.id]=a.createStyleLayer(Oe)).compileFilter(),this.keyCache[Oe.id]&&delete this.keyCache[Oe.id];for(const Oe of Se)delete this.keyCache[Oe],delete this._layerConfigs[Oe],delete this._layers[Oe];this.familiesBySource={};const dt=function(Oe,Ke){const Et={};for(let ae=0;ae<Oe.length;ae++){const Z=Ke&&Ke[Oe[ae].id]||Fe(Oe[ae]);Ke&&(Ke[Oe[ae].id]=Z);let Y=Et[Z];Y||(Y=Et[Z]=[]),Y.push(Oe[ae])}const Ie=[];for(const ae in Et)Ie.push(Et[ae]);return Ie}(a.values(this._layerConfigs),this.keyCache);for(const Oe of dt){const Ke=Oe.map(_e=>this._layers[_e.id]),Et=Ke[0];if("none"===Et.visibility)continue;const Ie=Et.source||"";let ae=this.familiesBySource[Ie];ae||(ae=this.familiesBySource[Ie]={});const Z=Et.sourceLayer||"_geojsonTileLayer";let Y=ae[Z];Y||(Y=ae[Z]=[]),Y.push(Ke)}}}class ee{loadTile(Pe,Se){const{uid:dt,encoding:Oe,rawImageData:Ke,padding:Et,buildQuadTree:Ie}=Pe,ae=a.window.ImageBitmap&&Ke instanceof a.window.ImageBitmap?this.getImageData(Ke,Et):Ke;Se(null,new a.DEMData(dt,ae,Oe,Et<1,Ie))}getImageData(Pe,Se){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Pe.width,Pe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Pe.width,this.offscreenCanvas.height=Pe.height,this.offscreenCanvasContext.drawImage(Pe,0,0,Pe.width,Pe.height);const dt=this.offscreenCanvasContext.getImageData(-Se,-Se,Pe.width+2*Se,Pe.height+2*Se);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),dt}}function fe(lt,Pe){if(0!==lt.length){he(lt[0],Pe);for(var Se=1;Se<lt.length;Se++)he(lt[Se],!Pe)}}function he(lt,Pe){for(var Se=0,dt=0,Oe=0,Ke=lt.length,Et=Ke-1;Oe<Ke;Et=Oe++){var Ie=(lt[Oe][0]-lt[Et][0])*(lt[Et][1]+lt[Oe][1]),ae=Se+Ie;dt+=Math.abs(Se)>=Math.abs(Ie)?Se-ae+Ie:Ie-ae+Se,Se=ae}Se+dt>=0!=!!Pe&&lt.reverse()}var ge=a.getDefaultExportFromCjs(function lt(Pe,Se){var dt,Oe=Pe&&Pe.type;if("FeatureCollection"===Oe)for(dt=0;dt<Pe.features.length;dt++)lt(Pe.features[dt],Se);else if("GeometryCollection"===Oe)for(dt=0;dt<Pe.geometries.length;dt++)lt(Pe.geometries[dt],Se);else if("Feature"===Oe)lt(Pe.geometry,Se);else if("Polygon"===Oe)fe(Pe.coordinates,Se);else if("MultiPolygon"===Oe)for(dt=0;dt<Pe.coordinates.length;dt++)fe(Pe.coordinates[dt],Se);return Pe});const at=a.VectorTileFeature.prototype.toGeoJSON;var mt={exports:{}},$e=a.pointGeometry,ze=a.vectorTile.VectorTileFeature,bt=xt;function xt(lt,Pe){this.options=Pe||{},this.features=lt,this.length=lt.length}function Qt(lt,Pe){this.id="number"==typeof lt.id?lt.id:void 0,this.type=lt.type,this.rawGeometry=1===lt.type?[lt.geometry]:lt.geometry,this.properties=lt.tags,this.extent=Pe||4096}xt.prototype.feature=function(lt){return new Qt(this.features[lt],this.options.extent)},Qt.prototype.loadGeometry=function(){var lt=this.rawGeometry;this.geometry=[];for(var Pe=0;Pe<lt.length;Pe++){for(var Se=lt[Pe],dt=[],Oe=0;Oe<Se.length;Oe++)dt.push(new $e(Se[Oe][0],Se[Oe][1]));this.geometry.push(dt)}return this.geometry},Qt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var lt=this.geometry,Pe=1/0,Se=-1/0,dt=1/0,Oe=-1/0,Ke=0;Ke<lt.length;Ke++)for(var Et=lt[Ke],Ie=0;Ie<Et.length;Ie++){var ae=Et[Ie];Pe=Math.min(Pe,ae.x),Se=Math.max(Se,ae.x),dt=Math.min(dt,ae.y),Oe=Math.max(Oe,ae.y)}return[Pe,dt,Se,Oe]},Qt.prototype.toGeoJSON=ze.prototype.toGeoJSON;var sn=a.pbf,Yt=bt;function Ut(lt){var Pe=new sn;return function(Se,dt){for(var Oe in Se.layers)dt.writeMessage(3,et,Se.layers[Oe])}(lt,Pe),Pe.finish()}function et(lt,Pe){var Se;Pe.writeVarintField(15,lt.version||1),Pe.writeStringField(1,lt.name||""),Pe.writeVarintField(5,lt.extent||4096);var dt={keys:[],values:[],keycache:{},valuecache:{}};for(Se=0;Se<lt.length;Se++)dt.feature=lt.feature(Se),Pe.writeMessage(2,It,dt);var Oe=dt.keys;for(Se=0;Se<Oe.length;Se++)Pe.writeStringField(3,Oe[Se]);var Ke=dt.values;for(Se=0;Se<Ke.length;Se++)Pe.writeMessage(4,St,Ke[Se])}function It(lt,Pe){var Se=lt.feature;void 0!==Se.id&&Pe.writeVarintField(1,Se.id),Pe.writeMessage(2,zt,lt),Pe.writeVarintField(3,Se.type),Pe.writeMessage(4,Ze,Se)}function zt(lt,Pe){var Se=lt.feature,dt=lt.keys,Oe=lt.values,Ke=lt.keycache,Et=lt.valuecache;for(var Ie in Se.properties){var ae=Se.properties[Ie],Z=Ke[Ie];if(null!==ae){void 0===Z&&(dt.push(Ie),Ke[Ie]=Z=dt.length-1),Pe.writeVarint(Z);var Y=typeof ae;"string"!==Y&&"boolean"!==Y&&"number"!==Y&&(ae=JSON.stringify(ae));var _e=Y+":"+ae,re=Et[_e];void 0===re&&(Oe.push(ae),Et[_e]=re=Oe.length-1),Pe.writeVarint(re)}}}function je(lt,Pe){return(Pe<<3)+(7&lt)}function At(lt){return lt<<1^lt>>31}function Ze(lt,Pe){for(var Se=lt.loadGeometry(),dt=lt.type,Oe=0,Ke=0,Et=Se.length,Ie=0;Ie<Et;Ie++){var ae=Se[Ie],Z=1;1===dt&&(Z=ae.length),Pe.writeVarint(je(1,Z));for(var Y=3===dt?ae.length-1:ae.length,_e=0;_e<Y;_e++){1===_e&&1!==dt&&Pe.writeVarint(je(2,Y-1));var re=ae[_e].x-Oe,Je=ae[_e].y-Ke;Pe.writeVarint(At(re)),Pe.writeVarint(At(Je)),Oe+=re,Ke+=Je}3===dt&&Pe.writeVarint(je(7,1))}}function St(lt,Pe){var Se=typeof lt;"string"===Se?Pe.writeStringField(1,lt):"boolean"===Se?Pe.writeBooleanField(7,lt):"number"===Se&&(lt%1!=0?Pe.writeDoubleField(3,lt):lt<0?Pe.writeSVarintField(6,lt):Pe.writeVarintField(5,lt))}mt.exports=Ut,mt.exports.fromVectorTileJs=Ut,mt.exports.fromGeojsonVt=function(lt,Pe){Pe=Pe||{};var Se={};for(var dt in lt)Se[dt]=new Yt(lt[dt].features,Pe),Se[dt].name=dt,Se[dt].version=Pe.version,Se[dt].extent=Pe.extent;return Ut({layers:Se})},mt.exports.GeoJSONWrapper=Yt;var wn=a.getDefaultExportFromCjs(mt.exports);const Rn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:lt=>lt},an=Math.fround||(Un=new Float32Array(1),lt=>(Un[0]=+lt,Un[0]));var Un;const nn=3,di=5,Wn=6;class $n{constructor(Pe){this.options=Object.assign(Object.create(Rn),Pe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Pe){const{log:Se,minZoom:dt,maxZoom:Oe}=this.options;Se&&console.time("total time");const Ke=`prepare ${Pe.length} points`;Se&&console.time(Ke),this.points=Pe;const Et=[];for(let ae=0;ae<Pe.length;ae++){const Z=Pe[ae];if(!Z.geometry)continue;const[Y,_e]=Z.geometry.coordinates,re=an(un(Y)),Je=an(pn(_e));Et.push(re,Je,1/0,ae,-1,1),this.options.reduce&&Et.push(0)}let Ie=this.trees[Oe+1]=this._createTree(Et);Se&&console.timeEnd(Ke);for(let ae=Oe;ae>=dt;ae--){const Z=+Date.now();Ie=this.trees[ae]=this._createTree(this._cluster(Ie,ae)),Se&&console.log("z%d: %d clusters in %dms",ae,Ie.numItems,+Date.now()-Z)}return Se&&console.timeEnd("total time"),this}getClusters(Pe,Se){let dt=((Pe[0]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,Pe[1]));let Ke=180===Pe[2]?180:((Pe[2]+180)%360+360)%360-180;const Et=Math.max(-90,Math.min(90,Pe[3]));if(Pe[2]-Pe[0]>=360)dt=-180,Ke=180;else if(dt>Ke){const _e=this.getClusters([dt,Oe,180,Et],Se),re=this.getClusters([-180,Oe,Ke,Et],Se);return _e.concat(re)}const Ie=this.trees[this._limitZoom(Se)],ae=Ie.range(un(dt),pn(Et),un(Ke),pn(Oe)),Z=Ie.data,Y=[];for(const _e of ae){const re=this.stride*_e;Y.push(Z[re+di]>1?ki(Z,re,this.clusterProps):this.points[Z[re+nn]])}return Y}getChildren(Pe){const Se=this._getOriginId(Pe),dt=this._getOriginZoom(Pe),Oe="No cluster with the specified id.",Ke=this.trees[dt];if(!Ke)throw new Error(Oe);const Et=Ke.data;if(Se*this.stride>=Et.length)throw new Error(Oe);const Ie=this.options.radius/(this.options.extent*Math.pow(2,dt-1)),ae=Ke.within(Et[Se*this.stride],Et[Se*this.stride+1],Ie),Z=[];for(const Y of ae){const _e=Y*this.stride;Et[_e+4]===Pe&&Z.push(Et[_e+di]>1?ki(Et,_e,this.clusterProps):this.points[Et[_e+nn]])}if(0===Z.length)throw new Error(Oe);return Z}getLeaves(Pe,Se,dt){const Oe=[];return this._appendLeaves(Oe,Pe,Se=Se||10,dt=dt||0,0),Oe}getTile(Pe,Se,dt){const Oe=this.trees[this._limitZoom(Pe)],Ke=Math.pow(2,Pe),{extent:Et,radius:Ie}=this.options,ae=Ie/Et,Z=(dt-ae)/Ke,Y=(dt+1+ae)/Ke,_e={features:[]};return this._addTileFeatures(Oe.range((Se-ae)/Ke,Z,(Se+1+ae)/Ke,Y),Oe.data,Se,dt,Ke,_e),0===Se&&this._addTileFeatures(Oe.range(1-ae/Ke,Z,1,Y),Oe.data,Ke,dt,Ke,_e),Se===Ke-1&&this._addTileFeatures(Oe.range(0,Z,ae/Ke,Y),Oe.data,-1,dt,Ke,_e),_e.features.length?_e:null}getClusterExpansionZoom(Pe){let Se=this._getOriginZoom(Pe)-1;for(;Se<=this.options.maxZoom;){const dt=this.getChildren(Pe);if(Se++,1!==dt.length)break;Pe=dt[0].properties.cluster_id}return Se}_appendLeaves(Pe,Se,dt,Oe,Ke){const Et=this.getChildren(Se);for(const Ie of Et){const ae=Ie.properties;if(ae&&ae.cluster?Ke+ae.point_count<=Oe?Ke+=ae.point_count:Ke=this._appendLeaves(Pe,ae.cluster_id,dt,Oe,Ke):Ke<Oe?Ke++:Pe.push(Ie),Pe.length===dt)break}return Ke}_createTree(Pe){const Se=new a.KDBush(Pe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let dt=0;dt<Pe.length;dt+=this.stride)Se.add(Pe[dt],Pe[dt+1]);return Se.finish(),Se.data=Pe,Se}_addTileFeatures(Pe,Se,dt,Oe,Ke,Et){for(const Ie of Pe){const ae=Ie*this.stride,Z=Se[ae+di]>1;let Y,_e,re;if(Z)Y=Jt(Se,ae,this.clusterProps),_e=Se[ae],re=Se[ae+1];else{const Cn=this.points[Se[ae+nn]];Y=Cn.properties;const[ni,xi]=Cn.geometry.coordinates;_e=un(ni),re=pn(xi)}const Je={type:1,geometry:[[Math.round(this.options.extent*(_e*Ke-dt)),Math.round(this.options.extent*(re*Ke-Oe))]],tags:Y};let Pt;Pt=Z||this.options.generateId?Se[ae+nn]:this.points[Se[ae+nn]].id,void 0!==Pt&&(Je.id=Pt),Et.features.push(Je)}}_limitZoom(Pe){return Math.max(this.options.minZoom,Math.min(Math.floor(+Pe),this.options.maxZoom+1))}_cluster(Pe,Se){const{radius:dt,extent:Oe,reduce:Ke,minPoints:Et}=this.options,Ie=dt/(Oe*Math.pow(2,Se)),ae=Pe.data,Z=[],Y=this.stride;for(let _e=0;_e<ae.length;_e+=Y){if(ae[_e+2]<=Se)continue;ae[_e+2]=Se;const re=ae[_e],Je=ae[_e+1],Pt=Pe.within(ae[_e],ae[_e+1],Ie),Cn=ae[_e+di];let ni=Cn;for(const xi of Pt){const sr=xi*Y;ae[sr+2]>Se&&(ni+=ae[sr+di])}if(ni>Cn&&ni>=Et){let xi,sr=re*Cn,Cr=Je*Cn,Jr=-1;const eo=(_e/Y<<5)+(Se+1)+this.points.length;for(const Lr of Pt){const Ci=Lr*Y;if(ae[Ci+2]<=Se)continue;ae[Ci+2]=Se;const Do=ae[Ci+di];sr+=ae[Ci]*Do,Cr+=ae[Ci+1]*Do,ae[Ci+4]=eo,Ke&&(xi||(xi=this._map(ae,_e,!0),Jr=this.clusterProps.length,this.clusterProps.push(xi)),Ke(xi,this._map(ae,Ci)))}ae[_e+4]=eo,Z.push(sr/ni,Cr/ni,1/0,eo,-1,ni),Ke&&Z.push(Jr)}else{for(let xi=0;xi<Y;xi++)Z.push(ae[_e+xi]);if(ni>1)for(const xi of Pt){const sr=xi*Y;if(!(ae[sr+2]<=Se)){ae[sr+2]=Se;for(let Cr=0;Cr<Y;Cr++)Z.push(ae[sr+Cr])}}}}return Z}_getOriginId(Pe){return Pe-this.points.length>>5}_getOriginZoom(Pe){return(Pe-this.points.length)%32}_map(Pe,Se,dt){if(Pe[Se+di]>1){const Et=this.clusterProps[Pe[Se+Wn]];return dt?Object.assign({},Et):Et}const Oe=this.points[Pe[Se+nn]].properties,Ke=this.options.map(Oe);return dt&&Ke===Oe?Object.assign({},Ke):Ke}}function ki(lt,Pe,Se){return{type:"Feature",id:lt[Pe+nn],properties:Jt(lt,Pe,Se),geometry:{type:"Point",coordinates:[(dt=lt[Pe],360*(dt-.5)),dn(lt[Pe+1])]}};var dt}function Jt(lt,Pe,Se){const dt=lt[Pe+di],Oe=dt>=1e4?`${Math.round(dt/1e3)}k`:dt>=1e3?Math.round(dt/100)/10+"k":dt,Ke=lt[Pe+Wn],Et=-1===Ke?{}:Object.assign({},Se[Ke]);return Object.assign(Et,{cluster:!0,cluster_id:lt[Pe+nn],point_count:dt,point_count_abbreviated:Oe})}function un(lt){return lt/360+.5}function pn(lt){const Pe=Math.sin(lt*Math.PI/180),Se=.5-.25*Math.log((1+Pe)/(1-Pe))/Math.PI;return Se<0?0:Se>1?1:Se}function dn(lt){const Pe=(180-360*lt)*Math.PI/180;return 360*Math.atan(Math.exp(Pe))/Math.PI-90}function jn(lt,Pe,Se,dt){for(var Oe,Ke=dt,Et=Se-Pe>>1,Ie=Se-Pe,ae=lt[Pe],Z=lt[Pe+1],Y=lt[Se],_e=lt[Se+1],re=Pe+3;re<Se;re+=3){var Je=Yn(lt[re],lt[re+1],ae,Z,Y,_e);if(Je>Ke)Oe=re,Ke=Je;else if(Je===Ke){var Pt=Math.abs(re-Et);Pt<Ie&&(Oe=re,Ie=Pt)}}Ke>dt&&(Oe-Pe>3&&jn(lt,Pe,Oe,dt),lt[Oe+2]=Ke,Se-Oe>3&&jn(lt,Oe,Se,dt))}function Yn(lt,Pe,Se,dt,Oe,Ke){var Et=Oe-Se,Ie=Ke-dt;if(0!==Et||0!==Ie){var ae=((lt-Se)*Et+(Pe-dt)*Ie)/(Et*Et+Ie*Ie);ae>1?(Se=Oe,dt=Ke):ae>0&&(Se+=Et*ae,dt+=Ie*ae)}return(Et=lt-Se)*Et+(Ie=Pe-dt)*Ie}function zn(lt,Pe,Se,dt){var Oe={id:void 0===lt?null:lt,type:Pe,geometry:Se,tags:dt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ke){var Et=Ke.geometry,Ie=Ke.type;if("Point"===Ie||"MultiPoint"===Ie||"LineString"===Ie)qn(Ke,Et);else if("Polygon"===Ie||"MultiLineString"===Ie)for(var ae=0;ae<Et.length;ae++)qn(Ke,Et[ae]);else if("MultiPolygon"===Ie)for(ae=0;ae<Et.length;ae++)for(var Z=0;Z<Et[ae].length;Z++)qn(Ke,Et[ae][Z])}(Oe),Oe}function qn(lt,Pe){for(var Se=0;Se<Pe.length;Se+=3)lt.minX=Math.min(lt.minX,Pe[Se]),lt.minY=Math.min(lt.minY,Pe[Se+1]),lt.maxX=Math.max(lt.maxX,Pe[Se]),lt.maxY=Math.max(lt.maxY,Pe[Se+1])}function ar(lt,Pe,Se,dt){if(Pe.geometry){var Oe=Pe.geometry.coordinates,Ke=Pe.geometry.type,Et=Math.pow(Se.tolerance/((1<<Se.maxZoom)*Se.extent),2),Ie=[],ae=Pe.id;if(Se.promoteId?ae=Pe.properties[Se.promoteId]:Se.generateId&&(ae=dt||0),"Point"===Ke)Gi(Oe,Ie);else if("MultiPoint"===Ke)for(var Z=0;Z<Oe.length;Z++)Gi(Oe[Z],Ie);else if("LineString"===Ke)Si(Oe,Ie,Et,!1);else if("MultiLineString"===Ke){if(Se.lineMetrics){for(Z=0;Z<Oe.length;Z++)Si(Oe[Z],Ie=[],Et,!1),lt.push(zn(ae,"LineString",Ie,Pe.properties));return}Mi(Oe,Ie,Et,!1)}else if("Polygon"===Ke)Mi(Oe,Ie,Et,!0);else{if("MultiPolygon"!==Ke){if("GeometryCollection"===Ke){for(Z=0;Z<Pe.geometry.geometries.length;Z++)ar(lt,{id:ae,geometry:Pe.geometry.geometries[Z],properties:Pe.properties},Se,dt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Z=0;Z<Oe.length;Z++){var Y=[];Mi(Oe[Z],Y,Et,!0),Ie.push(Y)}}lt.push(zn(ae,Ke,Ie,Pe.properties))}}function Gi(lt,Pe){Pe.push(Br(lt[0])),Pe.push(ji(lt[1])),Pe.push(0)}function Si(lt,Pe,Se,dt){for(var Oe,Ke,Et=0,Ie=0;Ie<lt.length;Ie++){var ae=Br(lt[Ie][0]),Z=ji(lt[Ie][1]);Pe.push(ae),Pe.push(Z),Pe.push(0),Ie>0&&(Et+=dt?(Oe*Z-ae*Ke)/2:Math.sqrt(Math.pow(ae-Oe,2)+Math.pow(Z-Ke,2))),Oe=ae,Ke=Z}var Y=Pe.length-3;Pe[2]=1,jn(Pe,0,Y,Se),Pe[Y+2]=1,Pe.size=Math.abs(Et),Pe.start=0,Pe.end=Pe.size}function Mi(lt,Pe,Se,dt){for(var Oe=0;Oe<lt.length;Oe++){var Ke=[];Si(lt[Oe],Ke,Se,dt),Pe.push(Ke)}}function Br(lt){return lt/360+.5}function ji(lt){var Pe=Math.sin(lt*Math.PI/180),Se=.5-.25*Math.log((1+Pe)/(1-Pe))/Math.PI;return Se<0?0:Se>1?1:Se}function Ln(lt,Pe,Se,dt,Oe,Ke,Et,Ie){if(dt/=Pe,Ke>=(Se/=Pe)&&Et<dt)return lt;if(Et<Se||Ke>=dt)return null;for(var ae=[],Z=0;Z<lt.length;Z++){var Y=lt[Z],_e=Y.geometry,re=Y.type,Je=0===Oe?Y.minX:Y.minY,Pt=0===Oe?Y.maxX:Y.maxY;if(Je>=Se&&Pt<dt)ae.push(Y);else if(!(Pt<Se||Je>=dt)){var Cn=[];if("Point"===re||"MultiPoint"===re)Bt(_e,Cn,Se,dt,Oe);else if("LineString"===re)jt(_e,Cn,Se,dt,Oe,!1,Ie.lineMetrics);else if("MultiLineString"===re)Ai(_e,Cn,Se,dt,Oe,!1);else if("Polygon"===re)Ai(_e,Cn,Se,dt,Oe,!0);else if("MultiPolygon"===re)for(var ni=0;ni<_e.length;ni++){var xi=[];Ai(_e[ni],xi,Se,dt,Oe,!0),xi.length&&Cn.push(xi)}if(Cn.length){if(Ie.lineMetrics&&"LineString"===re){for(ni=0;ni<Cn.length;ni++)ae.push(zn(Y.id,re,Cn[ni],Y.tags));continue}"LineString"!==re&&"MultiLineString"!==re||(1===Cn.length?(re="LineString",Cn=Cn[0]):re="MultiLineString"),"Point"!==re&&"MultiPoint"!==re||(re=3===Cn.length?"Point":"MultiPoint"),ae.push(zn(Y.id,re,Cn,Y.tags))}}}return ae.length?ae:null}function Bt(lt,Pe,Se,dt,Oe){for(var Ke=0;Ke<lt.length;Ke+=3){var Et=lt[Ke+Oe];Et>=Se&&Et<=dt&&(Pe.push(lt[Ke]),Pe.push(lt[Ke+1]),Pe.push(lt[Ke+2]))}}function jt(lt,Pe,Se,dt,Oe,Ke,Et){for(var Ie,ae,Z=Dn(lt),Y=0===Oe?On:st,_e=lt.start,re=0;re<lt.length-3;re+=3){var Je=lt[re],Pt=lt[re+1],Cn=lt[re+2],ni=lt[re+3],xi=lt[re+4],sr=0===Oe?Je:Pt,Cr=0===Oe?ni:xi,Jr=!1;Et&&(Ie=Math.sqrt(Math.pow(Je-ni,2)+Math.pow(Pt-xi,2))),sr<Se?Cr>Se&&(ae=Y(Z,Je,Pt,ni,xi,Se),Et&&(Z.start=_e+Ie*ae)):sr>dt?Cr<dt&&(ae=Y(Z,Je,Pt,ni,xi,dt),Et&&(Z.start=_e+Ie*ae)):Sn(Z,Je,Pt,Cn),Cr<Se&&sr>=Se&&(ae=Y(Z,Je,Pt,ni,xi,Se),Jr=!0),Cr>dt&&sr<=dt&&(ae=Y(Z,Je,Pt,ni,xi,dt),Jr=!0),!Ke&&Jr&&(Et&&(Z.end=_e+Ie*ae),Pe.push(Z),Z=Dn(lt)),Et&&(_e+=Ie)}var eo=lt.length-3;Je=lt[eo],Pt=lt[eo+1],Cn=lt[eo+2],(sr=0===Oe?Je:Pt)>=Se&&sr<=dt&&Sn(Z,Je,Pt,Cn),eo=Z.length-3,Ke&&eo>=3&&(Z[eo]!==Z[0]||Z[eo+1]!==Z[1])&&Sn(Z,Z[0],Z[1],Z[2]),Z.length&&Pe.push(Z)}function Dn(lt){var Pe=[];return Pe.size=lt.size,Pe.start=lt.start,Pe.end=lt.end,Pe}function Ai(lt,Pe,Se,dt,Oe,Ke){for(var Et=0;Et<lt.length;Et++)jt(lt[Et],Pe,Se,dt,Oe,Ke,!1)}function Sn(lt,Pe,Se,dt){lt.push(Pe),lt.push(Se),lt.push(dt)}function On(lt,Pe,Se,dt,Oe,Ke){var Et=(Ke-Pe)/(dt-Pe);return lt.push(Ke),lt.push(Se+(Oe-Se)*Et),lt.push(1),Et}function st(lt,Pe,Se,dt,Oe,Ke){var Et=(Ke-Se)/(Oe-Se);return lt.push(Pe+(dt-Pe)*Et),lt.push(Ke),lt.push(1),Et}function Xe(lt,Pe){for(var Se=[],dt=0;dt<lt.length;dt++){var Oe,Ke=lt[dt],Et=Ke.type;if("Point"===Et||"MultiPoint"===Et||"LineString"===Et)Oe=ye(Ke.geometry,Pe);else if("MultiLineString"===Et||"Polygon"===Et){Oe=[];for(var Ie=0;Ie<Ke.geometry.length;Ie++)Oe.push(ye(Ke.geometry[Ie],Pe))}else if("MultiPolygon"===Et)for(Oe=[],Ie=0;Ie<Ke.geometry.length;Ie++){for(var ae=[],Z=0;Z<Ke.geometry[Ie].length;Z++)ae.push(ye(Ke.geometry[Ie][Z],Pe));Oe.push(ae)}Se.push(zn(Ke.id,Et,Oe,Ke.tags))}return Se}function ye(lt,Pe){var Se=[];Se.size=lt.size,void 0!==lt.start&&(Se.start=lt.start,Se.end=lt.end);for(var dt=0;dt<lt.length;dt+=3)Se.push(lt[dt]+Pe,lt[dt+1],lt[dt+2]);return Se}function Ve(lt,Pe){if(lt.transformed)return lt;var Se,dt,Oe,Ke=1<<lt.z,Et=lt.x,Ie=lt.y;for(Se=0;Se<lt.features.length;Se++){var ae=lt.features[Se],Z=ae.geometry,Y=ae.type;if(ae.geometry=[],1===Y)for(dt=0;dt<Z.length;dt+=2)ae.geometry.push(gt(Z[dt],Z[dt+1],Pe,Ke,Et,Ie));else for(dt=0;dt<Z.length;dt++){var _e=[];for(Oe=0;Oe<Z[dt].length;Oe+=2)_e.push(gt(Z[dt][Oe],Z[dt][Oe+1],Pe,Ke,Et,Ie));ae.geometry.push(_e)}}return lt.transformed=!0,lt}function gt(lt,Pe,Se,dt,Oe,Ke){return[Math.round(Se*(lt*dt-Oe)),Math.round(Se*(Pe*dt-Ke))]}function wt(lt,Pe,Se,dt,Oe){for(var Ke=Pe===Oe.maxZoom?0:Oe.tolerance/((1<<Pe)*Oe.extent),Et={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Se,y:dt,z:Pe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ie=0;Ie<lt.length;Ie++){Et.numFeatures++,en(Et,lt[Ie],Ke,Oe);var ae=lt[Ie].minX,Z=lt[Ie].minY,Y=lt[Ie].maxX,_e=lt[Ie].maxY;ae<Et.minX&&(Et.minX=ae),Z<Et.minY&&(Et.minY=Z),Y>Et.maxX&&(Et.maxX=Y),_e>Et.maxY&&(Et.maxY=_e)}return Et}function en(lt,Pe,Se,dt){var Oe=Pe.geometry,Ke=Pe.type,Et=[];if("Point"===Ke||"MultiPoint"===Ke)for(var Ie=0;Ie<Oe.length;Ie+=3)Et.push(Oe[Ie]),Et.push(Oe[Ie+1]),lt.numPoints++,lt.numSimplified++;else if("LineString"===Ke)hn(Et,Oe,lt,Se,!1,!1);else if("MultiLineString"===Ke||"Polygon"===Ke)for(Ie=0;Ie<Oe.length;Ie++)hn(Et,Oe[Ie],lt,Se,"Polygon"===Ke,0===Ie);else if("MultiPolygon"===Ke)for(var ae=0;ae<Oe.length;ae++){var Z=Oe[ae];for(Ie=0;Ie<Z.length;Ie++)hn(Et,Z[Ie],lt,Se,!0,0===Ie)}if(Et.length){var Y=Pe.tags||null;if("LineString"===Ke&&dt.lineMetrics){for(var _e in Y={},Pe.tags)Y[_e]=Pe.tags[_e];Y.mapbox_clip_start=Oe.start/Oe.size,Y.mapbox_clip_end=Oe.end/Oe.size}var re={geometry:Et,type:"Polygon"===Ke||"MultiPolygon"===Ke?3:"LineString"===Ke||"MultiLineString"===Ke?2:1,tags:Y};null!==Pe.id&&(re.id=Pe.id),lt.features.push(re)}}function hn(lt,Pe,Se,dt,Oe,Ke){var Et=dt*dt;if(dt>0&&Pe.size<(Oe?Et:dt))Se.numPoints+=Pe.length/3;else{for(var Ie=[],ae=0;ae<Pe.length;ae+=3)(0===dt||Pe[ae+2]>Et)&&(Se.numSimplified++,Ie.push(Pe[ae]),Ie.push(Pe[ae+1])),Se.numPoints++;Oe&&function(Z,Y){for(var _e=0,re=0,Je=Z.length,Pt=Je-2;re<Je;Pt=re,re+=2)_e+=(Z[re]-Z[Pt])*(Z[re+1]+Z[Pt+1]);if(_e>0===Y)for(re=0,Je=Z.length;re<Je/2;re+=2){var Cn=Z[re],ni=Z[re+1];Z[re]=Z[Je-2-re],Z[re+1]=Z[Je-1-re],Z[Je-2-re]=Cn,Z[Je-1-re]=ni}}(Ie,Ke),lt.push(Ie)}}function si(lt,Pe){var Se=(Pe=this.options=function(Oe,Ke){for(var Et in Ke)Oe[Et]=Ke[Et];return Oe}(Object.create(this.options),Pe)).debug;if(Se&&console.time("preprocess data"),Pe.maxZoom<0||Pe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Pe.promoteId&&Pe.generateId)throw new Error("promoteId and generateId cannot be used together.");var Oe,Ke,Et,Ie,ae,Z,dt=function(Oe,Ke){var Et=[];if("FeatureCollection"===Oe.type)for(var Ie=0;Ie<Oe.features.length;Ie++)ar(Et,Oe.features[Ie],Ke,Ie);else ar(Et,"Feature"===Oe.type?Oe:{geometry:Oe},Ke);return Et}(lt,Pe);this.tiles={},this.tileCoords=[],Se&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Pe.indexMaxZoom,Pe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ie=Oe=dt,ae=Ln(Oe,1,-1-(Et=(Ke=Pe).buffer/Ke.extent),Et,0,-1,2,Ke),Z=Ln(Oe,1,1-Et,2+Et,0,-1,2,Ke),(ae||Z)&&(Ie=Ln(Oe,1,-Et,1+Et,0,-1,2,Ke)||[],ae&&(Ie=Xe(ae,1).concat(Ie)),Z&&(Ie=Ie.concat(Xe(Z,-1)))),(dt=Ie).length&&this.splitTile(dt,0,0,0),Se&&(dt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Hi(lt,Pe,Se){return 32*((1<<lt)*Se+Pe)+lt}function ti(lt,Pe){const Se=lt.tileID.canonical;if(!this._geoJSONIndex)return Pe(null,null);const dt=this._geoJSONIndex.getTile(Se.z,Se.x,Se.y);if(!dt)return Pe(null,null);const Oe=new class{constructor(Et){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=Et.length,this._features=Et}feature(Et){return new class{constructor(Ie){this._feature=Ie,this.extent=a.EXTENT,this.type=Ie.type,this.properties=Ie.tags,"id"in Ie&&!isNaN(Ie.id)&&(this.id=parseInt(Ie.id,10))}loadGeometry(){if(1===this._feature.type){const Ie=[];for(const ae of this._feature.geometry)Ie.push([new a.Point(ae[0],ae[1])]);return Ie}{const Ie=[];for(const ae of this._feature.geometry){const Z=[];for(const Y of ae)Z.push(new a.Point(Y[0],Y[1]));Ie.push(Z)}return Ie}}toGeoJSON(Ie,ae,Z){return at.call(this,Ie,ae,Z)}}(this._features[Et])}}(dt.features);let Ke=wn(Oe);0===Ke.byteOffset&&Ke.byteLength===Ke.buffer.byteLength||(Ke=new Uint8Array(Ke)),Pe(null,{vectorTile:Oe,rawData:Ke.buffer})}si.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},si.prototype.splitTile=function(lt,Pe,Se,dt,Oe,Ke,Et){for(var Ie=[lt,Pe,Se,dt],ae=this.options,Z=ae.debug;Ie.length;){dt=Ie.pop(),Se=Ie.pop(),Pe=Ie.pop(),lt=Ie.pop();var Y=1<<Pe,_e=Hi(Pe,Se,dt),re=this.tiles[_e];if(!re&&(Z>1&&console.time("creation"),re=this.tiles[_e]=wt(lt,Pe,Se,dt,ae),this.tileCoords.push({z:Pe,x:Se,y:dt}),Z)){Z>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Pe,Se,dt,re.numFeatures,re.numPoints,re.numSimplified),console.timeEnd("creation"));var Je="z"+Pe;this.stats[Je]=(this.stats[Je]||0)+1,this.total++}if(re.source=lt,Oe){if(Pe===ae.maxZoom||Pe===Oe)continue;var Pt=1<<Oe-Pe;if(Se!==Math.floor(Ke/Pt)||dt!==Math.floor(Et/Pt))continue}else if(Pe===ae.indexMaxZoom||re.numPoints<=ae.indexMaxPoints)continue;if(re.source=null,0!==lt.length){Z>1&&console.time("clipping");var Cn,ni,xi,sr,Cr,Jr,eo=.5*ae.buffer/ae.extent,Lr=.5-eo,Ci=.5+eo,Do=1+eo;Cn=ni=xi=sr=null,Cr=Ln(lt,Y,Se-eo,Se+Ci,0,re.minX,re.maxX,ae),Jr=Ln(lt,Y,Se+Lr,Se+Do,0,re.minX,re.maxX,ae),lt=null,Cr&&(Cn=Ln(Cr,Y,dt-eo,dt+Ci,1,re.minY,re.maxY,ae),ni=Ln(Cr,Y,dt+Lr,dt+Do,1,re.minY,re.maxY,ae),Cr=null),Jr&&(xi=Ln(Jr,Y,dt-eo,dt+Ci,1,re.minY,re.maxY,ae),sr=Ln(Jr,Y,dt+Lr,dt+Do,1,re.minY,re.maxY,ae),Jr=null),Z>1&&console.timeEnd("clipping"),Ie.push(Cn||[],Pe+1,2*Se,2*dt),Ie.push(ni||[],Pe+1,2*Se,2*dt+1),Ie.push(xi||[],Pe+1,2*Se+1,2*dt),Ie.push(sr||[],Pe+1,2*Se+1,2*dt+1)}}},si.prototype.getTile=function(lt,Pe,Se){var dt=this.options,Oe=dt.extent,Ke=dt.debug;if(lt<0||lt>24)return null;var Et=1<<lt,Ie=Hi(lt,Pe=(Pe%Et+Et)%Et,Se);if(this.tiles[Ie])return Ve(this.tiles[Ie],Oe);Ke>1&&console.log("drilling down to z%d-%d-%d",lt,Pe,Se);for(var ae,Z=lt,Y=Pe,_e=Se;!ae&&Z>0;)Z--,Y=Math.floor(Y/2),_e=Math.floor(_e/2),ae=this.tiles[Hi(Z,Y,_e)];return ae&&ae.source?(Ke>1&&console.log("found parent tile z%d-%d-%d",Z,Y,_e),Ke>1&&console.time("drilling down"),this.splitTile(ae.source,Z,Y,_e,lt,Pe,Se),Ke>1&&console.timeEnd("drilling down"),this.tiles[Ie]?Ve(this.tiles[Ie],Oe):null):null};class bi extends a.VectorTileWorkerSource{constructor(Pe,Se,dt,Oe,Ke){super(Pe,Se,dt,Oe,ti),Ke&&(this.loadGeoJSON=Ke)}loadData(Pe,Se){const dt=Pe&&Pe.request,Oe=dt&&dt.collectResourceTiming;this.loadGeoJSON(Pe,(Ke,Et)=>{if(Ke||!Et)return Se(Ke);if("object"!=typeof Et)return Se(new Error(`Input data given to '${Pe.source}' is not a valid GeoJSON object.`));{ge(Et,!0);try{if(Pe.filter){const ae=a.createExpression(Pe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===ae.result)throw new Error(ae.value.map(Y=>`${Y.key}: ${Y.message}`).join(", "));Et={type:"FeatureCollection",features:Et.features.filter(Y=>ae.value.evaluate({zoom:0},Y))}}this._geoJSONIndex=Pe.cluster?new $n(function({superclusterOptions:ae,clusterProperties:Z}){if(!Z||!ae)return ae;const Y={},_e={},re={accumulated:null,zoom:0},Je={properties:null},Pt=Object.keys(Z);for(const Cn of Pt){const[ni,xi]=Z[Cn],sr=a.createExpression(xi),Cr=a.createExpression("string"==typeof ni?[ni,["accumulated"],["get",Cn]]:ni);Y[Cn]=sr.value,_e[Cn]=Cr.value}return ae.map=Cn=>{Je.properties=Cn;const ni={};for(const xi of Pt)ni[xi]=Y[xi].evaluate(re,Je);return ni},ae.reduce=(Cn,ni)=>{Je.properties=ni;for(const xi of Pt)re.accumulated=Cn[xi],Cn[xi]=_e[xi].evaluate(re,Je)},ae}(Pe)).load(Et.features):new si(ae=Et,Pe.geojsonVtOptions)}catch(ae){return Se(ae)}this.loaded={};const Ie={};if(Oe){const ae=a.getPerformanceMeasurement(dt);ae&&(Ie.resourceTiming={},Ie.resourceTiming[Pe.source]=JSON.parse(JSON.stringify(ae)))}Se(null,Ie)}var ae})}reloadTile(Pe,Se){const dt=this.loaded;return dt&&dt[Pe.uid]?super.reloadTile(Pe,Se):this.loadTile(Pe,Se)}loadGeoJSON(Pe,Se){if(Pe.request)a.getJSON(Pe.request,Se);else{if("string"!=typeof Pe.data)return Se(new Error(`Input data given to '${Pe.source}' is not a valid GeoJSON object.`));try{return Se(null,JSON.parse(Pe.data))}catch{return Se(new Error(`Input data given to '${Pe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Pe,Se){try{Se(null,this._geoJSONIndex.getClusterExpansionZoom(Pe.clusterId))}catch(dt){Se(dt)}}getClusterChildren(Pe,Se){try{Se(null,this._geoJSONIndex.getChildren(Pe.clusterId))}catch(dt){Se(dt)}}getClusterLeaves(Pe,Se){try{Se(null,this._geoJSONIndex.getLeaves(Pe.clusterId,Pe.limit,Pe.offset))}catch(dt){Se(dt)}}}class gi{constructor(Pe){this.self=Pe,this.actor=new a.Actor(Pe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:bi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Se,dt)=>{if(this.workerSourceTypes[Se])throw new Error(`Worker source with name "${Se}" already registered.`);this.workerSourceTypes[Se]=dt},this.self.registerRTLTextPlugin=Se=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=Se.applyArabicShaping,a.plugin.processBidirectionalText=Se.processBidirectionalText,a.plugin.processStyledBidirectionalText=Se.processStyledBidirectionalText}}clearCaches(Pe,Se,dt){delete this.layerIndexes[Pe],delete this.availableImages[Pe],delete this.workerSources[Pe],delete this.demWorkerSources[Pe],dt()}checkIfReady(Pe,Se,dt){dt()}setReferrer(Pe,Se){this.referrer=Se}spriteLoaded(Pe,Se){this.isSpriteLoaded[Pe]=Se;for(const dt in this.workerSources[Pe]){const Oe=this.workerSources[Pe][dt];for(const Ke in Oe)Oe[Ke]instanceof a.VectorTileWorkerSource&&(Oe[Ke].isSpriteLoaded=Se,Oe[Ke].fire(new a.Event("isSpriteLoaded")))}}setImages(Pe,Se,dt){this.availableImages[Pe]=Se;for(const Oe in this.workerSources[Pe]){const Ke=this.workerSources[Pe][Oe];for(const Et in Ke)Ke[Et].availableImages=Se}dt()}enableTerrain(Pe,Se,dt){this.terrain=Se,dt()}setProjection(Pe,Se){this.projections[Pe]=a.getProjection(Se)}setLayers(Pe,Se,dt){this.getLayerIndex(Pe).replace(Se),dt()}updateLayers(Pe,Se,dt){this.getLayerIndex(Pe).update(Se.layers,Se.removedIds),dt()}loadTile(Pe,Se,dt){const Oe=this.enableTerrain?a.extend({enableTerrain:this.terrain},Se):Se;Oe.projection=this.projections[Pe]||this.defaultProjection,this.getWorkerSource(Pe,Se.type,Se.source).loadTile(Oe,dt)}loadDEMTile(Pe,Se,dt){const Oe=this.enableTerrain?a.extend({buildQuadTree:this.terrain},Se):Se;this.getDEMWorkerSource(Pe,Se.source).loadTile(Oe,dt)}reloadTile(Pe,Se,dt){const Oe=this.enableTerrain?a.extend({enableTerrain:this.terrain},Se):Se;Oe.projection=this.projections[Pe]||this.defaultProjection,this.getWorkerSource(Pe,Se.type,Se.source).reloadTile(Oe,dt)}abortTile(Pe,Se,dt){this.getWorkerSource(Pe,Se.type,Se.source).abortTile(Se,dt)}removeTile(Pe,Se,dt){this.getWorkerSource(Pe,Se.type,Se.source).removeTile(Se,dt)}removeSource(Pe,Se,dt){if(!this.workerSources[Pe]||!this.workerSources[Pe][Se.type]||!this.workerSources[Pe][Se.type][Se.source])return;const Oe=this.workerSources[Pe][Se.type][Se.source];delete this.workerSources[Pe][Se.type][Se.source],void 0!==Oe.removeSource?Oe.removeSource(Se,dt):dt()}loadWorkerSource(Pe,Se,dt){try{this.self.importScripts(Se.url),dt()}catch(Oe){dt(Oe.toString())}}syncRTLPluginState(Pe,Se,dt){try{a.plugin.setState(Se);const Oe=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&null!=Oe){this.self.importScripts(Oe);const Ke=a.plugin.isParsed();dt(Ke?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Oe}`),Ke)}}catch(Oe){dt(Oe.toString())}}getAvailableImages(Pe){let Se=this.availableImages[Pe];return Se||(Se=[]),Se}getLayerIndex(Pe){let Se=this.layerIndexes[Pe];return Se||(Se=this.layerIndexes[Pe]=new ve),Se}getWorkerSource(Pe,Se,dt){return this.workerSources[Pe]||(this.workerSources[Pe]={}),this.workerSources[Pe][Se]||(this.workerSources[Pe][Se]={}),this.workerSources[Pe][Se][dt]||(this.workerSources[Pe][Se][dt]=new this.workerSourceTypes[Se]({send:(Ke,Et,Ie,ae,Z,Y)=>{this.actor.send(Ke,Et,Ie,Pe,Z,Y)},scheduler:this.actor.scheduler},this.getLayerIndex(Pe),this.getAvailableImages(Pe),this.isSpriteLoaded[Pe])),this.workerSources[Pe][Se][dt]}getDEMWorkerSource(Pe,Se){return this.demWorkerSources[Pe]||(this.demWorkerSources[Pe]={}),this.demWorkerSources[Pe][Se]||(this.demWorkerSources[Pe][Se]=new ee),this.demWorkerSources[Pe][Se]}enforceCacheSizeLimit(Pe,Se){a.enforceCacheSizeLimit(Se)}getWorkerPerformanceMetrics(Pe,Se,dt){dt(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new gi(self)),gi}),C(0,function(a){function se(d,r){if(Array.isArray(d)){if(!Array.isArray(r)||d.length!==r.length)return!1;for(let u=0;u<d.length;u++)if(!se(d[u],r[u]))return!1;return!0}if("object"==typeof d&&null!==d&&null!==r){if("object"!=typeof r||Object.keys(d).length!==Object.keys(r).length)return!1;for(const u in d)if(!se(d[u],r[u]))return!1;return!0}return d===r}var Fe=ve;function ve(d){return r=d,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var m,y,b=new Blob([""],{type:"text/javascript"}),S=URL.createObjectURL(b);try{y=new Worker(S),m=!0}catch{m=!1}return y&&y.terminate(),URL.revokeObjectURL(S),m}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var m=document.createElement("canvas");m.width=m.height=1;var y=m.getContext("2d");if(!y)return!1;var b=y.getImageData(0,0,1,1);return b&&b.width===m.width}()||(void 0===ee[u=r&&r.failIfMajorPerformanceCaveat]&&(ee[u]=function(m){var y,S,z,U,b=(S=m,z=document.createElement("canvas"),(U=Object.create(ve.webGLContextAttributes)).failIfMajorPerformanceCaveat=S,z.getContext("webgl",U)||z.getContext("experimental-webgl",U));if(!b)return!1;try{y=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!y||b.isContextLost())&&(b.shaderSource(y,"void main() {}"),b.compileShader(y),!0===b.getShaderParameter(y,b.COMPILE_STATUS))}(u)),!ee[u]||document.documentMode));var r,u}var ee={};function fe(d,r,u){const m=a.window.document.createElement(d);return void 0!==r&&(m.className=r),u&&u.appendChild(m),m}function he(d,r,u){const m=a.window.document.createElementNS("http://www.w3.org/2000/svg",d);for(const y of Object.keys(r))m.setAttributeNS(null,y,r[y]);return u&&u.appendChild(m),m}ve.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ge=a.window.document&&a.window.document.documentElement.style,at=ge&&void 0!==ge.userSelect?"userSelect":"WebkitUserSelect";let mt;function $e(){ge&&at&&(mt=ge[at],ge[at]="none")}function ze(){ge&&at&&(ge[at]=mt)}function bt(d){d.preventDefault(),d.stopPropagation(),a.window.removeEventListener("click",bt,!0)}function xt(){a.window.addEventListener("click",bt,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",bt,!0)},0)}function Qt(d,r){const u=d.getBoundingClientRect();return Ut(d,u,r)}function sn(d,r){const u=d.getBoundingClientRect(),m=[];for(let y=0;y<r.length;y++)m.push(Ut(d,u,r[y]));return m}function Yt(d){return void 0!==a.window.InstallTrigger&&2===d.button&&d.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button}function Ut(d,r,u){const m=d.offsetWidth===r.width?1:d.offsetWidth/r.width;return new a.Point((u.clientX-r.left)*m,(u.clientY-r.top)*m)}function et(d,r){var u=r[0],m=r[1],y=r[2],b=r[3],S=u*b-y*m;return S?(d[0]=b*(S=1/S),d[1]=-m*S,d[2]=-y*S,d[3]=u*S,d):null}function It(d){const{userImage:r}=d;return!!(r&&r.render&&r.render())&&(d.data.replace(new Uint8Array(r.data.buffer)),!0)}class zt extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:u,callback:m}of this.requestors)this._notify(u,m);this.requestors=[]}}hasImage(r){return!!this.getImage(r)}getImage(r){return this.images[r]}addImage(r,u){this._validate(r,u)&&(this.images[r]=u)}_validate(r,u){let m=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),m=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),m=!1),this._validateContent(u.content,u)||(this.fire(new a.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),m=!1),m}_validateStretch(r,u){if(!r)return!0;let m=0;for(const y of r){if(y[0]<m||y[1]<y[0]||u<y[1])return!1;m=y[1]}return!0}_validateContent(r,u){return!(r&&(4!==r.length||r[0]<0||u.data.width<r[0]||r[1]<0||u.data.height<r[1]||r[2]<0||u.data.width<r[2]||r[3]<0||u.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,u){u.version=this.images[r].version+1,this.images[r]=u,this.updatedImages[r]=!0}removeImage(r){const u=this.images[r];delete this.images[r],delete this.patterns[r],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,u){let m=!0;if(!this.isLoaded())for(const y of r)this.images[y]||(m=!1);this.isLoaded()||m?this._notify(r,u):this.requestors.push({ids:r,callback:u})}_notify(r,u){const m={};for(const y of r){this.images[y]||this.fire(new a.Event("styleimagemissing",{id:y}));const b=this.images[y];b?m[y]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:!(!b.userImage||!b.userImage.render)}:a.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,m)}getPixelSize(){const{width:r,height:u}=this.atlasImage;return{width:r,height:u}}getPattern(r){const u=this.patterns[r],m=this.getImage(r);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{const y={w:m.data.width+2,h:m.data.height+2,x:0,y:0},b=new a.ImagePosition(y,m);this.patterns[r]={bin:y,position:b}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const u=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(r,this.atlasImage,u.RGBA),this.atlasTexture&&this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const b in this.patterns)r.push(this.patterns[b].bin);const{w:u,h:m}=a.potpack(r),y=this.atlasImage;y.resize({width:u||1,height:m||1});for(const b in this.patterns){const{bin:S}=this.patterns[b],z=S.x+1,U=S.y+1,J=this.images[b].data,Q=J.width,we=J.height;a.RGBAImage.copy(J,y,{x:0,y:0},{x:z,y:U},{width:Q,height:we}),a.RGBAImage.copy(J,y,{x:0,y:we-1},{x:z,y:U-1},{width:Q,height:1}),a.RGBAImage.copy(J,y,{x:0,y:0},{x:z,y:U+we},{width:Q,height:1}),a.RGBAImage.copy(J,y,{x:Q-1,y:0},{x:z-1,y:U},{width:1,height:we}),a.RGBAImage.copy(J,y,{x:0,y:0},{x:z+Q,y:U},{width:1,height:we})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const u of r){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const m=this.images[u];It(m)&&this.updateImage(u,m)}}}const je=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(d,r){return function([u,m,y]){const b=a.degToRad(m+90),S=a.degToRad(y);return{x:u*Math.cos(b)*Math.sin(S),y:u*Math.sin(b)*Math.sin(S),z:u*Math.cos(S),azimuthal:m,polar:y}}(d.expression.evaluate(r))}interpolate(d,r,u){return{x:a.number(d.x,r.x,u),y:a.number(d.y,r.y,u),z:a.number(d.z,r.z,u),azimuthal:a.number(d.azimuthal,r.azimuthal,u),polar:a.number(d.polar,r.polar,u)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)});class At extends a.Evented{constructor(r){super(),this._transitionable=new a.Transitionable(je),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,u={}){if(!this._validate(a.validateLight,r,u))for(const m in r){const y=r[m];a.endsWith(m,"-transition")?this._transitionable.setTransition(m.slice(0,-11),y):this._transitionable.setValue(m,y)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,m){return(!m||!1!==m.validate)&&a.emitValidationErrors(this,r.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const Ze=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)});let St=class extends a.Evented{constructor(d,r){super(),this._transitionable=new a.Transitionable(Ze),this.set(d),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(d){for(const r in d){const u=d[r];a.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-11),u):this._transitionable.setValue(r,u)}}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}};function wn(d,r,u,m){const y=a.smoothstep(45,65,u),[b,S]=Rn(d,m),z=a.length(r);let U=1-Math.min(1,Math.exp((z-b)/(S-b)*-6));return U*=U*U,U=Math.min(1,1.00747*U),U*y*d.alpha}function Rn(d,r){const u=.5/Math.tan(.5*r);return[d.range[0]+u,d.range[1]+u]}const an=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])});class Un extends a.Evented{constructor(r,u){super(),this._transitionable=new a.Transitionable(an),this.set(r),this._transitioning=this._transitionable.untransitioned(),this._transform=u}get state(){const r=this._transform,u="globe"===r.projection.name,m=a.globeToMercatorTransition(r.zoom),y=this.properties.get("range"),b=[.5,3];return{range:u?[a.number(b[0],y[0],m),a.number(b[1],y[1],m)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,u={}){if(!this._validate(a.validateFog,r,u)){for(const m of Object.keys(a.spec.fog))r&&void 0===r[m]&&(r[m]=a.spec.fog[m].default);for(const m in r){const y=r[m];a.endsWith(m,"-transition")?this._transitionable.setTransition(m.slice(0,-11),y):this._transitionable.setValue(m,y)}}}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:a.smoothstep(45,65,r))*u.a}getOpacityAtLatLng(r,u){return this._transform.projection.supportsFog?function(m,y,b){const S=a.MercatorCoordinate.fromLngLat(y),z=b.elevation?b.elevation.getAtPointOrZero(S):0,U=[S.x,S.y,z];return a.transformMat4(U,U,b.mercatorFogMatrix),wn(m,U,b.pitch,b._fov)}(this.state,r,u):0}getFovAdjustedRange(r){return this._transform.projection.supportsFog?Rn(this.state,r):[0,1]}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,m){return(!m||!1!==m.validate)&&a.emitValidationErrors(this,r.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class nn{constructor(r,u){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const m=this.workerPool.acquire(this.id);for(let y=0;y<m.length;y++){const b=new nn.Actor(m[y],u,this.id);b.name=`Worker ${y}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,u,m){a.asyncAll(this.actors,(y,b)=>{y.send(r,u,b)},m=m||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function di(d,r,u){return r*(a.EXTENT/(d.tileSize*Math.pow(2,u-d.tileID.overscaledZ)))}nn.Actor=a.Actor;class Wn{constructor(r,u,m,y){this.screenBounds=r,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(r,u){let m,y;if(r instanceof a.Point||"number"==typeof r[0]){const b=a.Point.convert(r);m=[b],y=u.isPointAboveHorizon(b)}else{const b=a.Point.convert(r[0]),S=a.Point.convert(r[1]);m=[b,S],y=a.polygonizeBounds(b,S).every(z=>u.isPointAboveHorizon(z))}return new Wn(m,u.getCameraPoint(),y,u)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(r){return a.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const u=this.screenBounds[0],m=1===this.screenBounds.length?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],y=a.polygonizeBounds(u,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<m.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?y[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(y[3]=this.cameraPoint)),a.bufferConvexPolygon(y,r)}bufferedCameraGeometryGlobe(r){const u=this.screenBounds[0],m=1===this.screenBounds.length?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],y=a.polygonizeBounds(u,m,r),b=this.cameraPoint.clone();switch(3*((b.y>u.y)+(b.y>m.y))+((b.x>u.x)+(b.x>m.x))){case 0:y[0]=b,y[4]=b.clone();break;case 1:y.splice(1,0,b);break;case 2:y[1]=b;break;case 3:y.splice(4,0,b);break;case 5:y.splice(2,0,b);break;case 6:y[3]=b;break;case 7:y.splice(3,0,b);break;case 8:y[2]=b}return y}containsTile(r,u,m,y=0){const b=r.queryPadding/u._pixelsPerMercatorPixel+1,S=m?this._bufferedCameraMercator(b,u):this._bufferedScreenMercator(b,u);let z=r.tileID.wrap+(S.unwrapped?y:0);const U=S.polygon.map(ft=>a.getTilePoint(r.tileTransform,ft,z));if(!a.polygonIntersectsBox(U,0,0,a.EXTENT,a.EXTENT))return;z=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);const J=this.screenGeometryMercator.polygon.map(ft=>a.getTileVec3(r.tileTransform,ft,z)),Q=J.map(ft=>new a.Point(ft[0],ft[1])),we=u.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),Ye=a.getTileVec3(r.tileTransform,we,z),Qe=J.map(ft=>{const Ee=a.sub(ft,ft,Ye);return a.normalize(Ee,Ee),new a.Ray(Ye,Ee)}),ut=di(r,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Q,tilespaceRays:Qe,bufferedTilespaceGeometry:U,bufferedTilespaceBounds:(it=a.getBounds(U),it.min.x=a.clamp(it.min.x,0,a.EXTENT),it.min.y=a.clamp(it.min.y,0,a.EXTENT),it.max.x=a.clamp(it.max.x,0,a.EXTENT),it.max.y=a.clamp(it.max.y,0,a.EXTENT),it),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:ut};var it}_bufferedScreenMercator(r,u){const m=Jt(r);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let y;return y="globe"===u.projection.name?this._projectAndResample(this.bufferedScreenGeometry(r),u):{polygon:this.bufferedScreenGeometry(r).map(b=>u.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[m]=y,y}}_bufferedCameraMercator(r,u){const m=Jt(r);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let y;return y="globe"===u.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),u):{polygon:this.bufferedCameraGeometry(r).map(b=>u.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[m]=y,y}}_projectAndResample(r,u){const m=function(b,S){const z=a.multiply([],S.pixelMatrix,S.globeMatrix),U=[0,-a.GLOBE_RADIUS,0,1],J=[0,a.GLOBE_RADIUS,0,1],Q=[0,0,0,1];a.transformMat4$1(U,U,z),a.transformMat4$1(J,J,z),a.transformMat4$1(Q,Q,z);const we=new a.Point(U[0]/U[3],U[1]/U[3]),Ye=new a.Point(J[0]/J[3],J[1]/J[3]),Qe=a.polygonContainsPoint(b,we)&&U[3]<Q[3],ut=a.polygonContainsPoint(b,Ye)&&J[3]<Q[3];if(!Qe&&!ut)return null;const it=function(Ot,on,Zt){for(let cn=1;cn<Ot.length;cn++){const li=ki(on.pointCoordinate3D(Ot[cn-1]).x),fn=ki(on.pointCoordinate3D(Ot[cn]).x);if(Zt<0){if(li<fn)return{idx:cn,t:-li/(fn-1-li)}}else if(fn<li)return{idx:cn,t:(1-li)/(fn+1-li)}}return null}(b,S,Qe?-1:1);if(!it)return null;const{idx:ft,t:Ee}=it;let qe=ft>1?$n(b.slice(0,ft),S):[],yt=ft<b.length?$n(b.slice(ft),S):[];qe=qe.map(Ot=>new a.Point(ki(Ot.x),Ot.y)),yt=yt.map(Ot=>new a.Point(ki(Ot.x),Ot.y));const Mt=[...qe];0===Mt.length&&Mt.push(yt[yt.length-1]);const $t=a.number(Mt[Mt.length-1].y,(0===yt.length?qe[0]:yt[0]).y,Ee);let Wt;return Wt=Qe?[new a.Point(0,$t),new a.Point(0,0),new a.Point(1,0),new a.Point(1,$t)]:[new a.Point(1,$t),new a.Point(1,1),new a.Point(0,1),new a.Point(0,$t)],Mt.push(...Wt),0===yt.length?Mt.push(qe[0]):Mt.push(...yt),{polygon:Mt.map(Ot=>new a.MercatorCoordinate(Ot.x,Ot.y)),unwrapped:!1}}(r,u);if(m)return m;const y=function(b,S){let z=!1,U=-1/0,J=0;for(let we=0;we<b.length-1;we++)b[we].x>U&&(U=b[we].x,J=we);for(let we=0;we<b.length-1;we++){const Ye=(J+we)%(b.length-1),Qe=b[Ye],ut=b[Ye+1];Math.abs(Qe.x-ut.x)>.5&&(Qe.x<ut.x?(Qe.x+=1,0===Ye&&(b[b.length-1].x+=1)):(ut.x+=1,Ye+1===b.length-1&&(b[0].x+=1)),z=!0)}const Q=a.mercatorXfromLng(S.center.lng);return z&&Q<Math.abs(Q-1)&&b.forEach(we=>{we.x-=1}),{polygon:b,unwrapped:z}}($n(r,u).map(b=>new a.Point(ki(b.x),b.y)),u);return{polygon:y.polygon.map(b=>new a.MercatorCoordinate(b.x,b.y)),unwrapped:y.unwrapped}}}function $n(d,r){return a.resample(d,u=>{const m=r.pointCoordinate3D(u);u.x=m.x,u.y=m.y},1/256)}function ki(d){return d<0?1+d%1:d%1}function Jt(d){return 100*d|0}function un(d,r,u,m,y){const b=function(S,z){if(S)return y(S);if(z){d.url&&z.tiles&&d.tiles&&delete d.tiles;const U=a.pick(a.extend(z,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);z.vector_layers&&(U.vectorLayers=z.vector_layers,U.vectorLayerIds=U.vectorLayers.map(J=>J.id)),U.tiles=r.canonicalizeTileset(U,d.url),y(null,U)}};return d.url?a.getJSON(r.transformRequest(r.normalizeSourceURL(d.url,null,u,m),a.ResourceType.Source),b):a.exported.frame(()=>b(null,d))}class pn{constructor(r,u,m){this.bounds=a.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=u||0,this.maxzoom=m||24}validateBounds(r){return Array.isArray(r)&&4===r.length?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const u=Math.pow(2,r.z),m=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*u),y=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*u),b=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*u),S=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*u);return r.x>=m&&r.x<b&&r.y>=y&&r.y<S}}class dn{constructor(r,u,m){this.context=r;const y=r.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const jn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Yn{constructor(r,u,m,y){this.length=u.length,this.attributes=m,this.itemSize=u.bytesPerElement,this.dynamicDraw=y,this.context=r;const b=r.gl;this.buffer=b.createBuffer(),r.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,u){for(let m=0;m<this.attributes.length;m++){const y=u.attributes[this.attributes[m].name];void 0!==y&&r.enableVertexAttribArray(y)}}setVertexAttribPointers(r,u,m){for(let y=0;y<this.attributes.length;y++){const b=this.attributes[y],S=u.attributes[b.name];void 0!==S&&r.vertexAttribPointer(S,b.components,r[jn[b.type]],!1,this.itemSize,b.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class zn{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qn extends zn{getDefault(){return a.Color.transparent}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class ar extends zn{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Gi extends zn{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Si extends zn{getDefault(){return[!0,!0,!0,!0]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Mi extends zn{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Br extends zn{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class ji extends zn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const u=this.current;(r.func!==u.func||r.ref!==u.ref||r.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Ln extends zn{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Bt extends zn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=r,this.dirty=!1}}class jt extends zn{getDefault(){return[0,1]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Dn extends zn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=r,this.dirty=!1}}class Ai extends zn{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Sn extends zn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.BLEND):u.disable(u.BLEND),this.current=r,this.dirty=!1}}class On extends zn{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class st extends zn{getDefault(){return a.Color.transparent}set(r){const u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Xe extends zn{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class ye extends zn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;r?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=r,this.dirty=!1}}class Ve extends zn{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class gt extends zn{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let wt,en=class extends zn{getDefault(){return null}set(d){(d!==this.current||this.dirty)&&(this.gl.useProgram(d),this.current=d,this.dirty=!1)}};class hn extends zn{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class si extends zn{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Hi extends zn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class ti extends zn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class bi extends zn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class gi extends zn{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class lt extends zn{getDefault(){return null}set(r){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Pe extends zn{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class Se extends zn{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class dt extends zn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Oe extends zn{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Ke extends zn{constructor(r,u){super(r),this.context=r,this.parent=u}getDefault(){return null}}class Et extends Ke{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Ie extends Ke{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ae extends Ie{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Z{constructor(r,u,m,y){this.context=r,this.width=u,this.height=m;const b=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new Et(r,b),y&&(this.depthAttachment=new Ie(r,b))}destroy(){const r=this.context.gl,u=this.colorAttachment.get();if(u&&r.deleteTexture(u),this.depthAttachment){const m=this.depthAttachment.get();m&&r.deleteRenderbuffer(m)}r.deleteFramebuffer(this.framebuffer)}}class Y{constructor(r,u=!1){if(this.gl=r,this.isWebGL2=u,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),u){const m=r;this.extVertexArrayObject={createVertexArrayOES:m.createVertexArray.bind(r),deleteVertexArrayOES:m.deleteVertexArray.bind(r),bindVertexArrayOES:m.bindVertexArray.bind(r)}}this.clearColor=new qn(this),this.clearDepth=new ar(this),this.clearStencil=new Gi(this),this.colorMask=new Si(this),this.depthMask=new Mi(this),this.stencilMask=new Br(this),this.stencilFunc=new ji(this),this.stencilOp=new Ln(this),this.stencilTest=new Bt(this),this.depthRange=new jt(this),this.depthTest=new Dn(this),this.depthFunc=new Ai(this),this.blend=new Sn(this),this.blendFunc=new On(this),this.blendColor=new st(this),this.blendEquation=new Xe(this),this.cullFace=new ye(this),this.cullFaceSide=new Ve(this),this.frontFace=new gt(this),this.program=new en(this),this.activeTexture=new hn(this),this.viewport=new si(this),this.bindFramebuffer=new Hi(this),this.bindRenderbuffer=new ti(this),this.bindTexture=new bi(this),this.bindVertexBuffer=new gi(this),this.bindElementBuffer=new lt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Pe(this),this.pixelStoreUnpack=new Se(this),this.pixelStoreUnpackPremultiplyAlpha=new dt(this),this.pixelStoreUnpackFlipY=new Oe(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),u||(this.extTextureHalfFloat=r.getExtension("OES_texture_half_float")),(u||this.extTextureHalfFloat&&r.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=u||r.getExtension("OES_standard_derivatives"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,u){return new dn(this,r,u)}createVertexBuffer(r,u,m){return new Yn(this,r,u,m)}createRenderbuffer(r,u,m){const y=this.gl,b=y.createRenderbuffer();return this.bindRenderbuffer.set(b),y.renderbufferStorage(y.RENDERBUFFER,r,u,m),this.bindRenderbuffer.set(null),b}createFramebuffer(r,u,m){return new Z(this,r,u,m)}clear({color:r,depth:u,stencil:m}){const y=this.gl;let b=0;r&&(b|=y.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),void 0!==u&&(b|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),void 0!==m&&(b|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),y.clear(b)}setCullFace(r){!1===r.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){se(r.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class _e extends a.Evented{constructor(r,u,m,y){if(super(),this.id=r,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(u,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(r){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map._worldview;this._tileJSONRequest=un(this._options,this.map._requestManager,u,m,(y,b)=>{this._tileJSONRequest=null,this._loaded=!0,y?(u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),m&&2!==m.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new a.ErrorEvent(y))):b&&(a.extend(this,b),b.bounds&&(this.tileBounds=new pn(b.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(b.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),r&&r(y)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}loadTile(r,u){const m=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(m,a.ResourceType.Tile),data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile};if(y.request.collectResourceTiming=this._collectResourceTiming,r.actor&&"expired"!==r.state)"loading"===r.state?r.reloadCallback=u:r.request=r.actor.send("reloadTile",y,b.bind(this));else if(r.actor=this._tileWorkers[m]=this._tileWorkers[m]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",y,b.bind(this),void 0,!0);else{const S=a.loadVectorTile.call({deduped:this._deduped},y,(z,U)=>{z||!U?b.call(this,z):(y.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},r.actor&&r.actor.send("loadTile",y,b.bind(this),void 0,!0))},!0);r.request={cancel:S}}function b(S,z){return delete r.request,r.aborted?u(null):S&&404!==S.status?u(S):(z&&z.resourceTiming&&(r.resourceTiming=z.resourceTiming),this.map._refreshExpiredTiles&&z&&r.setExpiryData(z),r.loadVectorData(z,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id})}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class re extends a.Evented{constructor(r,u,m,y){super(),this.id=r,this.dispatcher=m,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},u),a.extend(this,a.pick(u,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=un(this._options,this.map._requestManager,null,null,(u,m)=>{this._tileJSONRequest=null,this._loaded=!0,u?this.fire(new a.ErrorEvent(u)):m&&(a.extend(this,m),m.bounds&&(this.tileBounds=new pn(m.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(m.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),r&&r(u)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,u){const m=a.exported.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);r.request=a.getImage(this.map._requestManager.transformRequest(y,a.ResourceType.Tile),(b,S,z,U)=>(delete r.request,r.aborted?(r.state="unloaded",u(null)):b?(r.state="errored",u(b)):S?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:z,expires:U}),r.setTexture(S,this.map.painter),r.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void u(null)):u(null)))}static loadTileData(r,u,m){r.setTexture(u,m)}static unloadTileData(r,u){r.texture&&u.saveTileTexture(r.texture)}abortTile(r,u){r.request&&(r.request.cancel(),delete r.request),u()}unloadTile(r,u){r.texture&&this.map.painter.saveTileTexture(r.texture),u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Je(d,r,u,m,y,b,S,z){const U=[d,u,y,r,m,b,1,1,1],J=[S,z,1],Q=a.adjoint([],U),[we,Ye,Qe]=a.transformMat3(J,J,a.transpose(Q,Q));return a.multiply$1(U,[we,0,0,0,Ye,0,0,0,Qe],U)}class Pt extends a.Evented{constructor(r,u,m,y){super(),this.id=r,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=u,this._dirty=!1}load(r,u){this._loaded=u||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(m,y)=>{if(this._imageRequest=null,this._loaded=!0,m)this.fire(new a.ErrorEvent(m));else if(y){const{HTMLImageElement:b}=a.window;this.image=y instanceof b?a.exported.getImageData(y):y,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading()}})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(r){this.coordinates=r,this._boundsArray=void 0;const u=r.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(m){let y=1/0,b=1/0,S=-1/0,z=-1/0;for(const we of m)y=Math.min(y,we.x),b=Math.min(b,we.y),S=Math.max(S,we.x),z=Math.max(z,we.y);const U=Math.max(S-y,z-b),J=Math.max(0,Math.floor(-Math.log(U)/Math.LN2)),Q=Math.pow(2,J);return new a.CanonicalTileID(J,Math.floor((y+S)/2*Q),Math.floor((b+z)/2*Q))}(u),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(r){for(const U in this.tiles){const J=this.tiles[U];"loaded"!==J.state&&(J.state="loaded",J.texture=this.texture)}if(this._boundsArray)return;const u=a.tileTransform(this.tileID,this.map.transform.projection),[m,y,b,S]=this.coordinates.map(U=>{const J=u.projection.project(U[0],U[1]);return a.getTilePoint(u,J)._round()});this.perspectiveTransform=function(U,J,Q,we,Ye,Qe,ut,it,ft,Ee){const qe=Je(0,0,U,0,0,J,U,J),yt=Je(Q,we,Ye,Qe,ut,it,ft,Ee);return a.multiply$1(yt,a.adjoint(qe,qe),yt),[yt[6]/yt[8]*U/a.EXTENT,yt[7]/yt[8]*J/a.EXTENT]}(this.width,this.height,m.x,m.y,y.x,y.y,S.x,S.y,b.x,b.y);const z=this._boundsArray=new a.StructArrayLayout4i8;z.emplaceBack(m.x,m.y,0,0),z.emplaceBack(y.x,y.y,a.EXTENT,0),z.emplaceBack(S.x,S.y,0,a.EXTENT),z.emplaceBack(b.x,b.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=r.createVertexBuffer(z,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const r=this.map.painter.context,u=r.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new a.Texture(r,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(r)}loadTile(r,u){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},u(null)):(r.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Cn={vector:_e,raster:re,"raster-dem":class extends re{constructor(d,r,u,m){super(d,r,u,m),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(d,r){const u=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(y,b){y&&(d.state="errored",r(y)),b&&(d.dem=b,d.dem.onDeserialize(),d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0,d.state="loaded",r(null))}d.request=a.getImage(this.map._requestManager.transformRequest(u,a.ResourceType.Tile),function(y,b,S,z){if(delete d.request,d.aborted)d.state="unloaded",r(null);else if(y)d.state="errored",r(y);else if(b){this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:S,expires:z});const U=a.window.ImageBitmap&&b instanceof a.window.ImageBitmap&&(null==wt&&(wt=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof a.window.createImageBitmap),wt),J=1-(b.width-a.prevPowerOfTwo(b.width))/2;J<1||d.neighboringTiles||(d.neighboringTiles=this._getNeighboringTiles(d.tileID));const Q=U?b:a.exported.getImageData(b,J),we={uid:d.uid,coord:d.tileID,source:this.id,rawImageData:Q,encoding:this.encoding,padding:J};d.actor&&"expired"!==d.state||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",we,m.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(d){const r=d.canonical,u=Math.pow(2,r.z),m=(r.x-1+u)%u,y=0===r.x?d.wrap-1:d.wrap,b=(r.x+1+u)%u,S=r.x+1===u?d.wrap+1:d.wrap,z={};return z[new a.OverscaledTileID(d.overscaledZ,y,r.z,m,r.y).key]={backfilled:!1},z[new a.OverscaledTileID(d.overscaledZ,S,r.z,b,r.y).key]={backfilled:!1},r.y>0&&(z[new a.OverscaledTileID(d.overscaledZ,y,r.z,m,r.y-1).key]={backfilled:!1},z[new a.OverscaledTileID(d.overscaledZ,d.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},z[new a.OverscaledTileID(d.overscaledZ,S,r.z,b,r.y-1).key]={backfilled:!1}),r.y+1<u&&(z[new a.OverscaledTileID(d.overscaledZ,y,r.z,m,r.y+1).key]={backfilled:!1},z[new a.OverscaledTileID(d.overscaledZ,d.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},z[new a.OverscaledTileID(d.overscaledZ,S,r.z,b,r.y+1).key]={backfilled:!1}),z}unloadTile(d){d.demTexture&&this.map.painter.saveTileTexture(d.demTexture),d.fbo&&(d.fbo.destroy(),delete d.fbo),d.dem&&delete d.dem,delete d.neighboringTiles,d.state="unloaded"}},geojson:class extends a.Evented{constructor(d,r,u,m){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(m),this._data=r.data,this._options=a.extend({},r),this._collectResourceTiming=r.collectResourceTiming,void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const y=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*y,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*y,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:a.EXTENT,radius:(void 0!==r.clusterRadius?r.clusterRadius:50)*y,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(d){this.map=d,this.setData(this._data)}setData(d){return this._data=d,this._updateWorkerData(),this}getClusterExpansionZoom(d,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id},r),this}getClusterChildren(d,r){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id},r),this}getClusterLeaves(d,r,u,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:d,limit:r,offset:u},m),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const d=a.extend({},this.workerOptions),r=this._data;"string"==typeof r?(d.request=this.map._requestManager.transformRequest(a.exported.resolveURL(r),a.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,d,(u,m)=>{if(this._loaded=!0,this._pendingLoad=null,u)this.fire(new a.ErrorEvent(u));else{const y={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&m&&m.resourceTiming&&m.resourceTiming[this.id]&&(y.resourceTiming=m.resourceTiming[this.id]),this.fire(new a.Event("data",y)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(d,r){const u=d.actor?"reloadTile":"loadTile";d.actor=this.actor,d.request=this.actor.send(u,{type:this.type,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(m,y)=>(delete d.request,d.unloadVectorData(),d.aborted?r(null):m?r(m):(d.loadVectorData(y,this.map.painter,"reloadTile"===u),r(null))),void 0,"loadTile"===u)}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0}unloadTile(d){d.unloadVectorData(),this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Pt{constructor(d,r,u,m){super(d,r,u,m),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const d=this.options;this.urls=[];for(const r of d.urls)this.urls.push(this.map._requestManager.transformRequest(r,a.ResourceType.Source).url);a.getVideo(this.urls,(r,u)=>{this._loaded=!0,r?this.fire(new a.ErrorEvent(r)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){if(this.video){const r=this.video.seekable;d<r.start(0)||d>r.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=d}}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const d=this.map.painter.context,r=d.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(d,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(d)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Pt,canvas:class extends Pt{constructor(d,r,u,m){super(d,r,u,m),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some(y=>!Array.isArray(y)||2!==y.length||y.some(b=>"number"!=typeof b))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const r=this.map.painter.context;this.texture?(d||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}},custom:class extends a.Evented{constructor(d,r,u,m){super(),this.id=d,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=r,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new pn(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(d){this._map=d,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(d),this.load()}onRemove(d){this._implementation.onRemove&&this._implementation.onRemove(d)}hasTile(d){if(this._implementation.hasTile){const{x:r,y:u,z:m}=d.canonical;return this._implementation.hasTile({x:r,y:u,z:m})}return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,r){const{x:u,y:m,z:y}=d.tileID.canonical,b=new a.window.AbortController;d.request=Promise.resolve(this._implementation.loadTile({x:u,y:m,z:y},{signal:b.signal})).then(function(S){return delete d.request,d.aborted?(d.state="unloaded",r(null)):void 0===S?(d.state="errored",r(null)):null===S?(this.loadTileData(d,{width:this.tileSize,height:this.tileSize,data:null}),d.state="loaded",r(null)):(z=S)instanceof a.window.ImageData||z instanceof a.window.HTMLCanvasElement||z instanceof a.window.ImageBitmap||z instanceof a.window.HTMLImageElement?(this.loadTileData(d,S),d.state="loaded",void r(null)):(d.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var z}.bind(this)).catch(S=>{20!==S.code&&(d.state="errored",r(S))}),d.request.cancel=()=>b.abort()}loadTileData(d,r){re.loadTileData(d,r,this._map.painter)}unloadTileData(d){re.unloadTileData(d,this._map.painter)}unloadTile(d,r){if(this.unloadTileData(d),this._implementation.unloadTile){const{x:u,y:m,z:y}=d.tileID.canonical;this._implementation.unloadTile({x:u,y:m,z:y})}r()}abortTile(d,r){d.request&&d.request.cancel&&(d.request.cancel(),delete d.request),r()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(d=>({x:d.canonical.x,y:d.canonical.y,z:d.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},ni=function(d,r,u,m){const y=new Cn[r.type](d,r,u,m);if(y.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${y.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],y),y};function xi(d,r){const u=a.identity([]);return a.scale(u,u,[.5*d.width,.5*-d.height,1]),a.translate(u,u,[1,-1,0]),a.multiply(u,u,d.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(u)}function sr(d,r,u,m,y,b,S,z=!1){const U=d.tilesIn(m,S,z);U.sort(Jr);const J=[];for(const we of U)J.push({wrappedTileID:we.tile.tileID.wrapped().key,queryResults:we.tile.queryRenderedFeatures(r,u,d._state,we,y,b,xi(d.transform,we.tile.tileID),z)});const Q=function(we){const Ye={},Qe={};for(const ut of we){const it=ut.queryResults,ft=ut.wrappedTileID,Ee=Qe[ft]=Qe[ft]||{};for(const qe in it){const yt=it[qe],Mt=Ee[qe]=Ee[qe]||{},$t=Ye[qe]=Ye[qe]||[];for(const Wt of yt)Mt[Wt.featureIndex]||(Mt[Wt.featureIndex]=!0,$t.push(Wt))}}return Ye}(J);for(const we in Q)Q[we].forEach(Ye=>{const Qe=Ye.feature,ut=Qe.layer;ut&&"background"!==ut.type&&"sky"!==ut.type&&(Qe.source=ut.source,ut["source-layer"]&&(Qe.sourceLayer=ut["source-layer"]),Qe.state=void 0!==Qe.id?d.getFeatureState(ut["source-layer"],Qe.id):{})});return Q}function Cr(d,r){const u=d.getRenderableIds().map(b=>d.getTileByID(b)),m=[],y={};for(let b=0;b<u.length;b++){const S=u[b],z=S.tileID.canonical.key;y[z]||(y[z]=!0,S.querySourceFeatures(m,r))}return m}function Jr(d,r){const u=d.tileID,m=r.tileID;return u.overscaledZ-m.overscaledZ||u.canonical.y-m.canonical.y||u.wrap-m.wrap||u.canonical.x-m.canonical.x}function eo(){return null!=kt.workerClass?new kt.workerClass:new a.window.Worker(kt.workerUrl)}const Lr="mapboxgl_preloaded_worker_pool";class Ci{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Ci.workerCount;)this.workers.push(new eo);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],0===this.numActive()&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Lr]}numActive(){return Object.keys(this.active).length}}let Do;function Or(){return Do||(Do=new Ci),Do}function ms(d,r){const u={};for(const m in d)"ref"!==m&&(u[m]=d[m]);return a.refProperties.forEach(m=>{m in r&&(u[m]=r[m])}),u}function as(d){d=d.slice();const r=Object.create(null);for(let u=0;u<d.length;u++)r[d[u].id]=d[u];for(let u=0;u<d.length;u++)"ref"in d[u]&&(d[u]=ms(d[u],r[d[u].ref]));return d}Ci.workerCount=2;const fr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Xi(d,r,u){u.push({command:fr.addSource,args:[d,r[d]]})}function fo(d,r,u){r.push({command:fr.removeSource,args:[d]}),u[d]=!0}function oo(d,r,u,m){fo(d,u,m),Xi(d,r,u)}function so(d,r,u){let m;for(m in d[u])if(d[u].hasOwnProperty(m)&&"data"!==m&&!se(d[u][m],r[u][m]))return!1;for(m in r[u])if(r[u].hasOwnProperty(m)&&"data"!==m&&!se(d[u][m],r[u][m]))return!1;return!0}function ci(d,r,u,m,y,b){let S;for(S in r=r||{},d=d||{})d.hasOwnProperty(S)&&(se(d[S],r[S])||u.push({command:b,args:[m,S,r[S],y]}));for(S in r)r.hasOwnProperty(S)&&!d.hasOwnProperty(S)&&(se(d[S],r[S])||u.push({command:b,args:[m,S,r[S],y]}))}function mo(d){return d.id}function yr(d,r){return d[r.id]=r,d}class Uo{constructor(r,u){this.reset(r,u)}reset(r,u){this.points=r||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(1===this.points.length)return this.points[0];r=a.clamp(r,0,1);let u=1,m=this._distances[u];const y=r*this.paddedLength+this.padding;for(;m<y&&u<this._distances.length;)m=this._distances[++u];const b=u-1,S=this._distances[b],z=m-S,U=z>0?(y-S)/z:0;return this.points[b].mult(1-U).add(this.points[u].mult(U))}}class nt{constructor(r,u,m){const y=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(r/m),this.yCellCount=Math.ceil(u/m);for(let S=0;S<this.xCellCount*this.yCellCount;S++)y.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=u,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,u,m,y,b){this._forEachCell(u,m,y,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(y),this.bboxes.push(b)}insertCircle(r,u,m,y){this._forEachCell(u-y,m-y,u+y,m+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(u),this.circles.push(m),this.circles.push(y)}_insertBoxCell(r,u,m,y,b,S){this.boxCells[b].push(S)}_insertCircleCell(r,u,m,y,b,S){this.circleCells[b].push(S)}_query(r,u,m,y,b,S){if(m<0||r>this.width||y<0||u>this.height)return!b&&[];const z=[];if(r<=0&&u<=0&&this.width<=m&&this.height<=y){if(b)return!0;for(let U=0;U<this.boxKeys.length;U++)z.push({key:this.boxKeys[U],x1:this.bboxes[4*U],y1:this.bboxes[4*U+1],x2:this.bboxes[4*U+2],y2:this.bboxes[4*U+3]});for(let U=0;U<this.circleKeys.length;U++){const J=this.circles[3*U],Q=this.circles[3*U+1],we=this.circles[3*U+2];z.push({key:this.circleKeys[U],x1:J-we,y1:Q-we,x2:J+we,y2:Q+we})}return S?z.filter(S):z}return this._forEachCell(r,u,m,y,this._queryCell,z,{hitTest:b,seenUids:{box:{},circle:{}}},S),b?z.length>0:z}_queryCircle(r,u,m,y,b){const S=r-m,z=r+m,U=u-m,J=u+m;if(z<0||S>this.width||J<0||U>this.height)return!y&&[];const Q=[];return this._forEachCell(S,U,z,J,this._queryCellCircle,Q,{hitTest:y,circle:{x:r,y:u,radius:m},seenUids:{box:{},circle:{}}},b),y?Q.length>0:Q}query(r,u,m,y,b){return this._query(r,u,m,y,!1,b)}hitTest(r,u,m,y,b){return this._query(r,u,m,y,!0,b)}hitTestCircle(r,u,m,y){return this._queryCircle(r,u,m,!0,y)}_queryCell(r,u,m,y,b,S,z,U){const J=z.seenUids,Q=this.boxCells[b];if(null!==Q){const Ye=this.bboxes;for(const Qe of Q)if(!J.box[Qe]){J.box[Qe]=!0;const ut=4*Qe;if(r<=Ye[ut+2]&&u<=Ye[ut+3]&&m>=Ye[ut+0]&&y>=Ye[ut+1]&&(!U||U(this.boxKeys[Qe]))){if(z.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[Qe],x1:Ye[ut],y1:Ye[ut+1],x2:Ye[ut+2],y2:Ye[ut+3]})}}}const we=this.circleCells[b];if(null!==we){const Ye=this.circles;for(const Qe of we)if(!J.circle[Qe]){J.circle[Qe]=!0;const ut=3*Qe;if(this._circleAndRectCollide(Ye[ut],Ye[ut+1],Ye[ut+2],r,u,m,y)&&(!U||U(this.circleKeys[Qe]))){if(z.hitTest)return S.push(!0),!0;{const it=Ye[ut],ft=Ye[ut+1],Ee=Ye[ut+2];S.push({key:this.circleKeys[Qe],x1:it-Ee,y1:ft-Ee,x2:it+Ee,y2:ft+Ee})}}}}}_queryCellCircle(r,u,m,y,b,S,z,U){const J=z.circle,Q=z.seenUids,we=this.boxCells[b];if(null!==we){const Qe=this.bboxes;for(const ut of we)if(!Q.box[ut]){Q.box[ut]=!0;const it=4*ut;if(this._circleAndRectCollide(J.x,J.y,J.radius,Qe[it+0],Qe[it+1],Qe[it+2],Qe[it+3])&&(!U||U(this.boxKeys[ut])))return S.push(!0),!0}}const Ye=this.circleCells[b];if(null!==Ye){const Qe=this.circles;for(const ut of Ye)if(!Q.circle[ut]){Q.circle[ut]=!0;const it=3*ut;if(this._circlesCollide(Qe[it],Qe[it+1],Qe[it+2],J.x,J.y,J.radius)&&(!U||U(this.circleKeys[ut])))return S.push(!0),!0}}}_forEachCell(r,u,m,y,b,S,z,U){const J=this._convertToXCellCoord(r),Q=this._convertToYCellCoord(u),we=this._convertToXCellCoord(m),Ye=this._convertToYCellCoord(y);for(let Qe=J;Qe<=we;Qe++)for(let ut=Q;ut<=Ye;ut++)if(b.call(this,r,u,m,y,this.xCellCount*ut+Qe,S,z,U))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,u,m,y,b,S){const z=y-r,U=b-u,J=m+S;return J*J>z*z+U*U}_circleAndRectCollide(r,u,m,y,b,S,z){const U=(S-y)/2,J=Math.abs(r-(y+U));if(J>U+m)return!1;const Q=(z-b)/2,we=Math.abs(u-(b+Q));if(we>Q+m)return!1;if(J<=U||we<=Q)return!0;const Ye=J-U,Qe=we-Q;return Ye*Ye+Qe*Qe<=m*m}}const Ft={unknown:0,flipRequired:1,flipNotRequired:2},Tt=Math.tan(85*Math.PI/180);function ht(d,r,u,m,y,b,S){const z=a.create();if(u)if("globe"===b.name){const U=a.calculateGlobeLabelMatrix(y,r);a.multiply(z,z,U)}else{const U=et([],S);z[0]=U[0],z[1]=U[1],z[4]=U[2],z[5]=U[3],m||a.rotateZ(z,z,y.angle)}else a.multiply(z,y.labelPlaneMatrix,d);return z}function xn(d,r,u,m,y,b,S){const z=ht(d,r,u,m,y,b,S);return"globe"===b.name&&u||(z[2]=z[6]=z[10]=z[14]=0),z}function Xn(d,r,u,m,y,b,S){if(u){if("globe"===b.name){const z=ht(d,r,u,m,y,b,S);return a.invert(z,z),a.multiply(z,d,z),z}{const z=a.clone(d),U=a.identity([]);return U[0]=S[0],U[1]=S[1],U[4]=S[2],U[5]=S[3],a.multiply(z,z,U),m||a.rotateZ(z,z,-y.angle),z}}return y.glCoordMatrix}function Zn(d,r,u,m){const y=[d,r,u,1];u?a.transformMat4$1(y,y,m):Oi(y,y,m);const b=y[3];return y[0]/=b,y[1]/=b,y[2]/=b,y}function Ei(d,r){return Math.min(.5+d/r*.5,1.5)}function An(d,r){const u=d[0]/d[3],m=d[1]/d[3];return u>=-r[0]&&u<=r[0]&&m>=-r[1]&&m<=r[1]}function no(d,r,u,m,y,b,S,z,U,J){const Q=u.transform,we=m?d.textSizeData:d.iconSizeData,Ye=a.evaluateSizeForZoom(we,u.transform.zoom),Qe="globe"===Q.projection.name,ut=[256/u.width*2+1,256/u.height*2+1],it=m?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;it.clear();let ft=null;Qe&&(ft=m?d.text.globeExtVertexArray:d.icon.globeExtVertexArray);const Ee=d.lineVertexArray,qe=m?d.text.placedSymbolArray:d.icon.placedSymbolArray,yt=u.transform.width/u.transform.height;let Mt,$t=!1;for(let Wt=0;Wt<qe.length;Wt++){const Ot=qe.get(Wt),{numGlyphs:on,writingMode:Zt}=Ot;if(Zt!==a.WritingMode.vertical||$t||Mt===a.WritingMode.horizontal||($t=!0),Mt=Zt,(Ot.hidden||Zt===a.WritingMode.vertical)&&!$t){Ri(on,it);continue}$t=!1;const cn=new a.Point(Ot.tileAnchorX,Ot.tileAnchorY);let{x:li,y:fn,z:Fn}=Q.projection.projectTilePoint(cn.x,cn.y,J.canonical);if(U){const[wr,Vi,or]=U(cn);li+=wr,fn+=Vi,Fn+=or}const gn=[li,fn,Fn,1];if(a.transformMat4$1(gn,gn,r),!An(gn,ut)){Ri(on,it);continue}const ai=Ei(u.transform.cameraToCenterDistance,gn[3]),vn=a.evaluateSizeForFeature(we,Ye,Ot),Hn=S?vn/ai:vn*ai,ri=Zn(li,fn,Fn,y);if(ri[3]<=0){Ri(on,it);continue}let Qn={};const fi=S?null:U,tr=ii(Ot,Hn,!1,z,r,y,b,d.glyphOffsetArray,Ee,it,ft,ri,cn,Qn,yt,fi,Q.projection,J,S);$t=tr.useVertical,fi&&tr.needsFlipping&&(Qn={}),(tr.notEnoughRoom||$t||tr.needsFlipping&&ii(Ot,Hn,!0,z,r,y,b,d.glyphOffsetArray,Ee,it,ft,ri,cn,Qn,yt,fi,Q.projection,J,S).notEnoughRoom)&&Ri(on,it)}m?(d.text.dynamicLayoutVertexBuffer.updateData(it),ft&&d.text.globeExtVertexBuffer.updateData(ft)):(d.icon.dynamicLayoutVertexBuffer.updateData(it),ft&&d.icon.globeExtVertexBuffer.updateData(ft))}function lr(d,r,u,m,y,b,S,z,U,J,Q,we,Ye,Qe,ut,it){const{lineStartIndex:ft,glyphStartIndex:Ee,segment:qe}=z,yt=Ee+z.numGlyphs,Mt=ft+z.lineLength,$t=r.getoffsetX(Ee),Wt=r.getoffsetX(yt-1),Ot=ur(d*$t,u,m,y,b,S,qe,ft,Mt,U,J,Q,we,Ye,!0,Qe,ut,it);if(!Ot)return null;const on=ur(d*Wt,u,m,y,b,S,qe,ft,Mt,U,J,Q,we,Ye,!0,Qe,ut,it);return on?{first:Ot,last:on}:null}function Mr(d,r,u,m){return d===a.WritingMode.horizontal&&Math.abs(m)>Math.abs(u)?{useVertical:!0}:d===a.WritingMode.vertical?m>0?{needsFlipping:!0}:null:r!==Ft.unknown&&(0===(y=u)||Math.abs(m/y)>Tt)?r===Ft.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null;var y}function ii(d,r,u,m,y,b,S,z,U,J,Q,we,Ye,Qe,ut,it,ft,Ee,qe){const yt=r/24,Mt=d.lineOffsetX*yt,$t=d.lineOffsetY*yt,{lineStartIndex:Wt,glyphStartIndex:Ot,numGlyphs:on,segment:Zt,writingMode:cn,flipState:li}=d,fn=Wt+d.lineLength,Fn=gn=>{if(Q){const[ri,Qn,fi]=gn.up,tr=J.length;a.updateGlobeVertexNormal(Q,tr+0,ri,Qn,fi),a.updateGlobeVertexNormal(Q,tr+1,ri,Qn,fi),a.updateGlobeVertexNormal(Q,tr+2,ri,Qn,fi),a.updateGlobeVertexNormal(Q,tr+3,ri,Qn,fi)}const[ai,vn,Hn]=gn.point;a.addDynamicAttributes(J,ai,vn,Hn,gn.angle)};if(on>1){const gn=lr(yt,z,Mt,$t,u,we,Ye,d,U,b,Qe,it,!1,ft,Ee,qe);if(!gn)return{notEnoughRoom:!0};if(m&&!u){let[ai,vn,Hn]=gn.first.point,[ri,Qn,fi]=gn.last.point;[ai,vn]=Zn(ai,vn,Hn,S),[ri,Qn]=Zn(ri,Qn,fi,S);const tr=Mr(cn,li,(ri-ai)*ut,Qn-vn);if(d.flipState=tr&&tr.needsFlipping?Ft.flipRequired:Ft.flipNotRequired,tr)return tr}Fn(gn.first);for(let ai=Ot+1;ai<Ot+on-1;ai++){const vn=ur(yt*z.getoffsetX(ai),Mt,$t,u,we,Ye,Zt,Wt,fn,U,b,Qe,it,!1,!1,ft,Ee,qe);if(!vn)return J.length-=4*(ai-Ot),{notEnoughRoom:!0};Fn(vn)}Fn(gn.last)}else{if(m&&!u){const ai=Zn(Ye.x,Ye.y,0,y),vn=Wt+Zt+1,Hn=new a.Point(U.getx(vn),U.gety(vn)),ri=Zn(Hn.x,Hn.y,0,y),Qn=ri[3]>0?ri:Ui(Ye,Hn,ai,1,y,void 0,ft,Ee.canonical),fi=Mr(cn,li,(Qn[0]-ai[0])*ut,Qn[1]-ai[1]);if(d.flipState=fi&&fi.needsFlipping?Ft.flipRequired:Ft.flipNotRequired,fi)return fi}const gn=ur(yt*z.getoffsetX(Ot),Mt,$t,u,we,Ye,Zt,Wt,fn,U,b,Qe,it,!1,!1,ft,Ee,qe);if(!gn)return{notEnoughRoom:!0};Fn(gn)}return{}}function vi(d,r,u,m,y){const{x:b,y:S,z}=m.projectTilePoint(d.x,d.y,r);if(!y)return Zn(b,S,z,u);const[U,J,Q]=y(d);return Zn(b+U,S+J,z+Q,u)}function Ui(d,r,u,m,y,b,S,z){const U=vi(d.sub(r)._unit()._add(d),z,y,S,b);return a.sub(U,u,U),a.normalize(U,U),a.scaleAndAdd(U,u,U,m)}function ur(d,r,u,m,y,b,S,z,U,J,Q,we,Ye,Qe,ut,it,ft,Ee){const qe=m?d-r:d+r;let yt=qe>0?1:-1,Mt=0;m&&(yt*=-1,Mt=Math.PI),yt<0&&(Mt+=Math.PI);let $t=z+S+(yt>0?0:1)|0,Wt=y,Ot=y,on=0,Zt=0;const cn=Math.abs(qe),li=[],fn=[];let Fn=b,gn=Fn;const ai=()=>Ui(gn,Fn,Ot,cn-on+1,Q,Ye,it,ft.canonical);for(;on+Zt<=cn;){if($t+=yt,$t<z||$t>=U)return null;if(Ot=Wt,gn=Fn,li.push(Ot),Qe&&fn.push(gn),Fn=new a.Point(J.getx($t),J.gety($t)),Wt=we[$t],!Wt){const or=vi(Fn,ft.canonical,Q,it,Ye);Wt=or[3]>0?we[$t]=or:ai()}on+=Zt,Zt=a.distance(Ot,Wt)}ut&&Ye&&(we[$t]&&(Wt=ai(),Zt=a.distance(Ot,Wt)),we[$t]=Wt);const vn=(cn-on)/Zt,Hn=Fn.sub(gn)._mult(vn)._add(gn),ri=a.sub([],Wt,Ot),Qn=a.scaleAndAdd([],Ot,ri,vn);let fi=[0,0,1],tr=ri[0],wr=ri[1];if(Ee&&(fi=it.upVector(ft.canonical,Hn.x,Hn.y),0!==fi[0]||0!==fi[1]||1!==fi[2])){const or=[fi[2],0,-fi[0]],Ur=a.cross([],fi,or);a.normalize(or,or),a.normalize(Ur,Ur),tr=a.dot(ri,or),wr=a.dot(ri,Ur)}if(u){const or=a.cross([],fi,ri);a.normalize(or,or),a.scaleAndAdd(Qn,Qn,or,u*yt)}const Vi=Mt+Math.atan2(wr,tr);return li.push(Qn),Qe&&fn.push(Hn),{point:Qn,angle:Vi,path:li,tilePath:fn,up:fi}}function Ri(d,r){const u=r.length,m=u+4*d;r.resize(m),r.float32.fill(-1/0,4*u,4*m)}function Oi(d,r,u){const m=r[0],y=r[1];return d[0]=u[0]*m+u[4]*y+u[12],d[1]=u[1]*m+u[5]*y+u[13],d[3]=u[3]*m+u[7]*y+u[15],d}const nr=100;class mr{constructor(r,u,m=new nt(r.width+200,r.height+200,25),y=new nt(r.width+200,r.height+200,25)){this.transform=r,this.grid=m,this.ignoredGrid=y,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+nr,this.screenBottomBoundary=r.height+nr,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=u}placeCollisionBox(r,u,m,y,b,S,z,U){let J=m.projectedAnchorX,Q=m.projectedAnchorY,we=m.projectedAnchorZ;const Ye=m.elevation,Qe=m.tileID,ut=r.getProjection();if(Ye&&Qe){const[Wt,Ot,on]=ut.upVector(Qe.canonical,m.tileAnchorX,m.tileAnchorY),Zt=ut.upVectorScale(Qe.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;J+=Wt*Ye*Zt,Q+=Ot*Ye*Zt,we+=on*Ye*Zt}const it=this.projectAndGetPerspectiveRatio(z,J,Q,we,m.tileID,"globe"===ut.name||!!Ye||this.transform.pitch>0,ut),ft=S*it.perspectiveRatio,Ee=(m.x1*u+y.x-m.padding)*ft+it.point.x,qe=(m.y1*u+y.y-m.padding)*ft+it.point.y,yt=(m.x2*u+y.x+m.padding)*ft+it.point.x,Mt=(m.y2*u+y.y+m.padding)*ft+it.point.y,$t=it.perspectiveRatio<=.55||it.occluded;return!this.isInsideGrid(Ee,qe,yt,Mt)||!b&&this.grid.hitTest(Ee,qe,yt,Mt,U)||$t?{box:[],offscreen:!1,occluded:it.occluded}:{box:[Ee,qe,yt,Mt],offscreen:this.isOffscreen(Ee,qe,yt,Mt),occluded:!1}}placeCollisionCircles(r,u,m,y,b,S,z,U,J,Q,we,Ye,Qe,ut,it){const ft=[],Ee=this.transform.elevation,qe=r.getProjection(),yt=Ee?Ee.getAtTileOffsetFunc(it,this.transform.center.lat,this.transform.worldSize,qe):null,Mt=new a.Point(m.tileAnchorX,m.tileAnchorY);let{x:$t,y:Wt,z:Ot}=qe.projectTilePoint(Mt.x,Mt.y,it.canonical);if(yt){const[Hn,ri,Qn]=yt(Mt);$t+=Hn,Wt+=ri,Ot+=Qn}const on="globe"===qe.name,Zt=this.projectAndGetPerspectiveRatio(z,$t,Wt,Ot,it,on||!!Ee||this.transform.pitch>0,qe),{perspectiveRatio:cn}=Zt,li=(we?S/cn:S*cn)/a.ONE_EM,fn=Zn($t,Wt,Ot,U),Fn=Zt.signedDistanceFromCamera>0?lr(li,b,m.lineOffsetX*li,m.lineOffsetY*li,!1,fn,Mt,m,y,U,{},Ee&&!we?yt:null,we&&!!Ee,qe,it,we):null;let gn=!1,ai=!1,vn=!0;if(Fn&&!Zt.occluded){const Hn=.5*Qe*cn+ut,ri=new a.Point(-100,-100),Qn=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),fi=new Uo,{first:tr,last:wr}=Fn,Vi=tr.path.length;let or=[];for(let Qi=Vi-1;Qi>=1;Qi--)or.push(tr.path[Qi]);for(let Qi=1;Qi<wr.path.length;Qi++)or.push(wr.path[Qi]);const Ur=2.5*Hn;J&&(or=or.map(([Qi,Wi,Vo],es)=>(yt&&!on&&(Vo=yt(es<Vi-1?tr.tilePath[Vi-1-es]:wr.tilePath[es-Vi+2])[2]),Zn(Qi,Wi,Vo,J))),or.some(Qi=>Qi[3]<=0)&&(or=[]));let Zr=[];if(or.length>0){let Qi=1/0,Wi=-1/0,Vo=1/0,es=-1/0;for(const Co of or)Qi=Math.min(Qi,Co[0]),Vo=Math.min(Vo,Co[1]),Wi=Math.max(Wi,Co[0]),es=Math.max(es,Co[1]);Wi>=ri.x&&Qi<=Qn.x&&es>=ri.y&&Vo<=Qn.y&&(Zr=[or.map(Co=>new a.Point(Co[0],Co[1]))],(Qi<ri.x||Wi>Qn.x||Vo<ri.y||es>Qn.y)&&(Zr=a.clipLine(Zr,ri.x,ri.y,Qn.x,Qn.y)))}for(const Qi of Zr){fi.reset(Qi,.25*Hn);let Wi=0;Wi=fi.length<=.5*Hn?1:Math.ceil(fi.paddedLength/Ur)+1;for(let Vo=0;Vo<Wi;Vo++){const es=Vo/Math.max(Wi-1,1),Co=fi.lerp(es),Ya=Co.x+nr,Ma=Co.y+nr;ft.push(Ya,Ma,Hn,0);const bl=Ya-Hn,tl=Ma-Hn,ds=Ya+Hn,Ko=Ma+Hn;if(vn=vn&&this.isOffscreen(bl,tl,ds,Ko),ai=ai||this.isInsideGrid(bl,tl,ds,Ko),!u&&this.grid.hitTestCircle(Ya,Ma,Hn,Ye)&&(gn=!0,!Q))return{circles:[],offscreen:!1,collisionDetected:gn,occluded:!1}}}}return{circles:!Q&&gn||!ai?[]:ft,offscreen:vn,collisionDetected:gn,occluded:Zt.occluded}}queryRenderedSymbols(r){if(0===r.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const u=[];let m=1/0,y=1/0,b=-1/0,S=-1/0;for(const Q of r){const we=new a.Point(Q.x+nr,Q.y+nr);m=Math.min(m,we.x),y=Math.min(y,we.y),b=Math.max(b,we.x),S=Math.max(S,we.y),u.push(we)}const z=this.grid.query(m,y,b,S).concat(this.ignoredGrid.query(m,y,b,S)),U={},J={};for(const Q of z){const we=Q.key;if(void 0===U[we.bucketInstanceId]&&(U[we.bucketInstanceId]={}),U[we.bucketInstanceId][we.featureIndex])continue;const Ye=[new a.Point(Q.x1,Q.y1),new a.Point(Q.x2,Q.y1),new a.Point(Q.x2,Q.y2),new a.Point(Q.x1,Q.y2)];a.polygonIntersectsPolygon(u,Ye)&&(U[we.bucketInstanceId][we.featureIndex]=!0,void 0===J[we.bucketInstanceId]&&(J[we.bucketInstanceId]=[]),J[we.bucketInstanceId].push(we.featureIndex))}return J}insertCollisionBox(r,u,m,y,b){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:y,collisionGroupID:b},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,u,m,y,b){const S=u?this.ignoredGrid:this.grid,z={bucketInstanceId:m,featureIndex:y,collisionGroupID:b};for(let U=0;U<r.length;U+=4)S.insertCircle(z,r[U],r[U+1],r[U+2])}projectAndGetPerspectiveRatio(r,u,m,y,b,S,z){const U=[u,m,y,1];let J=!1;y||this.transform.pitch>0?(a.transformMat4$1(U,U,r),this.fogState&&b&&"globe"!==z.name&&(J=function(Ye,Qe,ut,it,ft,Ee){const qe=Ee.calculateFogTileMatrix(ft),yt=[Qe,ut,it];return a.transformMat4(yt,yt,qe),wn(Ye,yt,Ee.pitch,Ee._fov)}(this.fogState,u,m,y,b.toUnwrapped(),this.transform)>.9)):Oi(U,U,r);const Q=U[3];return{point:new a.Point((U[0]/Q+1)/2*this.transform.width+nr,(-U[1]/Q+1)/2*this.transform.height+nr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(z)/Q*.5,1.5),signedDistanceFromCamera:Q,occluded:S&&U[2]>Q||J}}isOffscreen(r,u,m,y){return m<nr||r>=this.screenRightBoundary||y<nr||u>this.screenBottomBoundary}isInsideGrid(r,u,m,y){return m>=0&&r<this.gridRightBoundary&&y>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const r=a.identity([]);return a.translate(r,r,[-100,-100,0]),r}}function io(d,r,u){const m=r.createTileMatrix(d,d.worldSize,u.toUnwrapped());return a.multiply(new Float32Array(16),d.projMatrix,m)}function yo(d,r,u){if(r.projection.name===u.projection.name)return d.projMatrix;const m=u.clone();return m.setProjection(r.projection),io(m,r.getProjection(),d)}function Ji(d,r,u){return r.name===u.projection.name?d.projMatrix:io(u,r,d)}class Zi{constructor(r,u,m,y){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?u:-u))):y&&m?1:0,this.placed=m}isHidden(){return 0===this.opacity&&!this.placed}}class hr{constructor(r,u,m,y,b,S=!1){this.text=new Zi(r?r.text:null,u,m,b),this.icon=new Zi(r?r.icon:null,u,y,b),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class oa{constructor(r,u,m,y=!1){this.text=r,this.icon=u,this.skipFade=m,this.clipped=y}}class jo{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class gl{constructor(r,u,m,y,b){this.bucketInstanceId=r,this.featureIndex=u,this.sourceLayerIndex=m,this.bucketIndex=y,this.tileID=b}}class ol{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const u=++this.maxGroupID;this.collisionGroups[r]={ID:u,predicate:m=>m.collisionGroupID===u}}return this.collisionGroups[r]}}function Ga(d,r,u,m,y){const{horizontalAlign:b,verticalAlign:S}=a.getAnchorAlignment(d),z=-(b-.5)*r,U=-(S-.5)*u,J=a.evaluateVariableOffset(d,m);return new a.Point(z+J[0]*y,U+J[1]*y)}function qs(d,r,u,m,y){const b=new a.Point(d,r);return u&&b._rotate(m?y:-y),b}class Dr{constructor(r,u,m,y,b){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new mr(this.transform,b),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new ol(m),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,u,m,y){const b=m.getBucket(u),S=m.latestFeatureIndex;if(!b||!S||u.id!==b.layerIds[0])return;const z=b.layers[0].layout,U=m.collisionBoxArray,J=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),Q=m.tileSize/a.EXTENT,we=m.tileID.toUnwrapped();this.transform.setProjection(b.projection);const Ye=(Qe=m.tileID,ut=b.getProjection(),it=this.transform,ut.name===this.projection?it.calculateProjMatrix(Qe.toUnwrapped()):io(it,ut,Qe));var Qe,ut,it;const ft="map"===z.get("text-pitch-alignment"),Ee="map"===z.get("text-rotation-alignment");u.compileFilter();const qe=u.dynamicFilter(),yt=u.dynamicFilterNeedsFeature(),Mt=this.transform.calculatePixelsToTileUnitsMatrix(m),$t=xn(Ye,m.tileID.canonical,ft,Ee,this.transform,b.getProjection(),Mt);let Wt=null;if(ft){const Zt=Xn(Ye,m.tileID.canonical,ft,Ee,this.transform,b.getProjection(),Mt);Wt=a.multiply([],this.transform.labelPlaneMatrix,Zt)}let Ot=null;qe&&m.latestFeatureIndex&&(Ot={unwrappedTileID:we,dynamicFilter:qe,dynamicFilterNeedsFeature:yt,featureIndex:m.latestFeatureIndex}),this.retainedQueryData[b.bucketInstanceId]=new gl(b.bucketInstanceId,S,b.sourceLayerIndex,b.index,m.tileID);const on={bucket:b,layout:z,posMatrix:Ye,textLabelPlaneMatrix:$t,labelToScreenMatrix:Wt,clippingData:Ot,scale:J,textPixelRatio:Q,holdingForFade:m.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(b.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(y)for(const Zt of b.sortKeyRanges){const{sortKey:cn,symbolInstanceStart:li,symbolInstanceEnd:fn}=Zt;r.push({sortKey:cn,symbolInstanceStart:li,symbolInstanceEnd:fn,parameters:on})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:on})}attemptAnchorPlacement(r,u,m,y,b,S,z,U,J,Q,we,Ye,Qe,ut,it,ft,Ee,qe){const{textOffset0:yt,textOffset1:Mt,crossTileID:$t}=Ye,Wt=[yt,Mt],Ot=Ga(r,m,y,Wt,b),on=this.collisionIndex.placeCollisionBox(ut,b,u,qs(Ot.x,Ot.y,S,z,this.transform.angle),we,U,J,Q.predicate);if(ft){const Zt=ut.getSymbolInstanceIconSize(qe,this.transform.zoom,Ye.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(ut,Zt,ft,qs(Ot.x,Ot.y,S,z,this.transform.angle),we,U,J,Q.predicate).box.length)return}if(on.box.length>0){let Zt;return this.prevPlacement&&this.prevPlacement.variableOffsets[$t]&&this.prevPlacement.placements[$t]&&this.prevPlacement.placements[$t].text&&(Zt=this.prevPlacement.variableOffsets[$t].anchor),this.variableOffsets[$t]={textOffset:Wt,width:m,height:y,anchor:r,textScale:b,prevAnchor:Zt},this.markUsedJustification(ut,r,Ye,it),ut.allowVerticalPlacement&&(this.markUsedOrientation(ut,it,Ye),this.placedOrientations[$t]=it),{shift:Ot,placedGlyphBoxes:on}}}placeLayerBucketPart(r,u,m,y){const{bucket:b,layout:S,posMatrix:z,textLabelPlaneMatrix:U,labelToScreenMatrix:J,clippingData:Q,textPixelRatio:we,holdingForFade:Ye,collisionBoxArray:Qe,partiallyEvaluatedTextSize:ut,partiallyEvaluatedIconSize:it,collisionGroup:ft}=r.parameters,Ee=S.get("text-optional"),qe=S.get("icon-optional"),yt=S.get("text-allow-overlap"),Mt=S.get("icon-allow-overlap"),$t="map"===S.get("text-rotation-alignment"),Wt="map"===S.get("text-pitch-alignment"),Ot="none"!==S.get("icon-text-fit"),on="viewport-y"===S.get("symbol-z-order");this.transform.setProjection(b.projection);let Zt=yt&&(Mt||!b.hasIconData()||qe),cn=Mt&&(yt||!b.hasTextData()||Ee);!b.collisionArrays&&Qe&&b.deserializeCollisionBoxes(Qe),m&&y&&b.updateCollisionDebugBuffers(this.transform.zoom,Qe);const li=(fn,Fn,gn)=>{const{crossTileID:ai,numVerticalGlyphVertices:vn}=fn;if(Q){const ds={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ko=null;if(Q.dynamicFilterNeedsFeature){const Mo=this.retainedQueryData[b.bucketInstanceId];Ko=Q.featureIndex.loadFeature({featureIndex:fn.featureIndex,bucketIndex:Mo.bucketIndex,sourceLayerIndex:Mo.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,Q.dynamicFilter)(ds,Ko,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new a.Point(fn.tileAnchorX,fn.tileAnchorY),this.transform.calculateDistanceTileData(Q.unwrappedTileID)))return this.placements[ai]=new oa(!1,!1,!1,!0),void u.add(ai)}if(u.has(ai))return;if(Ye)return void(this.placements[ai]=new oa(!1,!1,!1));let Hn=!1,ri=!1,Qn=!0,fi=!1,tr=!1,wr=null,Vi={box:null,offscreen:null,occluded:null},or={box:null,offscreen:null,occluded:null},Ur=null,Zr=null,Qi=null,Wi=0,Vo=0,es=0;gn.textFeatureIndex?Wi=gn.textFeatureIndex:fn.useRuntimeCollisionCircles&&(Wi=fn.featureIndex),gn.verticalTextFeatureIndex&&(Vo=gn.verticalTextFeatureIndex);const Co=ds=>{ds.tileID=this.retainedQueryData[b.bucketInstanceId].tileID;const Ko=this.transform.elevation;(Ko||ds.elevation)&&(ds.elevation=Ko?Ko.getAtTileOffset(ds.tileID,ds.tileAnchorX,ds.tileAnchorY):0)},Ya=gn.textBox;if(Ya){Co(Ya);const ds=Mo=>{let js=a.WritingMode.horizontal;if(b.allowVerticalPlacement&&!Mo&&this.prevPlacement){const Ys=this.prevPlacement.placedOrientations[ai];Ys&&(this.placedOrientations[ai]=Ys,js=Ys,this.markUsedOrientation(b,js,fn))}return js},Ko=(Mo,js)=>{if(b.allowVerticalPlacement&&vn>0&&gn.verticalTextBox){for(const Ys of b.writingModes)if(Ys===a.WritingMode.vertical?(Vi=js(),or=Vi):Vi=Mo(),Vi&&Vi.box&&Vi.box.length)break}else Vi=Mo()};if(S.get("text-variable-anchor")){let Mo=S.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ai]){const Mn=this.prevPlacement.variableOffsets[ai];Mo.indexOf(Mn.anchor)>0&&(Mo=Mo.filter(Vr=>Vr!==Mn.anchor),Mo.unshift(Mn.anchor))}const js=(Mn,Vr,nu)=>{const gc=b.getSymbolInstanceTextSize(ut,fn,this.transform.zoom,Fn),So=(Mn.x2-Mn.x1)*gc+2*Mn.padding,v=(Mn.y2-Mn.y1)*gc+2*Mn.padding,D=Ot&&!Mt?Vr:null;D&&Co(D);let F={box:[],offscreen:!1,occluded:!1};const oe=yt?2*Mo.length:Mo.length;for(let ne=0;ne<oe;++ne){const Te=this.attemptAnchorPlacement(Mo[ne%Mo.length],Mn,So,v,gc,$t,Wt,we,z,ft,ne>=Mo.length,fn,Fn,b,nu,D,ut,it);if(Te&&(F=Te.placedGlyphBoxes,F&&F.box&&F.box.length)){Hn=!0,wr=Te.shift;break}}return F};Ko(()=>js(Ya,gn.iconBox,a.WritingMode.horizontal),()=>{const Mn=gn.verticalTextBox;return Mn&&Co(Mn),b.allowVerticalPlacement&&!(Vi&&Vi.box&&Vi.box.length)&&vn>0&&Mn?js(Mn,gn.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Vi&&(Hn=Vi.box,Qn=Vi.offscreen,fi=Vi.occluded);const Ys=ds(!(!Vi||!Vi.box));if(!Hn&&this.prevPlacement){const Mn=this.prevPlacement.variableOffsets[ai];Mn&&(this.variableOffsets[ai]=Mn,this.markUsedJustification(b,Mn.anchor,fn,Ys))}}else{const Mo=(js,Ys)=>{const Mn=b.getSymbolInstanceTextSize(ut,fn,this.transform.zoom,Fn),Vr=this.collisionIndex.placeCollisionBox(b,Mn,js,new a.Point(0,0),yt,we,z,ft.predicate);return Vr&&Vr.box&&Vr.box.length&&(this.markUsedOrientation(b,Ys,fn),this.placedOrientations[ai]=Ys),Vr};Ko(()=>Mo(Ya,a.WritingMode.horizontal),()=>{const js=gn.verticalTextBox;return b.allowVerticalPlacement&&vn>0&&js?(Co(js),Mo(js,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),ds(!!(Vi&&Vi.box&&Vi.box.length))}}if(Ur=Vi,Hn=Ur&&Ur.box&&Ur.box.length>0,Qn=Ur&&Ur.offscreen,fi=Ur&&Ur.occluded,fn.useRuntimeCollisionCircles){const ds=b.text.placedSymbolArray.get(fn.centerJustifiedTextSymbolIndex>=0?fn.centerJustifiedTextSymbolIndex:fn.verticalPlacedTextSymbolIndex),Ko=a.evaluateSizeForFeature(b.textSizeData,ut,ds),Mo=S.get("text-padding");Zr=this.collisionIndex.placeCollisionCircles(b,yt,ds,b.lineVertexArray,b.glyphOffsetArray,Ko,z,U,J,m,Wt,ft.predicate,fn.collisionCircleDiameter*Ko/a.ONE_EM,Mo,this.retainedQueryData[b.bucketInstanceId].tileID),Hn=yt||Zr.circles.length>0&&!Zr.collisionDetected,Qn=Qn&&Zr.offscreen,fi=Zr.occluded}if(gn.iconFeatureIndex&&(es=gn.iconFeatureIndex),gn.iconBox){const ds=Ko=>{Co(Ko);const Mo=Ot&&wr?qs(wr.x,wr.y,$t,Wt,this.transform.angle):new a.Point(0,0),js=b.getSymbolInstanceIconSize(it,this.transform.zoom,fn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(b,js,Ko,Mo,Mt,we,z,ft.predicate)};or&&or.box&&or.box.length&&gn.verticalIconBox?(Qi=ds(gn.verticalIconBox),ri=Qi.box.length>0):(Qi=ds(gn.iconBox),ri=Qi.box.length>0),Qn=Qn&&Qi.offscreen,tr=Qi.occluded}const Ma=Ee||0===fn.numHorizontalGlyphVertices&&0===vn,bl=qe||0===fn.numIconVertices;if(Ma||bl?bl?Ma||(ri=ri&&Hn):Hn=ri&&Hn:ri=Hn=ri&&Hn,Hn&&Ur&&Ur.box&&this.collisionIndex.insertCollisionBox(Ur.box,S.get("text-ignore-placement"),b.bucketInstanceId,or&&or.box&&Vo?Vo:Wi,ft.ID),ri&&Qi&&this.collisionIndex.insertCollisionBox(Qi.box,S.get("icon-ignore-placement"),b.bucketInstanceId,es,ft.ID),Zr&&(Hn&&this.collisionIndex.insertCollisionCircles(Zr.circles,S.get("text-ignore-placement"),b.bucketInstanceId,Wi,ft.ID),m)){const ds=b.bucketInstanceId;let Ko=this.collisionCircleArrays[ds];void 0===Ko&&(Ko=this.collisionCircleArrays[ds]=new jo);for(let Mo=0;Mo<Zr.circles.length;Mo+=4)Ko.circles.push(Zr.circles[Mo+0]),Ko.circles.push(Zr.circles[Mo+1]),Ko.circles.push(Zr.circles[Mo+2]),Ko.circles.push(Zr.collisionDetected?1:0)}const tl="globe"!==b.projection.name;Zt=Zt&&(tl||!fi),cn=cn&&(tl||!tr),this.placements[ai]=new oa(Hn||Zt,ri||cn,Qn||b.justReloaded),u.add(ai)};if(on){const fn=b.getSortedSymbolIndexes(this.transform.angle);for(let Fn=fn.length-1;Fn>=0;--Fn){const gn=fn[Fn];li(b.symbolInstances.get(gn),gn,b.collisionArrays[gn])}}else for(let fn=r.symbolInstanceStart;fn<r.symbolInstanceEnd;fn++)li(b.symbolInstances.get(fn),fn,b.collisionArrays[fn]);if(m&&b.bucketInstanceId in this.collisionCircleArrays){const fn=this.collisionCircleArrays[b.bucketInstanceId];a.invert(fn.invProjMatrix,z),fn.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(r,u,m,y){const{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:U,crossTileID:J}=m,Q=a.getAnchorJustification(u),we=y===a.WritingMode.vertical?U:"left"===Q?b:"center"===Q?S:"right"===Q?z:-1;b>=0&&(r.text.placedSymbolArray.get(b).crossTileID=we>=0&&b!==we?0:J),S>=0&&(r.text.placedSymbolArray.get(S).crossTileID=we>=0&&S!==we?0:J),z>=0&&(r.text.placedSymbolArray.get(z).crossTileID=we>=0&&z!==we?0:J),U>=0&&(r.text.placedSymbolArray.get(U).crossTileID=we>=0&&U!==we?0:J)}markUsedOrientation(r,u,m){const y=u===a.WritingMode.horizontal||u===a.WritingMode.horizontalOnly?u:0,b=u===a.WritingMode.vertical?u:0,{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:z,rightJustifiedTextSymbolIndex:U,verticalPlacedTextSymbolIndex:J}=m,Q=r.text.placedSymbolArray;S>=0&&(Q.get(S).placedOrientation=y),z>=0&&(Q.get(z).placedOrientation=y),U>=0&&(Q.get(U).placedOrientation=y),J>=0&&(Q.get(J).placedOrientation=b)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let m=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const y=u?u.symbolFadeChange(r):1,b=u?u.opacities:{},S=u?u.variableOffsets:{},z=u?u.placedOrientations:{};for(const U in this.placements){const J=this.placements[U],Q=b[U];Q?(this.opacities[U]=new hr(Q,y,J.text,J.icon,null,J.clipped),m=m||J.text!==Q.text.placed||J.icon!==Q.icon.placed):(this.opacities[U]=new hr(null,y,J.text,J.icon,J.skipFade,J.clipped),m=m||J.text||J.icon)}for(const U in b){const J=b[U];if(!this.opacities[U]){const Q=new hr(J,y,!1,!1);Q.isHidden()||(this.opacities[U]=Q,m=m||J.text.placed||J.icon.placed)}}for(const U in S)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=S[U]);for(const U in z)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=z[U]);m?this.lastPlacementChangeTime=r:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:r)}updateLayerOpacities(r,u){const m=new Set;for(const y of u){const b=y.getBucket(r);b&&y.latestFeatureIndex&&r.id===b.layerIds[0]&&this.updateBucketOpacities(b,m,y.collisionBoxArray)}}updateBucketOpacities(r,u,m){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const y=r.layers[0].layout,b=!!r.layers[0].dynamicFilter(),S=new hr(null,0,!1,!1,!0),z=y.get("text-allow-overlap"),U=y.get("icon-allow-overlap"),J=y.get("text-variable-anchor"),Q="map"===y.get("text-rotation-alignment"),we="map"===y.get("text-pitch-alignment"),Ye="none"!==y.get("icon-text-fit"),Qe=new hr(null,0,z&&(U||!r.hasIconData()||y.get("icon-optional")),U&&(z||!r.hasTextData()||y.get("text-optional")),!0);!r.collisionArrays&&m&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(m);const ut=(ft,Ee,qe)=>{for(let yt=0;yt<Ee/4;yt++)ft.opacityVertexArray.emplaceBack(qe)};let it=0;for(let ft=0;ft<r.symbolInstances.length;ft++){const Ee=r.symbolInstances.get(ft),{numHorizontalGlyphVertices:qe,numVerticalGlyphVertices:yt,crossTileID:Mt,numIconVertices:$t}=Ee,Wt=u.has(Mt);let Ot=this.opacities[Mt];Wt?Ot=S:Ot||(Ot=Qe,this.opacities[Mt]=Ot),u.add(Mt);const on=qe>0||yt>0,Zt=$t>0,cn=this.placedOrientations[Mt],li=cn===a.WritingMode.vertical,fn=cn===a.WritingMode.horizontal||cn===a.WritingMode.horizontalOnly;if(!on&&!Zt||Ot.isHidden()||it++,on){const Fn=_s(Ot.text);ut(r.text,qe,li?xo:Fn),ut(r.text,yt,fn?xo:Fn);const gn=Ot.text.isHidden(),{leftJustifiedTextSymbolIndex:ai,centerJustifiedTextSymbolIndex:vn,rightJustifiedTextSymbolIndex:Hn,verticalPlacedTextSymbolIndex:ri}=Ee,Qn=r.text.placedSymbolArray,fi=gn||li?1:0;ai>=0&&(Qn.get(ai).hidden=fi),vn>=0&&(Qn.get(vn).hidden=fi),Hn>=0&&(Qn.get(Hn).hidden=fi),ri>=0&&(Qn.get(ri).hidden=gn||fn?1:0);const tr=this.variableOffsets[Mt];tr&&this.markUsedJustification(r,tr.anchor,Ee,cn);const wr=this.placedOrientations[Mt];wr&&(this.markUsedJustification(r,"left",Ee,wr),this.markUsedOrientation(r,wr,Ee))}if(Zt){const Fn=_s(Ot.icon),{placedIconSymbolIndex:gn,verticalPlacedIconSymbolIndex:ai}=Ee,vn=r.icon.placedSymbolArray,Hn=Ot.icon.isHidden()?1:0;gn>=0&&(ut(r.icon,$t,li?xo:Fn),vn.get(gn).hidden=Hn),ai>=0&&(ut(r.icon,Ee.numVerticalIconVertices,fn?xo:Fn),vn.get(ai).hidden=Hn)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Fn=r.collisionArrays[ft];if(Fn){let gn=new a.Point(0,0),ai=!0;if(Fn.textBox||Fn.verticalTextBox){if(J){const Hn=this.variableOffsets[Mt];Hn?(gn=Ga(Hn.anchor,Hn.width,Hn.height,Hn.textOffset,Hn.textScale),Q&&gn._rotate(we?this.transform.angle:-this.transform.angle)):ai=!1}b&&(ai=!Ot.clipped),Fn.textBox&&Ps(r.textCollisionBox.collisionVertexArray,Ot.text.placed,!ai||li,gn.x,gn.y),Fn.verticalTextBox&&Ps(r.textCollisionBox.collisionVertexArray,Ot.text.placed,!ai||fn,gn.x,gn.y)}const vn=ai&&!(fn||!Fn.verticalIconBox);Fn.iconBox&&Ps(r.iconCollisionBox.collisionVertexArray,Ot.icon.placed,vn,Ye?gn.x:0,Ye?gn.y:0),Fn.verticalIconBox&&Ps(r.iconCollisionBox.collisionVertexArray,Ot.icon.placed,!vn,Ye?gn.x:0,Ye?gn.y:0)}}}if(r.fullyClipped=0===it,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const ft=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=ft.invProjMatrix,r.placementViewportMatrix=ft.viewportMatrix,r.collisionCircleArray=ft.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return 0===this.fadeDuration?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,u){const m=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*m>r}setStale(){this.stale=!0}}function Ps(d,r,u,m,y){d.emplaceBack(r?1:0,u?1:0,m||0,y||0),d.emplaceBack(r?1:0,u?1:0,m||0,y||0),d.emplaceBack(r?1:0,u?1:0,m||0,y||0),d.emplaceBack(r?1:0,u?1:0,m||0,y||0)}const Yo=Math.pow(2,25),Rr=Math.pow(2,24),Zs=Math.pow(2,17),Wa=Math.pow(2,16),gs=Math.pow(2,9),$o=Math.pow(2,8),vs=Math.pow(2,1);function _s(d){if(0===d.opacity&&!d.placed)return 0;if(1===d.opacity&&d.placed)return 4294967295;const r=d.placed?1:0,u=Math.floor(127*d.opacity);return u*Yo+r*Rr+u*Zs+r*Wa+u*gs+r*$o+u*vs+r}const xo=0;class ga{constructor(r){this._sortAcrossTiles="viewport-y"!==r.layout.get("symbol-z-order")&&void 0!==r.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,u,m,y,b){const S=this._bucketParts;for(;this._currentTileIndex<r.length;)if(u.getBucketParts(S,y,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((z,U)=>z.sortKey-U.sortKey));this._currentPartIndex<S.length;){const z=S[this._currentPartIndex];if(u.placeLayerBucketPart(z,this._seenCrossTileIDs,m,0===z.symbolInstanceStart),this._currentPartIndex++,b())return!0}return!1}}class Da{constructor(r,u,m,y,b,S,z,U){this.placement=new Dr(r,b,S,z,U),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(r,u,m){const y=a.exported.now(),b=()=>{const S=a.exported.now()-y;return!this._forceFullPlacement&&S>2};for(;this._currentPlacementIndex>=0;){const S=u[r[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if("symbol"===S.type&&(!S.minzoom||S.minzoom<=z)&&(!S.maxzoom||S.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new ga(S)),this._inProgressLayer.continuePlacement(m[S.source],this.placement,this._showCollisionBoxes,S,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Io=512/a.EXTENT/2;class po{constructor(r,u,m){this.tileID=r,this.bucketInstanceId=m,this.index=new a.KDBush(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const y=r.canonical.x*a.EXTENT,b=r.canonical.y*a.EXTENT;for(let S=0;S<u.length;S++){const{key:z,crossTileID:U,tileAnchorX:J,tileAnchorY:Q}=u.get(S),we=Math.floor((y+J)*Io),Ye=Math.floor((b+Q)*Io);this.index.add(we,Ye),this.keys.push(z),this.crossTileIDs.push(U)}this.index.finish()}findMatches(r,u,m){const y=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),b=Io/Math.pow(2,u.canonical.z-this.tileID.canonical.z),S=u.canonical.x*a.EXTENT,z=u.canonical.y*a.EXTENT;for(let U=0;U<r.length;U++){const J=r.get(U);if(J.crossTileID)continue;const{key:Q,tileAnchorX:we,tileAnchorY:Ye}=J,Qe=Math.floor((S+we)*b),ut=Math.floor((z+Ye)*b),it=this.index.range(Qe-y,ut-y,Qe+y,ut+y);for(const ft of it){const Ee=this.crossTileIDs[ft];if(this.keys[ft]===Q&&!m.has(Ee)){m.add(Ee),J.crossTileID=Ee;break}}}}}class sa{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ms{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const u=Math.round((r-this.lng)/360);if(0!==u)for(const m in this.indexes){const y=this.indexes[m],b={};for(const S in y){const z=y[S];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+u),b[z.tileID.key]=z}this.indexes[m]=b}this.lng=r}addBucket(r,u,m){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let b=0;b<u.symbolInstances.length;b++)u.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const y=this.usedCrossTileIDs[r.overscaledZ];for(const b in this.indexes){const S=this.indexes[b];if(Number(b)>r.overscaledZ)for(const z in S){const U=S[z];U.tileID.isChildOf(r)&&U.findMatches(u.symbolInstances,r,y)}else{const z=S[r.scaledTo(Number(b)).key];z&&z.findMatches(u.symbolInstances,r,y)}}for(let b=0;b<u.symbolInstances.length;b++){const S=u.symbolInstances.get(b);S.crossTileID||(S.crossTileID=m.generate(),y.add(S.crossTileID))}return void 0===this.indexes[r.overscaledZ]&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new po(r,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(r,u){for(const m of u.crossTileIDs)this.usedCrossTileIDs[r].delete(m)}removeStaleBuckets(r){let u=!1;for(const m in this.indexes){const y=this.indexes[m];for(const b in y)r[y[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,y[b]),delete y[b],u=!0)}return u}}class Cs{constructor(){this.layerIndexes={},this.crossTileIDs=new sa,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,u,m,y){let b=this.layerIndexes[r.id];void 0===b&&(b=this.layerIndexes[r.id]=new Ms);let S=!1;const z={};"globe"!==y.name&&b.handleWrapJump(m);for(const U of u){const J=U.getBucket(r);J&&r.id===J.layerIds[0]&&(J.bucketInstanceId||(J.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(U.tileID,J,this.crossTileIDs)&&(S=!0),z[J.bucketInstanceId]=!0)}return b.removeStaleBuckets(z)&&(S=!0),S}pruneUnusedLayers(r){const u={};r.forEach(m=>{u[m]=!0});for(const m in this.layerIndexes)u[m]||delete this.layerIndexes[m]}}const vo=(d,r)=>a.emitValidationErrors(d,r&&r.filter(u=>"source.canvas"!==u.identifier)),zs=a.pick(fr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),xr=a.pick(fr,["setCenter","setZoom","setBearing","setPitch"]),aa={version:8,layers:[],sources:{}},va={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ls extends a.Evented{constructor(r,u={}){super(),this.map=r,this.dispatcher=new nn(Or(),this),this.imageManager=new zt,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(r._requestManager,u.localFontFamily?a.LocalGlyphMode.all:u.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,u.localFontFamily||u.localIdeographFontFamily),this.crossTileSymbolIndex=new Cs,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const m=this;this._rtlTextPluginCallback=ls.registerForPluginStateChange(y=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(b,S)=>{if(a.triggerPluginCompletionEvent(b),S&&S.every(z=>z))for(const z in m._sourceCaches){const U=m._sourceCaches[z],J=U.getSource().type;"vector"!==J&&"geojson"!==J||U.reload()}})}),this.on("data",y=>{if("source"!==y.dataType||"metadata"!==y.sourceDataType)return;const b=this.getSource(y.sourceId);if(b&&b.vectorLayerIds)for(const S in this._layers){const z=this._layers[S];z.source===b.id&&this._validateLayer(z)}})}loadURL(r,u={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const m="boolean"==typeof u.validate?u.validate:!a.isMapboxURL(r);r=this.map._requestManager.normalizeStyleURL(r,u.accessToken);const y=this.map._requestManager.transformRequest(r,a.ResourceType.Style);this._request=a.getJSON(y,(b,S)=>{this._request=null,b?this.fire(new a.ErrorEvent(b)):S&&this._load(S,m)})}loadJSON(r,u={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(r,!1!==u.validate)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(aa,!1)}_updateLayerCount(r,u){const m=u?1:-1;r.is3D()&&(this._num3DLayers+=m),"circle"===r.type&&(this._numCircleLayers+=m),"symbol"===r.type&&(this._numSymbolLayers+=m)}_load(r,u){if(u&&vo(this,a.validateStyle(r)))return;this._loaded=!0,this.stylesheet=a.clone$1(r),this._updateMapProjection();for(const y in r.sources)this.addSource(y,r.sources[y],{validate:!1});this._changed=!1,r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(r.glyphs);const m=as(this.stylesheet.layers);this._order=m.map(y=>y.id),this._layers={},this._serializedLayers={};for(const y of m){const b=a.createStyleLayer(y);b.setEventedParent(this,{layer:{id:b.id}}),this._layers[b.id]=b,this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new At(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(r){this._spriteRequest=function(u,m,y){let b,S,z;const U=a.exported.devicePixelRatio>1?"@2x":"";let J=a.getJSON(m.transformRequest(m.normalizeSpriteURL(u,U,".json"),a.ResourceType.SpriteJSON),(Ye,Qe)=>{J=null,z||(z=Ye,b=Qe,we())}),Q=a.getImage(m.transformRequest(m.normalizeSpriteURL(u,U,".png"),a.ResourceType.SpriteImage),(Ye,Qe)=>{Q=null,z||(z=Ye,S=Qe,we())});function we(){if(z)y(z);else if(b&&S){const Ye=a.exported.getImageData(S),Qe={};for(const ut in b){const{width:it,height:ft,x:Ee,y:qe,sdf:yt,pixelRatio:Mt,stretchX:$t,stretchY:Wt,content:Ot}=b[ut],on=new a.RGBAImage({width:it,height:ft});a.RGBAImage.copy(Ye,on,{x:Ee,y:qe},{x:0,y:0},{width:it,height:ft}),Qe[ut]={data:on,pixelRatio:Mt,sdf:yt,stretchX:$t,stretchY:Wt,content:Ot}}y(null,Qe)}}return{cancel(){J&&(J.cancel(),J=null),Q&&(Q.cancel(),Q=null)}}}(r,this.map._requestManager,(u,m)=>{if(this._spriteRequest=null,u)this.fire(new a.ErrorEvent(u));else if(m)for(const y in m)this.imageManager.addImage(y,m[y]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(r){const u=this.getSource(r.source);if(!u)return;const m=r.sourceLayer;m&&("geojson"===u.type||u.vectorLayerIds&&-1===u.vectorLayerIds.indexOf(m))&&this.fire(new a.ErrorEvent(new Error(`Source layer "${m}" does not exist on source "${u.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const u=[];for(const m of r){const y=this._layers[m];"custom"!==y.type&&u.push(y.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(r){return!!this.terrain&&("function"==typeof r.isLayerDraped?r.isLayerDraped():va[r.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(r){if(!this._loaded)return;const u=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(y.length||b.length)&&this._updateWorkerLayers(y,b);for(const S in this._updatedSources){const z=this._updatedSources[S];"reload"===z?this._reloadSource(S):"clear"===z&&this._clearSource(S)}this._updateTilesForChangedImages();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(r);this.light.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._resetUpdates()}const m={};for(const y in this._sourceCaches){const b=this._sourceCaches[y];m[y]=b.used,b.used=!1}for(const y of this._order){const b=this._layers[y];if(b.recalculate(r,this._availableImages),!b.isHidden(r.zoom)){const z=this._getLayerSourceCache(b);z&&(z.used=!0)}const S=this.map.painter;if(S){const z=b.getProgramIds();if(!z)continue;const U=b.getProgramConfiguration(r.zoom);for(const J of z)S.useProgram(J,U)}}for(const y in m){const b=this._sourceCaches[y];m[y]!==b.used&&b.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:b.getSource().id}))}this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),u&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const u in this._sourceCaches)this._sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),vo(this,a.validateStyle(r)))return!1;(r=a.clone$1(r)).layers=as(r.layers);const u=function(y,b){if(!y)return[{command:fr.setStyle,args:[b]}];let S=[];try{if(!se(y.version,b.version))return[{command:fr.setStyle,args:[b]}];se(y.center,b.center)||S.push({command:fr.setCenter,args:[b.center]}),se(y.zoom,b.zoom)||S.push({command:fr.setZoom,args:[b.zoom]}),se(y.bearing,b.bearing)||S.push({command:fr.setBearing,args:[b.bearing]}),se(y.pitch,b.pitch)||S.push({command:fr.setPitch,args:[b.pitch]}),se(y.sprite,b.sprite)||S.push({command:fr.setSprite,args:[b.sprite]}),se(y.glyphs,b.glyphs)||S.push({command:fr.setGlyphs,args:[b.glyphs]}),se(y.transition,b.transition)||S.push({command:fr.setTransition,args:[b.transition]}),se(y.light,b.light)||S.push({command:fr.setLight,args:[b.light]}),se(y.fog,b.fog)||S.push({command:fr.setFog,args:[b.fog]}),se(y.projection,b.projection)||S.push({command:fr.setProjection,args:[b.projection]});const z={},U=[];!function(we,Ye,Qe,ut){let it;for(it in Ye=Ye||{},we=we||{})we.hasOwnProperty(it)&&(Ye.hasOwnProperty(it)||fo(it,Qe,ut));for(it in Ye){if(!Ye.hasOwnProperty(it))continue;const ft=Ye[it];we.hasOwnProperty(it)?se(we[it],ft)||("geojson"===we[it].type&&"geojson"===ft.type&&so(we,Ye,it)?Qe.push({command:fr.setGeoJSONSourceData,args:[it,ft.data]}):oo(it,Ye,Qe,ut)):Xi(it,Ye,Qe)}}(y.sources,b.sources,U,z);const J=[];y.layers&&y.layers.forEach(we=>{we.source&&z[we.source]?S.push({command:fr.removeLayer,args:[we.id]}):J.push(we)});let Q=y.terrain;Q&&z[Q.source]&&(S.push({command:fr.setTerrain,args:[void 0]}),Q=void 0),S=S.concat(U),se(Q,b.terrain)||S.push({command:fr.setTerrain,args:[b.terrain]}),function(we,Ye,Qe){Ye=Ye||[];const ut=(we=we||[]).map(mo),it=Ye.map(mo),ft=we.reduce(yr,{}),Ee=Ye.reduce(yr,{}),qe=ut.slice(),yt=Object.create(null);let Mt,$t,Wt,Ot,on,Zt,cn;for(Mt=0,$t=0;Mt<ut.length;Mt++)Wt=ut[Mt],Ee.hasOwnProperty(Wt)?$t++:(Qe.push({command:fr.removeLayer,args:[Wt]}),qe.splice(qe.indexOf(Wt,$t),1));for(Mt=0,$t=0;Mt<it.length;Mt++)Wt=it[it.length-1-Mt],qe[qe.length-1-Mt]!==Wt&&(ft.hasOwnProperty(Wt)?(Qe.push({command:fr.removeLayer,args:[Wt]}),qe.splice(qe.lastIndexOf(Wt,qe.length-$t),1)):$t++,Zt=qe[qe.length-Mt],Qe.push({command:fr.addLayer,args:[Ee[Wt],Zt]}),qe.splice(qe.length-Mt,0,Wt),yt[Wt]=!0);for(Mt=0;Mt<it.length;Mt++)if(Wt=it[Mt],Ot=ft[Wt],on=Ee[Wt],!yt[Wt]&&!se(Ot,on))if(se(Ot.source,on.source)&&se(Ot["source-layer"],on["source-layer"])&&se(Ot.type,on.type)){for(cn in ci(Ot.layout,on.layout,Qe,Wt,null,fr.setLayoutProperty),ci(Ot.paint,on.paint,Qe,Wt,null,fr.setPaintProperty),se(Ot.filter,on.filter)||Qe.push({command:fr.setFilter,args:[Wt,on.filter]}),se(Ot.minzoom,on.minzoom)&&se(Ot.maxzoom,on.maxzoom)||Qe.push({command:fr.setLayerZoomRange,args:[Wt,on.minzoom,on.maxzoom]}),Ot)Ot.hasOwnProperty(cn)&&"layout"!==cn&&"paint"!==cn&&"filter"!==cn&&"metadata"!==cn&&"minzoom"!==cn&&"maxzoom"!==cn&&(0===cn.indexOf("paint.")?ci(Ot[cn],on[cn],Qe,Wt,cn.slice(6),fr.setPaintProperty):se(Ot[cn],on[cn])||Qe.push({command:fr.setLayerProperty,args:[Wt,cn,on[cn]]}));for(cn in on)on.hasOwnProperty(cn)&&!Ot.hasOwnProperty(cn)&&"layout"!==cn&&"paint"!==cn&&"filter"!==cn&&"metadata"!==cn&&"minzoom"!==cn&&"maxzoom"!==cn&&(0===cn.indexOf("paint.")?ci(Ot[cn],on[cn],Qe,Wt,cn.slice(6),fr.setPaintProperty):se(Ot[cn],on[cn])||Qe.push({command:fr.setLayerProperty,args:[Wt,cn,on[cn]]}))}else Qe.push({command:fr.removeLayer,args:[Wt]}),Zt=qe[qe.lastIndexOf(Wt)+1],Qe.push({command:fr.addLayer,args:[on,Zt]})}(J,b.layers,S)}catch(z){console.warn("Unable to compute style diff:",z),S=[{command:fr.setStyle,args:[b]}]}return S}(this.serialize(),r).filter(y=>!(y.command in xr));if(0===u.length)return!1;const m=u.filter(y=>!(y.command in zs));if(m.length>0)throw new Error(`Unimplemented: ${m.map(y=>y.command).join(", ")}.`);return u.forEach(y=>{"setTransition"!==y.command&&"setProjection"!==y.command&&this[y.command].apply(this,y.args)}),this.stylesheet=r,this._updateMapProjection(),!0}addImage(r,u){return this.getImage(r)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,u),this._afterImageUpdated(r),this)}updateImage(r,u){this.imageManager.updateImage(r,u)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r),this._afterImageUpdated(r),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(r,u,m={}){if(this._checkLoaded(),void 0!==this.getSource(r))throw new Error("There is already a source with this ID");if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(a.validateSource,`sources.${r}`,u,null,m))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const y=ni(r,u,this.dispatcher,this);y.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(r),source:y.serialize(),sourceId:r}));const b=S=>{const z=(S?"symbol:":"other:")+r,U=this._sourceCaches[z]=new a.SourceCache(z,y,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[r]=U,U.style=this,U.onAdd(this.map)};b(!1),"vector"!==u.type&&"geojson"!==u.type||b(!0),y.onAdd&&y.onAdd(this.map),this._changed=!0}removeSource(r){this._checkLoaded();const u=this.getSource(r);if(!u)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===r)return this.fire(new a.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.get().source===r)return this.fire(new a.ErrorEvent(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const m=this._getSourceCaches(r);for(const y of m)delete this._sourceCaches[y.id],delete this._updatedSources[y.id],y.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles();return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(r,u){this._checkLoaded(),this.getSource(r).setData(u),this._changed=!0}getSource(r){const u=this._getSourceCache(r);return u&&u.getSource()}_getSources(){const r=[];for(const u in this._otherSourceCaches){const m=this._getSourceCache(u);m&&r.push(m.getSource())}return r}addLayer(r,u,m={}){this._checkLoaded();const y=r.id;if(this.getLayer(y))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${y}" already exists on this map`)));let b;if("custom"===r.type){if(vo(this,a.validateCustomStyleLayer(r)))return;b=a.createStyleLayer(r)}else{if("object"==typeof r.source&&(this.addSource(y,r.source),r=a.clone$1(r),r=a.extend(r,{source:y})),this._validate(a.validateLayer,`layers.${y}`,r,{arrayIndex:-1},m))return;b=a.createStyleLayer(r),this._validateLayer(b),b.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}const S=u?this._order.indexOf(u):this._order.length;if(u&&-1===S)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`)));this._order.splice(S,0,y),this._layerOrderChanged=!0,this._layers[y]=b;const z=this._getLayerSourceCache(b);if(this._removedLayers[y]&&b.source&&z&&"custom"!==b.type){const U=this._removedLayers[y];delete this._removedLayers[y],U.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",z.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(r,u){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===u)return;const m=this._order.indexOf(r);this._order.splice(m,1);const y=u?this._order.indexOf(u):this._order.length;u&&-1===y?this.fire(new a.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`))):(this._order.splice(y,0,r),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(r){this._checkLoaded();const u=this._layers[r];if(!u)return void this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be removed.`)));u.setEventedParent(null),this._updateLayerCount(u,!1);const m=this._order.indexOf(r);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=u,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],u.onRemove&&u.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}hasLayerType(r){for(const u in this._layers)if(this._layers[u].type===r)return!0;return!1}setLayerZoomRange(r,u,m){this._checkLoaded();const y=this.getLayer(r);y?y.minzoom===u&&y.maxzoom===m||(null!=u&&(y.minzoom=u),null!=m&&(y.maxzoom=m),this._updateLayer(y)):this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,u,m={}){this._checkLoaded();const y=this.getLayer(r);if(y){if(!se(y.filter,u))return null==u?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(a.validateFilter,`layers.${y.id}.filter`,u,{layerType:y.type},m)||(y.filter=a.clone$1(u),this._updateLayer(y)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(r){const u=this.getLayer(r);return u&&a.clone$1(u.filter)}setLayoutProperty(r,u,m,y={}){this._checkLoaded();const b=this.getLayer(r);b?se(b.getLayoutProperty(u),m)||(b.setLayoutProperty(u,m,y),this._updateLayer(b)):this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(r,u){const m=this.getLayer(r);if(m)return m.getLayoutProperty(u);this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style.`)))}setPaintProperty(r,u,m,y={}){this._checkLoaded();const b=this.getLayer(r);b?se(b.getPaintProperty(u),m)||(b.setPaintProperty(u,m,y)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(r,u){const m=this.getLayer(r);return m&&m.getPaintProperty(u)}setFeatureState(r,u){this._checkLoaded();const m=r.source,y=r.sourceLayer,b=this.getSource(m);if(!b)return void this.fire(new a.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const S=b.type;if("geojson"===S&&y)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===S&&!y)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===r.id&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const z=this._getSourceCaches(m);for(const U of z)U.setFeatureState(y,r.id,u)}removeFeatureState(r,u){this._checkLoaded();const m=r.source,y=this.getSource(m);if(!y)return void this.fire(new a.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const b=y.type,S="vector"===b?r.sourceLayer:void 0;if("vector"===b&&!S)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&"string"!=typeof r.id&&"number"!=typeof r.id)return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const z=this._getSourceCaches(m);for(const U of z)U.removeFeatureState(S,r.id,u)}getFeatureState(r){this._checkLoaded();const u=r.source,m=r.sourceLayer,y=this.getSource(u);if(y){if("vector"!==y.type||m)return void 0===r.id&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(u)[0].getFeatureState(m,r.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const r={};for(const u in this._sourceCaches){const m=this._sourceCaches[u].getSource();r[m.id]||(r[m.id]=m.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:r,layers:this._serializeLayers(this._order)},u=>void 0!==u)}_updateLayer(r){this._updatedLayers[r.id]=!0;const u=this._getLayerSourceCache(r);r.source&&!this._updatedSources[r.source]&&u&&"raster"!==u.getSource().type&&(this._updatedSources[r.source]="reload",u.pause()),this._changed=!0,r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const u=S=>"fill-extrusion"===this._layers[S].type,m={},y=[];for(let S=this._order.length-1;S>=0;S--){const z=this._order[S];if(u(z)){m[z]=S;for(const U of r){const J=U[z];if(J)for(const Q of J)y.push(Q)}}}y.sort((S,z)=>z.intersectionZ-S.intersectionZ);const b=[];for(let S=this._order.length-1;S>=0;S--){const z=this._order[S];if(u(z))for(let U=y.length-1;U>=0;U--){const J=y[U].feature;if(m[J.layer.id]<S)break;b.push(J),y.pop()}else for(const U of r){const J=U[z];if(J)for(const Q of J)b.push(Q.feature)}}return b}queryRenderedFeatures(r,u,m){u&&u.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",u.filter,null,u);const y={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const U of u.layers){const J=this._layers[U];if(!J)return this.fire(new a.ErrorEvent(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];y[J.source]=!0}}const b=[];u.availableImages=this._availableImages;const S=u&&u.layers?u.layers.some(U=>{const J=this.getLayer(U);return J&&J.is3D()}):this.has3DLayers(),z=Wn.createFromScreenPoints(r,m);for(const U in this._sourceCaches){const J=this._sourceCaches[U].getSource().id;u.layers&&!y[J]||b.push(sr(this._sourceCaches[U],this._layers,this._serializedLayers,z,u,m,S,!!this.map._showQueryGeometry))}return this.placement&&b.push(function(U,J,Q,we,Ye,Qe,ut){const it={},ft=Qe.queryRenderedSymbols(we),Ee=[];for(const qe of Object.keys(ft).map(Number))Ee.push(ut[qe]);Ee.sort(Jr);for(const qe of Ee){const yt=qe.featureIndex.lookupSymbolFeatures(ft[qe.bucketInstanceId],J,qe.bucketIndex,qe.sourceLayerIndex,Ye.filter,Ye.layers,Ye.availableImages,U);for(const Mt in yt){const $t=it[Mt]=it[Mt]||[],Wt=yt[Mt];Wt.sort((Ot,on)=>{const Zt=qe.featureSortOrder;if(Zt){const cn=Zt.indexOf(Ot.featureIndex);return Zt.indexOf(on.featureIndex)-cn}return on.featureIndex-Ot.featureIndex});for(const Ot of Wt)$t.push(Ot)}}for(const qe in it)it[qe].forEach(yt=>{const Mt=yt.feature,$t=Q(U[qe]);if(!$t)return;const Wt=$t.getFeatureState(Mt.layer["source-layer"],Mt.id);Mt.source=Mt.layer.source,Mt.layer["source-layer"]&&(Mt.sourceLayer=Mt.layer["source-layer"]),Mt.state=Wt});return it}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),z.screenGeometry,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(r,u){u&&u.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",u.filter,null,u);const m=this._getSourceCaches(r);let y=[];for(const b of m)y=y.concat(Cr(b,u));return y}addSourceType(r,u,m){return ls.getSourceType(r)?m(new Error(`A source type called "${r}" already exists.`)):(ls.setSourceType(r,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:u.workerSourceURL},m):m(null,null))}getLight(){return this.light.getLight()}setLight(r,u={}){this._checkLoaded();const m=this.light.getLight();let y=!1;for(const S in r)if(!se(r[S],m[S])){y=!0;break}if(!y)return;const b=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(r,u),this.light.updateTransitions(b)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(r,u=1){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let m=r;if(1===u){if("object"==typeof m.source){const y="terrain-dem-src";this.addSource(y,m.source),m=a.clone$1(m),m=a.extend(m,{source:y})}if(this._validate(a.validateTerrain,"terrain",m))return}if(!this.terrain||this.terrain&&u!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,u)}else{const y=this.terrain,b=y.get();for(const S of Object.keys(a.spec.terrain))!m.hasOwnProperty(S)&&a.spec.terrain[S].default&&(m[S]=a.spec.terrain[S].default);for(const S in m)if(!se(m[S],b[S])){y.set(m),this.stylesheet.terrain=m;const z=this._setTransitionParameters({duration:0});y.updateTransitions(z);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const u=this.fog=new Un(r,this.map.transform);this.stylesheet.fog=r;const m=this._setTransitionParameters({duration:0});u.updateTransitions(m)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog,m=u.get();0===Object.keys(r).length&&u.set(r);for(const y in r)if(!se(r[y],m[y])){u.set(r),this.stylesheet.fog=r;const b=this._setTransitionParameters({duration:0});u.updateTransitions(b);break}}else this._createFog(r);this._markersNeedUpdate=!0}_setTransitionParameters(r){return{now:a.exported.now(),transition:a.extend(r,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const r=this._order.filter(m=>this.isLayerDraped(this._layers[m])),u=this._order.filter(m=>!this.isLayerDraped(this._layers[m]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...u)}_createTerrain(r,u){const m=this.terrain=new St(r,u);this.stylesheet.terrain=r,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const y=this._setTransitionParameters({duration:0});m.updateTransitions(y)}_force3DLayerUpdate(){for(const r in this._layers){const u=this._layers[r];"fill-extrusion"===u.type&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const u=this._layers[r];"symbol"===u.type&&this._updateLayer(u)}}_validate(r,u,m,y,b={}){return(!b||!1!==b.validate)&&vo(this,r.call(a.validateStyle,a.extend({key:u,style:this.serialize(),value:m,styleSpec:a.spec},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){const u=this._getSourceCaches(r);for(const m of u)m.clearTiles()}_reloadSource(r){const u=this._getSourceCaches(r);for(const m of u)m.resume(),m.reload()}_reloadSources(){for(const r of this._getSources())r.reload&&r.reload()}_updateSources(r){for(const u in this._sourceCaches)this._sourceCaches[u].update(r)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const u=this._sourceCaches[r];u.resume(),u.reload()}}_updatePlacement(r,u,m,y,b=!1){let S=!1,z=!1;const U={};for(const J of this._order){const Q=this._layers[J];if("symbol"!==Q.type)continue;if(!U[Q.source]){const Ye=this._getLayerSourceCache(Q);if(!Ye)continue;U[Q.source]=Ye.getRenderableIds(!0).map(Qe=>Ye.getTileByID(Qe)).sort((Qe,ut)=>ut.tileID.overscaledZ-Qe.tileID.overscaledZ||(Qe.tileID.isLessThan(ut.tileID)?-1:1))}const we=this.crossTileSymbolIndex.addLayer(Q,U[Q.source],r.center.lng,r.projection);S=S||we}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),b=b||this._layerOrderChanged||0===m,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(b||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),r.zoom))&&(this.pauseablePlacement=new Da(r,this._order,b,u,m,y,this.placement,this.fog&&r.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),z=!0),S&&this.pauseablePlacement.placement.setStale()),z||S)for(const J of this._order){const Q=this._layers[J];"symbol"===Q.type&&this.placement.updateLayerOpacities(Q,U[Q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,u,m){this.imageManager.getImages(u.icons,m),this._updateTilesForChangedImages();const y=b=>{b&&b.setDependencies(u.tileID.key,u.type,u.icons)};y(this._otherSourceCaches[u.source]),y(this._symbolSourceCaches[u.source])}getGlyphs(r,u,m){this.glyphManager.getGlyphs(u.stacks,m)}getResource(r,u,m){return a.makeRequest(u,m)}_getSourceCache(r){return this._otherSourceCaches[r]}_getLayerSourceCache(r){return"symbol"===r.type?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}_getSourceCaches(r){const u=[];return this._otherSourceCaches[r]&&u.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&u.push(this._symbolSourceCaches[r]),u}_isSourceCacheLoaded(r){const u=this._getSourceCaches(r);return 0===u.length?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${r}'`))),!1):u.every(m=>m.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ls.getSourceType=function(d){return Cn[d]},ls.setSourceType=function(d,r){Cn[d]=r},ls.registerForPluginStateChange=a.registerForPluginStateChange;var _a="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",Xs="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",la="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Is="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Xo="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Ka={},Qs={};const Sa=[];ya(_a,Sa),ya(la,Sa),ya(Is,Sa),ya(Xo,Sa),Ka=br("",la),Qs=br(Xo,Is);const ca=br("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),qa=_a,Go="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var rs={background:br("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:br("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:br("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:br("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:br("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:br("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:br("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:br("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:br("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:br("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:br("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:br("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:br("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:br("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:br("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:br("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:br("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:br("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:br("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:br("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:br("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:br("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:br("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:br("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:br("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:br("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Xs),skyboxGradient:br("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Xs),skyboxCapture:br("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:br("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:br("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function ya(d,r){const u=d.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let m of u)if(m=m.trim(),"#"===m[0]&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const y=m.split(" ");for(const b of y)r.includes(b)||r.push(b)}}function br(d,r){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=r.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),y={},b=[...Sa];return ya(d,b),ya(r,b),{fragmentSource:d=d.replace(u,(S,z,U,J,Q)=>(y[Q]=!0,"define"===z?`\n#ifndef HAS_UNIFORM_u_${Q}\nvarying ${U} ${J} ${Q};\n#else\nuniform ${U} ${J} u_${Q};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${Q}\n    ${U} ${J} ${Q} = u_${Q};\n#endif\n`)),vertexSource:r=r.replace(u,(S,z,U,J,Q)=>{const we="float"===J?"vec2":"vec4",Ye=Q.match(/color/)?"color":we;return y[Q]?"define"===z?`\n#ifndef HAS_UNIFORM_u_${Q}\nuniform lowp float u_${Q}_t;\nattribute ${U} ${we} a_${Q};\nvarying ${U} ${J} ${Q};\n#else\nuniform ${U} ${J} u_${Q};\n#endif\n`:"vec4"===Ye?`\n#ifndef HAS_UNIFORM_u_${Q}\n    ${Q} = a_${Q};\n#else\n    ${U} ${J} ${Q} = u_${Q};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${Q}\n    ${Q} = unpack_mix_${Ye}(a_${Q}, u_${Q}_t);\n#else\n    ${U} ${J} ${Q} = u_${Q};\n#endif\n`:"define"===z?`\n#ifndef HAS_UNIFORM_u_${Q}\nuniform lowp float u_${Q}_t;\nattribute ${U} ${we} a_${Q};\n#else\nuniform ${U} ${J} u_${Q};\n#endif\n`:"vec4"===Ye?`\n#ifndef HAS_UNIFORM_u_${Q}\n    ${U} ${J} ${Q} = a_${Q};\n#else\n    ${U} ${J} ${Q} = u_${Q};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${Q}\n    ${U} ${J} ${Q} = unpack_mix_${Ye}(a_${Q}, u_${Q}_t);\n#else\n    ${U} ${J} ${Q} = u_${Q};\n#endif\n`}),staticAttributes:m,usedDefines:b}}class Fa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,u,m,y,b,S,z){this.context=r;let U=this.boundPaintVertexBuffers.length!==y.length;for(let Q=0;!U&&Q<y.length;Q++)this.boundPaintVertexBuffers[Q]!==y[Q]&&(U=!0);let J=this.boundDynamicVertexBuffers.length!==z.length;for(let Q=0;!J&&Q<z.length;Q++)this.boundDynamicVertexBuffers[Q]!==z[Q]&&(J=!0);if(!r.extVertexArrayObject||!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==m||U||J||this.boundIndexBuffer!==b||this.boundVertexOffset!==S)this.freshBind(u,m,y,b,S,z);else{r.bindVertexArrayOES.set(this.vao);for(const Q of z)Q&&Q.bind();b&&b.dynamicDraw&&b.bind()}}freshBind(r,u,m,y,b,S){let z;const U=r.numAttributes,J=this.context,Q=J.gl;if(J.extVertexArrayObject)this.vao&&this.destroy(),this.vao=J.extVertexArrayObject.createVertexArrayOES(),J.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=r,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=y,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=S;else{z=J.currentNumAttributes||0;for(let we=U;we<z;we++)Q.disableVertexAttribArray(we)}u.enableAttributes(Q,r),u.bind(),u.setVertexAttribPointers(Q,r,b);for(const we of m)we.enableAttributes(Q,r),we.bind(),we.setVertexAttribPointers(Q,r,b);for(const we of S)we&&(we.enableAttributes(Q,r),we.bind(),we.setVertexAttribPointers(Q,r,b));y&&y.bind(),J.currentNumAttributes=U}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Za(d,r){const u=Math.pow(2,r.canonical.z),m=r.canonical.y;return[new a.MercatorCoordinate(0,m/u).toLngLat().lat,new a.MercatorCoordinate(0,(m+1)/u).toLngLat().lat]}function Xa(d,r,u,m,y,b,S){const z=d.context,U=z.gl,J=u.fbo;if(!J)return;d.prepareDrawTile();const Q=d.useProgram("hillshade");z.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,J.colorAttachment.get());const we=((it,ft,Ee,qe)=>{const yt=Ee.paint.get("hillshade-shadow-color"),Mt=Ee.paint.get("hillshade-highlight-color"),$t=Ee.paint.get("hillshade-accent-color");let Wt=Ee.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Ee.paint.get("hillshade-illumination-anchor")&&(Wt-=it.transform.angle);const Ot=!it.options.moving;return{u_matrix:qe||it.transform.calculateProjMatrix(ft.tileID.toUnwrapped(),Ot),u_image:0,u_latrange:Za(0,ft.tileID),u_light:[Ee.paint.get("hillshade-exaggeration"),Wt],u_shadow:yt,u_highlight:Mt,u_accent:$t}})(d,u,m,d.terrain?r.projMatrix:null);d.prepareDrawProgram(z,Q,r.toUnwrapped());const{tileBoundsBuffer:Ye,tileBoundsIndexBuffer:Qe,tileBoundsSegments:ut}=d.getTileBoundsBuffers(u);Q.draw(z,U.TRIANGLES,y,b,S,a.CullFaceMode.disabled,we,m.id,Ye,Qe,ut)}function Ts(d,r,u){if(!r.needsDEMTextureUpload)return;const m=d.context,y=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||d.getTileTexture(u.stride);const b=u.getPixels();r.demTexture?r.demTexture.update(b,{premultiply:!1}):r.demTexture=new a.Texture(m,b,y.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function Na(d,r,u,m,y,b){const S=d.context,z=S.gl;if(!r.dem)return;const U=r.dem;if(S.activeTexture.set(z.TEXTURE1),Ts(d,r,U),!r.demTexture)return;r.demTexture.bind(z.NEAREST,z.CLAMP_TO_EDGE);const J=U.dim;S.activeTexture.set(z.TEXTURE0);let Q=r.fbo;if(!Q){const ut=new a.Texture(S,{width:J,height:J,data:null},z.RGBA);ut.bind(z.LINEAR,z.CLAMP_TO_EDGE),Q=r.fbo=S.createFramebuffer(J,J,!0),Q.colorAttachment.set(ut.texture)}S.bindFramebuffer.set(Q.framebuffer),S.viewport.set([0,0,J,J]);const{tileBoundsBuffer:we,tileBoundsIndexBuffer:Ye,tileBoundsSegments:Qe}=d.getMercatorTileBoundsBuffers();d.useProgram("hillshadePrepare").draw(S,z.TRIANGLES,m,y,b,a.CullFaceMode.disabled,((ut,it)=>{const ft=it.stride,Ee=a.create();return a.ortho(Ee,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(Ee,Ee,[0,-a.EXTENT,0]),{u_matrix:Ee,u_image:1,u_dimension:[ft,ft],u_zoom:ut.overscaledZ,u_unpack:it.unpackVector}})(r.tileID,U),u.id,we,Ye,Qe),r.needsHillshadePrepare=!1}const Lo=d=>({u_matrix:new a.UniformMatrix4f(d),u_image0:new a.Uniform1i(d),u_skirt_height:new a.Uniform1f(d)}),ks=(d,r)=>({u_matrix:d,u_image0:0,u_skirt_height:r}),ys=(d,r,u,m,y,b,S,z,U,J,Q,we,Ye,Qe,ut)=>({u_proj_matrix:Float32Array.from(d),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:u,u_zoom_transition:y,u_merc_center:b,u_image0:0,u_frustum_tl:S,u_frustum_tr:z,u_frustum_br:U,u_frustum_bl:J,u_globe_pos:Q,u_globe_radius:we,u_viewport:Ye,u_grid_matrix:ut?Float32Array.from(ut):new Float32Array(9),u_skirt_height:Qe});function xs(d,r){return null!=d&&null!=r&&!(!d.hasData()||!r.hasData())&&null!=d.demTexture&&null!=r.demTexture&&d.tileID.key!==r.tileID.key}const hs=new class{constructor(){this.operations={}}newMorphing(d,r,u,m,y){if(d in this.operations){const b=this.operations[d];b.to.tileID.key!==u.tileID.key&&(b.queued=u)}else this.operations[d]={startTime:m,phase:0,duration:y,from:r,to:u,queued:null}}getMorphValuesForProxy(d){if(!(d in this.operations))return null;const r=this.operations[d];return{from:r.from,to:r.to,phase:r.phase}}update(d){for(const r in this.operations){const u=this.operations[r];for(u.phase=(d-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,d)){delete this.operations[r];break}}}_nextOp(d,r){return!!d.queued&&(d.from=d.to,d.to=d.queued,d.queued=null,d.phase=0,d.startTime=r,!0)}_validOp(d){return d.from.hasData()&&d.to.hasData()}},Eo={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Kr(d){return 6*Math.pow(1.5,22-d)}function Bs(d,r){const u=1<<d.z;return!r&&(0===d.x||d.x===u-1)||0===d.y||d.y===u-1}const Aa=d=>({u_matrix:d});function Va(d,r,u,m,y){if(y>0){const b=a.exported.now(),S=(b-d.timeAdded)/y,z=r?(b-r.timeAdded)/y:-1,U=u.getSource(),J=m.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),Q=!r||Math.abs(r.tileID.overscaledZ-J)>Math.abs(d.tileID.overscaledZ-J),we=Q&&d.refreshedUponExpiration?1:a.clamp(Q?S:1-z,0,1);return d.refreshedUponExpiration&&S>=1&&(d.refreshedUponExpiration=!1),r?{opacity:1,mix:1-we}:{opacity:we,mix:0}}return{opacity:1,mix:0}}class Js extends a.SourceCache{constructor(r){const u={type:"raster-dem",maxzoom:r.transform.maxZoom},m=new nn(Or(),null),y=ni("mock-dem",u,m,r.style);super("mock-dem",y,!1),y.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,u){r.state="loaded",u(null)}}class Hs extends a.SourceCache{constructor(r){const u=ni("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new nn(Or(),null),r.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,u,m){if(r.freezeTileCoverage)return;this.transform=r;const y=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,S)=>{if(b[S.key]="",!this._tiles[S.key]){const z=new a.Tile(S,this._source.tileSize*S.overscaleFactor(),r.tileZoom);z.state="loaded",this._tiles[S.key]=z}return b},{});for(const b in this._tiles)b in y||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(r){const u=this.proxyCachedFBO[r];if(void 0!==u){const m=Object.values(u);this.renderCachePool.push(...m),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ko extends a.OverscaledTileID{constructor(r,u,m){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=u,this.projMatrix=m}}class Wo extends a.Elevation{constructor(r,u){super(),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,y,b]=function(U){const J=new a.StructArrayLayout2i4,Q=new a.StructArrayLayout3ui6;J.reserve(17161),Q.reserve(33800);const Ye=a.EXTENT/128,Qe=a.EXTENT+Ye/2,ut=Qe+Ye;for(let ft=-Ye;ft<ut;ft+=Ye)for(let Ee=-Ye;Ee<ut;Ee+=Ye){const qe=Ee<0||Ee>Qe||ft<0||ft>Qe?24575:0,yt=a.clamp(Math.round(Ee),0,a.EXTENT),Mt=a.clamp(Math.round(ft),0,a.EXTENT);J.emplaceBack(yt+qe,Mt)}const it=(ft,Ee)=>{const qe=131*Ee+ft;Q.emplaceBack(qe+1,qe,qe+131),Q.emplaceBack(qe+131,qe+131+1,qe+1)};for(let ft=1;ft<129;ft++)for(let Ee=1;Ee<129;Ee++)it(Ee,ft);return[0,129].forEach(ft=>{for(let Ee=0;Ee<130;Ee++)it(Ee,ft),it(ft,Ee)}),[J,Q,32768]}(),S=r.context;this.gridBuffer=S.createVertexBuffer(m,a.posAttributes.members),this.gridIndexBuffer=S.createIndexBuffer(y),this.gridSegments=a.SegmentVector.simpleSegment(0,0,m.length,y.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,m.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Hs(u.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,a.EXTENT,0,a.EXTENT,0,1);const z=S.gl;this._overlapStencilMode=new a.StencilMode({func:z.GEQUAL,mask:255},0,255,z.KEEP,z.KEEP,z.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Js(u.map)}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),r.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=r,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,u,m){if(r&&r.terrain){this._style!==r&&(this.style=r),this.enabled=!0;const y=r.terrain.properties;this.sourceCache=0===r.terrain.drapeRenderMode?this._mockSourceCache:r._getSourceCache(y.get("source")),this._exaggeration=y.get("exaggeration");const b=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const S=this.getScaledDemTileSize();this.sourceCache.update(u,S,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,b(),this._initializing=!0),b(),u.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const r=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==r.efficiency&&a.warnOnce(`Terrain render cache efficiency is not optimal (${r.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${r.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(r){r.coord&&"source"===r.dataType?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):"style"===r.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._sourceCaches)this._style._sourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=0===m._centerAltitude&&-1===this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(m.center),-1),this._emptyDEMTextureDirty=!this._initializing);const y=this.proxyCoords=u.getIds().map(U=>{const J=u.getTileByID(U).tileID;return J.projMatrix=m.calculateProjMatrix(J.toUnwrapped()),J});(function(U,J){const Q=J.transform.pointCoordinate(J.transform.getCameraPoint()),we=new a.Point(Q.x,Q.y);U.sort((Ye,Qe)=>{if(Qe.overscaledZ-Ye.overscaledZ)return Qe.overscaledZ-Ye.overscaledZ;const ut=new a.Point(Ye.canonical.x+(1<<Ye.canonical.z)*Ye.wrap,Ye.canonical.y),it=new a.Point(Qe.canonical.x+(1<<Qe.canonical.z)*Qe.wrap,Qe.canonical.y),ft=we.mult(1<<Ye.canonical.z);return ft.x-=.5,ft.y-=.5,ft.distSqr(ut)-ft.distSqr(it)})})(y,this.painter),this._previousZoom=m.zoom;const b=this.proxyToSource||{};this.proxyToSource={},y.forEach(U=>{this.proxyToSource[U.key]={}}),this.terrainTileForTile={};const S=this._style._sourceCaches;for(const U in S){const J=S[U];if(!J.used||(J!==this.sourceCache&&this.resetTileLookupCache(J.id),this._setupProxiedCoordsForOrtho(J,r[U],b),J.usedForTerrain))continue;const Q=r[U];J.getSource().reparseOverscaled&&this._assignTerrainTiles(Q)}this.proxiedCoords[u.id]=y.map(U=>new ko(U,U.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const z={};this._visibleDemTiles=[];for(const U of this.proxyCoords){const J=this.terrainTileForTile[U.key];if(!J)continue;const Q=J.tileID.key;Q in z||(this._visibleDemTiles.push(J),z[Q]=Q)}}_assignTerrainTiles(r){this._initializing||r.forEach(u=>{if(this.terrainTileForTile[u.key])return;const m=this._findTileCoveringTileID(u,this.sourceCache);m&&(this.terrainTileForTile[u.key]=m)})}_prepareDEMTextures(){const r=this.painter.context,u=r.gl;for(const m in this.terrainTileForTile){const y=this.terrainTileForTile[m],b=y.dem;!b||y.demTexture&&!y.needsDEMTextureUpload||(r.activeTexture.set(u.TEXTURE1),Ts(this.painter,y,b))}}_prepareDemTileUniforms(r,u,m,y){if(!u||null==u.demTexture)return!1;const b=r.tileID.canonical,S=Math.pow(2,u.tileID.canonical.z-b.z),z=y||"";return m[`u_dem_tl${z}`]=[b.x*S%1,b.y*S%1],m[`u_dem_scale${z}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const r=this.painter.context,u=r.gl;if(!this._emptyDepthBufferTexture){const m=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(r,m,u.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let r=0;const u=this._visibleDemTiles.reduce((m,y)=>{if(!y.dem)return m;const b=y.dem.tree.minimums[0];return b>0&&r++,m+b},0);return r?u/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,u=r.gl;r.activeTexture.set(u.TEXTURE2);const m=this._getLoadedAreaMinimum(),y=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(m,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(y,{premultiply:!1}):b=this._emptyDEMTexture=new a.Texture(r,y,u.RGBA,{premultiply:!1}),b}setupElevationDraw(r,u,m){const y=this.painter.context,b=y.gl,S=(z=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(z),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var z;S.u_dem_size=this.sourceCache.getSource().tileSize,S.u_exaggeration=this.exaggeration();let U=null,J=null,Q=1;if(m&&m.morphing&&this._useVertexMorphing){const we=m.morphing.srcDemTile,Ye=m.morphing.dstDemTile;Q=m.morphing.phase,we&&Ye&&(this._prepareDemTileUniforms(r,we,S,"_prev")&&(J=we),this._prepareDemTileUniforms(r,Ye,S)&&(U=Ye))}if(J&&U?(y.activeTexture.set(b.TEXTURE2),U.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),y.activeTexture.set(b.TEXTURE4),J.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),S.u_dem_lerp=Q):(U=this.terrainTileForTile[r.tileID.key],y.activeTexture.set(b.TEXTURE2),(this._prepareDemTileUniforms(r,U,S)?U.demTexture:this.emptyDEMTexture).bind(b.NEAREST,b.CLAMP_TO_EDGE)),y.activeTexture.set(b.TEXTURE3),m&&m.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),this._depthFBO&&(S.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),S.u_depth_size_inv=[1,1]),m&&m.useMeterToDem&&U){const we=(1<<U.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=we}if(m&&m.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),u.setTerrainUniformValues(y,S),"globe"===this.painter.transform.projection.name){const we=this.globeUniformValues(this.painter.transform,r.tileID.canonical,m&&m.useDenormalizedUpVectorScale);u.setGlobeUniformValues(y,we)}}globeUniformValues(r,u,m){const y=r.projection;return{u_tile_tl_up:y.upVector(u,0,0),u_tile_tr_up:y.upVector(u,a.EXTENT,0),u_tile_br_up:y.upVector(u,a.EXTENT,a.EXTENT),u_tile_bl_up:y.upVector(u,0,a.EXTENT),u_tile_up_scale:m?a.globeMetersToEcef(1):y.upVectorScale(u,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const u=this.painter,m=this.painter.context;0!==r.length&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(y,b,S,z,U){if("globe"===y.transform.projection.name)!function(J,Q,we,Ye,Qe){const ut=J.context,it=ut.gl;let ft,Ee;const qe=J.options.showTerrainWireframe?2:0,yt=J.transform,Mt=a.globeUseCustomAntiAliasing(J,ut,yt),$t=(ai,vn)=>{if(Ee===ai)return;const Hn=[Eo[ai],"PROJECTION_GLOBE_VIEW"];Mt&&Hn.push("CUSTOM_ANTIALIASING"),vn&&Hn.push(Eo[qe]),ft=J.useProgram("globeRaster",null,Hn),Ee=ai},Wt=J.colorModeForRenderPass(),Ot=new a.DepthMode(it.LEQUAL,a.DepthMode.ReadWrite,J.depthRangeFor3D);hs.update(Qe);const on=a.calculateGlobeMercatorMatrix(yt),Zt=[a.mercatorXfromLng(yt.center.lng),a.mercatorYfromLat(yt.center.lat)],cn=qe?[!1,!0]:[!1],li=J.globeSharedBuffers,fn=[yt.width*a.exported.devicePixelRatio,yt.height*a.exported.devicePixelRatio],Fn=Float32Array.from(yt.globeMatrix),gn={useDenormalizedUpVectorScale:!0};if(cn.forEach(ai=>{const vn=J.transform,Hn=Kr(vn.zoom)*Q.exaggeration();Ee=-1;const ri=ai?it.LINES:it.TRIANGLES;for(const Qn of Ye){const fi=we.getTile(Qn),tr=a.StencilMode.disabled,wr=Q.prevTerrainTileForTile[Qn.key],Vi=Q.terrainTileForTile[Qn.key];xs(wr,Vi)&&hs.newMorphing(Qn.key,wr,Vi,Qe,250),ut.activeTexture.set(it.TEXTURE0),fi.texture.bind(it.LINEAR,it.CLAMP_TO_EDGE);const or=hs.getMorphValuesForProxy(Qn.key),Ur=or?1:0;or&&a.extend$1(gn,{morphing:{srcDemTile:or.from,dstDemTile:or.to,phase:a.easeCubicInOut(or.phase)}});const Zr=a.tileCornersToBounds(Qn.canonical),Qi=a.getLatitudinalLod(Zr.getCenter().lat),Wi=a.getGridMatrix(Qn.canonical,Zr,Qi,vn.worldSize/vn._pixelsPerMercatorPixel),Vo=a.globeNormalizeECEF(a.globeTileBounds(Qn.canonical)),es=ys(vn.projMatrix,Fn,on,Vo,a.globeToMercatorTransition(vn.zoom),Zt,vn.frustumCorners.TL,vn.frustumCorners.TR,vn.frustumCorners.BR,vn.frustumCorners.BL,vn.globeCenterInViewSpace,vn.globeRadius,fn,Hn,Wi);if($t(Ur,ai),Q.setupElevationDraw(fi,ft,gn),J.prepareDrawProgram(ut,ft,Qn.toUnwrapped()),li){const[Co,Ya,Ma]=ai?li.getWirefameBuffers(J.context,Qi):li.getGridBuffers(Qi,0!==Hn);ft.draw(ut,ri,Ot,tr,Wt,a.CullFaceMode.backCCW,es,"globe_raster",Co,Ya,Ma)}}}),li){const ai=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Mt&&ai.push("CUSTOM_ANTIALIASING"),ft=J.useProgram("globeRaster",null,ai);for(const vn of Ye){const{x:Hn,y:ri,z:Qn}=vn.canonical,fi=0===ri,tr=ri===(1<<Qn)-1,[wr,Vi,or,Ur]=li.getPoleBuffers(Qn);if(Ur&&(fi||tr)){const Zr=we.getTile(vn);ut.activeTexture.set(it.TEXTURE0),Zr.texture.bind(it.LINEAR,it.CLAMP_TO_EDGE);let Qi=a.globePoleMatrixForTile(Qn,Hn,yt);const Wi=a.globeNormalizeECEF(a.globeTileBounds(vn.canonical)),Vo=(es,Co)=>es.draw(ut,it.TRIANGLES,Ot,a.StencilMode.disabled,Wt,a.CullFaceMode.disabled,ys(yt.projMatrix,Qi,Qi,Wi,0,Zt,yt.frustumCorners.TL,yt.frustumCorners.TR,yt.frustumCorners.BR,yt.frustumCorners.BL,yt.globeCenterInViewSpace,yt.globeRadius,fn,0),"globe_pole_raster",Co,or,Ur);Q.setupElevationDraw(Zr,ft,gn),J.prepareDrawProgram(ut,ft,vn.toUnwrapped()),fi&&Vo(ft,wr),tr&&(Qi=a.scale(a.create(),Qi,[1,-1,1]),Vo(ft,Vi))}}}}(y,b,S,z,U);else{const J=y.context,Q=J.gl;let we,Ye;const Qe=y.options.showTerrainWireframe?2:0,ut=(yt,Mt)=>{if(Ye===yt)return;const $t=[Eo[yt]];Mt&&$t.push(Eo[Qe]),we=y.useProgram("terrainRaster",null,$t),Ye=yt},it=y.colorModeForRenderPass(),ft=new a.DepthMode(Q.LEQUAL,a.DepthMode.ReadWrite,y.depthRangeFor3D);hs.update(U);const Ee=y.transform,qe=Kr(Ee.zoom)*b.exaggeration();(Qe?[!1,!0]:[!1]).forEach(yt=>{Ye=-1;const Mt=yt?Q.LINES:Q.TRIANGLES,[$t,Wt]=yt?b.getWirefameBuffer():[b.gridIndexBuffer,b.gridSegments];for(const Ot of z){const on=S.getTile(Ot),Zt=a.StencilMode.disabled,cn=b.prevTerrainTileForTile[Ot.key],li=b.terrainTileForTile[Ot.key];xs(cn,li)&&hs.newMorphing(Ot.key,cn,li,U,250),J.activeTexture.set(Q.TEXTURE0),on.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE,Q.LINEAR_MIPMAP_NEAREST);const fn=hs.getMorphValuesForProxy(Ot.key),Fn=fn?1:0;let gn;fn&&(gn={morphing:{srcDemTile:fn.from,dstDemTile:fn.to,phase:a.easeCubicInOut(fn.phase)}});const ai=ks(Ot.projMatrix,Bs(Ot.canonical,Ee.renderWorldCopies)?qe/10:qe);ut(Fn,yt),b.setupElevationDraw(on,we,gn),y.prepareDrawProgram(J,we,Ot.toUnwrapped()),we.draw(J,Mt,ft,Zt,it,a.CullFaceMode.backCCW,ai,"terrain_raster",b.gridBuffer,$t,Wt)}})}}(u,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(0===this._drapedRenderBatches.length)return r+1;this.renderingToTexture=!0;const u=this.painter,m=this.painter.context,y=this.proxySourceCache,b=this.proxiedCoords[y.id],S=this._drapedRenderBatches.shift(),z=[],U=u.style.order;let J=0;for(const Q of b){const we=y.getTileByID(Q.proxyTileKey),Ye=y.proxyCachedFBO[Q.key]?y.proxyCachedFBO[Q.key][r]:void 0,Qe=void 0!==Ye?y.renderCache[Ye]:this.pool[J++],ut=void 0!==Ye;if(we.texture=Qe.tex,ut&&!Qe.dirty){z.push(we.tileID);continue}let it;m.bindFramebuffer.set(Qe.fb.framebuffer),this.renderedToTile=!1,Qe.dirty&&(m.clear({color:a.Color.transparent,stencil:0}),Qe.dirty=!1);for(let ft=S.start;ft<=S.end;++ft){const Ee=u.style._layers[U[ft]];if(Ee.isHidden(u.transform.zoom))continue;const qe=u.style._getLayerSourceCache(Ee),yt=qe?this.proxyToSource[Q.key][qe.id]:[Q];if(!yt)continue;const Mt=yt;m.viewport.set([0,0,Qe.fb.width,Qe.fb.height]),it!==(qe?qe.id:null)&&(this._setupStencil(Qe,yt,Ee,qe),it=qe?qe.id:null),u.renderLayer(u,qe,Ee,Mt)}this.renderedToTile?(Qe.dirty=!0,z.push(we.tileID)):ut||--J,5===J&&(J=0,this.renderToBackBuffer(z))}return this.renderToBackBuffer(z),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,u.width,u.height]),S.end+1}postRender(){}renderCacheEfficiency(r){const u=r.order.length;if(0===u)return{efficiency:100};let m,y=0,b=0,S=!1;for(let z=0;z<u;++z){const U=r._layers[r.order[z]];this._style.isLayerDraped(U)?(S&&++y,++b):S||(S=!0,m=U.id)}return 0===b?{efficiency:100}:{efficiency:100*(1-y/b),firstUndrapedLayer:m}}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{r=Math.min(r,u.dem.tree.minimums[0])}),0===r?r:(r-30)*this._exaggeration}raycast(r,u,m){if(!this._visibleDemTiles)return null;const y=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const S=b.tileID,z=1<<S.overscaledZ,{x:U,y:J}=S.canonical,Q=U/z,we=(U+1)/z,Ye=J/z,Qe=(J+1)/z;return{minx:Q,miny:Ye,maxx:we,maxy:Qe,t:b.dem.tree.raycastRoot(Q,Ye,we,Qe,r,u,m),tile:b}});y.sort((b,S)=>(null!==b.t?b.t:Number.MAX_VALUE)-(null!==S.t?S.t:Number.MAX_VALUE));for(const b of y){if(null==b.t)return null;const S=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,r,u,m);if(null!=S)return S}return null}_createFBO(){const r=this.painter.context,u=r.gl,m=this.drapeBufferSize;r.activeTexture.set(u.TEXTURE0);const y=new a.Texture(r,{width:m[0],height:m[1],data:null},u.RGBA);y.bind(u.LINEAR,u.CLAMP_TO_EDGE);const b=r.createFramebuffer(m[0],m[1],!1);return b.colorAttachment.set(y.texture),b.depthAttachment=new ae(r,b.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&!r.extTextureFilterAnisotropicForceOff&&u.texParameterf(u.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:b,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const u=this._style._layers[r],m=u.isHidden(this.painter.transform.zoom);return"custom"===u.type?!m&&u.shouldRedrape():!m&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const m of this._style._getSources())if(m instanceof _e){r=!0;break}if(!r)return;const u={};for(let m=0;m<this._style.order.length;++m){const y=this._style._layers[this._style.order[m]],b=this._style._getLayerSourceCache(y);if(b&&!u[b.id]&&!y.isHidden(this.painter.transform.zoom)&&"line"===y.type&&y.widthExpression()instanceof a.ZoomDependentExpression){u[b.id]=!0;for(const S of this.proxyCoords){const z=this.proxyToSource[S.key][b.id];if(z)for(const U of z)this._clearRenderCacheForTile(b.id,U)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const m in this._style._sourceCaches)if(this._style._sourceCaches[m]._source instanceof re){r=!0;break}if(!r)return;const u={};for(let m=0;m<this._style.order.length;++m){const y=this._style._layers[this._style.order[m]],b=this._style._getLayerSourceCache(y);if(!b||u[b.id]||y.isHidden(this.painter.transform.zoom)||"raster"!==y.type)continue;const S=y.paint.get("raster-fade-duration");for(const z of this.proxyCoords){const U=this.proxyToSource[z.key][b.id];if(U)for(const J of U){const Q=Va(b.getTile(J),b.findLoadedParent(J,0),b,this.painter.transform,S);(1!==Q.opacity||0!==Q.mix)&&this._clearRenderCacheForTile(b.id,J)}}}}_setupDrapedRenderBatches(){const r=this._style.order,u=r.length;if(0===u)return;const m=[];let y,b=0,S=this._style._layers[r[b]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++b<u;)S=this._style._layers[r[b]];for(;b<u;++b){const z=this._style._layers[r[b]];z.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(z)?void 0===y&&(y=b):void 0!==y&&(m.push({start:y,end:b-1}),y=void 0))}void 0!==y&&m.push({start:y,end:b-1}),this._drapedRenderBatches=m}_setupRenderCache(r){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const S=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let z=0;z<S.length;++z){const U=Object.values(S[z]);u.renderCachePool.push(...U)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,y=this._tilesDirty;for(let S=m.length-1;S>=0;S--){const z=m[S];if(u.getTileByID(z.key),void 0!==u.proxyCachedFBO[z.key]){const U=r[z.key],J=this.proxyToSource[z.key];let Q=0;for(const we in J){const Ye=J[we],Qe=U[we];if(!Qe||Qe.length!==Ye.length||Ye.some((ut,it)=>ut!==Qe[it]||y[we]&&y[we].hasOwnProperty(ut.key))){Q=-1;break}++Q}for(const we in u.proxyCachedFBO[z.key])u.renderCache[u.proxyCachedFBO[z.key][we]].dirty=Q<0||Q!==Object.values(U).length}}const b=[...this._drapedRenderBatches];b.sort((S,z)=>z.end-z.start-(S.end-S.start));for(const S of b)for(const z of m){if(u.proxyCachedFBO[z.key])continue;let U=u.renderCachePool.pop();void 0===U&&u.renderCache.length<50&&(U=u.renderCache.length,u.renderCache.push(this._createFBO())),void 0!==U&&(u.proxyCachedFBO[z.key]={},u.proxyCachedFBO[z.key][S.start]=U,u.renderCache[U].dirty=!0)}this._tilesDirty={}}_setupStencil(r,u,m,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,S=b.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let z;if(m.isTileClipped())z=u.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);z=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+z>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=z,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(r,u){const m=this.painter,y=this.painter.context,b=y.gl;m._tileClippingMaskIDs={},y.setColorMode(a.ColorMode.disabled),y.setDepthMode(a.DepthMode.disabled);const S=m.useProgram("clippingMask");for(const z of r){const U=m._tileClippingMaskIDs[z.key]=--u;S.draw(y,b.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:b.ALWAYS,mask:0},U,255,b.KEEP,b.KEEP,b.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Aa(z.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(r){const u=this.painter.transform;if(r.x<0||r.x>u.width||r.y<0||r.y>u.height)return null;const m=[r.x,r.y,1,1];a.transformMat4$1(m,m,u.pixelMatrixInverse),a.scale$1(m,m,1/m[3]),m[0]/=u.worldSize,m[1]/=u.worldSize;const y=u._camera.position,b=a.mercatorZfromAltitude(1,u.center.lat),S=[y[0],y[1],y[2]/b,0],z=a.subtract([],m.slice(0,3),S);a.normalize(z,z);const U=this.raycast(S,z,this._exaggeration);return null!==U&&U?(a.scaleAndAdd(S,S,z,U),S[3]=S[2],S[2]*=b,S):null}drawDepth(){const r=this.painter,u=r.context,m=this.proxySourceCache,y=Math.ceil(r.width),b=Math.ceil(r.height);if(!this._depthFBO||this._depthFBO.width===y&&this._depthFBO.height===b||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const S=u.gl,z=u.createFramebuffer(y,b,!0);u.activeTexture.set(S.TEXTURE0);const U=new a.Texture(u,{width:y,height:b,data:null},S.RGBA);U.bind(S.NEAREST,S.CLAMP_TO_EDGE),z.colorAttachment.set(U.texture);const J=u.createRenderbuffer(u.gl.DEPTH_COMPONENT16,y,b);z.depthAttachment.set(J),this._depthFBO=z,this._depthTexture=U}u.bindFramebuffer.set(this._depthFBO.framebuffer),u.viewport.set([0,0,y,b]),function(S,z,U,J){if("globe"===S.transform.projection.name)return;const Q=S.context,we=Q.gl;Q.clear({depth:1});const Ye=S.useProgram("terrainDepth"),Qe=new a.DepthMode(we.LESS,a.DepthMode.ReadWrite,S.depthRangeFor3D);for(const ut of J){const it=U.getTile(ut),ft=ks(ut.projMatrix,0);z.setupElevationDraw(it,Ye),Ye.draw(Q,we.TRIANGLES,Qe,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,ft,"terrain_depth",z.gridBuffer,z.gridIndexBuffer,z.gridNoSkirtSegments)}}(r,this,m,this.proxyCoords)}_setupProxiedCoordsForOrtho(r,u,m){if(r.getSource()instanceof Pt)return this._setupProxiedCoordsForImageSource(r,u,m);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const y=this.proxiedCoords[r.id]=[],b=this.proxyCoords;for(let z=0;z<b.length;z++){const U=b[z],J=this._findTileCoveringTileID(U,r);if(J){const Q=this._createProxiedId(U,J,m[U.key]&&m[U.key][r.id]);y.push(Q),this.proxyToSource[U.key][r.id]=[Q]}}let S=!1;for(let z=0;z<u.length;z++){const U=r.getTile(u[z]);if(!U||!U.hasData())continue;const J=this._findTileCoveringTileID(U.tileID,this.proxySourceCache);if(J&&J.tileID.canonical.z!==U.tileID.canonical.z){const Q=this.proxyToSource[J.tileID.key][r.id],we=this._createProxiedId(J.tileID,U,m[J.tileID.key]&&m[J.tileID.key][r.id]);Q?Q.splice(Q.length-1,0,we):this.proxyToSource[J.tileID.key][r.id]=[we],y.push(we),S=!0}}this._sourceTilesOverlap[r.id]=S}_setupProxiedCoordsForImageSource(r,u,m){if(!r.getSource().loaded())return;const y=this.proxiedCoords[r.id]=[],b=this.proxyCoords,S=r.getSource(),z=new a.Point(S.tileID.x,S.tileID.y)._div(1<<S.tileID.z),U=S.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((Q,we)=>(Q.min.x=Math.min(Q.min.x,we.x-z.x),Q.min.y=Math.min(Q.min.y,we.y-z.y),Q.max.x=Math.max(Q.max.x,we.x-z.x),Q.max.y=Math.max(Q.max.y,we.y-z.y),Q),{min:new a.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),J=(Q,we)=>{const Ye=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),Qe=Q.canonical.y/(1<<Q.canonical.z),ut=a.EXTENT/(1<<Q.canonical.z),it=we.wrap+we.canonical.x/(1<<we.canonical.z),ft=we.canonical.y/(1<<we.canonical.z);return Ye+ut<it+U.min.x||Ye>it+U.max.x||Qe+ut<ft+U.min.y||Qe>ft+U.max.y};for(let Q=0;Q<b.length;Q++){const we=b[Q];for(let Ye=0;Ye<u.length;Ye++){const Qe=r.getTile(u[Ye]);if(!Qe||!Qe.hasData()||J(we,Qe.tileID))continue;const ut=this._createProxiedId(we,Qe,m[we.key]&&m[we.key][r.id]),it=this.proxyToSource[we.key][r.id];it?it.push(ut):this.proxyToSource[we.key][r.id]=[ut],y.push(ut)}}}_createProxiedId(r,u,m){let y=this.orthoMatrix;if(m){const b=m.find(S=>S.key===u.tileID.key);if(b)return b}if(u.tileID.key!==r.key){const b=r.canonical.z-u.tileID.canonical.z;let S,z,U;y=a.create();const J=u.tileID.wrap-r.wrap<<r.overscaledZ;b>0?(S=a.EXTENT>>b,z=S*((u.tileID.canonical.x<<b)-r.canonical.x+J),U=S*((u.tileID.canonical.y<<b)-r.canonical.y)):(S=a.EXTENT<<-b,z=a.EXTENT*(u.tileID.canonical.x-(r.canonical.x+J<<-b)),U=a.EXTENT*(u.tileID.canonical.y-(r.canonical.y<<-b))),a.ortho(y,0,S,0,S,0,1),a.translate(y,y,[z,U,0])}return new ko(u.tileID,r.key,y)}_findTileCoveringTileID(r,u){let m=u.getTile(r);if(m&&m.hasData())return m;const y=this._findCoveringTileCache[u.id],b=y[r.key];if(m=b?u.getTileByID(b):null,m&&m.hasData()||null===b)return m;let S=m?m.tileID:r,z=S.overscaledZ;const U=u.getSource().minzoom,J=[];if(!b){const we=u.getSource().maxzoom;if(r.canonical.z>=we){const Ye=r.canonical.z-we;u.getSource().reparseOverscaled?(z=Math.max(r.canonical.z+2,u.transform.tileZoom),S=new a.OverscaledTileID(z,r.wrap,we,r.canonical.x>>Ye,r.canonical.y>>Ye)):0!==Ye&&(z=we,S=new a.OverscaledTileID(z,r.wrap,we,r.canonical.x>>Ye,r.canonical.y>>Ye))}S.key!==r.key&&(J.push(S.key),m=u.getTile(S))}const Q=we=>{J.forEach(Ye=>{y[Ye]=we}),J.length=0};for(z-=1;z>=U&&(!m||!m.hasData());z--){m&&Q(m.tileID.key);const we=S.calculateScaledKey(z);if(m=u.getTileByID(we),m&&m.hasData())break;const Ye=y[we];if(null===Ye)break;void 0===Ye?J.push(we):m=u.getTileByID(Ye)}return Q(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,u){let m=this._tilesDirty[r];m||(m=this._tilesDirty[r]={}),m[u.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const r=function(u){let m=0;const y=new a.StructArrayLayout2ui4,b=131;for(let S=1;S<129;S++){for(let z=1;z<129;z++)m=S*b+z,y.emplaceBack(m,m+1),y.emplaceBack(m,m+b),y.emplaceBack(m+1,m+b),128===S&&y.emplaceBack(m+b,m+b+1);y.emplaceBack(m+1,m+1+b)}return y}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(r),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,r.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Hr{static cacheKey(r,u,m,y){let b=`${u}${y?y.cacheKey:""}`;for(const S of m)r.usedDefines.includes(S)&&(b+=`/${S}`);return b}constructor(r,u,m,y,b,S){const z=r.gl;this.program=z.createProgram();const U=function(Ee){const qe=[];for(let yt=0;yt<Ee.length;yt++){if(null===Ee[yt])continue;const Mt=Ee[yt].split(" ");qe.push(Mt.pop())}return qe}(m.staticAttributes),J=y?y.getBinderAttributes():[],Q=U.concat(J);let we=y?y.defines():[];we=we.concat(S.map(Ee=>`#define ${Ee}`));const Ye=r.isWebGL2?"#version 300 es\n":"",Qe=Ye+we.concat(r.extStandardDerivatives&&0===Ye.length?"#extension GL_OES_standard_derivatives : enable\n".concat(Go):Go,Go,qa,ca.fragmentSource,Qs.fragmentSource,m.fragmentSource).join("\n"),ut=Ye+we.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",qa,ca.vertexSource,Qs.vertexSource,Ka.vertexSource,m.vertexSource).join("\n"),it=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);z.shaderSource(it,Qe),z.compileShader(it),z.attachShader(this.program,it);const ft=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())this.failedToCreate=!0;else{z.shaderSource(ft,ut),z.compileShader(ft),z.attachShader(this.program,ft),this.attributes={},this.numAttributes=Q.length;for(let Ee=0;Ee<this.numAttributes;Ee++)Q[Ee]&&(z.bindAttribLocation(this.program,Ee,Q[Ee]),this.attributes[Q[Ee]]=Ee);z.linkProgram(this.program),z.deleteShader(ft),z.deleteShader(it),this.fixedUniforms=b(r),this.binderUniforms=y?y.getUniforms(r):[],S.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new a.Uniform1i(Ee=r),u_dem_prev:new a.Uniform1i(Ee),u_dem_unpack:new a.Uniform4f(Ee),u_dem_tl:new a.Uniform2f(Ee),u_dem_scale:new a.Uniform1f(Ee),u_dem_tl_prev:new a.Uniform2f(Ee),u_dem_scale_prev:new a.Uniform1f(Ee),u_dem_size:new a.Uniform1f(Ee),u_dem_lerp:new a.Uniform1f(Ee),u_exaggeration:new a.Uniform1f(Ee),u_depth:new a.Uniform1i(Ee),u_depth_size_inv:new a.Uniform2f(Ee),u_meter_to_dem:new a.Uniform1f(Ee),u_label_plane_matrix_inv:new a.UniformMatrix4f(Ee)}),S.includes("GLOBE")&&(this.globeUniforms=(Ee=>({u_tile_tl_up:new a.Uniform3f(Ee),u_tile_tr_up:new a.Uniform3f(Ee),u_tile_br_up:new a.Uniform3f(Ee),u_tile_bl_up:new a.Uniform3f(Ee),u_tile_up_scale:new a.Uniform1f(Ee)}))(r)),S.includes("FOG")&&(this.fogUniforms=(Ee=>({u_fog_matrix:new a.UniformMatrix4f(Ee),u_fog_range:new a.Uniform2f(Ee),u_fog_color:new a.Uniform4f(Ee),u_fog_horizon_blend:new a.Uniform1f(Ee),u_fog_temporal_offset:new a.Uniform1f(Ee),u_frustum_tl:new a.Uniform3f(Ee),u_frustum_tr:new a.Uniform3f(Ee),u_frustum_br:new a.Uniform3f(Ee),u_frustum_bl:new a.Uniform3f(Ee),u_globe_pos:new a.Uniform3f(Ee),u_globe_radius:new a.Uniform1f(Ee),u_globe_transition:new a.Uniform1f(Ee),u_is_globe:new a.Uniform1i(Ee),u_viewport:new a.Uniform2f(Ee)}))(r))}var Ee}setTerrainUniformValues(r,u){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in u)m[y]&&m[y].set(this.program,y,u[y])}}setGlobeUniformValues(r,u){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in u)m[y]&&m[y].set(this.program,y,u[y])}}setFogUniformValues(r,u){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const y in u)m[y].set(this.program,y,u[y])}}draw(r,u,m,y,b,S,z,U,J,Q,we,Ye,Qe,ut,it){const ft=r.gl;if(this.failedToCreate)return;r.program.set(this.program),r.setDepthMode(m),r.setStencilMode(y),r.setColorMode(b),r.setCullFace(S);for(const qe of Object.keys(this.fixedUniforms))this.fixedUniforms[qe].set(this.program,qe,z[qe]);ut&&ut.setUniforms(this.program,r,this.binderUniforms,Ye,{zoom:Qe});const Ee={[ft.LINES]:2,[ft.TRIANGLES]:3,[ft.LINE_STRIP]:1}[u];for(const qe of we.get()){const yt=qe.vaos||(qe.vaos={});(yt[U]||(yt[U]=new Fa)).bind(r,this,J,ut?ut.getPaintVertexBuffers():[],Q,qe.vertexOffset,it||[]),ft.drawElements(u,qe.primitiveLength*Ee,ft.UNSIGNED_SHORT,qe.primitiveOffset*Ee*2)}}}function Ba(d,r){const u=Math.pow(2,r.tileID.overscaledZ),m=r.tileSize*Math.pow(2,d.transform.tileZoom)/u,y=m*(r.tileID.canonical.x+r.tileID.wrap*u),b=m*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_tile_units_to_pixels:1/di(r,1,d.transform.tileZoom),u_pixel_coord_upper:[y>>16,b>>16],u_pixel_coord_lower:[65535&y,65535&b]}}const Qa=a.create(),ua=(d,r,u,m,y,b,S,z,U,J,Q)=>{const we=r.style.light,Ye=we.properties.get("position"),Qe=[Ye.x,Ye.y,Ye.z],ut=a.create$1();"viewport"===we.properties.get("anchor")&&(a.fromRotation(ut,-r.transform.angle),a.transformMat3(Qe,Qe,ut));const it=we.properties.get("color"),ft=r.transform,Ee={u_matrix:d,u_lightpos:Qe,u_lightintensity:we.properties.get("intensity"),u_lightcolor:[it.r,it.g,it.b],u_vertical_gradient:+u,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Qa,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:y,u_edge_radius:b};return"globe"===ft.projection.name&&(Ee.u_tile_id=[S.canonical.x,S.canonical.y,1<<S.canonical.z],Ee.u_zoom_transition=U,Ee.u_inv_rot_matrix=Q,Ee.u_merc_center=J,Ee.u_up_dir=ft.projection.upVector(new a.CanonicalTileID(0,0,0),J[0]*a.EXTENT,J[1]*a.EXTENT),Ee.u_height_lift=z),Ee},xa=(d,r,u,m,y,b,S,z,U,J,Q,we)=>{const Ye=ua(d,r,u,m,y,b,S,U,J,Q,we),Qe={u_height_factor:-Math.pow(2,S.overscaledZ)/z.tileSize/8};return a.extend(Ye,Ba(r,z),Qe)},Os=d=>({u_matrix:d}),Pl=(d,r,u)=>a.extend(Os(d),Ba(r,u)),sl=(d,r)=>({u_matrix:d,u_world:r}),vl=(d,r,u,m)=>a.extend(Pl(d,r,u),{u_world:m}),be=a.create(),Ae=(d,r,u,m,y,b)=>{const S=d.transform,z="globe"===S.projection.name;let U;if("map"===b.paint.get("circle-pitch-alignment"))if(z){const Q=a.globePixelsToTileUnits(S.zoom,r.canonical)*S._pixelsPerMercatorPixel;U=Float32Array.from([Q,0,0,Q])}else U=S.calculatePixelsToTileUnitsMatrix(u);else U=new Float32Array([S.pixelsToGLUnits[0],0,0,S.pixelsToGLUnits[1]]);const J={u_camera_to_center_distance:S.cameraToCenterDistance,u_matrix:d.translatePosMatrix(r.projMatrix,u,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:U,u_inv_rot_matrix:be,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){J.u_inv_rot_matrix=m,J.u_merc_center=y,J.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],J.u_zoom_transition=a.globeToMercatorTransition(S.zoom);const Q=y[0]*a.EXTENT,we=y[1]*a.EXTENT;J.u_up_dir=S.projection.upVector(new a.CanonicalTileID(0,0,0),Q,we)}return J},K=d=>{const r=[];return"map"===d.paint.get("circle-pitch-alignment")&&r.push("PITCH_WITH_MAP"),"map"===d.paint.get("circle-pitch-scale")&&r.push("SCALE_WITH_MAP"),r},Ge=(d,r,u,m)=>{const y=a.EXTENT/u.tileSize;return{u_matrix:d,u_camera_to_center_distance:r.getCameraToCenterDistance(m),u_extrude_scale:[r.pixelsToGLUnits[0]/y,r.pixelsToGLUnits[1]/y]}},Ht=(d,r,u=1)=>({u_matrix:d,u_color:r,u_overlay:0,u_overlay_scale:u}),Fi=a.create(),Sr=(d,r,u,m,y,b,S)=>{const z=d.transform,U="globe"===z.projection.name,J=U?a.globePixelsToTileUnits(z.zoom,r.canonical)*z._pixelsPerMercatorPixel:di(u,1,b),Q={u_matrix:r.projMatrix,u_extrude_scale:J,u_intensity:S,u_inv_rot_matrix:Fi,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(U){Q.u_inv_rot_matrix=m,Q.u_merc_center=y,Q.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],Q.u_zoom_transition=a.globeToMercatorTransition(z.zoom);const we=y[0]*a.EXTENT,Ye=y[1]*a.EXTENT;Q.u_up_dir=z.projection.upVector(new a.CanonicalTileID(0,0,0),we,Ye)}return Q},Yr=(d,r,u,m,y,b,S)=>{const z=d.transform,U=z.calculatePixelsToTileUnitsMatrix(r);return{u_matrix:Ja(d,r,u,m),u_pixels_to_tile_units:U,u_device_pixel_ratio:b,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:y,u_texsize:Us(u)?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:ta(r,d.transform),u_alpha_discard_threshold:0,u_trim_offset:S}},ea=(d,r,u,m,y)=>{const b=d.transform;return{u_matrix:Ja(d,r,u,m),u_texsize:r.imageAtlasTexture.size,u_pixels_to_tile_units:b.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:y,u_image:0,u_tile_units_to_pixels:ta(r,b),u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ta(d,r){return 1/di(d,1,r.tileZoom)}function Ja(d,r,u,m){return d.translatePosMatrix(m||r.tileID.projMatrix,r,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}function Us(d){const r=d.paint.get("line-dasharray").value;return r.value||"constant"!==r.kind}const Bl=(d,r,u,m,y,b)=>{return{u_matrix:d,u_tl_parent:r,u_scale_parent:u,u_fade_t:m.mix,u_opacity:m.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(z=y.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(S=y.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:Pa(y.paint.get("raster-hue-rotate")),u_perspective_transform:b};var S,z};function Pa(d){d*=Math.PI/180;const r=Math.sin(d),u=Math.cos(d);return[(2*u+1)/3,(-Math.sqrt(3)*r-u+1)/3,(Math.sqrt(3)*r-u+1)/3]}const Hl=a.create(),Ul=(d,r,u,m,y,b,S,z,U,J,Q,we,Ye,Qe,ut,it)=>{const ft=y.transform,Ee={u_is_size_zoom_constant:+("constant"===d||"source"===d),u_is_size_feature_constant:+("constant"===d||"camera"===d),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:ft.cameraToCenterDistance,u_rotate_symbol:+u,u_aspect_ratio:ft.width/ft.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:S,u_coord_matrix:z,u_is_text:+U,u_pitch_with_map:+m,u_texsize:J,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Hl,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Hl,u_up_vector:[0,-1,0]};return"globe"===it.name&&(Ee.u_tile_id=[Q.canonical.x,Q.canonical.y,1<<Q.canonical.z],Ee.u_zoom_transition=we,Ee.u_inv_rot_matrix=Qe,Ee.u_merc_center=Ye,Ee.u_camera_forward=ft._camera.forward(),Ee.u_ecef_origin=a.globeECEFOrigin(ft.globeMatrix,Q.toUnwrapped()),Ee.u_tile_matrix=Float32Array.from(ft.globeMatrix),Ee.u_up_vector=ut),Ee},Ha=(d,r,u,m,y,b,S,z,U,J,Q,we,Ye,Qe,ut,it,ft)=>a.extend(Ul(d,r,u,m,y,b,S,z,U,J,we,Ye,Qe,ut,it,ft),{u_gamma_scale:m?y.transform.cameraToCenterDistance*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+Q}),zl=(d,r,u,m,y,b,S,z,U,J,Q,we,Ye,Qe,ut,it)=>a.extend(Ha(d,r,u,m,y,b,S,z,!0,U,!0,Q,we,Ye,Qe,ut,it),{u_texsize_icon:J,u_texture_icon:1}),el=(d,r,u)=>({u_matrix:d,u_opacity:r,u_color:u}),nc=(d,r,u,m,y)=>a.extend(function(b,S,z){const U=S.imageManager.getPattern(b.toString()),{width:J,height:Q}=S.imageManager.getPixelSize(),we=Math.pow(2,z.tileID.overscaledZ),Ye=z.tileSize*Math.pow(2,S.transform.tileZoom)/we,Qe=Ye*(z.tileID.canonical.x+z.tileID.wrap*we),ut=Ye*z.tileID.canonical.y;return{u_image:0,u_pattern_tl:U.tl,u_pattern_br:U.br,u_texsize:[J,Q],u_pattern_size:U.displaySize,u_tile_units_to_pixels:1/di(z,1,S.transform.tileZoom),u_pixel_coord_upper:[Qe>>16,ut>>16],u_pixel_coord_lower:[65535&Qe,65535&ut]}}(m,u,y),{u_matrix:d,u_opacity:r}),Gr={fillExtrusion:d=>({u_matrix:new a.UniformMatrix4f(d),u_lightpos:new a.Uniform3f(d),u_lightintensity:new a.Uniform1f(d),u_lightcolor:new a.Uniform3f(d),u_vertical_gradient:new a.Uniform1f(d),u_opacity:new a.Uniform1f(d),u_edge_radius:new a.Uniform1f(d),u_ao:new a.Uniform2f(d),u_tile_id:new a.Uniform3f(d),u_zoom_transition:new a.Uniform1f(d),u_inv_rot_matrix:new a.UniformMatrix4f(d),u_merc_center:new a.Uniform2f(d),u_up_dir:new a.Uniform3f(d),u_height_lift:new a.Uniform1f(d)}),fillExtrusionPattern:d=>({u_matrix:new a.UniformMatrix4f(d),u_lightpos:new a.Uniform3f(d),u_lightintensity:new a.Uniform1f(d),u_lightcolor:new a.Uniform3f(d),u_vertical_gradient:new a.Uniform1f(d),u_height_factor:new a.Uniform1f(d),u_edge_radius:new a.Uniform1f(d),u_ao:new a.Uniform2f(d),u_tile_id:new a.Uniform3f(d),u_zoom_transition:new a.Uniform1f(d),u_inv_rot_matrix:new a.UniformMatrix4f(d),u_merc_center:new a.Uniform2f(d),u_up_dir:new a.Uniform3f(d),u_height_lift:new a.Uniform1f(d),u_image:new a.Uniform1i(d),u_texsize:new a.Uniform2f(d),u_pixel_coord_upper:new a.Uniform2f(d),u_pixel_coord_lower:new a.Uniform2f(d),u_tile_units_to_pixels:new a.Uniform1f(d),u_opacity:new a.Uniform1f(d)}),fill:d=>({u_matrix:new a.UniformMatrix4f(d)}),fillPattern:d=>({u_matrix:new a.UniformMatrix4f(d),u_image:new a.Uniform1i(d),u_texsize:new a.Uniform2f(d),u_pixel_coord_upper:new a.Uniform2f(d),u_pixel_coord_lower:new a.Uniform2f(d),u_tile_units_to_pixels:new a.Uniform1f(d)}),fillOutline:d=>({u_matrix:new a.UniformMatrix4f(d),u_world:new a.Uniform2f(d)}),fillOutlinePattern:d=>({u_matrix:new a.UniformMatrix4f(d),u_world:new a.Uniform2f(d),u_image:new a.Uniform1i(d),u_texsize:new a.Uniform2f(d),u_pixel_coord_upper:new a.Uniform2f(d),u_pixel_coord_lower:new a.Uniform2f(d),u_tile_units_to_pixels:new a.Uniform1f(d)}),circle:d=>({u_camera_to_center_distance:new a.Uniform1f(d),u_extrude_scale:new a.UniformMatrix2f(d),u_device_pixel_ratio:new a.Uniform1f(d),u_matrix:new a.UniformMatrix4f(d),u_inv_rot_matrix:new a.UniformMatrix4f(d),u_merc_center:new a.Uniform2f(d),u_tile_id:new a.Uniform3f(d),u_zoom_transition:new a.Uniform1f(d),u_up_dir:new a.Uniform3f(d)}),collisionBox:d=>({u_matrix:new a.UniformMatrix4f(d),u_camera_to_center_distance:new a.Uniform1f(d),u_extrude_scale:new a.Uniform2f(d)}),collisionCircle:d=>({u_matrix:new a.UniformMatrix4f(d),u_inv_matrix:new a.UniformMatrix4f(d),u_camera_to_center_distance:new a.Uniform1f(d),u_viewport_size:new a.Uniform2f(d)}),debug:d=>({u_color:new a.UniformColor(d),u_matrix:new a.UniformMatrix4f(d),u_overlay:new a.Uniform1i(d),u_overlay_scale:new a.Uniform1f(d)}),clippingMask:d=>({u_matrix:new a.UniformMatrix4f(d)}),heatmap:d=>({u_extrude_scale:new a.Uniform1f(d),u_intensity:new a.Uniform1f(d),u_matrix:new a.UniformMatrix4f(d),u_inv_rot_matrix:new a.UniformMatrix4f(d),u_merc_center:new a.Uniform2f(d),u_tile_id:new a.Uniform3f(d),u_zoom_transition:new a.Uniform1f(d),u_up_dir:new a.Uniform3f(d)}),heatmapTexture:d=>({u_image:new a.Uniform1i(d),u_color_ramp:new a.Uniform1i(d),u_opacity:new a.Uniform1f(d)}),hillshade:d=>({u_matrix:new a.UniformMatrix4f(d),u_image:new a.Uniform1i(d),u_latrange:new a.Uniform2f(d),u_light:new a.Uniform2f(d),u_shadow:new a.UniformColor(d),u_highlight:new a.UniformColor(d),u_accent:new a.UniformColor(d)}),hillshadePrepare:d=>({u_matrix:new a.UniformMatrix4f(d),u_image:new a.Uniform1i(d),u_dimension:new a.Uniform2f(d),u_zoom:new a.Uniform1f(d),u_unpack:new a.Uniform4f(d)}),line:d=>({u_matrix:new a.UniformMatrix4f(d),u_pixels_to_tile_units:new a.UniformMatrix2f(d),u_device_pixel_ratio:new a.Uniform1f(d),u_units_to_pixels:new a.Uniform2f(d),u_dash_image:new a.Uniform1i(d),u_gradient_image:new a.Uniform1i(d),u_image_height:new a.Uniform1f(d),u_texsize:new a.Uniform2f(d),u_tile_units_to_pixels:new a.Uniform1f(d),u_alpha_discard_threshold:new a.Uniform1f(d),u_trim_offset:new a.Uniform2f(d)}),linePattern:d=>({u_matrix:new a.UniformMatrix4f(d),u_texsize:new a.Uniform2f(d),u_pixels_to_tile_units:new a.UniformMatrix2f(d),u_device_pixel_ratio:new a.Uniform1f(d),u_image:new a.Uniform1i(d),u_units_to_pixels:new a.Uniform2f(d),u_tile_units_to_pixels:new a.Uniform1f(d),u_alpha_discard_threshold:new a.Uniform1f(d)}),raster:d=>({u_matrix:new a.UniformMatrix4f(d),u_tl_parent:new a.Uniform2f(d),u_scale_parent:new a.Uniform1f(d),u_fade_t:new a.Uniform1f(d),u_opacity:new a.Uniform1f(d),u_image0:new a.Uniform1i(d),u_image1:new a.Uniform1i(d),u_brightness_low:new a.Uniform1f(d),u_brightness_high:new a.Uniform1f(d),u_saturation_factor:new a.Uniform1f(d),u_contrast_factor:new a.Uniform1f(d),u_spin_weights:new a.Uniform3f(d),u_perspective_transform:new a.Uniform2f(d)}),symbolIcon:d=>({u_is_size_zoom_constant:new a.Uniform1i(d),u_is_size_feature_constant:new a.Uniform1i(d),u_size_t:new a.Uniform1f(d),u_size:new a.Uniform1f(d),u_camera_to_center_distance:new a.Uniform1f(d),u_rotate_symbol:new a.Uniform1i(d),u_aspect_ratio:new a.Uniform1f(d),u_fade_change:new a.Uniform1f(d),u_matrix:new a.UniformMatrix4f(d),u_label_plane_matrix:new a.UniformMatrix4f(d),u_coord_matrix:new a.UniformMatrix4f(d),u_is_text:new a.Uniform1i(d),u_pitch_with_map:new a.Uniform1i(d),u_texsize:new a.Uniform2f(d),u_tile_id:new a.Uniform3f(d),u_zoom_transition:new a.Uniform1f(d),u_inv_rot_matrix:new a.UniformMatrix4f(d),u_merc_center:new a.Uniform2f(d),u_camera_forward:new a.Uniform3f(d),u_tile_matrix:new a.UniformMatrix4f(d),u_up_vector:new a.Uniform3f(d),u_ecef_origin:new a.Uniform3f(d),u_texture:new a.Uniform1i(d)}),symbolSDF:d=>({u_is_size_zoom_constant:new a.Uniform1i(d),u_is_size_feature_constant:new a.Uniform1i(d),u_size_t:new a.Uniform1f(d),u_size:new a.Uniform1f(d),u_camera_to_center_distance:new a.Uniform1f(d),u_rotate_symbol:new a.Uniform1i(d),u_aspect_ratio:new a.Uniform1f(d),u_fade_change:new a.Uniform1f(d),u_matrix:new a.UniformMatrix4f(d),u_label_plane_matrix:new a.UniformMatrix4f(d),u_coord_matrix:new a.UniformMatrix4f(d),u_is_text:new a.Uniform1i(d),u_pitch_with_map:new a.Uniform1i(d),u_texsize:new a.Uniform2f(d),u_texture:new a.Uniform1i(d),u_gamma_scale:new a.Uniform1f(d),u_device_pixel_ratio:new a.Uniform1f(d),u_tile_id:new a.Uniform3f(d),u_zoom_transition:new a.Uniform1f(d),u_inv_rot_matrix:new a.UniformMatrix4f(d),u_merc_center:new a.Uniform2f(d),u_camera_forward:new a.Uniform3f(d),u_tile_matrix:new a.UniformMatrix4f(d),u_up_vector:new a.Uniform3f(d),u_ecef_origin:new a.Uniform3f(d),u_is_halo:new a.Uniform1i(d)}),symbolTextAndIcon:d=>({u_is_size_zoom_constant:new a.Uniform1i(d),u_is_size_feature_constant:new a.Uniform1i(d),u_size_t:new a.Uniform1f(d),u_size:new a.Uniform1f(d),u_camera_to_center_distance:new a.Uniform1f(d),u_rotate_symbol:new a.Uniform1i(d),u_aspect_ratio:new a.Uniform1f(d),u_fade_change:new a.Uniform1f(d),u_matrix:new a.UniformMatrix4f(d),u_label_plane_matrix:new a.UniformMatrix4f(d),u_coord_matrix:new a.UniformMatrix4f(d),u_is_text:new a.Uniform1i(d),u_pitch_with_map:new a.Uniform1i(d),u_texsize:new a.Uniform2f(d),u_texsize_icon:new a.Uniform2f(d),u_texture:new a.Uniform1i(d),u_texture_icon:new a.Uniform1i(d),u_gamma_scale:new a.Uniform1f(d),u_device_pixel_ratio:new a.Uniform1f(d),u_is_halo:new a.Uniform1i(d)}),background:d=>({u_matrix:new a.UniformMatrix4f(d),u_opacity:new a.Uniform1f(d),u_color:new a.UniformColor(d)}),backgroundPattern:d=>({u_matrix:new a.UniformMatrix4f(d),u_opacity:new a.Uniform1f(d),u_image:new a.Uniform1i(d),u_pattern_tl:new a.Uniform2f(d),u_pattern_br:new a.Uniform2f(d),u_texsize:new a.Uniform2f(d),u_pattern_size:new a.Uniform2f(d),u_pixel_coord_upper:new a.Uniform2f(d),u_pixel_coord_lower:new a.Uniform2f(d),u_tile_units_to_pixels:new a.Uniform1f(d)}),terrainRaster:Lo,terrainDepth:Lo,skybox:d=>({u_matrix:new a.UniformMatrix4f(d),u_sun_direction:new a.Uniform3f(d),u_cubemap:new a.Uniform1i(d),u_opacity:new a.Uniform1f(d),u_temporal_offset:new a.Uniform1f(d)}),skyboxGradient:d=>({u_matrix:new a.UniformMatrix4f(d),u_color_ramp:new a.Uniform1i(d),u_center_direction:new a.Uniform3f(d),u_radius:new a.Uniform1f(d),u_opacity:new a.Uniform1f(d),u_temporal_offset:new a.Uniform1f(d)}),skyboxCapture:d=>({u_matrix_3f:new a.UniformMatrix3f(d),u_sun_direction:new a.Uniform3f(d),u_sun_intensity:new a.Uniform1f(d),u_color_tint_r:new a.Uniform4f(d),u_color_tint_m:new a.Uniform4f(d),u_luminance:new a.Uniform1f(d)}),globeRaster:d=>({u_proj_matrix:new a.UniformMatrix4f(d),u_globe_matrix:new a.UniformMatrix4f(d),u_normalize_matrix:new a.UniformMatrix4f(d),u_merc_matrix:new a.UniformMatrix4f(d),u_zoom_transition:new a.Uniform1f(d),u_merc_center:new a.Uniform2f(d),u_image0:new a.Uniform1i(d),u_grid_matrix:new a.UniformMatrix3f(d),u_skirt_height:new a.Uniform1f(d),u_frustum_tl:new a.Uniform3f(d),u_frustum_tr:new a.Uniform3f(d),u_frustum_br:new a.Uniform3f(d),u_frustum_bl:new a.Uniform3f(d),u_globe_pos:new a.Uniform3f(d),u_globe_radius:new a.Uniform1f(d),u_viewport:new a.Uniform2f(d)}),globeAtmosphere:d=>({u_frustum_tl:new a.Uniform3f(d),u_frustum_tr:new a.Uniform3f(d),u_frustum_br:new a.Uniform3f(d),u_frustum_bl:new a.Uniform3f(d),u_horizon:new a.Uniform1f(d),u_transition:new a.Uniform1f(d),u_fadeout_range:new a.Uniform1f(d),u_color:new a.Uniform4f(d),u_high_color:new a.Uniform4f(d),u_space_color:new a.Uniform4f(d),u_star_intensity:new a.Uniform1f(d),u_star_density:new a.Uniform1f(d),u_star_size:new a.Uniform1f(d),u_temporal_offset:new a.Uniform1f(d),u_horizon_angle:new a.Uniform1f(d),u_rotation_matrix:new a.UniformMatrix4f(d)})};let os;function Ro(d,r,u,m,y,b,S){const z=d.context,U=z.gl,J=d.transform,Q=d.useProgram("collisionBox"),we=[];let Ye=0,Qe=0;for(let Mt=0;Mt<m.length;Mt++){const $t=m[Mt],Wt=r.getTile($t),Ot=Wt.getBucket(u);if(!Ot)continue;const on=yo($t,Ot,J);let Zt=on;0===y[0]&&0===y[1]||(Zt=d.translatePosMatrix(on,Wt,y,b));const cn=S?Ot.textCollisionBox:Ot.iconCollisionBox,li=Ot.collisionCircleArray;if(li.length>0){const fn=a.create(),Fn=Zt;a.mul(fn,Ot.placementInvProjMatrix,J.glCoordMatrix),a.mul(fn,fn,Ot.placementViewportMatrix),we.push({circleArray:li,circleOffset:Qe,transform:Fn,invTransform:fn,projection:Ot.getProjection()}),Ye+=li.length/4,Qe=Ye}cn&&(d.terrain&&d.terrain.setupElevationDraw(Wt,Q),Q.draw(z,U.LINES,a.DepthMode.disabled,a.StencilMode.disabled,d.colorModeForRenderPass(),a.CullFaceMode.disabled,Ge(Zt,J,Wt,Ot.getProjection()),u.id,cn.layoutVertexBuffer,cn.indexBuffer,cn.segments,null,J.zoom,null,[cn.collisionVertexBuffer,cn.collisionVertexBufferExt]))}if(!S||!we.length)return;const ut=d.useProgram("collisionCircle"),it=new a.StructArrayLayout2f1f2i16;it.resize(4*Ye),it._trim();let ft=0;for(const Mt of we)for(let $t=0;$t<Mt.circleArray.length/4;$t++){const Wt=4*$t,Ot=Mt.circleArray[Wt+0],on=Mt.circleArray[Wt+1],Zt=Mt.circleArray[Wt+2],cn=Mt.circleArray[Wt+3];it.emplace(ft++,Ot,on,Zt,cn,0),it.emplace(ft++,Ot,on,Zt,cn,1),it.emplace(ft++,Ot,on,Zt,cn,2),it.emplace(ft++,Ot,on,Zt,cn,3)}(!os||os.length<2*Ye)&&(os=function(Mt){const $t=2*Mt,Wt=new a.StructArrayLayout3ui6;Wt.resize($t),Wt._trim();for(let Ot=0;Ot<$t;Ot++){const on=6*Ot;Wt.uint16[on+0]=4*Ot+0,Wt.uint16[on+1]=4*Ot+1,Wt.uint16[on+2]=4*Ot+2,Wt.uint16[on+3]=4*Ot+2,Wt.uint16[on+4]=4*Ot+3,Wt.uint16[on+5]=4*Ot+0}return Wt}(Ye));const Ee=z.createIndexBuffer(os,!0),qe=z.createVertexBuffer(it,a.collisionCircleLayout.members,!0);for(const Mt of we){const $t={u_matrix:Mt.transform,u_inv_matrix:Mt.invTransform,u_camera_to_center_distance:(yt=J).getCameraToCenterDistance(Mt.projection),u_viewport_size:[yt.width,yt.height]};ut.draw(z,U.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,d.colorModeForRenderPass(),a.CullFaceMode.disabled,$t,u.id,qe,Ee,a.SegmentVector.simpleSegment(0,2*Mt.circleOffset,Mt.circleArray.length,Mt.circleArray.length/2),null,J.zoom)}var yt;qe.destroy(),Ee.destroy()}const cs=a.create();function Es({width:d,height:r,anchor:u,textOffset:m,textScale:y},b){const{horizontalAlign:S,verticalAlign:z}=a.getAnchorAlignment(u),U=-(S-.5)*d,J=-(z-.5)*r,Q=a.evaluateVariableOffset(u,m);return new a.Point((U/y+Q[0])*b,(J/y+Q[1])*b)}function Zl(d,r,u,m,y,b,S,z,U,J,Q){const we=d.text.placedSymbolArray,Ye=d.text.dynamicLayoutVertexArray,Qe=d.icon.dynamicLayoutVertexArray,ut={},it=d.getProjection(),ft=Ji(z,it,b),Ee=b.elevation,qe=it.upVectorScale(z.canonical,b.center.lat,b.worldSize).metersToTile;Ye.clear();for(let yt=0;yt<we.length;yt++){const Mt=we.get(yt),{tileAnchorX:$t,tileAnchorY:Wt,numGlyphs:Ot}=Mt,on=Mt.hidden||!Mt.crossTileID||d.allowVerticalPlacement&&!Mt.placedOrientation?null:m[Mt.crossTileID];if(on){let Zt=0,cn=0,li=0;if(Ee){const fi=Ee?Ee.getAtTileOffset(z,$t,Wt):0,[tr,wr,Vi]=it.upVector(z.canonical,$t,Wt);Zt=fi*tr*qe,cn=fi*wr*qe,li=fi*Vi*qe}let[fn,Fn,gn,ai]=Zn(Mt.projectedAnchorX+Zt,Mt.projectedAnchorY+cn,Mt.projectedAnchorZ+li,u?ft:S);const vn=Ei(b.getCameraToCenterDistance(it),ai);let Hn=y.evaluateSizeForFeature(d.textSizeData,J,Mt)*vn/a.ONE_EM;u&&(Hn*=d.tilePixelRatio/U);const ri=Es(on,Hn);u?(({x:fn,y:Fn,z:gn}=it.projectTilePoint($t+ri.x,Wt+ri.y,z.canonical)),[fn,Fn,gn]=Zn(fn+Zt,Fn+cn,gn+li,S)):(r&&ri._rotate(-b.angle),fn+=ri.x,Fn+=ri.y,gn=0);const Qn=d.allowVerticalPlacement&&Mt.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let fi=0;fi<Ot;fi++)a.addDynamicAttributes(Ye,fn,Fn,gn,Qn);Q&&Mt.associatedIconIndex>=0&&(ut[Mt.associatedIconIndex]={x:fn,y:Fn,z:gn,angle:Qn})}else Ri(Ot,Ye)}if(Q){Qe.clear();const yt=d.icon.placedSymbolArray;for(let Mt=0;Mt<yt.length;Mt++){const $t=yt.get(Mt),{numGlyphs:Wt}=$t,Ot=ut[Mt];if($t.hidden||!Ot)Ri(Wt,Qe);else{const{x:on,y:Zt,z:cn,angle:li}=Ot;for(let fn=0;fn<Wt;fn++)a.addDynamicAttributes(Qe,on,Zt,cn,li)}}d.icon.dynamicLayoutVertexBuffer.updateData(Qe)}d.text.dynamicLayoutVertexBuffer.updateData(Ye)}function Il(d,r,u){return u.iconsInText&&r?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function al(d,r,u,m,y,b,S,z,U,J,Q,we){const Ye=d.context,Qe=Ye.gl,ut=d.transform,it="map"===z,ft="map"===U,Ee=it&&"point"!==u.layout.get("symbol-placement"),qe=it&&!ft&&!Ee,yt=void 0!==u.layout.get("symbol-sort-key").constantOr(1);let Mt=!1;const $t=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),Wt=[a.mercatorXfromLng(ut.center.lng),a.mercatorYfromLat(ut.center.lat)],Ot=u.layout.get("text-variable-anchor"),on="globe"===ut.projection.name,Zt=[],cn=[0,-1,0];let li=cn;!on&&!ut.mercatorFromTransition||it||(li=function(fn){const Fn=fn._camera.getWorldToCamera(fn.worldSize,1),gn=a.multiply([],Fn,fn.globeMatrix);a.invert(gn,gn);const ai=[0,0,0],vn=[0,1,0,0];return a.transformMat4$1(vn,vn,gn),ai[0]=vn[0],ai[1]=vn[1],ai[2]=vn[2],a.normalize(ai,ai),ai}(ut));for(const fn of m){const Fn=r.getTile(fn),gn=Fn.getBucket(u);if(!gn||"mercator"===gn.projection.name&&on)continue;const ai=y?gn.text:gn.icon;if(!ai||gn.fullyClipped||!ai.segments.get().length)continue;const vn=ai.programConfigurations.get(u.id),Hn=y||gn.sdfIcons,ri=y?gn.textSizeData:gn.iconSizeData,Qn=ft||0!==ut.pitch,fi=a.evaluateSizeForZoom(ri,ut.zoom);let tr,wr,Vi,or,Ur=[0,0],Zr=null;if(y)wr=Fn.glyphAtlasTexture,Vi=Qe.LINEAR,tr=Fn.glyphAtlasTexture.size,gn.iconsInText&&(Ur=Fn.imageAtlasTexture.size,Zr=Fn.imageAtlasTexture,or=Qn||d.options.rotating||d.options.zooming||"composite"===ri.kind||"camera"===ri.kind?Qe.LINEAR:Qe.NEAREST);else{const v=1!==u.layout.get("icon-size").constantOr(0)||gn.iconsNeedLinear;wr=Fn.imageAtlasTexture,Vi=Hn||d.options.rotating||d.options.zooming||v||Qn?Qe.LINEAR:Qe.NEAREST,tr=Fn.imageAtlasTexture.size}const Qi="globe"===gn.projection.name,Wi=Qi?li:cn,Vo=Qi?a.globeToMercatorTransition(ut.zoom):0,es=Ji(fn,gn.getProjection(),ut),Co=ut.calculatePixelsToTileUnitsMatrix(Fn),Ya=ht(es,Fn.tileID.canonical,ft,it,ut,gn.getProjection(),Co),Ma=d.terrain&&ft&&Ee?a.invert(a.create(),Ya):cs,bl=Xn(es,Fn.tileID.canonical,ft,it,ut,gn.getProjection(),Co),tl=Ot&&gn.hasTextData(),ds="none"!==u.layout.get("icon-text-fit")&&tl&&gn.hasIconData();if(Ee){const v=ut.elevation,D=v?v.getAtTileOffsetFunc(fn,ut.center.lat,ut.worldSize,gn.getProjection()):null,F=xn(es,Fn.tileID.canonical,ft,it,ut,gn.getProjection(),Co);no(gn,es,d,y,F,bl,ft,J,D,fn)}const Ko=Ee||y&&Ot||ds,Mo=d.translatePosMatrix(es,Fn,b,S),js=Ko?cs:Ya,Ys=d.translatePosMatrix(bl,Fn,b,S,!0),Mn=gn.getProjection().createInversionMatrix(ut,fn.canonical),Vr=[];d.terrainRenderModeElevated()&&ft&&Vr.push("PITCH_WITH_MAP_TERRAIN"),Qi&&Vr.push("PROJECTION_GLOBE_VIEW"),Ko&&Vr.push("PROJECTED_POS_ON_VIEWPORT");const nu=Hn&&0!==u.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1);let gc;gc=Hn?gn.iconsInText?zl(ri.kind,fi,qe,ft,d,Mo,js,Ys,tr,Ur,fn,Vo,Wt,Mn,Wi,gn.getProjection()):Ha(ri.kind,fi,qe,ft,d,Mo,js,Ys,y,tr,!0,fn,Vo,Wt,Mn,Wi,gn.getProjection()):Ul(ri.kind,fi,qe,ft,d,Mo,js,Ys,y,tr,fn,Vo,Wt,Mn,Wi,gn.getProjection());const So={program:d.useProgram(Il(Hn,y,gn),vn,Vr),buffers:ai,uniformValues:gc,atlasTexture:wr,atlasTextureIcon:Zr,atlasInterpolation:Vi,atlasInterpolationIcon:or,isSDF:Hn,hasHalo:nu,tile:Fn,labelPlaneMatrixInv:Ma};if(yt&&gn.canOverlap){Mt=!0;const v=ai.segments.get();for(const D of v)Zt.push({segments:new a.SegmentVector([D]),sortKey:D.sortKey,state:So})}else Zt.push({segments:ai.segments,sortKey:0,state:So})}Mt&&Zt.sort((fn,Fn)=>fn.sortKey-Fn.sortKey);for(const fn of Zt){const Fn=fn.state;if(d.terrain&&d.terrain.setupElevationDraw(Fn.tile,Fn.program,{useDepthForOcclusion:!on,labelPlaneMatrixInv:Fn.labelPlaneMatrixInv}),Ye.activeTexture.set(Qe.TEXTURE0),Fn.atlasTexture.bind(Fn.atlasInterpolation,Qe.CLAMP_TO_EDGE),Fn.atlasTextureIcon&&(Ye.activeTexture.set(Qe.TEXTURE1),Fn.atlasTextureIcon&&Fn.atlasTextureIcon.bind(Fn.atlasInterpolationIcon,Qe.CLAMP_TO_EDGE)),Fn.isSDF){const gn=Fn.uniformValues;Fn.hasHalo&&(gn.u_is_halo=1,bs(Fn.buffers,fn.segments,u,d,Fn.program,$t,Q,we,gn)),gn.u_is_halo=0}bs(Fn.buffers,fn.segments,u,d,Fn.program,$t,Q,we,Fn.uniformValues)}}function bs(d,r,u,m,y,b,S,z,U){const J=m.context,Q=[d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer,d.globeExtVertexBuffer];y.draw(J,J.gl.TRIANGLES,b,S,z,a.CullFaceMode.disabled,U,u.id,d.layoutVertexBuffer,d.indexBuffer,r,u.paint,m.transform.zoom,d.programConfigurations.get(u.id),Q)}function kl(d,r,u,m,y,b,S){const z=d.context.gl,U=u.paint.get("fill-pattern"),J=U&&U.constantOr(1);let Q,we,Ye,Qe,ut;S?(we=J&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Q=z.LINES):(we=J?"fillPattern":"fill",Q=z.TRIANGLES);for(const it of m){const ft=r.getTile(it);if(J&&!ft.patternsLoaded())continue;const Ee=ft.getBucket(u);if(!Ee)continue;d.prepareDrawTile();const qe=Ee.programConfigurations.get(u.id),yt=d.useProgram(we,qe);J&&(d.context.activeTexture.set(z.TEXTURE0),ft.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),qe.updatePaintBuffers());const Mt=U.constantOr(null);if(Mt&&ft.imageAtlas){const Wt=ft.imageAtlas.patternPositions[Mt.toString()];Wt&&qe.setConstantPatternPositions(Wt)}const $t=d.translatePosMatrix(it.projMatrix,ft,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(S){Qe=Ee.indexBuffer2,ut=Ee.segments2;const Wt=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[z.drawingBufferWidth,z.drawingBufferHeight];Ye="fillOutlinePattern"===we&&J?vl($t,d,ft,Wt):sl($t,Wt)}else Qe=Ee.indexBuffer,ut=Ee.segments,Ye=J?Pl($t,d,ft):Os($t);d.prepareDrawProgram(d.context,yt,it.toUnwrapped()),yt.draw(d.context,Q,y,d.stencilModeForClipping(it),b,a.CullFaceMode.disabled,Ye,u.id,Ee.layoutVertexBuffer,Qe,ut,u.paint,d.transform.zoom,qe)}}function za(d,r,u,m,y,b,S){const z=d.context,U=z.gl,J=d.transform,Q=u.paint.get("fill-extrusion-pattern"),we=Q.constantOr(1),Ye=u.paint.get("fill-extrusion-opacity"),Qe=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),u.paint.get("fill-extrusion-ambient-occlusion-radius")],ut=u.layout.get("fill-extrusion-edge-radius"),it=ut>0&&!u.paint.get("fill-extrusion-rounded-roof"),ft=it?0:ut,Ee="globe"===J.projection.name?a.fillExtrusionHeightLift():0,qe="globe"===J.projection.name,yt=qe?a.globeToMercatorTransition(J.zoom):0,Mt=[a.mercatorXfromLng(J.center.lng),a.mercatorYfromLat(J.center.lat)],$t=[];qe&&$t.push("PROJECTION_GLOBE_VIEW"),Qe[0]>0&&$t.push("FAUX_AO"),it&&$t.push("ZERO_ROOF_RADIUS");for(const Wt of m){const Ot=r.getTile(Wt),on=Ot.getBucket(u);if(!on||on.projection.name!==J.projection.name)continue;const Zt=on.programConfigurations.get(u.id),cn=d.useProgram(we?"fillExtrusionPattern":"fillExtrusion",Zt,$t);if(d.terrain){const Hn=d.terrain;if(d.style.terrainSetForDrapingOnly())Hn.setupElevationDraw(Ot,cn,{useMeterToDem:!0});else{if(!on.enableTerrain)continue;if(Hn.setupElevationDraw(Ot,cn,{useMeterToDem:!0}),_l(z,r,Wt,on,u,Hn),!on.centroidVertexBuffer){const ri=cn.attributes.a_centroid_pos;void 0!==ri&&U.vertexAttrib2f(ri,0,0)}}}we&&(d.context.activeTexture.set(U.TEXTURE0),Ot.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Zt.updatePaintBuffers());const li=Q.constantOr(null);if(li&&Ot.imageAtlas){const Hn=Ot.imageAtlas.patternPositions[li.toString()];Hn&&Zt.setConstantPatternPositions(Hn)}const fn=d.translatePosMatrix(Wt.projMatrix,Ot,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Fn=J.projection.createInversionMatrix(J,Wt.canonical),gn=u.paint.get("fill-extrusion-vertical-gradient"),ai=we?xa(fn,d,gn,Ye,Qe,ft,Wt,Ot,Ee,yt,Mt,Fn):ua(fn,d,gn,Ye,Qe,ft,Wt,Ee,yt,Mt,Fn);d.prepareDrawProgram(z,cn,Wt.toUnwrapped());const vn=[];d.terrain&&vn.push(on.centroidVertexBuffer),qe&&vn.push(on.layoutVertexExtBuffer),cn.draw(z,z.gl.TRIANGLES,y,b,S,a.CullFaceMode.backCCW,ai,u.id,on.layoutVertexBuffer,on.indexBuffer,on.segments,u.paint,d.transform.zoom,Zt,vn)}}function _l(d,r,u,m,y,b){const S=[Ee=>{let qe=Ee.canonical.x-1,yt=Ee.wrap;return qe<0&&(qe=(1<<Ee.canonical.z)-1,yt--),new a.OverscaledTileID(Ee.overscaledZ,yt,Ee.canonical.z,qe,Ee.canonical.y)},Ee=>{let qe=Ee.canonical.x+1,yt=Ee.wrap;return qe===1<<Ee.canonical.z&&(qe=0,yt++),new a.OverscaledTileID(Ee.overscaledZ,yt,Ee.canonical.z,qe,Ee.canonical.y)},Ee=>new a.OverscaledTileID(Ee.overscaledZ,Ee.wrap,Ee.canonical.z,Ee.canonical.x,(0===Ee.canonical.y?1<<Ee.canonical.z:Ee.canonical.y)-1),Ee=>new a.OverscaledTileID(Ee.overscaledZ,Ee.wrap,Ee.canonical.z,Ee.canonical.x,Ee.canonical.y===(1<<Ee.canonical.z)-1?0:Ee.canonical.y+1)],z=Ee=>{const qe=r.getSource().minzoom,yt=$t=>{const Wt=r.getTileByID($t);if(Wt&&Wt.hasData())return Wt.getBucket(y)},Mt=[0,-1,1];for(const $t of Mt){if(Ee.overscaledZ+$t<qe)continue;const Wt=yt(Ee.calculateScaledKey(Ee.overscaledZ+$t));if(Wt)return Wt}},U=[0,0,0],J=(Ee,qe)=>(U[0]=Math.min(Ee.min.y,qe.min.y),U[1]=Math.max(Ee.max.y,qe.max.y),U[2]=a.EXTENT-qe.min.x>Ee.max.x?qe.min.x-a.EXTENT:Ee.max.x,U),Q=(Ee,qe)=>(U[0]=Math.min(Ee.min.x,qe.min.x),U[1]=Math.max(Ee.max.x,qe.max.x),U[2]=a.EXTENT-qe.min.y>Ee.max.y?qe.min.y-a.EXTENT:Ee.max.y,U),we=[(Ee,qe)=>J(Ee,qe),(Ee,qe)=>J(qe,Ee),(Ee,qe)=>Q(Ee,qe),(Ee,qe)=>Q(qe,Ee)],Ye=new a.Point(0,0);let Qe,ut,it;const ft=(Ee,qe,yt,Mt,$t)=>{const Wt=[[Mt?yt:Ee,Mt?Ee:yt,0],[Mt?yt:qe,Mt?qe:yt,0]],Ot=$t<0?a.EXTENT+$t:$t,on=[Mt?Ot:(Ee+qe)/2,Mt?(Ee+qe)/2:Ot,0];return 0===yt&&$t<0||0!==yt&&$t>0?b.getForTilePoints(it,[on],!0,ut):Wt.push(on),b.getForTilePoints(u,Wt,!0,Qe),Math.max(Wt[0][2],Wt[1][2],on[2])/b.exaggeration()};for(let Ee=0;Ee<4;Ee++){const qe=(Ee<2?1:5)-Ee,yt=m.borders[Ee];if(0===yt.length)continue;const Mt=it=S[Ee](u),$t=z(Mt);if(!($t&&$t instanceof a.FillExtrusionBucket&&$t.enableTerrain)||m.borderDoneWithNeighborZ[Ee]===$t.canonical.z&&$t.borderDoneWithNeighborZ[qe]===m.canonical.z||(ut=b.findDEMTileFor(Mt),!ut||!ut.dem))continue;if(!Qe){const Zt=b.findDEMTileFor(u);if(!Zt||!Zt.dem)return;Qe=Zt}const Wt=$t.borders[qe];let Ot=0;const on=$t.borderDoneWithNeighborZ[qe]!==m.canonical.z;if(m.canonical.z===$t.canonical.z){for(let Zt=0;Zt<yt.length;Zt++){const cn=m.featuresOnBorder[yt[Zt]],li=cn.borders[Ee];let fn;for(;Ot<Wt.length&&(fn=$t.featuresOnBorder[Wt[Ot]],!(fn.borders[qe][1]>li[0]+3));)on&&$t.encodeCentroid(void 0,fn,!1),Ot++;if(fn&&Ot<Wt.length){const Fn=Ot;let gn=0;for(;!(fn.borders[qe][0]>li[1]-3)&&(gn++,++Ot!==Wt.length);)fn=$t.featuresOnBorder[Wt[Ot]];if(fn=$t.featuresOnBorder[Wt[Fn]],cn.intersectsCount()>1||fn.intersectsCount()>1||1!==gn){1!==gn&&(Ot=Fn),m.encodeCentroid(void 0,cn,!1),on&&$t.encodeCentroid(void 0,fn,!1);continue}const ai=we[Ee](cn,fn),vn=Ee%2?a.EXTENT-1:0;Ye.x=ft(ai[0],Math.min(a.EXTENT-1,ai[1]),vn,Ee<2,ai[2]),Ye.y=0,m.encodeCentroid(Ye,cn,!1),on&&$t.encodeCentroid(Ye,fn,!1)}else m.encodeCentroid(void 0,cn,!1)}m.borderDoneWithNeighborZ[Ee]=$t.canonical.z,m.needsCentroidUpdate=!0,on&&($t.borderDoneWithNeighborZ[qe]=m.canonical.z,$t.needsCentroidUpdate=!0)}else{for(const Zt of yt)m.encodeCentroid(void 0,m.featuresOnBorder[Zt],!1);if(on){for(const Zt of Wt)$t.encodeCentroid(void 0,$t.featuresOnBorder[Zt],!1);$t.borderDoneWithNeighborZ[qe]=m.canonical.z,$t.needsCentroidUpdate=!0}m.borderDoneWithNeighborZ[Ee]=$t.canonical.z,m.needsCentroidUpdate=!0}}(m.needsCentroidUpdate||!m.centroidVertexBuffer&&0!==m.centroidVertexArray.length)&&m.uploadCentroid(d)}const Ls=new a.Color(1,0,0,1),yl=new a.Color(0,1,0,1),Ia=new a.Color(0,0,1,1),Ne=new a.Color(1,0,1,1),N=new a.Color(0,1,1,1);function V(d,r,u){const m=d.context,y=d.transform,b=m.gl,S="globe"===y.projection.name,z=S?["PROJECTION_GLOBE_VIEW"]:null;let U=u.projMatrix;if(S&&a.globeToMercatorTransition(y.zoom)>0){const cn=a.transitionTileAABBinECEF(u.canonical,y),li=a.globeDenormalizeECEF(cn);U=a.multiply(new Float32Array(16),y.globeMatrix,li),a.multiply(U,y.projMatrix,U)}const J=d.useProgram("debug",null,z),Q=r.getTileByID(u.key);d.terrain&&d.terrain.setupElevationDraw(Q,J);const we=a.DepthMode.disabled,Ye=a.StencilMode.disabled,Qe=d.colorModeForRenderPass();m.activeTexture.set(b.TEXTURE0),d.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),S?Q._makeGlobeTileDebugBuffers(d.context,y):Q._makeDebugTileBoundsBuffers(d.context,y.projection);const it=Q._tileDebugBuffer||d.debugBuffer,ft=Q._tileDebugIndexBuffer||d.debugIndexBuffer,Ee=Q._tileDebugSegments||d.debugSegments;J.draw(m,b.LINE_STRIP,we,Ye,Qe,a.CullFaceMode.disabled,Ht(U,a.Color.red),"$debug",it,ft,Ee,null,null,null,[Q._globeTileDebugBorderBuffer]);const qe=Q.latestRawTileData,yt=Math.floor((qe&&qe.byteLength||0)/1024),Mt=r.getTile(u).tileSize,$t=512/Math.min(Mt,512)*(u.overscaledZ/y.zoom)*.5;let Wt=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(Wt+=` => ${u.overscaledZ}`),Wt+=` ${yt}kb`,function(cn,li){cn.initDebugOverlayCanvas();const fn=cn.debugOverlayCanvas,Fn=cn.context.gl,gn=cn.debugOverlayCanvas.getContext("2d");gn.clearRect(0,0,fn.width,fn.height),gn.shadowColor="white",gn.shadowBlur=2,gn.lineWidth=1.5,gn.strokeStyle="white",gn.textBaseline="top",gn.font="bold 36px Open Sans, sans-serif",gn.fillText(li,5,5),gn.strokeText(li,5,5),cn.debugOverlayTexture.update(fn),cn.debugOverlayTexture.bind(Fn.LINEAR,Fn.CLAMP_TO_EDGE)}(d,Wt);const Ot=Q._tileDebugTextBuffer||d.debugBuffer,on=Q._tileDebugTextIndexBuffer||d.quadTriangleIndexBuffer,Zt=Q._tileDebugTextSegments||d.debugSegments;J.draw(m,b.TRIANGLES,we,Ye,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,Ht(U,a.Color.transparent,$t),"$debug",Ot,on,Zt,null,null,null,[Q._globeTileDebugTextBuffer])}function te(d,r,u,m){ot(d,0,r+u/2,d.transform.width,u,m)}function Le(d,r,u,m){ot(d,r-u/2,0,u,d.transform.height,m)}function ot(d,r,u,m,y,b){const S=d.context,z=S.gl;z.enable(z.SCISSOR_TEST),z.scissor(r*a.exported.devicePixelRatio,u*a.exported.devicePixelRatio,m*a.exported.devicePixelRatio,y*a.exported.devicePixelRatio),S.clear({color:b}),z.disable(z.SCISSOR_TEST)}const Lt=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Kt}=Lt;function mn(d,r,u,m){d.emplaceBack(r,u,m)}class Pn{constructor(r){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,mn(this.vertexArray,-1,-1,1),mn(this.vertexArray,1,-1,1),mn(this.vertexArray,-1,1,1),mn(this.vertexArray,1,1,1),mn(this.vertexArray,-1,-1,-1),mn(this.vertexArray,1,-1,-1),mn(this.vertexArray,-1,1,-1),mn(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,Kt),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function Pi(d,r,u,m,y,b){const S=d.gl,z=r.paint.get("sky-atmosphere-color"),U=r.paint.get("sky-atmosphere-halo-color"),J=r.paint.get("sky-atmosphere-sun-intensity"),Q={u_matrix_3f:a.fromMat4(a.create$1(),m),u_sun_direction:y,u_sun_intensity:J,u_color_tint_r:[(ut=z).r,ut.g,ut.b,ut.a],u_color_tint_m:[(it=U).r,it.g,it.b,it.a],u_luminance:5e-5};var ut,it;S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+b,r.skyboxTexture,0),u.draw(d,S.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,Q,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const Yi=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class $r{constructor(r){const u=new a.StructArrayLayout5f20;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const m=new a.StructArrayLayout3ui6;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(u,Yi.members),this.indexBuffer=r.createIndexBuffer(m),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const cr={symbol:function(d,r,u,m,y){if("translucent"!==d.renderPass)return;const b=a.StencilMode.disabled,S=d.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(z,U,J,Q,we,Ye,Qe){const ut=U.transform,it="map"===we,ft="map"===Ye;for(const Ee of z){const qe=Q.getTile(Ee),yt=qe.getBucket(J);if(!yt||!yt.text||!yt.text.segments.get().length)continue;const Mt=a.evaluateSizeForZoom(yt.textSizeData,ut.zoom),$t=Ji(Ee,yt.getProjection(),ut),Wt=ut.calculatePixelsToTileUnitsMatrix(qe),Ot=ht($t,qe.tileID.canonical,ft,it,ut,yt.getProjection(),Wt),on="none"!==J.layout.get("icon-text-fit")&&yt.hasIconData();if(Mt){const Zt=Math.pow(2,ut.zoom-qe.tileID.overscaledZ);Zl(yt,it,ft,Qe,a.symbolSize,ut,Ot,Ee,Zt,Mt,on)}}}(m,d,u,r,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),y),0!==u.paint.get("icon-opacity").constantOr(1)&&al(d,r,u,m,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),b,S),0!==u.paint.get("text-opacity").constantOr(1)&&al(d,r,u,m,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),b,S),r.map.showCollisionBoxes&&(Ro(d,r,u,m,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Ro(d,r,u,m,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(d,r,u,m){if("translucent"!==d.renderPass)return;const y=u.paint.get("circle-opacity"),b=u.paint.get("circle-stroke-width"),S=u.paint.get("circle-stroke-opacity"),z=void 0!==u.layout.get("circle-sort-key").constantOr(1);if(0===y.constantOr(1)&&(0===b.constantOr(1)||0===S.constantOr(1)))return;const U=d.context,J=U.gl,Q=d.transform,we=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),Ye=a.StencilMode.disabled,Qe=d.colorModeForRenderPass(),ut="globe"===Q.projection.name,it=[a.mercatorXfromLng(Q.center.lng),a.mercatorYfromLat(Q.center.lat)],ft=[];for(let qe=0;qe<m.length;qe++){const yt=m[qe],Mt=r.getTile(yt),$t=Mt.getBucket(u);if(!$t||$t.projection.name!==Q.projection.name)continue;const Wt=$t.programConfigurations.get(u.id),Ot=K(u);ut&&Ot.push("PROJECTION_GLOBE_VIEW");const on=d.useProgram("circle",Wt,Ot),Zt=$t.layoutVertexBuffer,cn=$t.globeExtVertexBuffer,li=$t.indexBuffer,fn=Q.projection.createInversionMatrix(Q,yt.canonical),Fn={programConfiguration:Wt,program:on,layoutVertexBuffer:Zt,globeExtVertexBuffer:cn,indexBuffer:li,uniformValues:Ae(d,yt,Mt,fn,it,u),tile:Mt};if(z){const gn=$t.segments.get();for(const ai of gn)ft.push({segments:new a.SegmentVector([ai]),sortKey:ai.sortKey,state:Fn})}else ft.push({segments:$t.segments,sortKey:0,state:Fn})}z&&ft.sort((qe,yt)=>qe.sortKey-yt.sortKey);const Ee={useDepthForOcclusion:!ut};for(const qe of ft){const{programConfiguration:yt,program:Mt,layoutVertexBuffer:$t,globeExtVertexBuffer:Wt,indexBuffer:Ot,uniformValues:on,tile:Zt}=qe.state,cn=qe.segments;d.terrain&&d.terrain.setupElevationDraw(Zt,Mt,Ee),d.prepareDrawProgram(U,Mt,Zt.tileID.toUnwrapped()),Mt.draw(U,J.TRIANGLES,we,Ye,Qe,a.CullFaceMode.disabled,on,u.id,$t,Ot,cn,u.paint,Q.zoom,yt,[Wt])}},heatmap:function(d,r,u,m){if(0!==u.paint.get("heatmap-opacity"))if("offscreen"===d.renderPass){const y=d.context,b=y.gl,S=a.StencilMode.disabled,z=new a.ColorMode([b.ONE,b.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(Qe,ut,it,ft){const Ee=Qe.gl,qe=ut.width*ft,yt=ut.height*ft;Qe.activeTexture.set(Ee.TEXTURE1),Qe.viewport.set([0,0,qe,yt]);let Mt=it.heatmapFbo;if(!Mt||Mt&&(Mt.width!==qe||Mt.height!==yt)){Mt&&Mt.destroy();const $t=Ee.createTexture();Ee.bindTexture(Ee.TEXTURE_2D,$t),Ee.texParameteri(Ee.TEXTURE_2D,Ee.TEXTURE_WRAP_S,Ee.CLAMP_TO_EDGE),Ee.texParameteri(Ee.TEXTURE_2D,Ee.TEXTURE_WRAP_T,Ee.CLAMP_TO_EDGE),Ee.texParameteri(Ee.TEXTURE_2D,Ee.TEXTURE_MIN_FILTER,Ee.LINEAR),Ee.texParameteri(Ee.TEXTURE_2D,Ee.TEXTURE_MAG_FILTER,Ee.LINEAR),Mt=it.heatmapFbo=Qe.createFramebuffer(qe,yt,!1),function(Wt,Ot,on,Zt,cn,li){const fn=Wt.gl;fn.texImage2D(fn.TEXTURE_2D,0,Wt.isWebGL2&&Wt.extRenderToTextureHalfFloat?fn.RGBA16F:fn.RGBA,cn,li,0,fn.RGBA,Wt.extRenderToTextureHalfFloat?Wt.isWebGL2?fn.HALF_FLOAT:Wt.extTextureHalfFloat.HALF_FLOAT_OES:fn.UNSIGNED_BYTE,null),Zt.colorAttachment.set(on)}(Qe,0,$t,Mt,qe,yt)}else Ee.bindTexture(Ee.TEXTURE_2D,Mt.colorAttachment.get()),Qe.bindFramebuffer.set(Mt.framebuffer)})(y,d,u,"globe"===d.transform.projection.name?.5:.25),y.clear({color:a.Color.transparent});const U=d.transform,J="globe"===U.projection.name,Q=J?["PROJECTION_GLOBE_VIEW"]:null,we=J?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,Ye=[a.mercatorXfromLng(U.center.lng),a.mercatorYfromLat(U.center.lat)];for(let Qe=0;Qe<m.length;Qe++){const ut=m[Qe];if(r.hasRenderableParent(ut))continue;const it=r.getTile(ut),ft=it.getBucket(u);if(!ft||ft.projection.name!==U.projection.name)continue;const Ee=ft.programConfigurations.get(u.id),qe=d.useProgram("heatmap",Ee,Q),{zoom:yt}=d.transform;d.terrain&&d.terrain.setupElevationDraw(it,qe),d.prepareDrawProgram(y,qe,ut.toUnwrapped());const Mt=U.projection.createInversionMatrix(U,ut.canonical);qe.draw(y,b.TRIANGLES,a.DepthMode.disabled,S,z,we,Sr(d,ut,it,Mt,Ye,yt,u.paint.get("heatmap-intensity")),u.id,ft.layoutVertexBuffer,ft.indexBuffer,ft.segments,u.paint,d.transform.zoom,Ee,J?[ft.globeExtVertexBuffer]:null)}y.viewport.set([0,0,d.width,d.height])}else"translucent"===d.renderPass&&(d.context.setColorMode(d.colorModeForRenderPass()),function(y,b){const S=y.context,z=S.gl,U=b.heatmapFbo;if(!U)return;S.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,U.colorAttachment.get()),S.activeTexture.set(z.TEXTURE1);let J=b.colorRampTexture;J||(J=b.colorRampTexture=new a.Texture(S,b.colorRamp,z.RGBA)),J.bind(z.LINEAR,z.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(S,z.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,y.colorModeForRenderPass(),a.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:b.paint.get("heatmap-opacity")},b.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,b.paint,y.transform.zoom)}(d,u))},line:function(d,r,u,m){if("translucent"!==d.renderPass)return;const y=u.paint.get("line-opacity"),b=u.paint.get("line-width");if(0===y.constantOr(1)||0===b.constantOr(1))return;const S=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),z=d.colorModeForRenderPass(),U=d.terrain&&d.terrain.renderingToTexture?1:a.exported.devicePixelRatio,J=u.paint.get("line-dasharray"),Q=J.constantOr(1),we=u.layout.get("line-cap"),Ye=u.paint.get("line-pattern"),Qe=Ye.constantOr(1),ut=u.paint.get("line-gradient"),it=Qe?"linePattern":"line",ft=d.context,Ee=ft.gl,qe=(Mt=>{const $t=[];Us(Mt)&&$t.push("RENDER_LINE_DASH"),Mt.paint.get("line-gradient")&&$t.push("RENDER_LINE_GRADIENT");const Wt=Mt.paint.get("line-trim-offset");0===Wt[0]&&0===Wt[1]||$t.push("RENDER_LINE_TRIM_OFFSET");const Ot=Mt.paint.get("line-pattern").constantOr(1),on=1!==Mt.paint.get("line-opacity").constantOr(1);return!Ot&&on&&$t.push("RENDER_LINE_ALPHA_DISCARD"),$t})(u);let yt=qe.includes("RENDER_LINE_ALPHA_DISCARD");d.terrain&&d.terrain.clipOrMaskOverlapStencilType()&&(yt=!1);for(const Mt of m){const $t=r.getTile(Mt);if(Qe&&!$t.patternsLoaded())continue;const Wt=$t.getBucket(u);if(!Wt)continue;d.prepareDrawTile();const Ot=Wt.programConfigurations.get(u.id),on=d.useProgram(it,Ot,qe),Zt=Ye.constantOr(null);if(Zt&&$t.imageAtlas){const Hn=$t.imageAtlas.patternPositions[Zt.toString()];Hn&&Ot.setConstantPatternPositions(Hn)}const cn=J.constantOr(null),li=we.constantOr(null);if(!Qe&&cn&&li&&$t.lineAtlas){const Hn=$t.lineAtlas.getDash(cn,li);Hn&&Ot.setConstantPatternPositions(Hn)}let[fn,Fn]=u.paint.get("line-trim-offset");("round"===li||"square"===li)&&fn!==Fn&&(0===fn&&(fn-=1),1===Fn&&(Fn+=1));const gn=d.terrain?Mt.projMatrix:null,ai=Qe?ea(d,$t,u,gn,U):Yr(d,$t,u,gn,Wt.lineClipsArray.length,U,[fn,Fn]);if(ut){const Hn=Wt.gradients[u.id];let ri=Hn.texture;if(u.gradientVersion!==Hn.version){let Qn=256;if(u.stepInterpolant){const fi=r.getSource().maxzoom,tr=Mt.canonical.z===fi?Math.ceil(1<<d.transform.maxZoom-Mt.canonical.z):1;Qn=a.clamp(a.nextPowerOfTwo(Wt.maxLineLength/a.EXTENT*1024*tr),256,ft.maxTextureSize)}Hn.gradient=a.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:Qn,image:Hn.gradient||void 0,clips:Wt.lineClipsArray}),Hn.texture?Hn.texture.update(Hn.gradient):Hn.texture=new a.Texture(ft,Hn.gradient,Ee.RGBA),Hn.version=u.gradientVersion,ri=Hn.texture}ft.activeTexture.set(Ee.TEXTURE1),ri.bind(u.stepInterpolant?Ee.NEAREST:Ee.LINEAR,Ee.CLAMP_TO_EDGE)}Q&&(ft.activeTexture.set(Ee.TEXTURE0),$t.lineAtlasTexture.bind(Ee.LINEAR,Ee.REPEAT),Ot.updatePaintBuffers()),Qe&&(ft.activeTexture.set(Ee.TEXTURE0),$t.imageAtlasTexture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE),Ot.updatePaintBuffers()),d.prepareDrawProgram(ft,on,Mt.toUnwrapped());const vn=Hn=>{on.draw(ft,Ee.TRIANGLES,S,Hn,z,a.CullFaceMode.disabled,ai,u.id,Wt.layoutVertexBuffer,Wt.indexBuffer,Wt.segments,u.paint,d.transform.zoom,Ot,[Wt.layoutVertexBuffer2])};if(yt){const Hn=d.stencilModeForClipping(Mt).ref;0===Hn&&d.terrain&&ft.clear({stencil:0});const ri={func:Ee.EQUAL,mask:255};ai.u_alpha_discard_threshold=.8,vn(new a.StencilMode(ri,Hn,255,Ee.KEEP,Ee.KEEP,Ee.INVERT)),ai.u_alpha_discard_threshold=0,vn(new a.StencilMode(ri,Hn,255,Ee.KEEP,Ee.KEEP,Ee.KEEP))}else vn(d.stencilModeForClipping(Mt))}yt&&(d.resetStencilClippingMasks(),d.terrain&&ft.clear({stencil:0}))},fill:function(d,r,u,m){const y=u.paint.get("fill-color"),b=u.paint.get("fill-opacity");if(0===b.constantOr(1))return;const S=d.colorModeForRenderPass(),z=u.paint.get("fill-pattern"),U=d.opaquePassEnabledForLayer()&&!z.constantOr(1)&&1===y.constantOr(a.Color.transparent).a&&1===b.constantOr(0)?"opaque":"translucent";if(d.renderPass===U){const J=d.depthModeForSublayer(1,"opaque"===d.renderPass?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);kl(d,r,u,m,J,S,!1)}if("translucent"===d.renderPass&&u.paint.get("fill-antialias")){const J=d.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);kl(d,r,u,m,J,S,!0)}},"fill-extrusion":function(d,r,u,m){const y=u.paint.get("fill-extrusion-opacity");if(0!==y&&"translucent"===d.renderPass){const b=new a.DepthMode(d.context.gl.LEQUAL,a.DepthMode.ReadWrite,d.depthRangeFor3D);if(1!==y||u.paint.get("fill-extrusion-pattern").constantOr(1))za(d,r,u,m,b,a.StencilMode.disabled,a.ColorMode.disabled),za(d,r,u,m,b,d.stencilModeFor3D(),d.colorModeForRenderPass()),d.resetStencilClippingMasks();else{const S=d.colorModeForRenderPass();za(d,r,u,m,b,a.StencilMode.disabled,S)}}},hillshade:function(d,r,u,m){if("offscreen"!==d.renderPass&&"translucent"!==d.renderPass)return;const y=d.context,b=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),S=d.colorModeForRenderPass(),z=d.terrain&&d.terrain.renderingToTexture,[U,J]="translucent"!==d.renderPass||z?[{},m]:d.stencilConfigForOverlap(m);for(const Q of J){const we=r.getTile(Q);if(we.needsHillshadePrepare&&"offscreen"===d.renderPass)Na(d,we,u,b,a.StencilMode.disabled,S);else if("translucent"===d.renderPass){const Ye=z&&d.terrain?d.terrain.stencilModeForRTTOverlap(Q):U[Q.overscaledZ];Xa(d,Q,we,u,b,Ye,S)}}y.viewport.set([0,0,d.width,d.height]),d.resetStencilClippingMasks()},raster:function(d,r,u,m,y,b){if("translucent"!==d.renderPass||0===u.paint.get("raster-opacity")||!m.length)return;const S=d.context,z=S.gl,U=r.getSource(),J=d.useProgram("raster"),Q=d.colorModeForRenderPass(),we=d.terrain&&d.terrain.renderingToTexture,[Ye,Qe]=U instanceof Pt||we?[{},m]:d.stencilConfigForOverlap(m),ut=Qe[Qe.length-1].overscaledZ,it=!d.options.moving;for(const ft of Qe){const Ee=we?a.DepthMode.disabled:d.depthModeForSublayer(ft.overscaledZ-ut,1===u.paint.get("raster-opacity")?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,z.LESS),qe=ft.toUnwrapped(),yt=r.getTile(ft);if(we&&(!yt||!yt.hasData()))continue;const Mt=we?ft.projMatrix:d.transform.calculateProjMatrix(qe,it),$t=d.terrain&&we?d.terrain.stencilModeForRTTOverlap(ft):Ye[ft.overscaledZ],Wt=b?0:u.paint.get("raster-fade-duration");yt.registerFadeDuration(Wt);const Ot=r.findLoadedParent(ft,0),on=Va(yt,Ot,r,d.transform,Wt);let Zt,cn;d.terrain&&d.terrain.prepareDrawTile();const li="nearest"===u.paint.get("raster-resampling")?z.NEAREST:z.LINEAR;S.activeTexture.set(z.TEXTURE0),yt.texture.bind(li,z.CLAMP_TO_EDGE),S.activeTexture.set(z.TEXTURE1),Ot?(Ot.texture.bind(li,z.CLAMP_TO_EDGE),Zt=Math.pow(2,Ot.tileID.overscaledZ-yt.tileID.overscaledZ),cn=[yt.tileID.canonical.x*Zt%1,yt.tileID.canonical.y*Zt%1]):yt.texture.bind(li,z.CLAMP_TO_EDGE),yt.texture.useMipmap&&S.extTextureFilterAnisotropic&&d.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,S.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,S.extTextureFilterAnisotropicMax);const fn=Bl(Mt,cn||[0,0],Zt||1,on,u,U instanceof Pt?U.perspectiveTransform:[0,0]);if(d.prepareDrawProgram(S,J,qe),U instanceof Pt)U.boundsBuffer&&U.boundsSegments&&J.draw(S,z.TRIANGLES,Ee,a.StencilMode.disabled,Q,a.CullFaceMode.disabled,fn,u.id,U.boundsBuffer,d.quadTriangleIndexBuffer,U.boundsSegments);else{const{tileBoundsBuffer:Fn,tileBoundsIndexBuffer:gn,tileBoundsSegments:ai}=d.getTileBoundsBuffers(yt);J.draw(S,z.TRIANGLES,Ee,$t,Q,a.CullFaceMode.disabled,fn,u.id,Fn,gn,ai)}}d.resetStencilClippingMasks()},background:function(d,r,u,m){const y=u.paint.get("background-color"),b=u.paint.get("background-opacity");if(0===b)return;const S=d.context,z=S.gl,U=d.transform,J=U.tileSize,Q=u.paint.get("background-pattern");if(d.isPatternMissing(Q))return;const we=!Q&&1===y.a&&1===b&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==we)return;const Ye=a.StencilMode.disabled,Qe=d.depthModeForSublayer(0,"opaque"===we?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),ut=d.colorModeForRenderPass(),it=d.useProgram(Q?"backgroundPattern":"background");let ft,Ee=m;Ee||(ft=d.getBackgroundTiles(),Ee=Object.values(ft).map(qe=>qe.tileID)),Q&&(S.activeTexture.set(z.TEXTURE0),d.imageManager.bind(d.context));for(const qe of Ee){const yt=qe.toUnwrapped(),Mt=m?qe.projMatrix:d.transform.calculateProjMatrix(yt);d.prepareDrawTile();const $t=r?r.getTile(qe):ft?ft[qe.key]:new a.Tile(qe,J,U.zoom,d),Wt=Q?nc(Mt,b,d,Q,{tileID:qe,tileSize:J}):el(Mt,b,y);d.prepareDrawProgram(S,it,yt);const{tileBoundsBuffer:Ot,tileBoundsIndexBuffer:on,tileBoundsSegments:Zt}=d.getTileBoundsBuffers($t);it.draw(S,z.TRIANGLES,Qe,Ye,ut,a.CullFaceMode.disabled,Wt,u.id,Ot,on,Zt)}},sky:function(d,r,u){const m=d.transform,y="mercator"===m.projection.name||"globe"===m.projection.name?1:a.smoothstep(7,8,m.zoom),b=u.paint.get("sky-opacity")*y;if(0===b)return;const S=d.context,z=u.paint.get("sky-type"),U=new a.DepthMode(S.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),J=d.frameCounter/1e3%1;"atmosphere"===z?"offscreen"===d.renderPass?u.needsSkyboxCapture(d)&&(function(Q,we,Ye,Qe){const ut=Q.context,it=ut.gl;let ft=we.skyboxFbo;if(!ft){ft=we.skyboxFbo=ut.createFramebuffer(32,32,!1),we.skyboxGeometry=new Pn(ut),we.skyboxTexture=ut.gl.createTexture(),it.bindTexture(it.TEXTURE_CUBE_MAP,we.skyboxTexture),it.texParameteri(it.TEXTURE_CUBE_MAP,it.TEXTURE_WRAP_S,it.CLAMP_TO_EDGE),it.texParameteri(it.TEXTURE_CUBE_MAP,it.TEXTURE_WRAP_T,it.CLAMP_TO_EDGE),it.texParameteri(it.TEXTURE_CUBE_MAP,it.TEXTURE_MIN_FILTER,it.LINEAR),it.texParameteri(it.TEXTURE_CUBE_MAP,it.TEXTURE_MAG_FILTER,it.LINEAR);for(let Mt=0;Mt<6;++Mt)it.texImage2D(it.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,0,it.RGBA,32,32,0,it.RGBA,it.UNSIGNED_BYTE,null)}ut.bindFramebuffer.set(ft.framebuffer),ut.viewport.set([0,0,32,32]);const Ee=we.getCenter(Q,!0),qe=Q.useProgram("skyboxCapture"),yt=new Float64Array(16);a.identity(yt),a.rotateY(yt,yt,.5*-Math.PI),Pi(ut,we,qe,yt,Ee,0),a.identity(yt),a.rotateY(yt,yt,.5*Math.PI),Pi(ut,we,qe,yt,Ee,1),a.identity(yt),a.rotateX(yt,yt,.5*-Math.PI),Pi(ut,we,qe,yt,Ee,2),a.identity(yt),a.rotateX(yt,yt,.5*Math.PI),Pi(ut,we,qe,yt,Ee,3),a.identity(yt),Pi(ut,we,qe,yt,Ee,4),a.identity(yt),a.rotateY(yt,yt,Math.PI),Pi(ut,we,qe,yt,Ee,5),ut.viewport.set([0,0,Q.width,Q.height])}(d,u),u.markSkyboxValid(d)):"sky"===d.renderPass&&function(Q,we,Ye,Qe,ut){const it=Q.context,ft=it.gl,Ee=Q.transform,qe=Q.useProgram("skybox");it.activeTexture.set(ft.TEXTURE0),ft.bindTexture(ft.TEXTURE_CUBE_MAP,we.skyboxTexture);const yt=((Mt,$t,Wt,Ot,on)=>({u_matrix:Mt,u_sun_direction:$t,u_cubemap:0,u_opacity:Ot,u_temporal_offset:on}))(Ee.skyboxMatrix,we.getCenter(Q,!1),0,Qe,ut);Q.prepareDrawProgram(it,qe),qe.draw(it,ft.TRIANGLES,Ye,a.StencilMode.disabled,Q.colorModeForRenderPass(),a.CullFaceMode.backCW,yt,"skybox",we.skyboxGeometry.vertexBuffer,we.skyboxGeometry.indexBuffer,we.skyboxGeometry.segment)}(d,u,U,b,J):"gradient"===z&&"sky"===d.renderPass&&function(Q,we,Ye,Qe,ut){const it=Q.context,ft=it.gl,Ee=Q.transform,qe=Q.useProgram("skyboxGradient");we.skyboxGeometry||(we.skyboxGeometry=new Pn(it)),it.activeTexture.set(ft.TEXTURE0);let yt=we.colorRampTexture;yt||(yt=we.colorRampTexture=new a.Texture(it,we.colorRamp,ft.RGBA)),yt.bind(ft.LINEAR,ft.CLAMP_TO_EDGE);const Mt=($t=Ee.skyboxMatrix,Wt=we.getCenter(Q,!1),Ot=we.paint.get("sky-gradient-radius"),on=Qe,Zt=ut,{u_matrix:$t,u_color_ramp:0,u_center_direction:Wt,u_radius:a.degToRad(Ot),u_opacity:on,u_temporal_offset:Zt});var $t,Wt,Ot,on,Zt;Q.prepareDrawProgram(it,qe),qe.draw(it,ft.TRIANGLES,Ye,a.StencilMode.disabled,Q.colorModeForRenderPass(),a.CullFaceMode.backCW,Mt,"skyboxGradient",we.skyboxGeometry.vertexBuffer,we.skyboxGeometry.indexBuffer,we.skyboxGeometry.segment)}(d,u,U,b,J)},debug:function(d,r,u){for(let m=0;m<u.length;m++)V(d,r,u[m])},custom:function(d,r,u,m){const y=d.context,b=u.implementation;if(!d.transform.projection.unsupportedLayers||!d.transform.projection.unsupportedLayers.includes("custom")||d.terrain&&(d.terrain.renderingToTexture||"offscreen"===d.renderPass)&&u.isLayerDraped()){if("offscreen"===d.renderPass){const S=b.prerender;if(S){if(d.setCustomLayerDefaults(),y.setColorMode(d.colorModeForRenderPass()),"globe"===d.transform.projection.name){const z=d.transform.pointMerc;S.call(b,y.gl,d.transform.customLayerMatrix(),d.transform.getProjection(),d.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(d.transform.zoom),[z.x,z.y],d.transform.pixelsPerMeterRatio)}else S.call(b,y.gl,d.transform.customLayerMatrix());y.setDirty(),d.setBaseState()}}else if("translucent"===d.renderPass){if(d.terrain&&d.terrain.renderingToTexture){const z=b.renderToTile;if(z){const U=m[0].canonical,J=new a.MercatorCoordinate(U.x+m[0].wrap*(1<<U.z),U.y,U.z);y.setDepthMode(a.DepthMode.disabled),y.setStencilMode(a.StencilMode.disabled),y.setColorMode(d.colorModeForRenderPass()),d.setCustomLayerDefaults(),z.call(b,y.gl,J),y.setDirty(),d.setBaseState()}return}d.setCustomLayerDefaults(),y.setColorMode(d.colorModeForRenderPass()),y.setStencilMode(a.StencilMode.disabled);const S="3d"===b.renderingMode?new a.DepthMode(d.context.gl.LEQUAL,a.DepthMode.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,a.DepthMode.ReadOnly);if(y.setDepthMode(S),"globe"===d.transform.projection.name){const z=d.transform.pointMerc;b.render(y.gl,d.transform.customLayerMatrix(),d.transform.getProjection(),d.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(d.transform.zoom),[z.x,z.y],d.transform.pixelsPerMeterRatio)}else b.render(y.gl,d.transform.customLayerMatrix());y.setDirty(),d.setBaseState(),y.bindFramebuffer.set(null)}}else a.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class ir{constructor(r,u,m=!1){this.context=new Y(r,m),this.transform=u,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(r,u){const m=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Wo(this,r));const y=this._terrain;this.transform.elevation=m?y:null,y.update(r,this.transform,u)}_updateFog(r){const u=r.fog;if(!u||"globe"===this.transform.projection.name||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,y]=u.getFovAdjustedRange(this.transform._fov);if(m>y)return void(this.transform.fogCullDistSq=null);const b=m+.78*(y-m);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(r,u){if(this.width=r*a.exported.devicePixelRatio,this.height=u*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._layers[m].resize()}setup(){const r=this.context,u=new a.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(a.EXTENT,0),u.emplaceBack(0,a.EXTENT),u.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(u,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const m=new a.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(a.EXTENT,0),m.emplaceBack(0,a.EXTENT),m.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=r.createVertexBuffer(m,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const y=new a.StructArrayLayout2i4;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(y,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const b=new a.StructArrayLayout4i8;b.emplaceBack(0,0,0,0),b.emplaceBack(a.EXTENT,0,a.EXTENT,0),b.emplaceBack(0,a.EXTENT,0,a.EXTENT),b.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=r.createVertexBuffer(b,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(S);const z=new a.StructArrayLayout1ui2;for(const J of[0,1,3,2,0])z.emplaceBack(J);this.debugIndexBuffer=r.createIndexBuffer(z),this.emptyTexture=new a.Texture(r,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA),this.identityMat=a.create();const U=this.context.gl;this.stencilClearMode=new a.StencilMode({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new $r(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context,u=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(r,u.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,Aa(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,u,m){if(!u||this.currentStencilSource===u.id||!r.isTileClipped()||!m||0===m.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let z=!1;for(const U of m)if(void 0===this._tileClippingMaskIDs[U.key]){z=!0;break}if(!z)return}this.currentStencilSource=u.id;const y=this.context,b=y.gl;this.nextStencilID+m.length>256&&this.clearStencil(),y.setColorMode(a.ColorMode.disabled),y.setDepthMode(a.DepthMode.disabled);const S=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of m){const U=u.getTile(z),J=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,{tileBoundsBuffer:Q,tileBoundsIndexBuffer:we,tileBoundsSegments:Ye}=this.getTileBoundsBuffers(U);S.draw(y,b.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:b.ALWAYS,mask:0},J,255,b.KEEP,b.KEEP,b.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Aa(z.projMatrix),"$clipping",Q,we,Ye)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,u=this.context.gl;return new a.StencilMode({func:u.NOTEQUAL,mask:255},r,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const u=this.context.gl;return new a.StencilMode({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(r){const u=this.context.gl,m=r.sort((S,z)=>z.overscaledZ-S.overscaledZ),y=m[m.length-1].overscaledZ,b=m[0].overscaledZ-y+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const S={};for(let z=0;z<b;z++)S[z+y]=new a.StencilMode({func:u.GEQUAL,mask:255},z+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=b,[S,m]}return[{[y]:a.StencilMode.disabled},m]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([r.CONSTANT_COLOR,r.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(r,u,m){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new a.DepthMode(m||this.context.gl.LEQUAL,u,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,u){this.style=r,this.options=u,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const m=this.style.order,y=this.style._sourceCaches;for(const J in y){const Q=y[J];Q.used&&Q.prepare(this.context)}const b={},S={},z={};for(const J in y){const Q=y[J];b[J]=Q.getVisibleCoordinates(),S[J]=b[J].slice().reverse(),z[J]=Q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let J=0;J<m.length;J++)if(this.style._layers[m[J]].is3D()){this.opaquePassCutoff=J;break}if(this.terrain&&(this.terrain.updateTileBinding(z),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const J of m){const Q=this.style._layers[J],we=r._getLayerSourceCache(Q);if(!Q.hasOffscreenPass()||Q.isHidden(this.transform.zoom))continue;const Ye=we?S[we.id]:void 0;("custom"===Q.type||Q.isSky()||Ye&&Ye.length)&&this.renderLayer(this,we,Q,Ye)}this.depthRangeFor3D=[0,1-(r.order.length+2)*this.numSublayers*this.depthEpsilon];const U=this.terrain;if(U&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&U.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:u.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const J=this.style._layers[m[this.currentLayer]],Q=r._getLayerSourceCache(J);if(J.isSky())continue;const we=Q?S[Q.id]:void 0;this._renderTileClippingMasks(J,Q,we),this.renderLayer(this,Q,J,we)}if(this.style.fog&&this.transform.projection.supportsFog&&function(J,Q){const we=J.context,Ye=we.gl,Qe=J.transform,ut=new a.DepthMode(Ye.LEQUAL,a.DepthMode.ReadOnly,[0,1]),it=J.useProgram("globeAtmosphere",null,"globe"===Qe.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ft=a.globeToMercatorTransition(Qe.zoom),Ee=Q.properties.get("color").toArray01(),qe=Q.properties.get("high-color").toArray01(),yt=Q.properties.get("space-color").toArray01PremultipliedAlpha(),Mt=a.identity$1([]);a.rotateY$1(Mt,Mt,-a.degToRad(Qe._center.lng)),a.rotateX$1(Mt,Mt,a.degToRad(Qe._center.lat)),a.rotateZ$1(Mt,Mt,Qe.angle),a.rotateX$1(Mt,Mt,-Qe._pitch);const $t=a.fromQuat(new Float32Array(16),Mt),Wt=a.mapValue(Q.properties.get("star-intensity"),0,1,0,.25),on=a.mapValue(Q.properties.get("horizon-blend"),0,1,5e-4,.25),Zt=a.globeUseCustomAntiAliasing(J,we,Qe)&&5e-4===on?Qe.worldSize/(2*Math.PI*1.025)-1:Qe.globeRadius,cn=J.frameCounter/1e3%1,li=a.length(Qe.globeCenterInViewSpace),fn=Math.sqrt(Math.pow(li,2)-Math.pow(Zt,2)),Fn=Math.acos(fn/li),gn={u_frustum_tl:Qe.frustumCorners.TL,u_frustum_tr:Qe.frustumCorners.TR,u_frustum_br:Qe.frustumCorners.BR,u_frustum_bl:Qe.frustumCorners.BL,u_horizon:Qe.frustumCorners.horizon,u_transition:ft,u_fadeout_range:on,u_color:Ee,u_high_color:qe,u_space_color:yt,u_star_intensity:Wt,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:cn,u_horizon_angle:Fn,u_rotation_matrix:$t};J.prepareDrawProgram(we,it);const ai=J.atmosphereBuffer;ai&&it.draw(we,Ye.TRIANGLES,ut,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,gn,"skybox",ai.vertexBuffer,ai.indexBuffer,ai.segments)}(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const J=this.style._layers[m[this.currentLayer]],Q=r._getLayerSourceCache(J);J.isSky()&&this.renderLayer(this,Q,J,Q?S[Q.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;){const J=this.style._layers[m[this.currentLayer]],Q=r._getLayerSourceCache(J);if(J.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(J)){if(J.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const we=Q?("symbol"===J.type?z:S)[Q.id]:void 0;this._renderTileClippingMasks(J,Q,Q?b[Q.id]:void 0),this.renderLayer(this,Q,J,we),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let J=null;a.values(this.style._layers).forEach(Q=>{const we=r._getLayerSourceCache(Q);we&&!Q.isHidden(this.transform.zoom)&&(!J||J.getSource().maxzoom<we.getSource().maxzoom)&&(J=we)}),J&&this.options.showTileBoundaries&&cr.debug(this,J,J.getVisibleCoordinates())}this.options.showPadding&&function(J){const Q=J.transform.padding;te(J,J.transform.height-(Q.top||0),3,Ls),te(J,Q.bottom||0,3,yl),Le(J,Q.left||0,3,Ia),Le(J,J.transform.width-(Q.right||0),3,Ne);const we=J.transform.centerPoint;var Ye,Qe,ut,it;ot(Ye=J,(Qe=we.x)-1,(ut=J.transform.height-we.y)-10,2,20,it=N),ot(Ye,Qe-10,ut-1,20,2,it)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(r,u,m,y){m.isHidden(this.transform.zoom)||("background"===m.type||"sky"===m.type||"custom"===m.type||y&&y.length)&&(this.id=m.id,this.gpuTimingStart(m),(!r.transform.projection.unsupportedLayers||!r.transform.projection.unsupportedLayers.includes(m.type)||r.terrain&&"custom"===m.type)&&cr[m.type](r,u,m,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let m=this.gpuTimers[r.id];m||(m=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),m.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,m.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,u=r.createQueryEXT();this.deferredRenderGpuTimeQueries.push(u),r.beginQueryEXT(r.TIME_ELAPSED_EXT,u)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const u={};for(const m in r){const y=r[m],b=this.context.extTimerQuery,S=b.getQueryObjectEXT(y.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(y.query),u[m]=S}return u}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.extTimerQuery;let m=0;for(const y of r)m+=u.getQueryObjectEXT(y,u.QUERY_RESULT_EXT)/1e6,u.deleteQueryEXT(y);return m}translatePosMatrix(r,u,m,y,b){if(!m[0]&&!m[1])return r;const S=b?"map"===y?this.transform.angle:0:"viewport"===y?-this.transform.angle:0;if(S){const J=Math.sin(S),Q=Math.cos(S);m=[m[0]*Q-m[1]*J,m[0]*J+m[1]*Q]}const z=[b?m[0]:di(u,m[0],this.transform.zoom),b?m[1]:di(u,m[1],this.transform.zoom),0],U=new Float32Array(16);return a.translate(U,r,z),U}saveTileTexture(r){const u=this._tileTextures[r.size[0]];u?u.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const u=this._tileTextures[r];return u&&u.length>0?u.pop():null}isPatternMissing(r){return null===r||void 0!==r&&!this.imageManager.getPattern(r.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const r=this.terrain&&this.terrain.renderingToTexture,u=this.terrain&&0===this.terrain.exaggeration(),m=this.style&&this.style.fog,y=[];return this.terrainRenderModeElevated()&&y.push("TERRAIN"),"globe"===this.transform.projection.name&&y.push("GLOBE"),u&&y.push("ZERO_EXAGGERATION"),m&&!r&&0!==m.getOpacity(this.transform.pitch)&&y.push("FOG"),r&&y.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&y.push("OVERDRAW_INSPECTOR"),y}useProgram(r,u,m){this.cache=this.cache||{};const y=m||[],b=this.currentGlobalDefines().concat(y),S=Hr.cacheKey(rs[r],r,b,u);return this.cache[S]||(this.cache[S]=new Hr(this.context,r,rs[r],u,Gr[r],b)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(r,u,m){if(this.terrain&&this.terrain.renderingToTexture)return;const y=this.style.fog;if(y){const b=y.getOpacity(this.transform.pitch),S=((z,U,J,Q,we,Ye,Qe,ut,it,ft,Ee)=>{const qe=z.transform,yt=U.properties.get("color").toArray01();yt[3]=Q;const Mt=z.frameCounter/1e3%1;return{u_fog_matrix:J?qe.calculateFogTileMatrix(J):z.identityMat,u_fog_range:U.getFovAdjustedRange(qe._fov),u_fog_color:yt,u_fog_horizon_blend:U.properties.get("horizon-blend"),u_fog_temporal_offset:Mt,u_frustum_tl:we,u_frustum_tr:Ye,u_frustum_br:Qe,u_frustum_bl:ut,u_globe_pos:it,u_globe_radius:ft,u_viewport:Ee,u_globe_transition:a.globeToMercatorTransition(qe.zoom),u_is_globe:+("globe"===qe.projection.name)}})(this,y,m,b,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);u.setFogUniformValues(r,S)}}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,u=r.createTexture();return r.bindTexture(r.TEXTURE_2D,u),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&0!==r.getOpacity(this.transform.pitch)}getBackgroundTiles(){const r=this._backgroundTiles,u=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const y of m)u[y.key]=r[y.key]||new a.Tile(y,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}}class Ar{constructor(r=0,u=0,m=0,y=0){if(isNaN(r)||r<0||isNaN(u)||u<0||isNaN(m)||m<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=u,this.left=m,this.right=y}interpolate(r,u,m){return null!=u.top&&null!=r.top&&(this.top=a.number(r.top,u.top,m)),null!=u.bottom&&null!=r.bottom&&(this.bottom=a.number(r.bottom,u.bottom,m)),null!=u.left&&null!=r.left&&(this.left=a.number(r.left,u.left,m)),null!=u.right&&null!=r.right&&(this.right=a.number(r.right,u.right,m)),this}getCenter(r,u){const m=a.clamp((this.left+r-this.right)/2,0,r),y=a.clamp((this.top+u-this.bottom)/2,0,u);return new a.Point(m,y)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Ar(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function bo(d,r){const u=a.getColumn(d,3);a.fromQuat(d,r),a.setColumn(d,3,u)}function vr(d,r){const u=a.identity$1([]);return a.rotateZ$1(u,u,-r),a.rotateX$1(u,u,-d),u}function Qo(d,r){const u=[d[0],d[1],0],m=[r[0],r[1],0];if(a.length(u)>=1e-15){const S=a.normalize([],u);a.scale$2(m,S,a.dot(m,S)),r[0]=m[0],r[1]=m[1]}const y=a.cross([],r,d);if(a.len(y)<1e-15)return null;const b=Math.atan2(-y[1],y[0]);return vr(Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2]),b)}class Ue{constructor(r,u){this.position=r,this.orientation=u}get position(){return this._position}set position(r){if(r){const u=r instanceof a.MercatorCoordinate?r:new a.MercatorCoordinate(r[0],r[1],r[2]);this._renderWorldCopies&&(u.x=a.wrap(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(r,u){if(this.orientation=null,!this.position)return;const m=this.position,y=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(r)):0,b=a.MercatorCoordinate.fromLngLat(r,y),S=[b.x-m.x,b.y-m.y,b.z-m.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=Qo(S,u)}setPitchBearing(r,u){this.orientation=vr(a.degToRad(r),a.degToRad(-u))}}class De{constructor(r,u){this._transform=a.identity([]),this.orientation=u,this.position=r}get mercatorPosition(){const r=this.position;return new a.MercatorCoordinate(r[0],r[1],r[2])}get position(){const r=a.getColumn(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var u;r&&a.setColumn(this._transform,3,[(u=r)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||a.identity$1([]),r&&bo(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,u){this._orientation=vr(r,u),bo(this._transform,this._orientation)}forward(){const r=a.getColumn(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=a.getColumn(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=a.getColumn(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,u){const m=new Float64Array(16);return a.invert(m,this.getWorldToCamera(r,u)),m}getWorldToCameraPosition(r,u,m){const y=this.position;a.scale$2(y,y,-r);const b=new Float64Array(16);return a.fromScaling(b,[m,m,m]),a.translate(b,b,y),b[10]*=u,b}getWorldToCamera(r,u){const m=new Float64Array(16),y=new Float64Array(4),b=this.position;return a.conjugate(y,this._orientation),a.scale$2(b,b,-r),a.fromQuat(m,y),a.translate(m,m,b),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=u,m[9]*=u,m[10]*=u,m[11]*=u,m}getCameraToClipPerspective(r,u,m,y){const b=new Float64Array(16);return a.perspective(b,r,u,m,y),b}getDistanceToElevation(r,u=!1){const m=0===r?0:a.mercatorZfromAltitude(r,u?a.latFromMercatorY(this.position[1]):this.position[1]),y=this.forward();return(m-this.position[2])/y[2]}clone(){return new De([...this.position],[...this.orientation])}}function ie(d,r){const u=W(d.projection,d.zoom,d.width,d.height),m=function(b,S,z,U,J){const Q=new a.LngLat(z.lng-180*Ce,z.lat),we=new a.LngLat(z.lng+180*Ce,z.lat),Ye=b.project(Q.lng,Q.lat),Qe=b.project(we.lng,we.lat),ut=-Math.atan2(Qe.y-Ye.y,Qe.x-Ye.x),it=a.MercatorCoordinate.fromLngLat(z);it.y=a.clamp(it.y,-1+Ce,1-Ce);const ft=it.toLngLat(),Ee=b.project(ft.lng,ft.lat),qe=a.MercatorCoordinate.fromLngLat(ft);qe.x+=Ce;const yt=qe.toLngLat(),Mt=b.project(yt.lng,yt.lat),$t=ei(Mt.x-Ee.x,Mt.y-Ee.y,ut),Wt=a.MercatorCoordinate.fromLngLat(ft);Wt.y+=Ce;const Ot=Wt.toLngLat(),on=b.project(Ot.lng,Ot.lat),Zt=ei(on.x-Ee.x,on.y-Ee.y,ut),cn=Math.abs($t.x)/Math.abs(Zt.y),li=a.identity([]);a.rotateZ(li,li,-ut*(1-(J?0:U)));const fn=a.identity([]);return a.scale(fn,fn,[1,1-(1-cn)*U,1]),fn[4]=-Zt.x/Zt.y*U,a.rotateZ(fn,fn,ut),a.multiply(fn,li,fn),fn}(d.projection,0,d.center,u,r),y=le(d);return a.scale(m,m,[y,y,1]),m}function le(d){const r=d.projection,u=W(d.projection,d.zoom,d.width,d.height),m=xe(r,d.center),y=xe(r,a.LngLat.convert(r.center));return Math.pow(2,m*u+(1-u)*y)}function W(d,r,u,m,y=1/0){const b=d.range;if(!b)return 0;const S=Math.min(y,Math.max(u,m)),z=Math.log(S/1024)/Math.LN2;return a.smoothstep(b[0]+z,b[1]+z,r)}const Ce=1/4e4;function xe(d,r){const u=a.clamp(r.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),m=new a.LngLat(r.lng-180*Ce,u),y=new a.LngLat(r.lng+180*Ce,u),b=d.project(m.lng,u),S=d.project(y.lng,u),z=a.MercatorCoordinate.fromLngLat(m),U=a.MercatorCoordinate.fromLngLat(y),J=S.x-b.x,Q=S.y-b.y,we=U.x-z.x,Ye=U.y-z.y,Qe=Math.sqrt((we*we+Ye*Ye)/(J*J+Q*Q));return Math.log(Qe)/Math.LN2}function ei(d,r,u){const m=Math.cos(u),y=Math.sin(u);return{x:d*m-r*y,y:d*y+r*m}}class L{constructor(r,u,m,y,b,S,z){this.tileSize=512,this._renderWorldCopies=void 0===b||b,this._minZoom=r||0,this._maxZoom=u||22,this._minPitch=m??0,this._maxPitch=y??60,this.setProjection(S),this.setMaxBounds(z),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ar,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new De,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const r=new L(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(r,u=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||m)&&this._updateCameraOnTerrain(),(r||m)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const m=!se(u,this.getProjection());return m&&this._calcMatrices(),this.mercatorFromTransition=!1,m}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.getProjection({name:"mercator"});const u=r!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(r){void 0===r?r=!0:null===r&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.Point(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const u=-r*Math.PI/180;var m,y,b,S,z,U,J,Q,we,Ye;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(m=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m),y=this.rotationMatrix,S=this.angle,z=(b=this.rotationMatrix)[0],U=b[1],J=b[2],Q=b[3],we=Math.sin(S),Ye=Math.cos(S),y[0]=z*Ye+J*we,y[1]=U*Ye+Q*we,y[2]=z*-we+J*Ye,y[3]=U*-we+Q*Ye)}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const u=a.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=a.degToRad(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const u=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const r=this._elevation;this._centerAltitude=r.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=r.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let y=0,b=0;for(let S=0;S<u.length;S++){const z=new a.Point(u[S][0]*this.width,m+u[S][1]*(this.height-m)),U=r.pointCoordinate(z);if(!U)continue;const J=1/Math.hypot(U[0]-this._camera.position[0],U[1]-this._camera.position[1]);y+=U[3]*J,b+=J}return 0===b?NaN:y/b}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const r=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*u,y=this._mercatorZfromZoom(r),b=this._mercatorZfromZoom(this._maxZoom),S=Math.max(y-m,b);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let m;m=r.z<this._camera.position[2]?[u.x,u.y,u.z]:[r.x,r.y,r.z];const y=a.length(a.sub([],this._camera.position,m));return a.clamp(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let u=!1;if(r.orientation&&!a.exactEquals(r.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(r.orientation)),r.position){const m=[r.position.x,r.position.y,r.position.z];a.exactEquals$1(m,this._camera.position)||(this._setCameraPosition(m),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,u=new Ue;return u.position=new a.MercatorCoordinate(r[0],r[1],r[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(r){if(!a.length$1(r))return!1;a.normalize$1(r,r);const u=a.transformQuat([],[0,0,-1],r),m=a.transformQuat([],[0,-1,0],r);if(m[2]<0)return!1;const y=Qo(u,m);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(r){const u=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;r[2]=a.clamp(r[2],y/m,y/u),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,u,m){this._unmodified=!1,this._edgeInsets.interpolate(r,u,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const u=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(r){const u=[new a.UnwrappedTileID(0,r)];if(this.renderWorldCopies){const m=this.pointCoordinate(new a.Point(0,0)),y=this.pointCoordinate(new a.Point(this.width,0)),b=this.pointCoordinate(new a.Point(this.width,this.height)),S=this.pointCoordinate(new a.Point(0,this.height)),z=Math.floor(Math.min(m.x,y.x,b.x,S.x)),U=Math.floor(Math.max(m.x,y.x,b.x,S.x)),J=1;for(let Q=z-J;Q<=U+J;Q++)0!==Q&&u.push(new a.UnwrappedTileID(Q,r))}return u}coveringTiles(r){let u=this.coveringZoomLevel(r);const m=u,y=this.elevation&&!r.isTerrainDEM,b="mercator"===this.projection.name;if(void 0!==r.minzoom&&u<r.minzoom)return[];void 0!==r.maxzoom&&u>r.maxzoom&&(u=r.maxzoom);const S=this.locationCoordinate(this.center),z=this.center.lat,U=1<<u,J=[U*S.x,U*S.y,0],Q="globe"===this.projection.name,we=!Q,Ye=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,we),Qe=Q?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ut=U*a.mercatorZfromAltitude(1,this.center.lat),it=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),ft=[U*Qe.x,U*Qe.y,it*(we?1:ut)],Ee=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),qe=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?u:0,yt=r.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Mt=r.isTerrainDEM?-yt:this._elevation?this._elevation.getMinElevationBelowMSL():0,$t=this.projection.isReprojectedInTileSpace?le(this):1,Wt=vn=>{const ri=new a.MercatorCoordinate(vn.x+25e-6,vn.y,vn.z),Qn=new a.MercatorCoordinate(vn.x,vn.y+25e-6,vn.z),fi=vn.toLngLat(),tr=ri.toLngLat(),wr=Qn.toLngLat(),Vi=this.locationCoordinate(fi),or=this.locationCoordinate(tr),Ur=this.locationCoordinate(wr),Zr=Math.hypot(or.x-Vi.x,or.y-Vi.y),Qi=Math.hypot(Ur.x-Vi.x,Ur.y-Vi.y);return Math.sqrt(Zr*Qi)*$t/25e-6},Ot=vn=>{const Hn=yt,ri=Mt;return{aabb:a.tileAABB(this,U,0,0,0,vn,ri,Hn,this.projection),zoom:0,x:0,y:0,minZ:ri,maxZ:Hn,wrap:vn,fullyVisible:!1}},on=[];let Zt=[];const cn=u,li=r.reparseOverscaled?m:u,fn=vn=>vn*vn,Fn=fn((it-this._centerAltitude)*ut),gn=vn=>{if(!this._elevation||!vn.tileID||!b)return;const Hn=this._elevation.getMinMaxForTile(vn.tileID),ri=vn.aabb;Hn?(ri.min[2]=Hn.min,ri.max[2]=Hn.max,ri.center[2]=(ri.min[2]+ri.max[2])/2):(vn.shouldSplit=ai(vn),vn.shouldSplit||(ri.min[2]=ri.max[2]=ri.center[2]=this._centerAltitude))},ai=vn=>{if(vn.zoom<qe)return!0;if(vn.zoom===cn)return!1;if(null!=vn.shouldSplit)return vn.shouldSplit;const Hn=vn.aabb.distanceX(ft),ri=vn.aabb.distanceY(ft);let Qn=Fn,fi=1;if(Q){Qn=fn(vn.aabb.distanceZ(ft));const Vi=Math.pow(2,vn.zoom),or=a.latFromMercatorY((vn.y+1)/Vi),Ur=a.latFromMercatorY(vn.y/Vi),Zr=Math.min(Math.max(z,or),Ur),Qi=a.circumferenceAtLatitude(Zr)/a.circumferenceAtLatitude(z);if(fi=Zr===z?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Qi/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&vn.zoom===cn-1&&Qi>=.9)return!0}else if(y&&(Qn=fn(vn.aabb.distanceZ(ft)*ut)),this.projection.isReprojectedInTileSpace&&m<=5){const Vi=Math.pow(2,vn.zoom),or=Wt(new a.MercatorCoordinate((vn.x+.5)/Vi,(vn.y+.5)/Vi));fi=or>.85?1:or}const tr=Hn*Hn+ri*ri+Qn;return tr<fn((1<<cn-vn.zoom)*Ee*fi*((Vi,or)=>{if(or*fn(.707)<Vi)return 1;const Ur=Math.sqrt(or/Vi);return Ur/(1.4144271570014144+(Math.pow(1.1,Ur-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Qn,Fn),tr))};if(this.renderWorldCopies)for(let vn=1;vn<=3;vn++)on.push(Ot(-vn)),on.push(Ot(vn));for(on.push(Ot(0));on.length>0;){const vn=on.pop(),Hn=vn.x,ri=vn.y;let Qn=vn.fullyVisible;if(!Qn){const fi=vn.aabb.intersects(Ye);if(0===fi)continue;Qn=2===fi}if(vn.zoom!==cn&&ai(vn))for(let fi=0;fi<4;fi++){const tr=(Hn<<1)+fi%2,wr=(ri<<1)+(fi>>1),Vi={aabb:b?vn.aabb.quadrant(fi):a.tileAABB(this,U,vn.zoom+1,tr,wr,vn.wrap,vn.minZ,vn.maxZ,this.projection),zoom:vn.zoom+1,x:tr,y:wr,wrap:vn.wrap,fullyVisible:Qn,tileID:void 0,shouldSplit:void 0,minZ:vn.minZ,maxZ:vn.maxZ};y&&!Q&&(Vi.tileID=new a.OverscaledTileID(vn.zoom+1===cn?li:vn.zoom+1,vn.wrap,vn.zoom+1,tr,wr),gn(Vi)),on.push(Vi)}else{const fi=vn.zoom===cn?li:vn.zoom;if(r.minzoom&&r.minzoom>fi)continue;const tr=J[0]-(.5+Hn+(vn.wrap<<vn.zoom))*(1<<u-vn.zoom),wr=J[1]-.5-ri,Vi=vn.tileID?vn.tileID:new a.OverscaledTileID(fi,vn.wrap,vn.zoom,Hn,ri);Zt.push({tileID:Vi,distanceSq:tr*tr+wr*wr})}}if(this.fogCullDistSq){const vn=this.fogCullDistSq,Hn=this.horizonLineFromTop();Zt=Zt.filter(ri=>{const Qn=[0,0,0,1],fi=[a.EXTENT,a.EXTENT,0,1],tr=this.calculateFogTileMatrix(ri.tileID.toUnwrapped());a.transformMat4$1(Qn,Qn,tr),a.transformMat4$1(fi,fi,tr);const wr=a.getAABBPointSquareDist(Qn,fi);if(0===wr)return!0;let Vi=!1;const or=this._elevation;if(or&&wr>vn&&0!==Hn){const Ur=this.calculateProjMatrix(ri.tileID.toUnwrapped());let Zr;r.isTerrainDEM||(Zr=or.getMinMaxForTile(ri.tileID)),Zr||(Zr={min:Mt,max:yt});const Qi=a.furthestTileCorner(this.rotation),Wi=[Qi[0]*a.EXTENT,Qi[1]*a.EXTENT,Zr.max];a.transformMat4(Wi,Wi,Ur),Vi=(1-Wi[1])*this.height*.5<Hn}return wr<vn||Vi})}return Zt.sort((vn,Hn)=>vn.distanceSq-Hn.distanceSq).map(vn=>vn.tileID)}resize(r,u){this.width=r,this.height=u,this.pixelsToGLUnits=[2/r,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const u=a.clamp(r.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),m=this.projection.project(r.lng,u);return new a.Point(m.x*this.worldSize,m.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,u){let m,y;const b=this.centerPoint;if("globe"===this.projection.name){const z=this.worldSize;m=(u.x-b.x)/z,y=(u.y-b.y)/z}else{const z=this.pointCoordinate(u),U=this.pointCoordinate(b);m=z.x-U.x,y=z.y-U.y}const S=this.locationCoordinate(r);this.setLocation(new a.MercatorCoordinate(S.x-m,S.y-y))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,u){const m=u?a.mercatorZfromAltitude(u,r.lat):void 0,y=this.projection.project(r.lng,r.lat);return new a.MercatorCoordinate(y.x,y.y,m)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,u){const m=u??this._centerAltitude,y=[r.x,r.y,0,1],b=[r.x,r.y,1,1];a.transformMat4$1(y,y,this.pixelMatrixInverse),a.transformMat4$1(b,b,this.pixelMatrixInverse);const S=b[3];a.scale$1(y,y,1/y[3]),a.scale$1(b,b,1/S);const z=y[2],U=b[2];return{p0:y,p1:b,t:z===U?0:(m-z)/(U-z)}}screenPointToMercatorRay(r){const u=[r.x,r.y,0,1],m=[r.x,r.y,1,1];return a.transformMat4$1(u,u,this.pixelMatrixInverse),a.transformMat4$1(m,m,this.pixelMatrixInverse),a.scale$1(u,u,1/u[3]),a.scale$1(m,m,1/m[3]),u[2]=a.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,m[2]=a.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,a.scale$1(u,u,1/this.worldSize),a.scale$1(m,m,1/this.worldSize),new a.Ray([u[0],u[1],u[2]],a.normalize([],a.sub([],m,u)))}rayIntersectionCoordinate(r){const{p0:u,p1:m,t:y}=r,b=a.mercatorZfromAltitude(u[2],this._center.lat),S=a.mercatorZfromAltitude(m[2],this._center.lat);return new a.MercatorCoordinate(a.number(u[0],m[0],y)/this.worldSize,a.number(u[1],m[1],y)/this.worldSize,a.number(b,S,y))}pointCoordinate(r,u=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,u)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let u=this.projection.pointCoordinate3D(this,r.x,r.y);if(u)return new a.MercatorCoordinate(u[0],u[1],u[2]);let m=0,y=this.horizonLineFromTop();if(r.y>y)return this.pointCoordinate(r);const b=.02*y,S=r.clone();for(let z=0;z<10&&y-m>b;z++){S.y=a.number(m,y,.66);const U=this.projection.pointCoordinate3D(this,S.x,S.y);U?(y=S.y,u=U):m=S.y}return u?new a.MercatorCoordinate(u[0],u[1],u[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(r);const u=this.pointCoordinate(r);return u.y>=0&&u.y<=1}_coordinatePoint(r,u){const m=u&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,y=[r.x*this.worldSize,r.y*this.worldSize,m+r.toAltitude(),1];return a.transformMat4$1(y,y,this.pixelMatrix),y[3]>0?new a.Point(y[0]/y[3],y[1]/y[3]):new a.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:u}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,y=this.width-this._edgeInsets.right,b=this.pointLocation3D(new a.Point(u,r)),S=this.pointLocation3D(new a.Point(y,r)),z=this.pointLocation3D(new a.Point(y,m)),U=this.pointLocation3D(new a.Point(u,m));let J=Math.min(b.lng,S.lng,z.lng,U.lng),Q=Math.max(b.lng,S.lng,z.lng,U.lng),we=Math.min(b.lat,S.lat,z.lat,U.lat),Ye=Math.max(b.lat,S.lat,z.lat,U.lat);const Qe=Math.pow(2,-this.zoom)/16*270,ut="globe"===this.projection.name?1:4,it=(ft,Ee,qe,yt,Mt)=>{const $t=(ft+qe)/2,Wt=(Ee+yt)/2,Ot=new a.Point($t,Wt),{lng:on,lat:Zt}=this.pointLocation3D(Ot),cn=Math.max(0,J-on,we-Zt,on-Q,Zt-Ye);J=Math.min(J,on),Q=Math.max(Q,on),we=Math.min(we,Zt),Ye=Math.max(Ye,Zt),(Mt<ut||cn>Qe)&&(it(ft,Ee,$t,Wt,Mt+1),it($t,Wt,qe,yt,Mt+1))};if(it(u,r,y,r,1),it(y,r,y,m,1),it(y,m,u,m,1),it(u,m,u,r,1),"globe"===this.projection.name){const[ft,Ee]=a.polesInViewport(this);ft?(Ye=90,Q=180,J=-180):Ee&&(we=-90,Q=180,J=-180)}return new a.LngLatBounds(new a.LngLat(J,we),new a.LngLat(Q,Ye))}_getBoundsRectangular(r,u){const{top:m,left:y}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,z=new a.Point(y,m),U=new a.Point(S,m),J=new a.Point(S,b),Q=new a.Point(y,b);let we=this.pointCoordinate(z,r),Ye=this.pointCoordinate(U,r);const Qe=this.pointCoordinate(J,u),ut=this.pointCoordinate(Q,u),it=(ft,Ee)=>(Ee.y-ft.y)/(Ee.x-ft.x);return we.y>1&&Ye.y>=0?we=new a.MercatorCoordinate((1-ut.y)/it(ut,we)+ut.x,1):we.y<0&&Ye.y<=1&&(we=new a.MercatorCoordinate(-ut.y/it(ut,we)+ut.x,0)),Ye.y>1&&we.y>=0?Ye=new a.MercatorCoordinate((1-Qe.y)/it(Qe,Ye)+Qe.x,1):Ye.y<0&&we.y<=1&&(Ye=new a.MercatorCoordinate(-Qe.y/it(Qe,Ye)+Qe.x,0)),(new a.LngLatBounds).extend(this.coordinateLocation(we)).extend(this.coordinateLocation(Ye)).extend(this.coordinateLocation(ut)).extend(this.coordinateLocation(Qe))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=r.visibleDemTiles.reduce((m,y)=>{if(y.dem){const b=y.dem.tree;m.min=Math.min(m.min,b.minimums[0]),m.max=Math.max(m.max,b.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*r.exaggeration(),u.max*r.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,m=this.height/2-u*(1-this._horizonShift);return r?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,u){return this.projection.createTileMatrix(this,u,r)}calculateDistanceTileData(r){const u=r.key,m=this._distanceTileDataCache;if(m[u])return m[u];const y=r.canonical,b=1/this.height,S=this.cameraWorldSize,z=S/this.zoomScale(y.z),U=(y.x+Math.pow(2,y.z)*r.wrap)*z,J=y.y*z,Q=this.point;Q.x*=S/this.worldSize,Q.y*=S/this.worldSize;const we=this.angle,Ye=Math.sin(-we),Qe=-Math.cos(-we);return m[u]={bearing:[Ye,Qe],center:[(Q.x-U)*b,(Q.y-J)*b],scale:z/a.EXTENT*b},m[u]}calculateFogTileMatrix(r){const u=r.key,m=this._fogTileMatrixCache;if(m[u])return m[u];const y=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return a.multiply(y,this.worldToFogMatrix,y),m[u]=new Float32Array(y),m[u]}calculateProjMatrix(r,u=!1){const m=r.key,y=u?this._alignedProjMatrixCache:this._projMatrixCache;if(y[m])return y[m];const b=this.calculatePosMatrix(r,this.worldSize);return a.multiply(b,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:u?this.alignedProjMatrix:this.projMatrix,b),y[m]=new Float32Array(b),y[m]}calculatePixelsToTileUnitsMatrix(r){const u=r.tileID.key,m=this._pixelsToTileUnitsCache;if(m[u])return m[u];const y=function(b,S){const{scale:z}=b.tileTransform,U=z*a.EXTENT/(b.tileSize*Math.pow(2,S.zoom-b.tileID.overscaledZ+b.tileID.canonical.z));return J=new Float32Array(4),Ye=(Q=S.inverseAdjustmentMatrix)[1],Qe=Q[2],ut=Q[3],ft=(we=[U,U])[1],J[0]=Q[0]*(it=we[0]),J[1]=Ye*it,J[2]=Qe*ft,J[3]=ut*ft,J;var J,Q,we,Ye,Qe,ut,it,ft}(r,this);return m[u]=y,m[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const r=1/this.worldSize,u=a.fromScaling([],[r,r,r]);return a.multiply(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const r=this._elevation;this._updateCameraState();const u=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(u),y=this._camera.forward(),b=a.mercatorZfromAltitude(1,this._center.lat);m[2]/=b,y[2]/=b,a.normalize(y,y);const S=r.raycast(m,y,r.exaggeration());if(S){const z=a.scaleAndAdd([],m,y,S),U=new a.MercatorCoordinate(z[0],z[1],a.mercatorZfromAltitude(z[2],a.latFromMercatorY(z[1]))),J=(U.z+a.length([U.x-m[0],U.y-m[1],U.z-m[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(J),this._centerAltitude=U.toAltitude(),this._center=this.coordinateLocation(U),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const u=this._elevation,m=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(m),b=u.getAtPointOrZero(new a.MercatorCoordinate(...y)),S=this.pixelsPerMeter/this.worldSize*b,z=this._minimumHeightOverTerrain(),U=y[2]-S;if(U<=z)if(U<0||r){const J=this.locationCoordinate(this._center,this._centerAltitude),Q=[y[0],y[1],J.z-y[2]],we=a.length(Q);Q[2]-=(z-U)/this._pixelsPerMercatorPixel;const Ye=a.length(Q);if(0===Ye)return;a.scale$2(Q,Q,we/Ye*this._pixelsPerMercatorPixel),this._camera.position=[y[0],y[1],J.z*this._pixelsPerMercatorPixel-Q[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const Ye=this.center;return Ye.lat=a.clamp(Ye.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(Ye.lng=a.clamp(Ye.lng,this.minLng,this.maxLng)),this.center=Ye,void(this._constraining=!1)}const u=this._unmodified,{x:m,y}=this.point;let b=0,S=m,z=y;const U=this.width/2,J=this.height/2,Q=this.worldMinY*this.scale,we=this.worldMaxY*this.scale;if(y-J<Q&&(z=Q+J),y+J>we&&(z=we-J),we-Q<this.height&&(b=Math.max(b,this.height/(we-Q)),z=(we+Q)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Ye=this.worldMinX*this.scale,Qe=this.worldMaxX*this.scale,ut=this.worldSize/2-(Ye+Qe)/2;S=(m+ut+this.worldSize)%this.worldSize-ut,S-U<Ye&&(S=Ye+U),S+U>Qe&&(S=Qe-U),Qe-Ye<this.width&&(b=Math.max(b,this.width/(Qe-Ye)),S=(Qe+Ye)/2)}S===m&&z===y||(this.center=this.unproject(new a.Point(S,z))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,u=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=a.mercatorZfromAltitude(1,this.center.lat)/a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE));const m=W(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,m),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const y="meters"===this.projection.zAxisUnit?u:1,b=this._camera.getWorldToCamera(this.worldSize,y),S=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);S[8]=2*-r.x/this.width,S[9]=2*r.y/this.height;let z=a.mul([],S,b);if(this.projection.isReprojectedInTileSpace){const Wt=this.locationCoordinate(this.center),Ot=a.identity([]);a.translate(Ot,Ot,[Wt.x*this.worldSize,Wt.y*this.worldSize,0]),a.multiply(Ot,Ot,ie(this)),a.translate(Ot,Ot,[-Wt.x*this.worldSize,-Wt.y*this.worldSize,0]),a.multiply(z,z,Ot),this.inverseAdjustmentMatrix=function(on){const Zt=ie(on,!0);return et([],[Zt[0],Zt[1],Zt[4],Zt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],z,[this.worldSize,this.worldSize,this.worldSize/y,1]),this.projMatrix=z,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const U=a.invert([],S);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(U,this.horizonLineFromTop(),this.height);const J=new Float32Array(16);a.identity(J),a.scale(J,J,[1,-1,1]),a.rotateX(J,J,this._pitch),a.rotateZ(J,J,this.angle);const Q=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),we=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Q[8]=2*-r.x/this.width,Q[9]=2*(r.y+we)/this.height,this.skyboxMatrix=a.multiply(J,Q,J);const Ye=this.point,Qe=Ye.x,ut=Ye.y,it=this.width%2/2,ft=this.height%2/2,Ee=Math.cos(this.angle),qe=Math.sin(this.angle),yt=Qe-Math.round(Qe)+Ee*it+qe*ft,Mt=ut-Math.round(ut)+Ee*ft+qe*it,$t=new Float64Array(z);if(a.translate($t,$t,[yt>.5?yt-1:yt,Mt>.5?Mt-1:Mt,0]),this.alignedProjMatrix=$t,z=a.create(),a.scale(z,z,[this.width/2,-this.height/2,1]),a.translate(z,z,[1,-1,0]),this.labelPlaneMatrix=z,z=a.create(),a.scale(z,z,[1,-1,1]),a.translate(z,z,[-1,-1,0]),a.scale(z,z,[2/this.width,2/this.height,1]),this.glCoordMatrix=z,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},z=a.invert(new Float64Array(16),this.pixelMatrix),!z)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=z,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const Wt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4(Wt,Wt,b),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=z;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,m=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,b=[r,r,u];a.scale$2(b,b,y),a.scale$2(m,m,-1),a.multiply$2(m,m,b);const S=a.create();a.translate(S,S,m),a.scale(S,S,b),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,u,y)}_computeCameraPosition(r){const u=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),y=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-r/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-m[0]*b,y.y/this.worldSize-m[1]*b,r/this.worldSize*this._centerAltitude-m[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],y=r[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),y>0&&(b=Math.min((u-m)/y,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,r,b),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,u=this._camera.forward(),{pitch:m,bearing:y}=this._camera.getPitchBearing(),b=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),z=Math.max((r[2]-b)/Math.cos(m),S),U=this._zoomFromMercatorZ(z);a.scaleAndAdd(r,r,u,z),this._pitch=a.clamp(m,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(y,-Math.PI,Math.PI),this._setZoom(a.clamp(U,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let u=0,m=a.GLOBE_ZOOM_THRESHOLD_MAX,y=0,b=1/0;for(;m-u>1e-6&&m>u;){const S=u+.5*(m-u),z=this.tileSize*Math.pow(2,S),U=this.getCameraToCenterDistance(this.projection,S,z),J=this.scaleZoom(U/(r*this.tileSize)),Q=Math.abs(S-J);Q<b&&(b=Q,y=S),S<J?u=S:m=S}return y}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,u){const m=Math.min(r.x,u.x),y=Math.max(r.x,u.x),b=Math.min(r.y,u.y),S=Math.max(r.y,u.y);if(b<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const z=[new a.Point(m,b),new a.Point(y,S),new a.Point(m,S),new a.Point(y,b)],U=this.renderWorldCopies?-3:0,J=this.renderWorldCopies?4:1;for(const Q of z){const we=this.pointRayIntersection(Q);if(we.t<0)return!0;const Ye=this.rayIntersectionCoordinate(we);if(Ye.x<U||Ye.y<0||Ye.x>J||Ye.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.Point(0,0),new a.Point(this.width,this.height))}zoomDeltaToMovement(r,u){const m=a.length(a.sub([],this._camera.position,r)),y=this._zoomFromMercatorZ(m)+u;return m-this._mercatorZfromZoom(y)}getCameraPoint(){if("globe"===this.projection.name){const r=function([u,m,y],b){const S=[u,m,y,1];a.transformMat4$1(S,S,b);const z=S[3]=Math.max(S[3],1e-6);return S[0]/=z,S[1]/=z,S[2]/=z,S}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.Point(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,r))}}getCameraToCenterDistance(r,u=this.zoom,m=this.worldSize){const y=W(r,u,this.width,this.height,1024),b=r.pixelSpaceConversion(this.center.lat,m,y);return.5/Math.tan(.5*this._fov)*this.height*b}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&a.multiply(r,r,this.globeMatrix),r}}function Me(d,r){let u=!1,m=null;const y=()=>{m=null,u&&(d(),m=setTimeout(y,r),u=!1)};return()=>(u=!0,m||y(),m)}class X{constructor(r){this._hashName=r&&encodeURIComponent(r),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Me(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,a.window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const u=pe(r);if(this._hashName){const m=this._hashName;let y=!1;const b=a.window.location.hash.slice(1).split("&").map(S=>{const z=S.split("=")[0];return z===m?(y=!0,`${z}=${u}`):S}).filter(S=>S);return y||b.push(`${m}=${u}`),`#${b.join("&")}`}return`#${u}`}_getCurrentHash(){const r=a.window.location.hash.replace("#","");if(this._hashName){let u;return r.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(u=m)}),(u&&u[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(m=>isNaN(m))){const m=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(u[3]||0):r.getBearing();return r.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:m,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,r)}}function pe(d,r){const u=d.getCenter(),m=Math.round(100*d.getZoom())/100,y=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,y),S=Math.round(u.lng*b)/b,z=Math.round(u.lat*b)/b,U=d.getBearing(),J=d.getPitch();let Q=r?`/${S}/${z}/${m}`:`${m}/${z}/${S}`;return(U||J)&&(Q+="/"+Math.round(10*U)/10),J&&(Q+=`/${Math.round(J)}`),Q}const vt={linearity:.3,easing:a.bezier(0,0,.3,1)},Nt=a.extend({deceleration:2500,maxSpeed:1400},vt),tn=a.extend({deceleration:20,maxSpeed:1400},vt),Xt=a.extend({deceleration:1e3,maxSpeed:360},vt),zi=a.extend({deceleration:1e3,maxSpeed:90},vt);class pr{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,u=a.exported.now();for(;r.length>0&&u-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)u.zoom+=b.zoomDelta||0,u.bearing+=b.bearingDelta||0,u.pitch+=b.pitchDelta||0,b.panDelta&&u.pan._add(b.panDelta),b.around&&(u.around=b.around),b.pinchAround&&(u.pinchAround=b.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(u.pan.mag()){const b=er(u.pan.mag(),m,a.extend({},Nt,r||{}));y.offset=u.pan.mult(b.amount/u.pan.mag()),y.center=this._map.transform.center,Pr(y,b)}if(u.zoom){const b=er(u.zoom,m,tn);y.zoom=this._map.transform.zoom+b.amount,Pr(y,b)}if(u.bearing){const b=er(u.bearing,m,Xt);y.bearing=this._map.transform.bearing+a.clamp(b.amount,-179,179),Pr(y,b)}if(u.pitch){const b=er(u.pitch,m,zi);y.pitch=this._map.transform.pitch+b.amount,Pr(y,b)}if(y.zoom||y.bearing){const b=void 0===u.pinchAround?u.around:u.pinchAround;y.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function Pr(d,r){(!d.duration||d.duration<r.duration)&&(d.duration=r.duration,d.easing=r.easing)}function er(d,r,u){const{maxSpeed:m,linearity:y,deceleration:b}=u,S=a.clamp(d*y/(r/1e3),-m,m),z=Math.abs(S)/(b*y);return{easing:u.easing,duration:1e3*z,amount:S*(z/2)}}class _r extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,m,y={}){const b=Qt(u.getCanvasContainer(),m),S=u.unproject(b);super(r,a.extend({point:b,lngLat:S,originalEvent:m},y)),this._defaultPrevented=!1,this.target=u}}class rr extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,m){const y="touchend"===r?m.changedTouches:m.touches,b=sn(u.getCanvasContainer(),y),S=b.map(U=>u.unproject(U)),z=b.reduce((U,J,Q,we)=>U.add(J.div(we.length)),new a.Point(0,0));super(r,{points:b,point:z,lngLats:S,lngLat:u.unproject(z),originalEvent:m}),this._defaultPrevented=!1}}class qr extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,m){super(r,{originalEvent:m}),this._defaultPrevented=!1}}class Fr{constructor(r,u){this._map=r,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new qr(r.type,this._map,r))}mousedown(r,u){return this._mousedownPos=u,this._firePreventable(new _r(r.type,this._map,r))}mouseup(r){this._map.fire(new _r(r.type,this._map,r))}preclick(r){const u=a.extend({},r);u.type="preclick",this._map.fire(new _r(u.type,this._map,u))}click(r,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(r),this._map.fire(new _r(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new _r(r.type,this._map,r))}mouseover(r){this._map.fire(new _r(r.type,this._map,r))}mouseout(r){this._map.fire(new _r(r.type,this._map,r))}touchstart(r){return this._firePreventable(new rr(r.type,this._map,r))}touchmove(r){this._map.fire(new rr(r.type,this._map,r))}touchend(r){this._map.fire(new rr(r.type,this._map,r))}touchcancel(r){this._map.fire(new rr(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class In{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new _r(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _r("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new _r(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ni{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,u){this.isEnabled()&&r.shiftKey&&0===r.button&&($e(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(r,u){if(!this._active)return;const m=u,y=this._startPos,b=this._lastPos;if(!y||!b||b.equals(m)||!this._box&&m.dist(y)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=fe("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const S=Math.min(y.x,m.x),z=Math.max(y.x,m.x),U=Math.min(y.y,m.y),J=Math.max(y.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${U}px)`,this._box.style.width=z-S+"px",this._box.style.height=J-U+"px")})}mouseupWindow(r,u){if(!this._active)return;const m=this._startPos,y=u;if(m&&0===r.button){if(this.reset(),xt(),m.x!==y.x||m.y!==y.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:b=>b.fitScreenCoordinates(m,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&27===r.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ze(),delete this._startPos,delete this._lastPos}_fireEvent(r,u){return this._map.fire(new a.Event(r,{originalEvent:u}))}}function Tr(d,r){const u={};for(let m=0;m<d.length;m++)u[d[m].identifier]=r[m];return u}class uo{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,u,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=r.timeStamp),m.length===this.numTouches&&(this.centroid=function(y){const b=new a.Point(0,0);for(const S of y)b._add(S);return b.div(y.length)}(u),this.touches=Tr(m,u)))}touchmove(r,u,m){if(this.aborted||!this.centroid)return;const y=Tr(m,u);for(const b in this.touches){const S=y[b];(!S||S.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(r,u,m){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),0===m.length){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class ho{constructor(r){this.singleTap=new uo(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,u,m){this.singleTap.touchstart(r,u,m)}touchmove(r,u,m){this.singleTap.touchmove(r,u,m)}touchend(r,u,m){const y=this.singleTap.touchend(r,u,m);if(y){const b=r.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(y)<30;if(b&&S||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class ss{constructor(){this._zoomIn=new ho({numTouches:1,numTaps:2}),this._zoomOut=new ho({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,u,m){this._zoomIn.touchstart(r,u,m),this._zoomOut.touchstart(r,u,m)}touchmove(r,u,m){this._zoomIn.touchmove(r,u,m),this._zoomOut.touchmove(r,u,m)}touchend(r,u,m){const y=this._zoomIn.touchend(r,u,m),b=this._zoomOut.touchend(r,u,m);return y?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(y)},{originalEvent:r})}):b?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(b)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const ba={0:1,2:2};class Nr{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,u){return!1}_move(r,u){return{}}mousedown(r,u){if(this._lastPoint)return;const m=Yt(r);this._correctButton(r,m)&&(this._lastPoint=u,this._eventButton=m)}mousemoveWindow(r,u){const m=this._lastPoint;if(m)if(r.preventDefault(),null!=this._eventButton&&function(y,b){const S=ba[b];return void 0===y.buttons||(y.buttons&S)!==S}(r,this._eventButton))this.reset();else if(this._moved||!(u.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(m,u)}mouseupWindow(r){this._lastPoint&&Yt(r)===this._eventButton&&(this._moved&&xt(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _o extends Nr{mousedown(r,u){super.mousedown(r,u),this._lastPoint&&(this._active=!0)}_correctButton(r,u){return 0===u&&!r.ctrlKey}_move(r,u){return{around:u,panDelta:u.sub(r)}}}class Ds extends Nr{_correctButton(r,u){return 0===u&&r.ctrlKey||2===u}_move(r,u){const m=.8*(u.x-r.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(r){r.preventDefault()}}class Ir extends Nr{_correctButton(r,u){return 0===u&&r.ctrlKey||2===u}_move(r,u){const m=-.5*(u.y-r.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(r){r.preventDefault()}}class ll{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)}touchstart(r,u,m){return this._calculateTransform(r,u,m)}touchmove(r,u,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===m.length&&!a.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,u,m)}}touchend(r,u,m){this._calculateTransform(r,u,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,u,m){m.length>0&&(this._active=!0);const y=Tr(m,u),b=new a.Point(0,0),S=new a.Point(0,0);let z=0;for(const J in y){const Q=y[J],we=this._touches[J];we&&(b._add(Q),S._add(Q.sub(we)),z++,y[J]=Q)}if(this._touches=y,z<this._minTouches||!S.mag())return;const U=S.div(z);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(z),panDelta:U}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=fe("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class ic{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,u,m){return{}}touchstart(r,u,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([u[0],u[1]]))}touchmove(r,u,m){const y=this._firstTwoTouches;if(!y)return;r.preventDefault();const[b,S]=y,z=ka(m,u,b),U=ka(m,u,S);if(!z||!U)return;const J=this._aroundCenter?null:z.add(U).div(2);return this._move([z,U],J,r)}touchend(r,u,m){if(!this._firstTwoTouches)return;const[y,b]=this._firstTwoTouches,S=ka(m,u,y),z=ka(m,u,b);S&&z||(this._active&&xt(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&"center"===r.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ka(d,r,u){for(let m=0;m<d.length;m++)if(d[m].identifier===u)return r[m]}function ao(d,r){return Math.log(d/r)/Math.LN2}class jl extends ic{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,u){const m=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(ao(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ao(this._distance,m),pinchAround:u}}}function cl(d,r){return 180*d.angleWith(r)/Math.PI}class ul extends ic{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,u){const m=this._vector;if(this._vector=r[0].sub(r[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:cl(this._vector,m),pinchAround:u}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const u=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const y=cl(r,m);return Math.abs(y)<u}}function Ua(d){return Math.abs(d.y)>Math.abs(d.x)}class Yl extends ic{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,Ua(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,u,m){const y=this._lastPoints;if(!y)return;const b=r[0].sub(y[0]),S=r[1].sub(y[1]);return this._map._cooperativeGestures&&!a.isFullscreen()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(b,S,m.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(b.y+S.y)/2*-.5})}gestureBeginsVertically(r,u,m){if(void 0!==this._valid)return this._valid;const y=r.mag()>=2,b=u.mag()>=2;if(!y&&!b)return;if(!y||!b)return null==this._firstMove&&(this._firstMove=m),m-this._firstMove<100&&void 0;const S=r.y>0==u.y>0;return Ua(r)&&Ua(u)&&S}}const Fo={panStep:100,bearingStep:15,pitchStep:10};class wo{constructor(){const r=Fo;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let u=0,m=0,y=0,b=0,S=0;switch(r.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:r.shiftKey?m=-1:(r.preventDefault(),b=-1);break;case 39:r.shiftKey?m=1:(r.preventDefault(),b=1);break;case 38:r.shiftKey?y=1:(r.preventDefault(),S=-1);break;case 40:r.shiftKey?y=-1:(r.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(m=0,y=0),{cameraAnimation:z=>{const U=z.getZoom();z.easeTo({duration:300,easeId:"keyboardHandler",easing:Ss,zoom:u?Math.round(U)+u*(r.shiftKey?2:1):U,bearing:z.getBearing()+m*this._bearingStep,pitch:z.getPitch()+y*this._pitchStep,offset:[-b*this._panStep,-S*this._panStep],center:z.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ss(d){return d*(2-d)}const kr=4.000244140625;class dc{constructor(r,u){this._map=r,this._el=r.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&"center"===r.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||a.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=r.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const m=a.exported.now(),y=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,0!==u&&u%kr==0?this._type="wheel":0!==u&&Math.abs(u)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(y*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),r.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=r,this._delta-=u,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=Qt(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;"wheel"===this._type&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(0!==this._delta){const U="wheel"===this._type&&Math.abs(this._delta)>kr?this._wheelZoomRate:this._defaultZoomRate;let J=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&0!==J&&(J=1/J);const Q=u(),we=Math.pow(2,Q),Ye="number"==typeof this._targetZoom?r.zoomScale(this._targetZoom):we;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(Ye*J))),"wheel"===this._type&&(this._startZoom=Q,this._easing=this._smoothOutEasing(200)),this._delta=0}const m="number"==typeof this._targetZoom?this._targetZoom:u(),y=this._startZoom,b=this._easing;let S,z=!1;if("wheel"===this._type&&y&&b){const U=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),J=b(U);S=a.number(y,m,J),U<1?this._frameId||(this._frameId=!0):z=!0}else S=m,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!z,zoomDelta:S-u(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let u=a.ease;if(this._prevEase){const m=this._prevEase,y=(a.exported.now()-m.start)/m.duration,b=m.easing(y+.01)-m.easing(y),S=.27/Math.sqrt(b*b+1e-4)*.01,z=Math.sqrt(.0729-S*S);u=a.bezier(S,z,.25,1)}return this._prevEase={start:a.exported.now(),duration:r,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=fe("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class xl{constructor(r,u){this._clickZoom=r,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class No{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,u){return r.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(r.shiftKey?-1:1),around:m.unproject(u)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fc{constructor(){this._tap=new ho({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,u,m){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=u[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(r,u,m))}touchmove(r,u,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const y=u[0],b=y.y-this._swipePoint.y;return this._swipePoint=y,r.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(r,u,m)}touchend(r,u,m){this._tapTime?this._swipePoint&&0===m.length&&this.reset():this._tap.touchend(r,u,m)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pc{constructor(r,u,m){this._el=r,this._mousePan=u,this._touchPan=m}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Rs{constructor(r,u,m){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=u,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class eu{constructor(r,u,m,y){this._el=r,this._touchZoom=u,this._touchRotate=m,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Jo=d=>d.zoom||d.drag||d.pitch||d.rotate;class wa extends a.Event{}class Pc{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,u){const m=a.sub([],u,r);this.radius=a.length(m[2]<0?a.div([],m,this.constants):[m[0],m[1],0])}projectRay(r){a.div(r,r,this.constants),a.normalize(r,r),a.mul$1(r,r,this.constants);const u=a.scale$2([],r,this.radius);if(u[2]>0){const m=a.scale$2([],[0,0,1],a.dot(u,[0,0,1])),y=a.scale$2([],a.normalize([],[u[0],u[1],0]),this.radius),b=a.add([],u,a.scale$2([],a.sub([],a.add([],y,m),u),2));u[0]=b[0],u[1]=b[1]}return u}}function ha(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class ja{constructor(r,u){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new pr(r),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Pc,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),a.bindAll(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[y,b,S]of this._listeners)y.addEventListener(b,y===a.window.document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[r,u,m]of this._listeners)r.removeEventListener(u,r===a.window.document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(r){const u=this._map,m=u.getCanvasContainer();this._add("mapEvent",new Fr(u,r));const y=u.boxZoom=new Ni(u,r);this._add("boxZoom",y);const b=new ss,S=new No;u.doubleClickZoom=new xl(S,b),this._add("tapZoom",b),this._add("clickZoom",S);const z=new fc;this._add("tapDragZoom",z);const U=u.touchPitch=new Yl(u);this._add("touchPitch",U);const J=new Ds(r),Q=new Ir(r);u.dragRotate=new Rs(r,J,Q),this._add("mouseRotate",J,["mousePitch"]),this._add("mousePitch",Q,["mouseRotate"]);const we=new _o(r),Ye=new ll(u,r);u.dragPan=new pc(m,we,Ye),this._add("mousePan",we),this._add("touchPan",Ye,["touchZoom","touchRotate"]);const Qe=new ul,ut=new jl;u.touchZoomRotate=new eu(m,ut,Qe,z),this._add("touchRotate",Qe,["touchPan","touchZoom"]),this._add("touchZoom",ut,["touchPan","touchRotate"]),this._add("blockableMapEvent",new In(u));const it=u.scrollZoom=new dc(u,this);this._add("scrollZoom",it,["mousePan"]);const ft=u.keyboard=new wo;this._add("keyboard",ft);for(const Ee of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[Ee]&&u[Ee].enable(r[Ee])}_add(r,u,m){this._handlers.push({handlerName:r,handler:u,allowed:m}),this._handlersById[r]=u}stop(r){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Jo(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,u,m){for(const y in r)if(y!==m&&(!u||u.indexOf(y)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const u=[];for(const m of r)this._el.contains(m.target)&&u.push(m);return u}handleEvent(r,u){this._updatingCamera=!0;const m="renderFrame"===r.type,y=m?void 0:r,b={needsRenderFrame:!1},S={},z={},U=r.touches?this._getMapTouches(r.touches):void 0,J=U?sn(this._el,U):m?void 0:Qt(this._el,r);for(const{handlerName:Ye,handler:Qe,allowed:ut}of this._handlers){if(!Qe.isEnabled())continue;let it;this._blockedByActive(z,ut,Ye)?Qe.reset():Qe[u||r.type]&&(it=Qe[u||r.type](r,J,U),this.mergeHandlerResult(b,S,it,Ye,y),it&&it.needsRenderFrame&&this._triggerRenderFrame()),(it||Qe.isActive())&&(z[Ye]=Qe)}const Q={};for(const Ye in this._previousActiveHandlers)z[Ye]||(Q[Ye]=y);this._previousActiveHandlers=z,(Object.keys(Q).length||ha(b))&&(this._changes.push([b,S,Q]),this._triggerRenderFrame()),(Object.keys(z).length||ha(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:we}=b;we&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],we(this._map))}mergeHandlerResult(r,u,m,y,b){if(!m)return;a.extend(r,m);const S={handlerName:y,originalEvent:m.originalEvent||b};void 0!==m.zoomDelta&&(u.zoom=S),void 0!==m.panDelta&&(u.drag=S),void 0!==m.pitchDelta&&(u.pitch=S),void 0!==m.bearingDelta&&(u.rotate=S)}_applyChanges(){const r={},u={},m={};for(const[y,b,S]of this._changes)y.panDelta&&(r.panDelta=(r.panDelta||new a.Point(0,0))._add(y.panDelta)),y.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+y.pitchDelta),void 0!==y.around&&(r.around=y.around),void 0!==y.aroundCoord&&(r.aroundCoord=y.aroundCoord),void 0!==y.pinchAround&&(r.pinchAround=y.pinchAround),y.noInertia&&(r.noInertia=y.noInertia),a.extend(u,b),a.extend(m,S);this._updateMapTransform(r,u,m),this._changes=[]}_updateMapTransform(r,u,m){const y=this._map,b=y.transform,S=qe=>[qe.x,qe.y,qe.z];if((qe=>{const yt=this._eventsInProgress.drag;return yt&&!this._handlersById[yt.handlerName].isActive()})()&&!ha(r)){const qe=b.zoom;b.cameraElevationReference="sea",b.recenterOnTerrain(),b.cameraElevationReference="ground",qe!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&y._stop(!0),!ha(r))return void this._fireEvents(u,m,!0);let{panDelta:z,zoomDelta:U,bearingDelta:J,pitchDelta:Q,around:we,aroundCoord:Ye,pinchAround:Qe}=r;b._isCameraConstrained&&(U>0&&(U=0),b._isCameraConstrained=!1),void 0!==Qe&&(we=Qe),(U||(qe=>u.drag&&!this._eventsInProgress.drag)())&&we&&(this._dragOrigin=S(b.pointCoordinate3D(we)),this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",y._stop(!0),we=we||y.transform.centerPoint,J&&(b.bearing+=J),Q&&(b.pitch+=Q),b._updateCameraState();const ut=[0,0,0];if(z)if("mercator"===b.projection.name){const qe=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(we).dir),yt=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(we.sub(z)).dir);ut[0]=yt[0]-qe[0],ut[1]=yt[1]-qe[1]}else{const qe=b.pointCoordinate(we);if("globe"===b.projection.name){z=z.rotate(-b.angle);const yt=b._pixelsPerMercatorPixel/b.worldSize;ut[0]=-z.x*a.mercatorScale(a.latFromMercatorY(qe.y))*yt,ut[1]=-z.y*a.mercatorScale(b.center.lat)*yt}else{const yt=b.pointCoordinate(we.sub(z));qe&&yt&&(ut[0]=yt.x-qe.x,ut[1]=yt.y-qe.y)}}const it=b.zoom,ft=[0,0,0];if(U){const qe=S(Ye||b.pointCoordinate3D(we)),yt={dir:a.normalize([],a.sub([],qe,b._camera.position))};if(yt.dir[2]<0){const Mt=b.zoomDeltaToMovement(qe,U);a.scale$2(ft,yt.dir,Mt)}}const Ee=a.add(ut,ut,ft);b._translateCameraConstrained(Ee),U&&Math.abs(b.zoom-it)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(u,m,!0)}_fireEvents(r,u,m){const y=Jo(this._eventsInProgress),b=Jo(r),S={};for(const Q in r){const{originalEvent:we}=r[Q];this._eventsInProgress[Q]||(S[`${Q}start`]=we),this._eventsInProgress[Q]=r[Q]}!y&&b&&this._fireEvent("movestart",b.originalEvent);for(const Q in S)this._fireEvent(Q,S[Q]);b&&this._fireEvent("move",b.originalEvent);for(const Q in r){const{originalEvent:we}=r[Q];this._fireEvent(Q,we)}const z={};let U;for(const Q in this._eventsInProgress){const{handlerName:we,originalEvent:Ye}=this._eventsInProgress[Q];this._handlersById[we].isActive()||(delete this._eventsInProgress[Q],U=u[we]||Ye,z[`${Q}end`]=U)}for(const Q in z)this._fireEvent(Q,z[Q]);const J=Jo(this._eventsInProgress);if(m&&(y||b)&&!J){this._updatingCamera=!0;const Q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),we=Ye=>0!==Ye&&-this._bearingSnap<Ye&&Ye<this._bearingSnap;Q?(we(Q.bearing||this._map.getBearing())&&(Q.bearing=0),this._map.easeTo(Q,{originalEvent:U})):(this._map.fire(new a.Event("moveend",{originalEvent:U})),we(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,u){this._map.fire(new a.Event(r,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new wa("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const da="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class mc extends a.Evented{constructor(r,u){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=!1!==u.respectPrefersReducedMotion,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,u){return this.jumpTo({center:r},u)}panBy(r,u,m){return r=a.Point.convert(r).mult(-1),this.panTo(this.transform.center,a.extend({offset:r},u),m)}panTo(r,u,m){return this.easeTo(a.extend({center:r},u),m)}getZoom(){return this.transform.zoom}setZoom(r,u){return this.jumpTo({zoom:r},u),this}zoomTo(r,u,m){return this.easeTo(a.extend({zoom:r},u),m)}zoomIn(r,u){return this.zoomTo(this.getZoom()+1,r,u),this}zoomOut(r,u){return this.zoomTo(this.getZoom()-1,r,u),this}getBearing(){return this.transform.bearing}setBearing(r,u){return this.jumpTo({bearing:r},u),this}getPadding(){return this.transform.padding}setPadding(r,u){return this.jumpTo({padding:r},u),this}rotateTo(r,u,m){return this.easeTo(a.extend({bearing:r},u),m)}resetNorth(r,u){return this.rotateTo(0,a.extend({duration:1e3},r),u),this}resetNorthPitch(r,u){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},r),u),this}snapToNorth(r,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,u):this}getPitch(){return this.transform.pitch}setPitch(r,u){return this.jumpTo({pitch:r},u),this}cameraForBounds(r,u){r=a.LngLatBounds.convert(r);const m=u&&u.bearing||0,y=u&&u.pitch||0,b=r.getNorthWest(),S=r.getSouthEast();return this._cameraForBounds(this.transform,b,S,m,y,u)}_extendCameraOptions(r){const u={top:0,bottom:0,right:0,left:0};if("number"==typeof(r=a.extend({padding:u,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){const m=r.padding;r.padding={top:m,bottom:m,right:m,left:m}}return r.padding=a.extend(u,r.padding),r}_minimumAABBFrustumDistance(r,u){const m=u.max[0]-u.min[0],y=u.max[1]-u.min[1];return m/y>r.aspect?m/(2*Math.tan(.5*r.fovX)*r.aspect):y/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,u,m,y,b,S){const z=r.clone(),U=this._extendCameraOptions(S);z.bearing=y,z.pitch=b;const J=a.LngLat.convert(u),Q=a.LngLat.convert(m),we=.5*(J.lat+Q.lat),Ye=.5*(J.lng+Q.lng),Qe=a.latLngToECEF(we,Ye),ut=a.normalize([],Qe),it=a.normalize([],a.cross([],ut,[0,1,0])),ft=a.cross([],it,ut),Ee=[it[0],it[1],it[2],0,ft[0],ft[1],ft[2],0,ut[0],ut[1],ut[2],0,0,0,0,1],qe=[Qe,a.latLngToECEF(J.lat,J.lng),a.latLngToECEF(Q.lat,J.lng),a.latLngToECEF(Q.lat,Q.lng),a.latLngToECEF(J.lat,Q.lng),a.latLngToECEF(we,J.lng),a.latLngToECEF(we,Q.lng),a.latLngToECEF(J.lat,Ye),a.latLngToECEF(Q.lat,Ye)];let yt=a.Aabb.fromPoints(qe.map(Qn=>[a.dot(it,Qn),a.dot(ft,Qn),a.dot(ut,Qn)]));const Mt=a.transformMat4([],yt.center,Ee);0===a.squaredLength(Mt)&&a.set(Mt,0,0,1),a.normalize(Mt,Mt),a.scale$2(Mt,Mt,a.GLOBE_RADIUS),z.center=a.ecefToLatLng(Mt);const $t=z.getWorldToCameraMatrix(),Wt=a.invert(new Float64Array(16),$t);yt=a.Aabb.applyTransform(yt,a.multiply([],$t,Ee)),a.transformMat4(Mt,Mt,$t);const Ot=.5*(yt.max[2]-yt.min[2]),on=this._minimumAABBFrustumDistance(z,yt),Zt=a.scale$2([],[0,0,1],Ot),cn=a.add(Zt,Mt,Zt),li=on+(0===z.pitch?0:a.distance(Mt,cn)),fn=z.globeCenterInViewSpace,Fn=a.sub([],Mt,[fn[0],fn[1],fn[2]]);a.normalize(Fn,Fn),a.scale$2(Fn,Fn,li);const gn=a.add([],Mt,Fn);a.transformMat4(gn,gn,Wt);const ai=a.earthRadius/a.GLOBE_RADIUS,vn=a.length(gn),Hn=a.mercatorZfromAltitude(Math.max(vn*ai-a.earthRadius,Number.EPSILON),0),ri=Math.min(z.zoomFromMercatorZAdjusted(Hn),U.maxZoom);return ri>.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(z.setProjection({name:"mercator"}),z.zoom=ri,this._cameraForBounds(z,u,m,y,b,S)):{center:z.center,zoom:ri,bearing:y,pitch:b}}queryTerrainElevation(r,u){const m=this.transform.elevation;return m?(u=a.extend({},{exaggerated:!0},u),m.getAtPoint(a.MercatorCoordinate.fromLngLat(r),null,u.exaggerated)):null}_cameraForBounds(r,u,m,y,b,S){if("globe"===r.projection.name)return this._cameraForBoundsOnGlobe(r,u,m,y,b,S);const z=r.clone(),U=this._extendCameraOptions(S),J=z.padding;z.bearing=y,z.pitch=b;const Q=a.LngLat.convert(u),we=a.LngLat.convert(m),Ye=new a.LngLat(Q.lng,we.lat),Qe=new a.LngLat(we.lng,Q.lat),ut=z.project(Q),it=z.project(we),ft=this.queryTerrainElevation(Q),Ee=this.queryTerrainElevation(we),qe=this.queryTerrainElevation(Ye),yt=this.queryTerrainElevation(Qe),Mt=[[ut.x,ut.y,Math.min(ft||0,Ee||0,qe||0,yt||0)],[it.x,it.y,Math.max(ft||0,Ee||0,qe||0,yt||0)]];let $t=a.Aabb.fromPoints(Mt);const Wt=z.getWorldToCameraMatrix(),Ot=a.invert(new Float64Array(16),Wt);$t=a.Aabb.applyTransform($t,Wt);const on=a.sub([],$t.max,$t.min),Zt=J.left||0,cn=J.right||0,li=J.bottom||0,fn=J.top||0,{left:Fn,right:gn,top:ai,bottom:vn}=U.padding,Hn=.5*(Zt+cn),ri=.5*(fn+li),Qn=Math.min(z.scaleZoom(z.scale*Math.min((z.width-(Zt+cn+Fn+gn))/on[0],(z.height-(li+fn+vn+ai))/on[1])),U.maxZoom),fi=z.scale/z.zoomScale(Qn);$t=new a.Aabb([$t.min[0]-(Fn+Hn)*fi,$t.min[1]-(vn+ri)*fi,$t.min[2]],[$t.max[0]+(gn+Hn)*fi,$t.max[1]+(ai+ri)*fi,$t.max[2]]);const tr=.5*on[2],wr=this._minimumAABBFrustumDistance(z,$t),Vi=[0,0,1,0];a.transformMat4$1(Vi,Vi,Wt),a.normalize$2(Vi,Vi);const or=a.scale$2([],Vi,wr+tr),Ur=a.add([],$t.center,or),Zr=("number"==typeof U.offset.x&&"number"==typeof U.offset.y?new a.Point(U.offset.x,U.offset.y):a.Point.convert(U.offset)).rotate(-a.degToRad(y));$t.center[0]-=Zr.x*fi,$t.center[1]+=Zr.y*fi,a.transformMat4($t.center,$t.center,Ot),a.transformMat4(Ur,Ur,Ot);const Qi=[$t.center[0],$t.center[1],Ur[2]*z.pixelsPerMeter];a.scale$2(Qi,Qi,1/z.worldSize);const Wi=a.lngFromMercatorX(Qi[0]),Vo=a.latFromMercatorY(Qi[1]),es=Math.min(z._zoomFromMercatorZ(Qi[2]),U.maxZoom),Co=new a.LngLat(Wi,Vo);return z.mercatorFromTransition&&es<.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(z.setProjection({name:"globe"}),z.zoom=es,this._cameraForBounds(z,u,m,y,b,S)):{center:Co,zoom:es,bearing:y,pitch:b}}fitBounds(r,u,m){const y=this.cameraForBounds(r,u);return this._fitInternal(y,u,m)}fitScreenCoordinates(r,u,m,y,b){const S=a.Point.convert(r),z=a.Point.convert(u),U=new a.Point(Math.min(S.x,z.x),Math.min(S.y,z.y)),J=new a.Point(Math.max(S.x,z.x),Math.max(S.y,z.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(S,z))return this;const Q=this.transform.pointLocation3D(U),we=this.transform.pointLocation3D(J),Ye=this.transform.pointLocation3D(new a.Point(U.x,J.y)),Qe=this.transform.pointLocation3D(new a.Point(J.x,U.y)),ut=[Math.min(Q.lng,we.lng,Ye.lng,Qe.lng),Math.min(Q.lat,we.lat,Ye.lat,Qe.lat)],it=[Math.max(Q.lng,we.lng,Ye.lng,Qe.lng),Math.max(Q.lat,we.lat,Ye.lat,Qe.lat)],ft=y&&y.pitch?y.pitch:this.getPitch(),Ee=this._cameraForBounds(this.transform,ut,it,m,ft,y);return this._fitInternal(Ee,y,b)}_fitInternal(r,u,m){return r?(delete(u=a.extend(r,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this}jumpTo(r,u){this.stop();const m=r.preloadOnly?this.transform.clone():this.transform;let y=!1,b=!1,S=!1;return"zoom"in r&&m.zoom!==+r.zoom&&(y=!0,m.zoom=+r.zoom),void 0!==r.center&&(m.center=a.LngLat.convert(r.center)),"bearing"in r&&m.bearing!==+r.bearing&&(b=!0,m.bearing=+r.bearing),"pitch"in r&&m.pitch!==+r.pitch&&(S=!0,m.pitch=+r.pitch),null==r.padding||m.isPaddingEqual(r.padding)||(m.padding=r.padding),r.preloadOnly?(this._preloadTiles(m),this):(this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),y&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),b&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),S&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(da),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,u){const m=this.transform;if(!m.projection.supportsFreeCamera)return a.warnOnce(da),this;this.stop();const y=m.zoom,b=m.pitch,S=m.bearing;m.setFreeCameraOptions(r);const z=y!==m.zoom,U=b!==m.pitch,J=S!==m.bearing;return this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),z&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),J&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),U&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u)),this}easeTo(r,u){this._stop(!1,r.easeId),(!1===(r=a.extend({offset:[0,0],duration:500,easing:a.ease},r)).animate||this._prefersReducedMotion(r))&&(r.duration=0);const m=this.transform,y=this.getZoom(),b=this.getBearing(),S=this.getPitch(),z=this.getPadding(),U="zoom"in r?+r.zoom:y,J="bearing"in r?this._normalizeBearing(r.bearing,b):b,Q="pitch"in r?+r.pitch:S,we="padding"in r?r.padding:m.padding,Ye=a.Point.convert(r.offset);let Qe,ut,it;if("globe"===m.projection.name){const Zt=a.MercatorCoordinate.fromLngLat(m.center),cn=Ye.rotate(-m.angle);Zt.x+=cn.x/m.worldSize,Zt.y+=cn.y/m.worldSize;const li=Zt.toLngLat(),fn=a.LngLat.convert(r.center||li);this._normalizeCenter(fn),Qe=m.centerPoint.add(cn),ut=new a.Point(Zt.x,Zt.y).mult(m.worldSize),it=new a.Point(a.mercatorXfromLng(fn.lng),a.mercatorYfromLat(fn.lat)).mult(m.worldSize).sub(ut)}else{Qe=m.centerPoint.add(Ye);const Zt=m.pointLocation(Qe),cn=a.LngLat.convert(r.center||Zt);this._normalizeCenter(cn),ut=m.project(Zt),it=m.project(cn).sub(ut)}const ft=m.zoomScale(U-y);let Ee,qe;r.around&&(Ee=a.LngLat.convert(r.around),qe=m.locationPoint(Ee));const yt=this._zooming||U!==y,Mt=this._rotating||b!==J,$t=this._pitching||Q!==S,Wt=!m.isPaddingEqual(we),Ot=Zt=>cn=>{if(yt&&(Zt.zoom=a.number(y,U,cn)),Mt&&(Zt.bearing=a.number(b,J,cn)),$t&&(Zt.pitch=a.number(S,Q,cn)),Wt&&(Zt.interpolatePadding(z,we,cn),Qe=Zt.centerPoint.add(Ye)),Ee)Zt.setLocationAtPoint(Ee,qe);else{const li=Zt.zoomScale(Zt.zoom-y),fn=U>y?Math.min(2,ft):Math.max(.5,ft),Fn=Math.pow(fn,1-cn),gn=Zt.unproject(ut.add(it.mult(cn*Fn)).mult(li));Zt.setLocationAtPoint(Zt.renderWorldCopies?gn.wrap():gn,Qe)}return r.preloadOnly||this._fireMoveEvents(u),Zt};if(r.preloadOnly){const Zt=this._emulate(Ot,r.duration,m);return this._preloadTiles(Zt),this}const on={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=yt,this._rotating=Mt,this._pitching=$t,this._padding=Wt,this._easeId=r.easeId,this._prepareEase(u,r.noMoveStart,on),this._ease(Ot(m),Zt=>{m.recenterOnTerrain(),this._afterEase(u,Zt)},r),this}_prepareEase(r,u,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",u||m.moving||this.fire(new a.Event("movestart",r)),this._zooming&&!m.zooming&&this.fire(new a.Event("zoomstart",r)),this._rotating&&!m.rotating&&this.fire(new a.Event("rotatestart",r)),this._pitching&&!m.pitching&&this.fire(new a.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new a.Event("move",r)),this._zooming&&this.fire(new a.Event("zoom",r)),this._rotating&&this.fire(new a.Event("rotate",r)),this._pitching&&this.fire(new a.Event("pitch",r))}_afterEase(r,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,y=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new a.Event("zoomend",r)),y&&this.fire(new a.Event("rotateend",r)),b&&this.fire(new a.Event("pitchend",r)),this.fire(new a.Event("moveend",r))}flyTo(r,u){if(this._prefersReducedMotion(r)){const Qn=a.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Qn,u)}this.stop(),r=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},r);const m=this.transform,y=this.getZoom(),b=this.getBearing(),S=this.getPitch(),z=this.getPadding(),U="zoom"in r?a.clamp(+r.zoom,m.minZoom,m.maxZoom):y,J="bearing"in r?this._normalizeBearing(r.bearing,b):b,Q="pitch"in r?+r.pitch:S,we="padding"in r?r.padding:m.padding,Ye=m.zoomScale(U-y),Qe=a.Point.convert(r.offset);let ut=m.centerPoint.add(Qe);const it=m.pointLocation(ut),ft=a.LngLat.convert(r.center||it);this._normalizeCenter(ft);const Ee=m.project(it),qe=m.project(ft).sub(Ee);let yt=r.curve;const Mt=Math.max(m.width,m.height),$t=Mt/Ye,Wt=qe.mag();if("minZoom"in r){const Qn=a.clamp(Math.min(r.minZoom,y,U),m.minZoom,m.maxZoom),fi=Mt/m.zoomScale(Qn-y);yt=Math.sqrt(fi/Wt*2)}const Ot=yt*yt;function on(Qn){const fi=($t*$t-Mt*Mt+(Qn?-1:1)*Ot*Ot*Wt*Wt)/(2*(Qn?$t:Mt)*Ot*Wt);return Math.log(Math.sqrt(fi*fi+1)-fi)}function Zt(Qn){return(Math.exp(Qn)-Math.exp(-Qn))/2}function cn(Qn){return(Math.exp(Qn)+Math.exp(-Qn))/2}const li=on(0);let fn=function(Qn){return cn(li)/cn(li+yt*Qn)},Fn=function(Qn){return Mt*((cn(li)*(Zt(fi=li+yt*Qn)/cn(fi))-Zt(li))/Ot)/Wt;var fi},gn=(on(1)-li)/yt;if(Math.abs(Wt)<1e-6||!isFinite(gn)){if(Math.abs(Mt-$t)<1e-6)return this.easeTo(r,u);const Qn=$t<Mt?-1:1;gn=Math.abs(Math.log($t/Mt))/yt,Fn=function(){return 0},fn=function(fi){return Math.exp(Qn*yt*fi)}}r.duration="duration"in r?+r.duration:1e3*gn/("screenSpeed"in r?+r.screenSpeed/yt:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const ai=b!==J,vn=Q!==S,Hn=!m.isPaddingEqual(we),ri=Qn=>fi=>{const tr=fi*gn,wr=1/fn(tr);Qn.zoom=1===fi?U:y+Qn.scaleZoom(wr),ai&&(Qn.bearing=a.number(b,J,fi)),vn&&(Qn.pitch=a.number(S,Q,fi)),Hn&&(Qn.interpolatePadding(z,we,fi),ut=Qn.centerPoint.add(Qe));const Vi=1===fi?ft:Qn.unproject(Ee.add(qe.mult(Fn(tr))).mult(wr));return Qn.setLocationAtPoint(Qn.renderWorldCopies?Vi.wrap():Vi,ut),Qn._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(u),Qn};if(r.preloadOnly){const Qn=this._emulate(ri,r.duration,m);return this._preloadTiles(Qn),this}return this._zooming=!0,this._rotating=ai,this._pitching=vn,this._padding=Hn,this._prepareEase(u,!1),this._ease(ri(m),()=>this._afterEase(u),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,u)}if(!r){const m=this.handlers;m&&m.stop(!1)}return this}_ease(r,u,m){!1===m.animate||0===m.duration?(r(1),u()):(this._easeStart=a.exported.now(),this._easeOptions=m,this._onEaseFrame=r,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,u){r=a.wrap(r,-180,180);const m=Math.abs(r-u);return Math.abs(r-360-u)<m&&(r-=360),Math.abs(r+360-u)<m&&(r+=360),r}_normalizeCenter(r){const u=this.transform;if(!u.renderWorldCopies||u.maxBounds)return;const m=r.lng-u.center.lng;r.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&a.exported.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,u,m){const y=Math.ceil(15*u/1e3),b=[],S=r(m.clone());for(let z=0;z<=y;z++){const U=S(z/y);b.push(U.clone())}return b}}class $i{constructor(r={}){this.options=r,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const u=this.options&&this.options.compact;return this._map=r,this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=fe("button","mapboxgl-ctrl-attrib-button",this._container),fe("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=fe("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===u&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(r,u){const m=this._map._getUIString(`AttributionControl.${u}`);r.setAttribute("aria-label",m),r.removeAttribute("title"),r.firstElementChild&&r.firstElementChild.setAttribute("title",m)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(r){const m=u.reduce((y,b,S)=>(b.value&&(y+=`${b.key}=${b.value}${S<u.length-1?"&":""}`),y),"?");r.href=`${a.config.FEEDBACK_URL}/${m}#${pe(this._map,!0)}`,r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}}_updateData(r){!r||"metadata"!==r.sourceDataType&&"visibility"!==r.sourceDataType&&"style"!==r.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const u=this._map.style._sourceCaches;for(const y in u){const b=u[y];if(b.used){const S=b.getSource();S.attribution&&r.indexOf(S.attribution)<0&&r.push(S.attribution)}}r.sort((y,b)=>y.length-b.length),r=r.filter((y,b)=>{for(let S=b+1;S<r.length;S++)if(r[S].indexOf(y)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const m=r.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,r.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class tu{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=fe("div","mapboxgl-ctrl");const u=fe("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&"metadata"!==r.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(0===Object.entries(r).length)return!0;for(const u in r){const m=r[u].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const u=r[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class zc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const u=++this._id;return this._queue.push({callback:r,id:u,cancelled:!1}),u}remove(r){const u=this._currentlyRunning,m=u?this._queue.concat(u):this._queue;for(const y of m)if(y.id===r)return void(y.cancelled=!0)}run(r=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const m of u)if(!m.cancelled&&(m.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Xl(d,r,u){if(d=new a.LngLat(d.lng,d.lat),r){const m=new a.LngLat(d.lng-360,d.lat),y=new a.LngLat(d.lng+360,d.lat),b=360*Math.ceil(Math.abs(d.lng-u.center.lng)/360),S=u.locationPoint(d).distSqr(r),z=r.x<0||r.y<0||r.x>u.width||r.y>u.height;u.locationPoint(m).distSqr(r)<S&&(z||Math.abs(m.lng-u.center.lng)<b)?d=m:u.locationPoint(y).distSqr(r)<S&&(z||Math.abs(y.lng-u.center.lng)<b)&&(d=y)}for(;Math.abs(d.lng-u.center.lng)>180;){const m=u.locationPoint(d);if(m.x>=0&&m.y>=0&&m.x<=u.width&&m.y<=u.height)break;d.lng>u.center.lng?d.lng-=360:d.lng+=360}return d}const rc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ti extends a.Evented{constructor(r,u){if(super(),(r instanceof a.window.HTMLElement||u)&&(r=a.extend({element:r},u)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=a.Point.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=fe("div");const y=41,b=27,S=he("svg",{display:"block",height:y*this._scale+"px",width:b*this._scale+"px",viewBox:`0 0 ${b} ${y}`},this._element),z=he("radialGradient",{id:"shadowGradient"},he("defs",{},S));he("stop",{offset:"10%","stop-opacity":.4},z),he("stop",{offset:"100%","stop-opacity":.05},z),he("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},S),he("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},S),he("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},S),he("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},S),this._offset=a.Point.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()});const m=this._element.classList;for(const y in rc)m.remove(`mapboxgl-marker-anchor-${y}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=a.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(24.6+y)],"bottom-right":[-y,-1*(24.6+y)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const u=r.code,m=r.charCode||r.keyCode;"Space"!==u&&"Enter"!==u&&32!==m&&13!==m||this.togglePopup()}_onMapClick(r){const u=r.originalEvent.target,m=this._element;this._popup&&(u===m||m.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,u=this._pos;if(!r||!u)return!1;const m=r.unproject(u),y=r.getFreeCameraOptions();if(!y.position)return!1;const b=y.position.toLngLat();return b.distanceTo(m)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const u=this._pos;if(!u||u.x<0||u.x>r.transform.width||u.y<0||u.y>r.transform.height)return void this._clearFadeTimer();const m=r.unproject(u);let y;r._showingGlobe()&&a.isLngLatBehindGlobe(r.transform,this._lngLat)?y=0:(y=1-r._queryFogOpacity(m),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(y*=this._occludedOpacity)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${r.x}px,${r.y}px)\n            ${rc[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${u.x}px,${u.y}px)\n        `}_calculateXYTransform(){const r=this._pos,u=this._map,m=this.getPitchAlignment();if(!u||!r||"map"!==m)return"";if(!u._showingGlobe()){const U=u.getPitch();return U?`rotateX(${U}deg)`:""}const y=a.radToDeg(a.globeTiltAtLngLat(u.transform,this._lngLat)),b=r.sub(a.globeCenterToScreenPoint(u.transform)),S=Math.abs(b.x)+Math.abs(b.y);if(0===S)return"";const z=y/S;return`rotateX(${-b.y*z}deg) rotateY(${b.x*z}deg)`}_calculateZTransform(){const r=this._pos,u=this._map;if(!u||!r)return"";let m=0;const y=this.getRotationAlignment();if("map"===y)if(u._showingGlobe()){const b=u.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),S=u.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);m=a.radToDeg(Math.atan2(S.y,S.x))-90}else m=-u.getBearing();else if("horizon"===y){const b=a.smoothstep(4,6,u.getZoom()),S=a.globeCenterToScreenPoint(u.transform);S.y+=b*u.transform.height;const z=r.sub(S),U=a.radToDeg(Math.atan2(z.y,z.x));m=(U>90?U-270:U+90)*(1-b)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(r){a.window.cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=Xl(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat),!0===r?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=a.Point.convert(r),this._update(),this}_onMove(r){const u=this._map;if(!u)return;const m=this._pointerdownPos,y=this._positionDelta;if(m&&y){if(!this._isDragging){const b=this._clickTolerance||u._clickTolerance;if(r.point.dist(m)<b)return;this._isDragging=!0}this._pos=r.point.sub(y),this._lngLat=u.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(r){const u=this._map,m=this._pos;u&&m&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(m),this._pointerdownPos=r.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const u=this._map;return u&&(r?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Nu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Bh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function hh(d=new a.Point(0,0),r="bottom"){if("number"==typeof d){const u=Math.round(Math.sqrt(.5*Math.pow(d,2)));switch(r){case"top":return new a.Point(0,d);case"top-left":return new a.Point(u,u);case"top-right":return new a.Point(-u,u);case"bottom":return new a.Point(0,-d);case"bottom-left":return new a.Point(u,-u);case"bottom-right":return new a.Point(-u,-u);case"left":return new a.Point(d,0);case"right":return new a.Point(-d,0)}return new a.Point(0,0)}return d instanceof a.Point||Array.isArray(d)?a.Point.convert(d):a.Point.convert(d[r]||[0,0])}class pu{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const u=a.easeCubicInOut((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,u,m){this._start=this.getValue(u),this._end=r,this._startTime=u,this._endTime=u+m}}const Vu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},I={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},G={showCompass:!0,showZoom:!0,visualizePitch:!1};class B{constructor(r,u,m=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new Ds({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,m&&(this.mousePitch=new Ir({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(r,u){this.mouseRotate.mousedown(r,u),this.mousePitch&&this.mousePitch.mousedown(r,u),$e()}move(r,u){const m=this.map,y=this.mouseRotate.mousemoveWindow(r,u),b=y&&y.bearingDelta;if(b&&m.setBearing(m.getBearing()+b),this.mousePitch){const S=this.mousePitch.mousemoveWindow(r,u),z=S&&S.pitchDelta;z&&m.setPitch(m.getPitch()+z)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ze(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(a.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Qt(this.element,r)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,Qt(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){1!==r.targetTouches.length?this.reset():(this._startPos=this._lastPos=sn(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){1!==r.targetTouches.length?this.reset():(this._lastPos=sn(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){0===r.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const $={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},me={maxWidth:100,unit:"metric"},We={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},kt={version:a.version,supported:Fe,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends mc{constructor(d){if(a.LivePerformanceUtils.mark(a.PerformanceMarkers.create),null!=(d=a.extend({},I,d)).minZoom&&null!=d.maxZoom&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=d.minPitch&&null!=d.maxPitch&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=d.minPitch&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=d.maxPitch&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(d.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(d.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new L(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),d),this._interactive=d.interactive,this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._useWebGL2=d.useWebGL2,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=d.crossSourceCollisions,this._collectResourceTiming=d.collectResourceTiming,this._optimizeForTerrain=d.optimizeForTerrain,this._language=this._parseLanguage(d.language),this._worldview=d.worldview,this._renderTaskQueue=new zc,this._domRenderTaskQueue=new zc,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Vu,d.locale),this._clickTolerance=d.clickTolerance,this._cooperativeGestures=d.cooperativeGestures,this._performanceMetricsCollection=d.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new pu(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.RequestManager(d.transformRequest,d.accessToken,d.testMode),this._silenceAuthErrors=!!d.testMode,"string"==typeof d.container){if(this._container=a.window.document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),d.maxBounds&&this.setMaxBounds(d.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==a.window&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new ja(this,d),this._localFontFamily=d.localFontFamily,this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),d.projection&&this.setProjection(d.projection),this._hash=d.hash&&new X("string"==typeof d.hash&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,a.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),d.attributionControl&&this.addControl(new $i({customAttribution:d.customAttribution})),this._logoControl=new tu,this.addControl(this._logoControl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update("style"===r.dataType),this.fire(new a.Event(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new a.Event(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(d,r){if(void 0===r&&(r=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=d.onAdd(this);this._controls.push(d);const m=this._controlPositions[r];return-1!==r.indexOf("bottom")?m.insertBefore(u,m.firstChild):m.appendChild(u),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(d);return r>-1&&this._controls.splice(r,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(d){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new a.Event("movestart",d)).fire(new a.Event("move",d)),this.fire(new a.Event("resize",d)),r&&this.fire(new a.Event("moveend",d)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(d){return this.transform.setMaxBounds(a.LngLatBounds.convert(d)),this._update()}setMinZoom(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d?this.setZoom(d):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d??22)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d?this.setZoom(d):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d?this.setPitch(d):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d?this.setPitch(d):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(d){return"auto"===d?a.window.navigator.language:Array.isArray(d)?0===d.length?void 0:d.map(r=>"auto"===r?a.window.navigator.language:r):d}setLanguage(d){const r=this._parseLanguage(d);if(!this.style||r===this._language)return this;this._language=r,this.style._reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(d){return this.style&&d!==this._worldview?(this._worldview=d,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(d){return this._lazyInitEmptyStyle(),d?"string"==typeof d&&(d={name:d}):d=null,this._useExplicitProjection=!!d,this._prioritizeAndUpdateProjection(d,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const d=this.transform,r=d.projection.name;let u;"globe"===r&&d.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(d.setMercatorFromTransition(),u=!0):"mercator"===r&&d.zoom<a.GLOBE_ZOOM_THRESHOLD_MAX&&(d.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(d,r){return this._updateProjection(d||r||{name:"mercator"})}_updateProjection(d){let r;if(r="globe"===d.name&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(d),this.style.applyProjectionUpdate(),r){this.painter.clearBackgroundTiles();for(const u in this.style._sourceCaches)this.style._sourceCaches[u].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(d){return this.transform.locationPoint3D(a.LngLat.convert(d))}unproject(d){return this.transform.pointLocation3D(a.Point.convert(d))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(d,r,u){if("mouseenter"===d||"mouseover"===d){let m=!1;const y=S=>{const z=r.filter(J=>this.getLayer(J)),U=z.length?this.queryRenderedFeatures(S.point,{layers:z}):[];U.length?m||(m=!0,u.call(this,new _r(d,this,S.originalEvent,{features:U}))):m=!1},b=()=>{m=!1};return{layers:new Set(r),listener:u,delegates:{mousemove:y,mouseout:b}}}if("mouseleave"===d||"mouseout"===d){let m=!1;const y=S=>{const z=r.filter(U=>this.getLayer(U));(z.length?this.queryRenderedFeatures(S.point,{layers:z}):[]).length?m=!0:m&&(m=!1,u.call(this,new _r(d,this,S.originalEvent)))},b=S=>{m&&(m=!1,u.call(this,new _r(d,this,S.originalEvent)))};return{layers:new Set(r),listener:u,delegates:{mousemove:y,mouseout:b}}}{const m=y=>{const b=r.filter(z=>this.getLayer(z)),S=b.length?this.queryRenderedFeatures(y.point,{layers:b}):[];S.length&&(y.features=S,u.call(this,y),delete y.features)};return{layers:new Set(r),listener:u,delegates:{[d]:m}}}}on(d,r,u){if(void 0===u)return super.on(d,r);Array.isArray(r)||(r=[r]);const m=this._createDelegatedListener(d,r,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(m);for(const y in m.delegates)this.on(y,m.delegates[y]);return this}once(d,r,u){if(void 0===u)return super.once(d,r);Array.isArray(r)||(r=[r]);const m=this._createDelegatedListener(d,r,u);for(const y in m.delegates)this.once(y,m.delegates[y]);return this}off(d,r,u){if(void 0===u)return super.off(d,r);r=new Set(Array.isArray(r)?r:[r]);const m=(b,S)=>{if(b.size!==S.size)return!1;for(const z of b)if(!S.has(z))return!1;return!0},y=this._delegatedListeners?this._delegatedListeners[d]:void 0;return y&&(b=>{for(let S=0;S<b.length;S++){const z=b[S];if(z.listener===u&&m(z.layers,r)){for(const U in z.delegates)this.off(U,z.delegates[U]);return b.splice(S,1),this}}})(y),this}queryRenderedFeatures(d,r){return this.style?(void 0!==r||void 0===d||d instanceof a.Point||Array.isArray(d)||(r=d,d=void 0),this.style.queryRenderedFeatures(d=d||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(d,r){return this.style.querySourceFeatures(d,r)}isPointOnSurface(d){const{name:r}=this.transform.projection;return"globe"!==r&&"mercator"!==r&&a.warnOnce(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.Point.convert(d))}setStyle(d,r){return!1!==(r=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&d?(this._diffStyle(d,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(d,r))}_getUIString(d){const r=this._locale[d];if(null==r)throw new Error(`Missing UI string '${d}'`);return r}_updateStyle(d,r){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),d&&(this.style=new ls(this,r||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof d?this.style.loadURL(d):this.style.loadJSON(d)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ls(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,r){if("string"==typeof d){const u=this._requestManager.normalizeStyleURL(d),m=this._requestManager.transformRequest(u,a.ResourceType.Style);a.getJSON(m,(y,b)=>{y?this.fire(new a.ErrorEvent(y)):b&&this._updateDiff(b,r)})}else"object"==typeof d&&this._updateDiff(d,r)}_updateDiff(d,r){try{this.style.setState(d)&&this._update(!0)}catch(u){a.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(d,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(d,r){return this._lazyInitEmptyStyle(),this.style.addSource(d,r),this._update(!0)}isSourceLoaded(d){return!!this.style&&this.style._isSourceCacheLoaded(d)}areTilesLoaded(){const d=this.style&&this.style._sourceCaches;for(const r in d){const u=d[r]._tiles;for(const m in u){const y=u[m];if("loaded"!==y.state&&"errored"!==y.state)return!1}}return!0}addSourceType(d,r,u){this._lazyInitEmptyStyle(),this.style.addSourceType(d,r,u)}removeSource(d){return this.style.removeSource(d),this._updateTerrain(),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,r,{pixelRatio:u=1,sdf:m=!1,stretchX:y,stretchY:b,content:S}={}){if(this._lazyInitEmptyStyle(),r instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&r instanceof a.window.ImageBitmap){const{width:z,height:U,data:J}=a.exported.getImageData(r);this.style.addImage(d,{data:new a.RGBAImage({width:z,height:U},J),pixelRatio:u,stretchX:y,stretchY:b,content:S,sdf:m,version:0})}else if(void 0===r.width||void 0===r.height)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:z,height:U}=r,J=r;this.style.addImage(d,{data:new a.RGBAImage({width:z,height:U},new Uint8Array(J.data)),pixelRatio:u,stretchX:y,stretchY:b,content:S,sdf:m,version:0,userImage:J}),J.onAdd&&J.onAdd(this,d)}}updateImage(d,r){const u=this.style.getImage(d);if(!u)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=r instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&r instanceof a.window.ImageBitmap?a.exported.getImageData(r):r,{width:y,height:b}=m;void 0!==y&&void 0!==b?y===u.data.width&&b===u.data.height?(u.data.replace(m.data,!(r instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&r instanceof a.window.ImageBitmap)),this.style.updateImage(d,u)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${y}, ${b})\n                must be that same as the previous version of the image\n                (${u.data.width}, ${u.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,r){a.getImage(this._requestManager.transformRequest(d,a.ResourceType.Image),(u,m)=>{r(u,m instanceof a.window.HTMLImageElement?a.exported.getImageData(m):m)})}listImages(){return this.style.listImages()}addLayer(d,r){return this._lazyInitEmptyStyle(),this.style.addLayer(d,r),this._update(!0)}moveLayer(d,r){return this.style.moveLayer(d,r),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}setLayerZoomRange(d,r,u){return this.style.setLayerZoomRange(d,r,u),this._update(!0)}setFilter(d,r,u={}){return this.style.setFilter(d,r,u),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,r,u,m={}){return this.style.setPaintProperty(d,r,u,m),this._update(!0)}getPaintProperty(d,r){return this.style.getPaintProperty(d,r)}setLayoutProperty(d,r,u,m={}){return this.style.setLayoutProperty(d,r,u,m),this._update(!0)}getLayoutProperty(d,r){return this.style.getLayoutProperty(d,r)}setLight(d,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,r),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(d){return this._lazyInitEmptyStyle(),!d&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(d),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(d){return this._lazyInitEmptyStyle(),this.style.setFog(d),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(d){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(d),this.transform):0}setFeatureState(d,r){return this.style.setFeatureState(d,r),this._update()}removeFeatureState(d,r){return this.style.removeFeatureState(d,r),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}_updateContainerDimensions(){if(!this._container)return;const d=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let u,m,y,b=this._container;for(;b&&(!m||!y);){const S=a.window.getComputedStyle(b).transform;S&&"none"!==S&&(u=S.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&"0"!==u[0]&&"1"!==u[0]&&(m=u[0]),u[3]&&"0"!==u[3]&&"1"!==u[3]&&(y=u[3])),b=b.parentElement}this._containerWidth=m?Math.abs(d/m):d,this._containerHeight=y?Math.abs(r/y):r}_detectMissingCSS(){"rgb(250, 128, 114)"!==a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=fe("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=fe("div","mapboxgl-canvas-container",d);this._interactive&&r.classList.add("mapboxgl-interactive"),this._canvas=fe("canvas","mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=fe("div","mapboxgl-control-container",d),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{m[y]=fe("div",`mapboxgl-ctrl-${y}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,r){const u=a.exported.devicePixelRatio||1;this._canvas.width=u*Math.ceil(d),this._canvas.height=u*Math.ceil(r),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${r}px`}_addMarker(d){this._markers.push(d)}_removeMarker(d){const r=this._markers.indexOf(d);-1!==r&&this._markers.splice(r,1)}_addPopup(d){this._popups.push(d)}_removePopup(d){const r=this._popups.indexOf(d);-1!==r&&this._popups.splice(r,1)}_setupPainter(){const d=a.extend({},Fe.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._useWebGL2&&this._canvas.getContext("webgl2",d),u=r||this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);u?(this._useWebGL2&&!r&&a.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),a.storeAuthState(u,!0),this.painter=new ir(u,this.transform,!!r),this.on("data",m=>{"source"===m.dataType&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(u)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_requestDomTask(d){!this.loaded()||this.loaded()&&!this.isMoving()?d():this._domRenderTaskQueue.add(d)}_render(d){let r;const u=this.painter.context.extTimerQuery,m=a.exported.now();if(this.listens("gpu-timing-frame")&&(r=u.createQueryEXT(),u.beginQueryEXT(u.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],a.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],a.window.performance.now())),this._renderTaskQueue.run(d),this._domRenderTaskQueue.run(d),this._removed)return;this._updateProjectionTransition();const y=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,U=this.transform.pitch,J=a.exported.now(),Q=new a.EvaluationParameters(z,{now:J,fadeDuration:y,pitch:U,transition:this.style.getTransition()});this.style.update(Q)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let b=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),b=this._updateAverageElevation(m),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):b=this._updateAverageElevation(m),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,y,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const z=a.exported.now()-m;u.endQueryEXT(u.TIME_ELAPSED_EXT,r),setTimeout(()=>{const U=u.getQueryObjectEXT(r,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(r),this.fire(new a.Event("gpu-timing-frame",{cpuTime:z,gpuTime:U})),a.window.performance.mark("frame-gpu",{startTime:m,detail:{gpuTime:U}})},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const U=this.painter.queryGpuTimers(z);this.fire(new a.Event("gpu-timing-layer",{layerTimes:U}))},50)}if(this.listens("gpu-timing-deferred-render")){const z=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const U=this.painter.queryGpuTimeDeferredRender(z);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:U}))},50)}const S=this._sourcesDirty||this._styleDirty||this._placementDirty||b;if(S||this._repaint)this.triggerRepaint();else{const z=!this.isMoving()&&this.loaded();if(z&&(b=this._updateAverageElevation(m,!0)),b)this.triggerRepaint();else if(this._triggerFrame(!1),z&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const U=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:U})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||S||(this._fullyLoaded=!0,a.LivePerformanceUtils.mark(a.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&a.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(d){for(const r of this._markers)d&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!d||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(d,r=!1){const u=m=>(this.transform.averageElevation=m,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&u(0);if((r||d-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(d)){const m=this.transform.averageElevation;let y=this.transform.sampleAverageElevation(),b=!1;this.transform.elevation&&(b=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(y)?y=0:this._averageElevationLastSampledAt=d;const S=Math.abs(m-y);if(S>1){if(this._isInitialLoad||b)return this._averageElevation.jumpTo(y),u(y);this._averageElevation.easeTo(y,d,300)}else if(S>1e-4)return this._averageElevation.jumpTo(y),u(y)}return!!this._averageElevation.isEasing(d)&&u(this._averageElevation.getValue(d))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,d=>{if(d&&(d.message===a.AUTH_ERR_MSG||401===d.status)){const r=this.painter.context.gl;a.storeAuthState(r,!1),this._logoControl instanceof tu&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const d=this._isDragging();this.painter.updateTerrain(this.style,d)}_calculateSpeedIndex(){const d=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const u=this.painter.context.gl,m=u.createFramebuffer();function y(b){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,b,0);const S=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,S),S}return u.bindFramebuffer(u.FRAMEBUFFER,m),this._canvasPixelComparison(y(d),r.canvasCopies.map(y),r.timeStamps)}_canvasPixelComparison(d,r,u){let m=u[1]-u[0];const y=d.length/4;for(let b=0;b<r.length;b++){const S=r[b];let z=0;for(let U=0;U<S.length;U+=4)S[U]===d[U]&&S[U+1]===d[U+1]&&S[U+2]===d[U+2]&&S[U+3]===d[U+3]&&(z+=1);m+=(u[b+2]-u[b+1])*(1-z/y)}return m}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==a.window&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1),a.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(d){this._renderNextFrame=this._renderNextFrame||d,this.style&&!this._frame&&(this._frame=a.exported.frame(r=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(r)}))}_preloadTiles(d){const r=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(r,(u,m)=>u._preloadTiles(d,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}_onVisibilityChange(){"hidden"===a.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(d){this._showTerrainWireframe!==d&&(this._showTerrainWireframe=d,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(d){this._speedIndexTiming!==d&&(this._speedIndexTiming=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(d){this._showTileAABBs!==d&&(this._showTileAABBs=d,d&&this._update())}_setCacheLimits(d,r){a.setCacheLimits(d,r)}get version(){return a.version}},NavigationControl:class{constructor(d){this.options=a.extend({},G,d),this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),fe("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),fe("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:r}):u.resetNorth({},{originalEvent:r}))}),this._compassIcon=fe("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const d=this._map;if(!d)return;const r=d.getZoom(),u=r===d.getMaxZoom(),m=r===d.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const d=this._map;if(!d)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(d.transform.pitch*(Math.PI/180)),.5)}) rotateX(${d.transform.pitch}deg) rotateZ(${d.transform.angle*(180/Math.PI)}deg)`:`rotate(${d.transform.angle*(180/Math.PI)}deg)`;d._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),d.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&d.on("pitch",this._rotateCompassArrow),d.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new B(d,this._compass,this.options.visualizePitch)),this._container}onRemove(){const d=this._map;d&&(this._container.remove(),this.options.showZoom&&d.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&d.off("pitch",this._rotateCompassArrow),d.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(d,r){const u=fe("button",d,this._container);return u.type="button",u.addEventListener("click",r),u}_setButtonTitle(d,r){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${r}`);d.setAttribute("aria-label",u),d.firstElementChild&&d.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends a.Evented{constructor(d){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},$,d),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Me(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(d){return this._map=d,this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(d){const r=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,d(u)};void 0!==this._supportsGeolocation?d(this._supportsGeolocation):void 0!==a.window.navigator.permissions?a.window.navigator.permissions.query({name:"geolocation"}).then(u=>r("denied"!==u.state)).catch(()=>r()):r()}_isOutOfMapMaxBounds(d){const r=this._map.getMaxBounds(),u=d.coords;return!!r&&(u.longitude<r.getWest()||u.longitude>r.getEast()||u.latitude<r.getSouth()||u.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(d),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",d)),this._finish()}}_updateCamera(d){const r=new a.LngLat(d.coords.longitude,d.coords.latitude),u=d.coords.accuracy,m=this._map.getBearing(),y=a.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(u),y,{geolocateSource:!0})}_updateMarker(d){if(d){const r=new a.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map.transform,r=a.mercatorZfromAltitude(1,d._center.lat)*d.worldSize,u=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(d){if(this._map){if(this.options.trackUserLocation)if(1===d.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===d.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=fe("button","mapboxgl-ctrl-geolocate",this._container),fe("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===d){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=fe("div","mapboxgl-user-location"),this._dotElement.appendChild(fe("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(fe("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ti({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=fe("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ti({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||"ACTIVE_LOCK"!==this._watchState||r.originalEvent&&"resize"===r.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}}_onDeviceOrientation(d){this._userLocationDotMarker&&(d.webkitCompassHeading?this._heading=d.webkitCompassHeading:!0===d.absolute&&(this._heading=-1*d.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(d={maximumAge:6e5,timeout:0},this._noTimeout=!0):(d=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,d),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const d=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==a.window.DeviceMotionEvent&&"function"==typeof a.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(r=>{"granted"===r&&d()}).catch(console.error):d()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:$i,ScaleControl:class{constructor(d){this.options=a.extend({},me,d),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const d=this.options.maxWidth||100,r=this._map,u=r._containerHeight/2,m=r._containerWidth/2-d/2,y=r.unproject([m,u]),b=r.unproject([m+d,u]),S=y.distanceTo(b);if("imperial"===this.options.unit){const z=3.2808*S;z>5280?this._setScale(d,z/5280,"mile"):this._setScale(d,z,"foot")}else"nautical"===this.options.unit?this._setScale(d,S/1852,"nautical-mile"):S>=1e3?this._setScale(d,S/1e3,"kilometer"):this._setScale(d,S,"meter")}_setScale(d,r,u){this._map._requestDomTask(()=>{const m=function(b){const S=Math.pow(10,`${Math.floor(b)}`.length-1);let z=b/S;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(U){const J=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*J)/J}(z),S*z}(r),y=m/r;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==u?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(m):`${m}&nbsp;${We[u]}`,this._container.style.width=d*y+"px"})}onAdd(d){return this._map=d,this._language=d.getLanguage(),this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(d){this._language=d,this._update()}setUnit(d){this.options.unit=d,this._update()}},FullscreenControl:class{constructor(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof a.window.HTMLElement?this._container=d.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=fe("button","mapboxgl-ctrl-fullscreen",this._controlContainer);fe("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",d)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(d){super(),this.options=a.extend(Object.create(Nu),d),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(d&&d.className?d.className.trim().split(/\s+/):[])}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&d.on("preclick",this._onClose),this.options.closeOnMove&&d.on("move",this._onClose),d.on("remove",this.remove),this._update(),d._addPopup(this),this._focusFirstElement(),this._trackPointer?(d.on("mousemove",this._onMouseEvent),d.on("mouseup",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")):d.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const d=this._map;return d&&(d.off("move",this._update),d.off("move",this._onClose),d.off("preclick",this._onClose),d.off("click",this._onClose),d.off("remove",this.remove),d.off("mousemove",this._onMouseEvent),d.off("mouseup",this._onMouseEvent),d.off("drag",this._onMouseEvent),d._canvasContainer&&d._canvasContainer.classList.remove("mapboxgl-track-pointer"),d._removePopup(this),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(d){this._lngLat=a.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const d=this._map;return d&&(d.off("move",this._update),d.on("mousemove",this._onMouseEvent),d.on("drag",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(a.window.document.createTextNode(d))}setHTML(d){const r=a.window.document.createDocumentFragment(),u=a.window.document.createElement("body");let m;for(u.innerHTML=d;m=u.firstChild,m;)r.appendChild(m);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=fe("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(d),this.options.closeButton){const u=this._closeButton=fe("button","mapboxgl-popup-close-button",r);u.type="button",u.setAttribute("aria-label","Close popup"),u.setAttribute("aria-hidden","true"),u.innerHTML="&#215;",u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(d){return this._classList.add(d),this._updateClassList(),this}removeClassName(d){return this._classList.delete(d),this._updateClassList(),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){let r;return this._classList.delete(d)?r=!1:(this._classList.add(d),r=!0),this._updateClassList(),r}_onMouseEvent(d){this._update(d.point)}_getAnchor(d){if(this.options.anchor)return this.options.anchor;const r=this._map,u=this._container,m=this._pos;if(!r||!u||!m)return"bottom";const y=u.offsetWidth,b=u.offsetHeight,S=m.x<y/2,z=m.x>r.transform.width-y/2;if(m.y+d<b)return S?"top-left":z?"top-right":"top";if(m.y>r.transform.height-b){if(S)return"bottom-left";if(z)return"bottom-right"}return S?"left":z?"right":"bottom"}_updateClassList(){const d=this._container;if(!d)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),d.className=r.join(" ")}_update(d){const r=this._map,u=this._content;if(!r||!this._lngLat&&!this._trackPointer||!u)return;let m=this._container;if(m||(m=this._container=fe("div","mapboxgl-popup",r.getContainer()),this._tip=fe("div","mapboxgl-popup-tip",m),m.appendChild(u)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Xl(this._lngLat,this._pos,r.transform)),!this._trackPointer||d){const y=this._pos=this._trackPointer&&d?d:r.project(this._lngLat),b=hh(this.options.offset),S=this._anchor=this._getAnchor(b.y),z=hh(this.options.offset,S),U=y.add(z).round();r._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${rc[S]} translate(${U.x}px,${U.y}px)`)})}if(!this._marker&&r._showingGlobe()){const y=a.isLngLatBehindGlobe(r.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(Bh);d&&d.focus()}_onClose(){this.remove()}_setOpacity(d){this._container&&(this._container.style.opacity=`${d}`),this._content&&(this._content.style.pointerEvents=d?"auto":"none")}},Marker:Ti,Style:ls,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:Ue,Evented:a.Evented,config:a.config,prewarm:function(){Or().acquire(Lr)},clearPrewarmedResources:function(){const d=Do;d&&(d.isPreloaded()&&1===d.numActive()?(d.release(Lr),Do=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(d){a.config.ACCESS_TOKEN=d},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(d){a.config.API_URL=d},get workerCount(){return Ci.workerCount},set workerCount(d){Ci.workerCount=d},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){a.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){a.clearTileCache(d)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return kt}),M}()},4412:(Nn,Ct,R)=>{"use strict";R.d(Ct,{t:()=>C});var M=R(1413);class C extends M.B{constructor(a){super(),this._value=a}get value(){return this.getValue()}_subscribe(a){const se=super._subscribe(a);return!se.closed&&a.next(this._value),se}getValue(){const{hasError:a,thrownError:se,_value:Fe}=this;if(a)throw se;return this._throwIfClosed(),Fe}next(a){super.next(this._value=a)}}},1985:(Nn,Ct,R)=>{"use strict";R.d(Ct,{c:()=>ee});var M=R(7707),C=R(8359),de=R(3494),a=R(1203),se=R(1026),Fe=R(8071),ve=R(9786);let ee=(()=>{class at{constructor($e){$e&&(this._subscribe=$e)}lift($e){const ze=new at;return ze.source=this,ze.operator=$e,ze}subscribe($e,ze,bt){const xt=function ge(at){return at&&at instanceof M.vU||function he(at){return at&&(0,Fe.T)(at.next)&&(0,Fe.T)(at.error)&&(0,Fe.T)(at.complete)}(at)&&(0,C.Uv)(at)}($e)?$e:new M.Ms($e,ze,bt);return(0,ve.Y)(()=>{const{operator:Qt,source:sn}=this;xt.add(Qt?Qt.call(xt,sn):sn?this._subscribe(xt):this._trySubscribe(xt))}),xt}_trySubscribe($e){try{return this._subscribe($e)}catch(ze){$e.error(ze)}}forEach($e,ze){return new(ze=fe(ze))((bt,xt)=>{const Qt=new M.Ms({next:sn=>{try{$e(sn)}catch(Yt){xt(Yt),Qt.unsubscribe()}},error:xt,complete:bt});this.subscribe(Qt)})}_subscribe($e){var ze;return null===(ze=this.source)||void 0===ze?void 0:ze.subscribe($e)}[de.s](){return this}pipe(...$e){return(0,a.m)($e)(this)}toPromise($e){return new($e=fe($e))((ze,bt)=>{let xt;this.subscribe(Qt=>xt=Qt,Qt=>bt(Qt),()=>ze(xt))})}}return at.create=mt=>new at(mt),at})();function fe(at){var mt;return null!==(mt=at??se.$.Promise)&&void 0!==mt?mt:Promise}},2771:(Nn,Ct,R)=>{"use strict";R.d(Ct,{m:()=>de});var M=R(1413),C=R(6129);class de extends M.B{constructor(se=1/0,Fe=1/0,ve=C.U){super(),this._bufferSize=se,this._windowTime=Fe,this._timestampProvider=ve,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=Fe===1/0,this._bufferSize=Math.max(1,se),this._windowTime=Math.max(1,Fe)}next(se){const{isStopped:Fe,_buffer:ve,_infiniteTimeWindow:ee,_timestampProvider:fe,_windowTime:he}=this;Fe||(ve.push(se),!ee&&ve.push(fe.now()+he)),this._trimBuffer(),super.next(se)}_subscribe(se){this._throwIfClosed(),this._trimBuffer();const Fe=this._innerSubscribe(se),{_infiniteTimeWindow:ve,_buffer:ee}=this,fe=ee.slice();for(let he=0;he<fe.length&&!se.closed;he+=ve?1:2)se.next(fe[he]);return this._checkFinalizedStatuses(se),Fe}_trimBuffer(){const{_bufferSize:se,_timestampProvider:Fe,_buffer:ve,_infiniteTimeWindow:ee}=this,fe=(ee?1:2)*se;if(se<1/0&&fe<ve.length&&ve.splice(0,ve.length-fe),!ee){const he=Fe.now();let ge=0;for(let at=1;at<ve.length&&ve[at]<=he;at+=2)ge=at;ge&&ve.splice(0,ge+1)}}}},1413:(Nn,Ct,R)=>{"use strict";R.d(Ct,{B:()=>ve});var M=R(1985),C=R(8359);const a=(0,R(1853).L)(fe=>function(){fe(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var se=R(7908),Fe=R(9786);let ve=(()=>{class fe extends M.c{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(ge){const at=new ee(this,this);return at.operator=ge,at}_throwIfClosed(){if(this.closed)throw new a}next(ge){(0,Fe.Y)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const at of this.currentObservers)at.next(ge)}})}error(ge){(0,Fe.Y)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=ge;const{observers:at}=this;for(;at.length;)at.shift().error(ge)}})}complete(){(0,Fe.Y)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:ge}=this;for(;ge.length;)ge.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var ge;return(null===(ge=this.observers)||void 0===ge?void 0:ge.length)>0}_trySubscribe(ge){return this._throwIfClosed(),super._trySubscribe(ge)}_subscribe(ge){return this._throwIfClosed(),this._checkFinalizedStatuses(ge),this._innerSubscribe(ge)}_innerSubscribe(ge){const{hasError:at,isStopped:mt,observers:$e}=this;return at||mt?C.Kn:(this.currentObservers=null,$e.push(ge),new C.yU(()=>{this.currentObservers=null,(0,se.o)($e,ge)}))}_checkFinalizedStatuses(ge){const{hasError:at,thrownError:mt,isStopped:$e}=this;at?ge.error(mt):$e&&ge.complete()}asObservable(){const ge=new M.c;return ge.source=this,ge}}return fe.create=(he,ge)=>new ee(he,ge),fe})();class ee extends ve{constructor(he,ge){super(),this.destination=he,this.source=ge}next(he){var ge,at;null===(at=null===(ge=this.destination)||void 0===ge?void 0:ge.next)||void 0===at||at.call(ge,he)}error(he){var ge,at;null===(at=null===(ge=this.destination)||void 0===ge?void 0:ge.error)||void 0===at||at.call(ge,he)}complete(){var he,ge;null===(ge=null===(he=this.destination)||void 0===he?void 0:he.complete)||void 0===ge||ge.call(he)}_subscribe(he){var ge,at;return null!==(at=null===(ge=this.source)||void 0===ge?void 0:ge.subscribe(he))&&void 0!==at?at:C.Kn}}},7707:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Ms:()=>bt,vU:()=>at});var M=R(8071),C=R(8359),de=R(1026),a=R(5334),se=R(5343);const Fe=fe("C",void 0,void 0);function fe(Ut,et,It){return{kind:Ut,value:et,error:It}}var he=R(9270),ge=R(9786);class at extends C.yU{constructor(et){super(),this.isStopped=!1,et?(this.destination=et,(0,C.Uv)(et)&&et.add(this)):this.destination=Yt}static create(et,It,zt){return new bt(et,It,zt)}next(et){this.isStopped?sn(function ee(Ut){return fe("N",Ut,void 0)}(et),this):this._next(et)}error(et){this.isStopped?sn(function ve(Ut){return fe("E",void 0,Ut)}(et),this):(this.isStopped=!0,this._error(et))}complete(){this.isStopped?sn(Fe,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(et){this.destination.next(et)}_error(et){try{this.destination.error(et)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const mt=Function.prototype.bind;function $e(Ut,et){return mt.call(Ut,et)}class ze{constructor(et){this.partialObserver=et}next(et){const{partialObserver:It}=this;if(It.next)try{It.next(et)}catch(zt){xt(zt)}}error(et){const{partialObserver:It}=this;if(It.error)try{It.error(et)}catch(zt){xt(zt)}else xt(et)}complete(){const{partialObserver:et}=this;if(et.complete)try{et.complete()}catch(It){xt(It)}}}class bt extends at{constructor(et,It,zt){let je;if(super(),(0,M.T)(et)||!et)je={next:et??void 0,error:It??void 0,complete:zt??void 0};else{let At;this&&de.$.useDeprecatedNextContext?(At=Object.create(et),At.unsubscribe=()=>this.unsubscribe(),je={next:et.next&&$e(et.next,At),error:et.error&&$e(et.error,At),complete:et.complete&&$e(et.complete,At)}):je=et}this.destination=new ze(je)}}function xt(Ut){de.$.useDeprecatedSynchronousErrorHandling?(0,ge.l)(Ut):(0,a.m)(Ut)}function sn(Ut,et){const{onStoppedNotification:It}=de.$;It&&he.f.setTimeout(()=>It(Ut,et))}const Yt={closed:!0,next:se.l,error:function Qt(Ut){throw Ut},complete:se.l}},8359:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Kn:()=>Fe,yU:()=>se,Uv:()=>ve});var M=R(8071);const de=(0,R(1853).L)(fe=>function(ge){fe(this),this.message=ge?`${ge.length} errors occurred during unsubscription:\n${ge.map((at,mt)=>`${mt+1}) ${at.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=ge});var a=R(7908);class se{constructor(he){this.initialTeardown=he,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let he;if(!this.closed){this.closed=!0;const{_parentage:ge}=this;if(ge)if(this._parentage=null,Array.isArray(ge))for(const $e of ge)$e.remove(this);else ge.remove(this);const{initialTeardown:at}=this;if((0,M.T)(at))try{at()}catch($e){he=$e instanceof de?$e.errors:[$e]}const{_finalizers:mt}=this;if(mt){this._finalizers=null;for(const $e of mt)try{ee($e)}catch(ze){he=he??[],ze instanceof de?he=[...he,...ze.errors]:he.push(ze)}}if(he)throw new de(he)}}add(he){var ge;if(he&&he!==this)if(this.closed)ee(he);else{if(he instanceof se){if(he.closed||he._hasParent(this))return;he._addParent(this)}(this._finalizers=null!==(ge=this._finalizers)&&void 0!==ge?ge:[]).push(he)}}_hasParent(he){const{_parentage:ge}=this;return ge===he||Array.isArray(ge)&&ge.includes(he)}_addParent(he){const{_parentage:ge}=this;this._parentage=Array.isArray(ge)?(ge.push(he),ge):ge?[ge,he]:he}_removeParent(he){const{_parentage:ge}=this;ge===he?this._parentage=null:Array.isArray(ge)&&(0,a.o)(ge,he)}remove(he){const{_finalizers:ge}=this;ge&&(0,a.o)(ge,he),he instanceof se&&he._removeParent(this)}}se.EMPTY=(()=>{const fe=new se;return fe.closed=!0,fe})();const Fe=se.EMPTY;function ve(fe){return fe instanceof se||fe&&"closed"in fe&&(0,M.T)(fe.remove)&&(0,M.T)(fe.add)&&(0,M.T)(fe.unsubscribe)}function ee(fe){(0,M.T)(fe)?fe():fe.unsubscribe()}},1026:(Nn,Ct,R)=>{"use strict";R.d(Ct,{$:()=>M});const M={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},17:(Nn,Ct,R)=>{"use strict";R.d(Ct,{G:()=>Fe});var M=R(1985),C=R(8359),de=R(9898),a=R(4360),se=R(9974);class Fe extends M.c{constructor(ee,fe){super(),this.source=ee,this.subjectFactory=fe,this._subject=null,this._refCount=0,this._connection=null,(0,se.S)(ee)&&(this.lift=ee.lift)}_subscribe(ee){return this.getSubject().subscribe(ee)}getSubject(){const ee=this._subject;return(!ee||ee.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:ee}=this;this._subject=this._connection=null,ee?.unsubscribe()}connect(){let ee=this._connection;if(!ee){ee=this._connection=new C.yU;const fe=this.getSubject();ee.add(this.source.subscribe((0,a._)(fe,void 0,()=>{this._teardown(),fe.complete()},he=>{this._teardown(),fe.error(he)},()=>this._teardown()))),ee.closed&&(this._connection=null,ee=C.yU.EMPTY)}return ee}refCount(){return(0,de.B)()(this)}}},4572:(Nn,Ct,R)=>{"use strict";R.d(Ct,{z:()=>he});var M=R(1985),C=R(3073),de=R(6648),a=R(3669),se=R(6450),Fe=R(9326),ve=R(8496),ee=R(4360),fe=R(5225);function he(...mt){const $e=(0,Fe.lI)(mt),ze=(0,Fe.ms)(mt),{args:bt,keys:xt}=(0,C.D)(mt);if(0===bt.length)return(0,de.H)([],$e);const Qt=new M.c(function ge(mt,$e,ze=a.D){return bt=>{at($e,()=>{const{length:xt}=mt,Qt=new Array(xt);let sn=xt,Yt=xt;for(let Ut=0;Ut<xt;Ut++)at($e,()=>{const et=(0,de.H)(mt[Ut],$e);let It=!1;et.subscribe((0,ee._)(bt,zt=>{Qt[Ut]=zt,It||(It=!0,Yt--),Yt||bt.next(ze(Qt.slice()))},()=>{--sn||bt.complete()}))},bt)},bt)}}(bt,$e,xt?sn=>(0,ve.e)(xt,sn):a.D));return ze?Qt.pipe((0,se.I)(ze)):Qt}function at(mt,$e,ze){mt?(0,fe.N)(ze,mt,$e):$e()}},8793:(Nn,Ct,R)=>{"use strict";R.d(Ct,{x:()=>se});var M=R(6365),de=R(9326),a=R(6648);function se(...Fe){return function C(){return(0,M.U)(1)}()((0,a.H)(Fe,(0,de.lI)(Fe)))}},9030:(Nn,Ct,R)=>{"use strict";R.d(Ct,{v:()=>de});var M=R(1985),C=R(8750);function de(a){return new M.c(se=>{(0,C.Tg)(a()).subscribe(se)})}},983:(Nn,Ct,R)=>{"use strict";R.d(Ct,{w:()=>C});const C=new(R(1985).c)(se=>se.complete())},6648:(Nn,Ct,R)=>{"use strict";R.d(Ct,{H:()=>zt});var M=R(8750),C=R(5225),de=R(9974),a=R(4360);function se(je,At=0){return(0,de.N)((Ze,St)=>{Ze.subscribe((0,a._)(St,wn=>(0,C.N)(St,je,()=>St.next(wn),At),()=>(0,C.N)(St,je,()=>St.complete(),At),wn=>(0,C.N)(St,je,()=>St.error(wn),At)))})}function Fe(je,At=0){return(0,de.N)((Ze,St)=>{St.add(je.schedule(()=>Ze.subscribe(St),At))})}var fe=R(1985),ge=R(4761),at=R(8071);function $e(je,At){if(!je)throw new Error("Iterable cannot be null");return new fe.c(Ze=>{(0,C.N)(Ze,At,()=>{const St=je[Symbol.asyncIterator]();(0,C.N)(Ze,At,()=>{St.next().then(wn=>{wn.done?Ze.complete():Ze.next(wn.value)})},0,!0)})})}var ze=R(5055),bt=R(9858),xt=R(7441),Qt=R(5397),sn=R(7953),Yt=R(591),Ut=R(5196);function zt(je,At){return At?function It(je,At){if(null!=je){if((0,ze.l)(je))return function ve(je,At){return(0,M.Tg)(je).pipe(Fe(At),se(At))}(je,At);if((0,xt.X)(je))return function he(je,At){return new fe.c(Ze=>{let St=0;return At.schedule(function(){St===je.length?Ze.complete():(Ze.next(je[St++]),Ze.closed||this.schedule())})})}(je,At);if((0,bt.y)(je))return function ee(je,At){return(0,M.Tg)(je).pipe(Fe(At),se(At))}(je,At);if((0,sn.T)(je))return $e(je,At);if((0,Qt.x)(je))return function mt(je,At){return new fe.c(Ze=>{let St;return(0,C.N)(Ze,At,()=>{St=je[ge.l](),(0,C.N)(Ze,At,()=>{let wn,Rn;try{({value:wn,done:Rn}=St.next())}catch(an){return void Ze.error(an)}Rn?Ze.complete():Ze.next(wn)},0,!0)}),()=>(0,at.T)(St?.return)&&St.return()})}(je,At);if((0,Ut.U)(je))return function et(je,At){return $e((0,Ut.C)(je),At)}(je,At)}throw(0,Yt.L)(je)}(je,At):(0,M.Tg)(je)}},3726:(Nn,Ct,R)=>{"use strict";R.d(Ct,{R:()=>he});var M=R(8750),C=R(1985),de=R(1397),a=R(7441),se=R(8071),Fe=R(6450);const ve=["addListener","removeListener"],ee=["addEventListener","removeEventListener"],fe=["on","off"];function he(ze,bt,xt,Qt){if((0,se.T)(xt)&&(Qt=xt,xt=void 0),Qt)return he(ze,bt,xt).pipe((0,Fe.I)(Qt));const[sn,Yt]=function $e(ze){return(0,se.T)(ze.addEventListener)&&(0,se.T)(ze.removeEventListener)}(ze)?ee.map(Ut=>et=>ze[Ut](bt,et,xt)):function at(ze){return(0,se.T)(ze.addListener)&&(0,se.T)(ze.removeListener)}(ze)?ve.map(ge(ze,bt)):function mt(ze){return(0,se.T)(ze.on)&&(0,se.T)(ze.off)}(ze)?fe.map(ge(ze,bt)):[];if(!sn&&(0,a.X)(ze))return(0,de.Z)(Ut=>he(Ut,bt,xt))((0,M.Tg)(ze));if(!sn)throw new TypeError("Invalid event target");return new C.c(Ut=>{const et=(...It)=>Ut.next(1<It.length?It:It[0]);return sn(et),()=>Yt(et)})}function ge(ze,bt){return xt=>Qt=>ze[xt](bt,Qt)}},8750:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Tg:()=>mt});var M=R(1635),C=R(7441),de=R(9858),a=R(1985),se=R(5055),Fe=R(7953),ve=R(591),ee=R(5397),fe=R(5196),he=R(8071),ge=R(5334),at=R(3494);function mt(Ut){if(Ut instanceof a.c)return Ut;if(null!=Ut){if((0,se.l)(Ut))return function $e(Ut){return new a.c(et=>{const It=Ut[at.s]();if((0,he.T)(It.subscribe))return It.subscribe(et);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ut);if((0,C.X)(Ut))return function ze(Ut){return new a.c(et=>{for(let It=0;It<Ut.length&&!et.closed;It++)et.next(Ut[It]);et.complete()})}(Ut);if((0,de.y)(Ut))return function bt(Ut){return new a.c(et=>{Ut.then(It=>{et.closed||(et.next(It),et.complete())},It=>et.error(It)).then(null,ge.m)})}(Ut);if((0,Fe.T)(Ut))return Qt(Ut);if((0,ee.x)(Ut))return function xt(Ut){return new a.c(et=>{for(const It of Ut)if(et.next(It),et.closed)return;et.complete()})}(Ut);if((0,fe.U)(Ut))return function sn(Ut){return Qt((0,fe.C)(Ut))}(Ut)}throw(0,ve.L)(Ut)}function Qt(Ut){return new a.c(et=>{(function Yt(Ut,et){var It,zt,je,At;return(0,M.sH)(this,void 0,void 0,function*(){try{for(It=(0,M.xN)(Ut);!(zt=yield It.next()).done;)if(et.next(zt.value),et.closed)return}catch(Ze){je={error:Ze}}finally{try{zt&&!zt.done&&(At=It.return)&&(yield At.call(It))}finally{if(je)throw je.error}}et.complete()})})(Ut,et).catch(It=>et.error(It))})}},7786:(Nn,Ct,R)=>{"use strict";R.d(Ct,{h:()=>Fe});var M=R(6365),C=R(8750),de=R(983),a=R(9326),se=R(6648);function Fe(...ve){const ee=(0,a.lI)(ve),fe=(0,a.R0)(ve,1/0),he=ve;return he.length?1===he.length?(0,C.Tg)(he[0]):(0,M.U)(fe)((0,se.H)(he,ee)):de.w}},7673:(Nn,Ct,R)=>{"use strict";R.d(Ct,{of:()=>de});var M=R(9326),C=R(6648);function de(...a){const se=(0,M.lI)(a);return(0,C.H)(a,se)}},1584:(Nn,Ct,R)=>{"use strict";R.d(Ct,{O:()=>se});var M=R(1985),C=R(3236),de=R(9470);function se(Fe=0,ve,ee=C.b){let fe=-1;return null!=ve&&((0,de.m)(ve)?ee=ve:fe=ve),new M.c(he=>{let ge=function a(Fe){return Fe instanceof Date&&!isNaN(Fe)}(Fe)?+Fe-ee.now():Fe;ge<0&&(ge=0);let at=0;return ee.schedule(function(){he.closed||(he.next(at++),0<=fe?this.schedule(void 0,fe):he.complete())},ge)})}},4360:(Nn,Ct,R)=>{"use strict";R.d(Ct,{_:()=>C});var M=R(7707);function C(a,se,Fe,ve,ee){return new de(a,se,Fe,ve,ee)}class de extends M.vU{constructor(se,Fe,ve,ee,fe,he){super(se),this.onFinalize=fe,this.shouldUnsubscribe=he,this._next=Fe?function(ge){try{Fe(ge)}catch(at){se.error(at)}}:super._next,this._error=ee?function(ge){try{ee(ge)}catch(at){se.error(at)}finally{this.unsubscribe()}}:super._error,this._complete=ve?function(){try{ve()}catch(ge){se.error(ge)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var se;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Fe}=this;super.unsubscribe(),!Fe&&(null===(se=this.onFinalize)||void 0===se||se.call(this))}}}},3798:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Z:()=>ve});var M=R(3236),C=R(9974),de=R(8750),a=R(4360),Fe=R(1584);function ve(ee,fe=M.E){return function se(ee){return(0,C.N)((fe,he)=>{let ge=!1,at=null,mt=null,$e=!1;const ze=()=>{if(mt?.unsubscribe(),mt=null,ge){ge=!1;const xt=at;at=null,he.next(xt)}$e&&he.complete()},bt=()=>{mt=null,$e&&he.complete()};fe.subscribe((0,a._)(he,xt=>{ge=!0,at=xt,mt||(0,de.Tg)(ee(xt)).subscribe(mt=(0,a._)(he,ze,bt))},()=>{$e=!0,(!ge||!mt||mt.closed)&&he.complete()}))})}(()=>(0,Fe.O)(ee,fe))}},9437:(Nn,Ct,R)=>{"use strict";R.d(Ct,{W:()=>a});var M=R(8750),C=R(4360),de=R(9974);function a(se){return(0,de.N)((Fe,ve)=>{let he,ee=null,fe=!1;ee=Fe.subscribe((0,C._)(ve,void 0,void 0,ge=>{he=(0,M.Tg)(se(ge,a(se)(Fe))),ee?(ee.unsubscribe(),ee=null,he.subscribe(ve)):fe=!0})),fe&&(ee.unsubscribe(),ee=null,he.subscribe(ve))})}},274:(Nn,Ct,R)=>{"use strict";R.d(Ct,{H:()=>de});var M=R(1397),C=R(8071);function de(a,se){return(0,C.T)(se)?(0,M.Z)(a,se,1):(0,M.Z)(a,1)}},152:(Nn,Ct,R)=>{"use strict";R.d(Ct,{B:()=>a});var M=R(3236),C=R(9974),de=R(4360);function a(se,Fe=M.E){return(0,C.N)((ve,ee)=>{let fe=null,he=null,ge=null;const at=()=>{if(fe){fe.unsubscribe(),fe=null;const $e=he;he=null,ee.next($e)}};function mt(){const $e=ge+se,ze=Fe.now();if(ze<$e)return fe=this.schedule(void 0,$e-ze),void ee.add(fe);at()}ve.subscribe((0,de._)(ee,$e=>{he=$e,ge=Fe.now(),fe||(fe=Fe.schedule(mt,se),ee.add(fe))},()=>{at(),ee.complete()},void 0,()=>{he=fe=null}))})}},9901:(Nn,Ct,R)=>{"use strict";R.d(Ct,{U:()=>de});var M=R(9974),C=R(4360);function de(a){return(0,M.N)((se,Fe)=>{let ve=!1;se.subscribe((0,C._)(Fe,ee=>{ve=!0,Fe.next(ee)},()=>{ve||Fe.next(a),Fe.complete()}))})}},3294:(Nn,Ct,R)=>{"use strict";R.d(Ct,{F:()=>a});var M=R(3669),C=R(9974),de=R(4360);function a(Fe,ve=M.D){return Fe=Fe??se,(0,C.N)((ee,fe)=>{let he,ge=!0;ee.subscribe((0,de._)(fe,at=>{const mt=ve(at);(ge||!Fe(he,mt))&&(ge=!1,he=mt,fe.next(at))}))})}function se(Fe,ve){return Fe===ve}},5964:(Nn,Ct,R)=>{"use strict";R.d(Ct,{p:()=>de});var M=R(9974),C=R(4360);function de(a,se){return(0,M.N)((Fe,ve)=>{let ee=0;Fe.subscribe((0,C._)(ve,fe=>a.call(se,fe,ee++)&&ve.next(fe)))})}},980:(Nn,Ct,R)=>{"use strict";R.d(Ct,{j:()=>C});var M=R(9974);function C(de){return(0,M.N)((a,se)=>{try{a.subscribe(se)}finally{se.add(de)}})}},1594:(Nn,Ct,R)=>{"use strict";R.d(Ct,{$:()=>ve});var M=R(9350),C=R(5964),de=R(6697),a=R(9901),se=R(3774),Fe=R(3669);function ve(ee,fe){const he=arguments.length>=2;return ge=>ge.pipe(ee?(0,C.p)((at,mt)=>ee(at,mt,ge)):Fe.D,(0,de.s)(1),he?(0,a.U)(fe):(0,se.v)(()=>new M.G))}},6354:(Nn,Ct,R)=>{"use strict";R.d(Ct,{T:()=>de});var M=R(9974),C=R(4360);function de(a,se){return(0,M.N)((Fe,ve)=>{let ee=0;Fe.subscribe((0,C._)(ve,fe=>{ve.next(a.call(se,fe,ee++))}))})}},3703:(Nn,Ct,R)=>{"use strict";R.d(Ct,{u:()=>C});var M=R(6354);function C(de){return(0,M.T)(()=>de)}},6365:(Nn,Ct,R)=>{"use strict";R.d(Ct,{U:()=>de});var M=R(1397),C=R(3669);function de(a=1/0){return(0,M.Z)(C.D,a)}},1397:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Z:()=>ee});var M=R(6354),C=R(8750),de=R(9974),a=R(5225),se=R(4360),ve=R(8071);function ee(fe,he,ge=1/0){return(0,ve.T)(he)?ee((at,mt)=>(0,M.T)(($e,ze)=>he(at,$e,mt,ze))((0,C.Tg)(fe(at,mt))),ge):("number"==typeof he&&(ge=he),(0,de.N)((at,mt)=>function Fe(fe,he,ge,at,mt,$e,ze,bt){const xt=[];let Qt=0,sn=0,Yt=!1;const Ut=()=>{Yt&&!xt.length&&!Qt&&he.complete()},et=zt=>Qt<at?It(zt):xt.push(zt),It=zt=>{$e&&he.next(zt),Qt++;let je=!1;(0,C.Tg)(ge(zt,sn++)).subscribe((0,se._)(he,At=>{mt?.(At),$e?et(At):he.next(At)},()=>{je=!0},void 0,()=>{if(je)try{for(Qt--;xt.length&&Qt<at;){const At=xt.shift();ze?(0,a.N)(he,ze,()=>It(At)):It(At)}Ut()}catch(At){he.error(At)}}))};return fe.subscribe((0,se._)(he,et,()=>{Yt=!0,Ut()})),()=>{bt?.()}}(at,mt,fe,ge)))}},9898:(Nn,Ct,R)=>{"use strict";R.d(Ct,{B:()=>de});var M=R(9974),C=R(4360);function de(){return(0,M.N)((a,se)=>{let Fe=null;a._refCount++;const ve=(0,C._)(se,void 0,void 0,void 0,()=>{if(!a||a._refCount<=0||0<--a._refCount)return void(Fe=null);const ee=a._connection,fe=Fe;Fe=null,ee&&(!fe||ee===fe)&&ee.unsubscribe(),se.unsubscribe()});a.subscribe(ve),ve.closed||(Fe=a.connect())})}},7647:(Nn,Ct,R)=>{"use strict";R.d(Ct,{u:()=>se});var M=R(8750),C=R(1413),de=R(7707),a=R(9974);function se(ve={}){const{connector:ee=(()=>new C.B),resetOnError:fe=!0,resetOnComplete:he=!0,resetOnRefCountZero:ge=!0}=ve;return at=>{let mt,$e,ze,bt=0,xt=!1,Qt=!1;const sn=()=>{$e?.unsubscribe(),$e=void 0},Yt=()=>{sn(),mt=ze=void 0,xt=Qt=!1},Ut=()=>{const et=mt;Yt(),et?.unsubscribe()};return(0,a.N)((et,It)=>{bt++,!Qt&&!xt&&sn();const zt=ze=ze??ee();It.add(()=>{bt--,0===bt&&!Qt&&!xt&&($e=Fe(Ut,ge))}),zt.subscribe(It),!mt&&bt>0&&(mt=new de.Ms({next:je=>zt.next(je),error:je=>{Qt=!0,sn(),$e=Fe(Yt,fe,je),zt.error(je)},complete:()=>{xt=!0,sn(),$e=Fe(Yt,he),zt.complete()}}),(0,M.Tg)(et).subscribe(mt))})(at)}}function Fe(ve,ee,...fe){if(!0===ee)return void ve();if(!1===ee)return;const he=new de.Ms({next:()=>{he.unsubscribe(),ve()}});return(0,M.Tg)(ee(...fe)).subscribe(he)}},4668:(Nn,Ct,R)=>{"use strict";R.d(Ct,{t:()=>de});var M=R(2771),C=R(7647);function de(a,se,Fe){let ve,ee=!1;return a&&"object"==typeof a?({bufferSize:ve=1/0,windowTime:se=1/0,refCount:ee=!1,scheduler:Fe}=a):ve=a??1/0,(0,C.u)({connector:()=>new M.m(ve,se,Fe),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:ee})}},5245:(Nn,Ct,R)=>{"use strict";R.d(Ct,{i:()=>C});var M=R(5964);function C(de){return(0,M.p)((a,se)=>de<=se)}},9172:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Z:()=>a});var M=R(8793),C=R(9326),de=R(9974);function a(...se){const Fe=(0,C.lI)(se);return(0,de.N)((ve,ee)=>{(Fe?(0,M.x)(se,ve,Fe):(0,M.x)(se,ve)).subscribe(ee)})}},5558:(Nn,Ct,R)=>{"use strict";R.d(Ct,{n:()=>a});var M=R(8750),C=R(9974),de=R(4360);function a(se,Fe){return(0,C.N)((ve,ee)=>{let fe=null,he=0,ge=!1;const at=()=>ge&&!fe&&ee.complete();ve.subscribe((0,de._)(ee,mt=>{fe?.unsubscribe();let $e=0;const ze=he++;(0,M.Tg)(se(mt,ze)).subscribe(fe=(0,de._)(ee,bt=>ee.next(Fe?Fe(mt,bt,ze,$e++):bt),()=>{fe=null,at()}))},()=>{ge=!0,at()}))})}},6697:(Nn,Ct,R)=>{"use strict";R.d(Ct,{s:()=>a});var M=R(983),C=R(9974),de=R(4360);function a(se){return se<=0?()=>M.w:(0,C.N)((Fe,ve)=>{let ee=0;Fe.subscribe((0,de._)(ve,fe=>{++ee<=se&&(ve.next(fe),se<=ee&&ve.complete())}))})}},6977:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Q:()=>se});var M=R(9974),C=R(4360),de=R(8750),a=R(5343);function se(Fe){return(0,M.N)((ve,ee)=>{(0,de.Tg)(Fe).subscribe((0,C._)(ee,()=>ee.complete(),a.l)),!ee.closed&&ve.subscribe(ee)})}},8141:(Nn,Ct,R)=>{"use strict";R.d(Ct,{M:()=>se});var M=R(8071),C=R(9974),de=R(4360),a=R(3669);function se(Fe,ve,ee){const fe=(0,M.T)(Fe)||ve||ee?{next:Fe,error:ve,complete:ee}:Fe;return fe?(0,C.N)((he,ge)=>{var at;null===(at=fe.subscribe)||void 0===at||at.call(fe);let mt=!0;he.subscribe((0,de._)(ge,$e=>{var ze;null===(ze=fe.next)||void 0===ze||ze.call(fe,$e),ge.next($e)},()=>{var $e;mt=!1,null===($e=fe.complete)||void 0===$e||$e.call(fe),ge.complete()},$e=>{var ze;mt=!1,null===(ze=fe.error)||void 0===ze||ze.call(fe,$e),ge.error($e)},()=>{var $e,ze;mt&&(null===($e=fe.unsubscribe)||void 0===$e||$e.call(fe)),null===(ze=fe.finalize)||void 0===ze||ze.call(fe)}))}):a.D}},3774:(Nn,Ct,R)=>{"use strict";R.d(Ct,{v:()=>a});var M=R(9350),C=R(9974),de=R(4360);function a(Fe=se){return(0,C.N)((ve,ee)=>{let fe=!1;ve.subscribe((0,de._)(ee,he=>{fe=!0,ee.next(he)},()=>fe?ee.complete():ee.error(Fe())))})}function se(){return new M.G}},6780:(Nn,Ct,R)=>{"use strict";R.d(Ct,{R:()=>se});var M=R(8359);class C extends M.yU{constructor(ve,ee){super()}schedule(ve,ee=0){return this}}const de={setInterval(Fe,ve,...ee){const{delegate:fe}=de;return fe?.setInterval?fe.setInterval(Fe,ve,...ee):setInterval(Fe,ve,...ee)},clearInterval(Fe){const{delegate:ve}=de;return(ve?.clearInterval||clearInterval)(Fe)},delegate:void 0};var a=R(7908);class se extends C{constructor(ve,ee){super(ve,ee),this.scheduler=ve,this.work=ee,this.pending=!1}schedule(ve,ee=0){var fe;if(this.closed)return this;this.state=ve;const he=this.id,ge=this.scheduler;return null!=he&&(this.id=this.recycleAsyncId(ge,he,ee)),this.pending=!0,this.delay=ee,this.id=null!==(fe=this.id)&&void 0!==fe?fe:this.requestAsyncId(ge,this.id,ee),this}requestAsyncId(ve,ee,fe=0){return de.setInterval(ve.flush.bind(ve,this),fe)}recycleAsyncId(ve,ee,fe=0){if(null!=fe&&this.delay===fe&&!1===this.pending)return ee;null!=ee&&de.clearInterval(ee)}execute(ve,ee){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const fe=this._execute(ve,ee);if(fe)return fe;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(ve,ee){let he,fe=!1;try{this.work(ve)}catch(ge){fe=!0,he=ge||new Error("Scheduled action threw falsy error")}if(fe)return this.unsubscribe(),he}unsubscribe(){if(!this.closed){const{id:ve,scheduler:ee}=this,{actions:fe}=ee;this.work=this.state=this.scheduler=null,this.pending=!1,(0,a.o)(fe,this),null!=ve&&(this.id=this.recycleAsyncId(ee,ve,null)),this.delay=null,super.unsubscribe()}}}},9687:(Nn,Ct,R)=>{"use strict";R.d(Ct,{q:()=>de});var M=R(6129);class C{constructor(se,Fe=C.now){this.schedulerActionCtor=se,this.now=Fe}schedule(se,Fe=0,ve){return new this.schedulerActionCtor(this,se).schedule(ve,Fe)}}C.now=M.U.now;class de extends C{constructor(se,Fe=C.now){super(se,Fe),this.actions=[],this._active=!1}flush(se){const{actions:Fe}=this;if(this._active)return void Fe.push(se);let ve;this._active=!0;do{if(ve=se.execute(se.state,se.delay))break}while(se=Fe.shift());if(this._active=!1,ve){for(;se=Fe.shift();)se.unsubscribe();throw ve}}}},536:(Nn,Ct,R)=>{"use strict";R.d(Ct,{X:()=>ve});var M=R(6780),C=R(8359);const de={schedule(fe){let he=requestAnimationFrame,ge=cancelAnimationFrame;const{delegate:at}=de;at&&(he=at.requestAnimationFrame,ge=at.cancelAnimationFrame);const mt=he($e=>{ge=void 0,fe($e)});return new C.yU(()=>ge?.(mt))},requestAnimationFrame(...fe){const{delegate:he}=de;return(he?.requestAnimationFrame||requestAnimationFrame)(...fe)},cancelAnimationFrame(...fe){const{delegate:he}=de;return(he?.cancelAnimationFrame||cancelAnimationFrame)(...fe)},delegate:void 0};var se=R(9687);const ve=new class Fe extends se.q{flush(he){let ge;this._active=!0,he?ge=he.id:(ge=this._scheduled,this._scheduled=void 0);const{actions:at}=this;let mt;he=he||at.shift();do{if(mt=he.execute(he.state,he.delay))break}while((he=at[0])&&he.id===ge&&at.shift());if(this._active=!1,mt){for(;(he=at[0])&&he.id===ge&&at.shift();)he.unsubscribe();throw mt}}}(class a extends M.R{constructor(he,ge){super(he,ge),this.scheduler=he,this.work=ge}requestAsyncId(he,ge,at=0){return null!==at&&at>0?super.requestAsyncId(he,ge,at):(he.actions.push(this),he._scheduled||(he._scheduled=de.requestAnimationFrame(()=>he.flush(void 0))))}recycleAsyncId(he,ge,at=0){var mt;if(null!=at?at>0:this.delay>0)return super.recycleAsyncId(he,ge,at);const{actions:$e}=he;null!=ge&&ge===he._scheduled&&(null===(mt=$e[$e.length-1])||void 0===mt?void 0:mt.id)!==ge&&(de.cancelAnimationFrame(ge),he._scheduled=void 0)}})},5007:(Nn,Ct,R)=>{"use strict";R.d(Ct,{$:()=>$e});var M=R(6780);let de,C=1;const a={};function se(bt){return bt in a&&(delete a[bt],!0)}const Fe={setImmediate(bt){const xt=C++;return a[xt]=!0,de||(de=Promise.resolve()),de.then(()=>se(xt)&&bt()),xt},clearImmediate(bt){se(bt)}},{setImmediate:ee,clearImmediate:fe}=Fe,he={setImmediate(...bt){const{delegate:xt}=he;return(xt?.setImmediate||ee)(...bt)},clearImmediate(bt){const{delegate:xt}=he;return(xt?.clearImmediate||fe)(bt)},delegate:void 0};var at=R(9687);const $e=new class mt extends at.q{flush(xt){this._active=!0;const Qt=this._scheduled;this._scheduled=void 0;const{actions:sn}=this;let Yt;xt=xt||sn.shift();do{if(Yt=xt.execute(xt.state,xt.delay))break}while((xt=sn[0])&&xt.id===Qt&&sn.shift());if(this._active=!1,Yt){for(;(xt=sn[0])&&xt.id===Qt&&sn.shift();)xt.unsubscribe();throw Yt}}}(class ge extends M.R{constructor(xt,Qt){super(xt,Qt),this.scheduler=xt,this.work=Qt}requestAsyncId(xt,Qt,sn=0){return null!==sn&&sn>0?super.requestAsyncId(xt,Qt,sn):(xt.actions.push(this),xt._scheduled||(xt._scheduled=he.setImmediate(xt.flush.bind(xt,void 0))))}recycleAsyncId(xt,Qt,sn=0){var Yt;if(null!=sn?sn>0:this.delay>0)return super.recycleAsyncId(xt,Qt,sn);const{actions:Ut}=xt;null!=Qt&&(null===(Yt=Ut[Ut.length-1])||void 0===Yt?void 0:Yt.id)!==Qt&&(he.clearImmediate(Qt),xt._scheduled===Qt&&(xt._scheduled=void 0))}})},3236:(Nn,Ct,R)=>{"use strict";R.d(Ct,{E:()=>de,b:()=>a});var M=R(6780);const de=new(R(9687).q)(M.R),a=de},6129:(Nn,Ct,R)=>{"use strict";R.d(Ct,{U:()=>M});const M={now:()=>(M.delegate||Date).now(),delegate:void 0}},9270:(Nn,Ct,R)=>{"use strict";R.d(Ct,{f:()=>M});const M={setTimeout(C,de,...a){const{delegate:se}=M;return se?.setTimeout?se.setTimeout(C,de,...a):setTimeout(C,de,...a)},clearTimeout(C){const{delegate:de}=M;return(de?.clearTimeout||clearTimeout)(C)},delegate:void 0}},4761:(Nn,Ct,R)=>{"use strict";R.d(Ct,{l:()=>C});const C=function M(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},3494:(Nn,Ct,R)=>{"use strict";R.d(Ct,{s:()=>M});const M="function"==typeof Symbol&&Symbol.observable||"@@observable"},9350:(Nn,Ct,R)=>{"use strict";R.d(Ct,{G:()=>C});const C=(0,R(1853).L)(de=>function(){de(this),this.name="EmptyError",this.message="no elements in sequence"})},9326:(Nn,Ct,R)=>{"use strict";R.d(Ct,{R0:()=>Fe,lI:()=>se,ms:()=>a});var M=R(8071),C=R(9470);function de(ve){return ve[ve.length-1]}function a(ve){return(0,M.T)(de(ve))?ve.pop():void 0}function se(ve){return(0,C.m)(de(ve))?ve.pop():void 0}function Fe(ve,ee){return"number"==typeof de(ve)?ve.pop():ee}},3073:(Nn,Ct,R)=>{"use strict";R.d(Ct,{D:()=>se});const{isArray:M}=Array,{getPrototypeOf:C,prototype:de,keys:a}=Object;function se(ve){if(1===ve.length){const ee=ve[0];if(M(ee))return{args:ee,keys:null};if(function Fe(ve){return ve&&"object"==typeof ve&&C(ve)===de}(ee)){const fe=a(ee);return{args:fe.map(he=>ee[he]),keys:fe}}}return{args:ve,keys:null}}},7908:(Nn,Ct,R)=>{"use strict";function M(C,de){if(C){const a=C.indexOf(de);0<=a&&C.splice(a,1)}}R.d(Ct,{o:()=>M})},1853:(Nn,Ct,R)=>{"use strict";function M(C){const a=C(se=>{Error.call(se),se.stack=(new Error).stack});return a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a}R.d(Ct,{L:()=>M})},8496:(Nn,Ct,R)=>{"use strict";function M(C,de){return C.reduce((a,se,Fe)=>(a[se]=de[Fe],a),{})}R.d(Ct,{e:()=>M})},9786:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Y:()=>de,l:()=>a});var M=R(1026);let C=null;function de(se){if(M.$.useDeprecatedSynchronousErrorHandling){const Fe=!C;if(Fe&&(C={errorThrown:!1,error:null}),se(),Fe){const{errorThrown:ve,error:ee}=C;if(C=null,ve)throw ee}}else se()}function a(se){M.$.useDeprecatedSynchronousErrorHandling&&C&&(C.errorThrown=!0,C.error=se)}},5225:(Nn,Ct,R)=>{"use strict";function M(C,de,a,se=0,Fe=!1){const ve=de.schedule(function(){a(),Fe?C.add(this.schedule(null,se)):this.unsubscribe()},se);if(C.add(ve),!Fe)return ve}R.d(Ct,{N:()=>M})},3669:(Nn,Ct,R)=>{"use strict";function M(C){return C}R.d(Ct,{D:()=>M})},7441:(Nn,Ct,R)=>{"use strict";R.d(Ct,{X:()=>M});const M=C=>C&&"number"==typeof C.length&&"function"!=typeof C},7953:(Nn,Ct,R)=>{"use strict";R.d(Ct,{T:()=>C});var M=R(8071);function C(de){return Symbol.asyncIterator&&(0,M.T)(de?.[Symbol.asyncIterator])}},8071:(Nn,Ct,R)=>{"use strict";function M(C){return"function"==typeof C}R.d(Ct,{T:()=>M})},5055:(Nn,Ct,R)=>{"use strict";R.d(Ct,{l:()=>de});var M=R(3494),C=R(8071);function de(a){return(0,C.T)(a[M.s])}},5397:(Nn,Ct,R)=>{"use strict";R.d(Ct,{x:()=>de});var M=R(4761),C=R(8071);function de(a){return(0,C.T)(a?.[M.l])}},4402:(Nn,Ct,R)=>{"use strict";R.d(Ct,{A:()=>de});var M=R(1985),C=R(8071);function de(a){return!!a&&(a instanceof M.c||(0,C.T)(a.lift)&&(0,C.T)(a.subscribe))}},9858:(Nn,Ct,R)=>{"use strict";R.d(Ct,{y:()=>C});var M=R(8071);function C(de){return(0,M.T)(de?.then)}},5196:(Nn,Ct,R)=>{"use strict";R.d(Ct,{C:()=>de,U:()=>a});var M=R(1635),C=R(8071);function de(se){return(0,M.AQ)(this,arguments,function*(){const ve=se.getReader();try{for(;;){const{value:ee,done:fe}=yield(0,M.N3)(ve.read());if(fe)return yield(0,M.N3)(void 0);yield yield(0,M.N3)(ee)}}finally{ve.releaseLock()}})}function a(se){return(0,C.T)(se?.getReader)}},9470:(Nn,Ct,R)=>{"use strict";R.d(Ct,{m:()=>C});var M=R(8071);function C(de){return de&&(0,M.T)(de.schedule)}},9974:(Nn,Ct,R)=>{"use strict";R.d(Ct,{N:()=>de,S:()=>C});var M=R(8071);function C(a){return(0,M.T)(a?.lift)}function de(a){return se=>{if(C(se))return se.lift(function(Fe){try{return a(Fe,this)}catch(ve){this.error(ve)}});throw new TypeError("Unable to lift unknown Observable type")}}},6450:(Nn,Ct,R)=>{"use strict";R.d(Ct,{I:()=>a});var M=R(6354);const{isArray:C}=Array;function a(se){return(0,M.T)(Fe=>function de(se,Fe){return C(Fe)?se(...Fe):se(Fe)}(se,Fe))}},5343:(Nn,Ct,R)=>{"use strict";function M(){}R.d(Ct,{l:()=>M})},1203:(Nn,Ct,R)=>{"use strict";R.d(Ct,{F:()=>C,m:()=>de});var M=R(3669);function C(...a){return de(a)}function de(a){return 0===a.length?M.D:1===a.length?a[0]:function(Fe){return a.reduce((ve,ee)=>ee(ve),Fe)}}},5334:(Nn,Ct,R)=>{"use strict";R.d(Ct,{m:()=>de});var M=R(1026),C=R(9270);function de(a){C.f.setTimeout(()=>{const{onUnhandledError:se}=M.$;if(!se)throw a;se(a)})}},591:(Nn,Ct,R)=>{"use strict";function M(C){return new TypeError(`You provided ${null!==C&&"object"==typeof C?"an invalid object":`'${C}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}R.d(Ct,{L:()=>M})},9969:(Nn,Ct,R)=>{"use strict";R.d(Ct,{FX:()=>At,If:()=>M,K2:()=>Fe,P:()=>$e,hZ:()=>de,i0:()=>a,iF:()=>ve,kY:()=>he,kp:()=>C,sf:()=>zt,ui:()=>je,wk:()=>ee,yc:()=>ze});var M=function(Ze){return Ze[Ze.State=0]="State",Ze[Ze.Transition=1]="Transition",Ze[Ze.Sequence=2]="Sequence",Ze[Ze.Group=3]="Group",Ze[Ze.Animate=4]="Animate",Ze[Ze.Keyframes=5]="Keyframes",Ze[Ze.Style=6]="Style",Ze[Ze.Trigger=7]="Trigger",Ze[Ze.Reference=8]="Reference",Ze[Ze.AnimateChild=9]="AnimateChild",Ze[Ze.AnimateRef=10]="AnimateRef",Ze[Ze.Query=11]="Query",Ze[Ze.Stagger=12]="Stagger",Ze}(M||{});const C="*";function de(Ze,St){return{type:M.Trigger,name:Ze,definitions:St,options:{}}}function a(Ze,St=null){return{type:M.Animate,styles:St,timings:Ze}}function Fe(Ze,St=null){return{type:M.Sequence,steps:Ze,options:St}}function ve(Ze){return{type:M.Style,styles:Ze,offset:null}}function ee(Ze,St,wn){return{type:M.State,name:Ze,styles:St,options:wn}}function he(Ze,St,wn=null){return{type:M.Transition,expr:Ze,animation:St,options:wn}}function $e(Ze,St,wn=null){return{type:M.Query,selector:Ze,animation:St,options:wn}}function ze(Ze,St){return{type:M.Stagger,timings:Ze,animation:St}}class zt{constructor(St=0,wn=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=St+wn}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(St=>St()),this._onDoneFns=[])}onStart(St){this._originalOnStartFns.push(St),this._onStartFns.push(St)}onDone(St){this._originalOnDoneFns.push(St),this._onDoneFns.push(St)}onDestroy(St){this._onDestroyFns.push(St)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(St=>St()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(St=>St()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(St){this._position=this.totalTime?St*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(St){const wn="start"==St?this._onStartFns:this._onDoneFns;wn.forEach(Rn=>Rn()),wn.length=0}}class je{constructor(St){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=St;let wn=0,Rn=0,an=0;const Un=this.players.length;0==Un?queueMicrotask(()=>this._onFinish()):this.players.forEach(nn=>{nn.onDone(()=>{++wn==Un&&this._onFinish()}),nn.onDestroy(()=>{++Rn==Un&&this._onDestroy()}),nn.onStart(()=>{++an==Un&&this._onStart()})}),this.totalTime=this.players.reduce((nn,di)=>Math.max(nn,di.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(St=>St()),this._onDoneFns=[])}init(){this.players.forEach(St=>St.init())}onStart(St){this._onStartFns.push(St)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(St=>St()),this._onStartFns=[])}onDone(St){this._onDoneFns.push(St)}onDestroy(St){this._onDestroyFns.push(St)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(St=>St.play())}pause(){this.players.forEach(St=>St.pause())}restart(){this.players.forEach(St=>St.restart())}finish(){this._onFinish(),this.players.forEach(St=>St.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(St=>St.destroy()),this._onDestroyFns.forEach(St=>St()),this._onDestroyFns=[])}reset(){this.players.forEach(St=>St.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(St){const wn=St*this.totalTime;this.players.forEach(Rn=>{const an=Rn.totalTime?Math.min(1,wn/Rn.totalTime):1;Rn.setPosition(an)})}getPosition(){const St=this.players.reduce((wn,Rn)=>null===wn||Rn.totalTime>wn.totalTime?Rn:wn,null);return null!=St?St.getPosition():0}beforeDestroy(){this.players.forEach(St=>{St.beforeDestroy&&St.beforeDestroy()})}triggerCallback(St){const wn="start"==St?this._onStartFns:this._onDoneFns;wn.forEach(Rn=>Rn()),wn.length=0}}const At="!"},8617:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Bu:()=>nn,FN:()=>lt,GX:()=>Mi,Pd:()=>Ie,_G:()=>Ai,kB:()=>Br,vR:()=>Pe,w6:()=>Sn});var M=R(177),C=R(4438),de=R(6860),a=R(1413),se=R(8359),Fe=R(4412),ve=R(7673),ee=R(7336),fe=R(8141),he=R(152),ge=R(5964),at=R(6354),mt=R(6697),$e=R(5245),ze=R(3294),bt=R(6977),xt=R(2318),Qt=R(4085),sn=R(1708);class an{constructor(Z,Y){this._items=Z,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new a.B,this._typeaheadSubscription=se.yU.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=_e=>_e.disabled,this._pressedLetters=[],this.tabOut=new a.B,this.change=new a.B,Z instanceof C.rOR?this._itemChangesSubscription=Z.changes.subscribe(_e=>this._itemsChanged(_e.toArray())):(0,C.Hps)(Z)&&(this._effectRef=(0,C.QZP)(()=>this._itemsChanged(Z()),{injector:Y}))}skipPredicate(Z){return this._skipPredicateFn=Z,this}withWrap(Z=!0){return this._wrap=Z,this}withVerticalOrientation(Z=!0){return this._vertical=Z,this}withHorizontalOrientation(Z){return this._horizontal=Z,this}withAllowedModifierKeys(Z){return this._allowedModifierKeys=Z,this}withTypeAhead(Z=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe((0,fe.M)(Y=>this._pressedLetters.push(Y)),(0,he.B)(Z),(0,ge.p)(()=>this._pressedLetters.length>0),(0,at.T)(()=>this._pressedLetters.join(""))).subscribe(Y=>{const _e=this._getItemsArray();for(let re=1;re<_e.length+1;re++){const Je=(this._activeItemIndex+re)%_e.length,Pt=_e[Je];if(!this._skipPredicateFn(Pt)&&0===Pt.getLabel().toUpperCase().trim().indexOf(Y)){this.setActiveItem(Je);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(Z=!0){return this._homeAndEnd=Z,this}withPageUpDown(Z=!0,Y=10){return this._pageUpAndDown={enabled:Z,delta:Y},this}setActiveItem(Z){const Y=this._activeItem;this.updateActiveItem(Z),this._activeItem!==Y&&this.change.next(this._activeItemIndex)}onKeydown(Z){const Y=Z.keyCode,re=["altKey","ctrlKey","metaKey","shiftKey"].every(Je=>!Z[Je]||this._allowedModifierKeys.indexOf(Je)>-1);switch(Y){case ee.wn:return void this.tabOut.next();case ee.n6:if(this._vertical&&re){this.setNextItemActive();break}return;case ee.i7:if(this._vertical&&re){this.setPreviousItemActive();break}return;case ee.LE:if(this._horizontal&&re){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case ee.UQ:if(this._horizontal&&re){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case ee.yZ:if(this._homeAndEnd&&re){this.setFirstItemActive();break}return;case ee.Kp:if(this._homeAndEnd&&re){this.setLastItemActive();break}return;case ee.w_:if(this._pageUpAndDown.enabled&&re){const Je=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(Je>0?Je:0,1);break}return;case ee.dB:if(this._pageUpAndDown.enabled&&re){const Je=this._activeItemIndex+this._pageUpAndDown.delta,Pt=this._getItemsArray().length;this._setActiveItemByIndex(Je<Pt?Je:Pt-1,-1);break}return;default:return void((re||(0,ee.rp)(Z,"shiftKey"))&&(Z.key&&1===Z.key.length?this._letterKeyStream.next(Z.key.toLocaleUpperCase()):(Y>=ee.A&&Y<=ee.Z||Y>=ee.f2&&Y<=ee.bn)&&this._letterKeyStream.next(String.fromCharCode(Y))))}this._pressedLetters=[],Z.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(Z){const Y=this._getItemsArray(),_e="number"==typeof Z?Z:Y.indexOf(Z);this._activeItem=Y[_e]??null,this._activeItemIndex=_e}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(Z){this._wrap?this._setActiveInWrapMode(Z):this._setActiveInDefaultMode(Z)}_setActiveInWrapMode(Z){const Y=this._getItemsArray();for(let _e=1;_e<=Y.length;_e++){const re=(this._activeItemIndex+Z*_e+Y.length)%Y.length;if(!this._skipPredicateFn(Y[re]))return void this.setActiveItem(re)}}_setActiveInDefaultMode(Z){this._setActiveItemByIndex(this._activeItemIndex+Z,Z)}_setActiveItemByIndex(Z,Y){const _e=this._getItemsArray();if(_e[Z]){for(;this._skipPredicateFn(_e[Z]);)if(!_e[Z+=Y])return;this.setActiveItem(Z)}}_getItemsArray(){return(0,C.Hps)(this._items)?this._items():this._items instanceof C.rOR?this._items.toArray():this._items}_itemsChanged(Z){if(this._activeItem){const Y=Z.indexOf(this._activeItem);Y>-1&&Y!==this._activeItemIndex&&(this._activeItemIndex=Y)}}}class nn extends an{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(Z){return this._origin=Z,this}setActiveItem(Z){super.setActiveItem(Z),this.activeItem&&this.activeItem.focus(this._origin)}}let Wn=(()=>{class ae{constructor(Y){this._platform=Y}isDisabled(Y){return Y.hasAttribute("disabled")}isVisible(Y){return function ki(ae){return!!(ae.offsetWidth||ae.offsetHeight||"function"==typeof ae.getClientRects&&ae.getClientRects().length)}(Y)&&"visible"===getComputedStyle(Y).visibility}isTabbable(Y){if(!this._platform.isBrowser)return!1;const _e=function $n(ae){try{return ae.frameElement}catch{return null}}(function Gi(ae){return ae.ownerDocument&&ae.ownerDocument.defaultView||window}(Y));if(_e&&(-1===zn(_e)||!this.isVisible(_e)))return!1;let re=Y.nodeName.toLowerCase(),Je=zn(Y);return Y.hasAttribute("contenteditable")?-1!==Je:!("iframe"===re||"object"===re||this._platform.WEBKIT&&this._platform.IOS&&!function qn(ae){let Z=ae.nodeName.toLowerCase(),Y="input"===Z&&ae.type;return"text"===Y||"password"===Y||"select"===Z||"textarea"===Z}(Y))&&("audio"===re?!!Y.hasAttribute("controls")&&-1!==Je:"video"===re?-1!==Je&&(null!==Je||this._platform.FIREFOX||Y.hasAttribute("controls")):Y.tabIndex>=0)}isFocusable(Y,_e){return function ar(ae){return!function un(ae){return function dn(ae){return"input"==ae.nodeName.toLowerCase()}(ae)&&"hidden"==ae.type}(ae)&&(function Jt(ae){let Z=ae.nodeName.toLowerCase();return"input"===Z||"select"===Z||"button"===Z||"textarea"===Z}(ae)||function pn(ae){return function jn(ae){return"a"==ae.nodeName.toLowerCase()}(ae)&&ae.hasAttribute("href")}(ae)||ae.hasAttribute("contenteditable")||Yn(ae))}(Y)&&!this.isDisabled(Y)&&(_e?.ignoreVisibility||this.isVisible(Y))}static{this.\u0275fac=function(_e){return new(_e||ae)(C.KVO(de.OD))}}static{this.\u0275prov=C.jDH({token:ae,factory:ae.\u0275fac,providedIn:"root"})}}return ae})();function Yn(ae){if(!ae.hasAttribute("tabindex")||void 0===ae.tabIndex)return!1;let Z=ae.getAttribute("tabindex");return!(!Z||isNaN(parseInt(Z,10)))}function zn(ae){if(!Yn(ae))return null;const Z=parseInt(ae.getAttribute("tabindex")||"",10);return isNaN(Z)?-1:Z}class Si{get enabled(){return this._enabled}set enabled(Z){this._enabled=Z,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(Z,this._startAnchor),this._toggleAnchorTabIndex(Z,this._endAnchor))}constructor(Z,Y,_e,re,Je=!1){this._element=Z,this._checker=Y,this._ngZone=_e,this._document=re,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,Je||this.attachAnchors()}destroy(){const Z=this._startAnchor,Y=this._endAnchor;Z&&(Z.removeEventListener("focus",this.startAnchorListener),Z.remove()),Y&&(Y.removeEventListener("focus",this.endAnchorListener),Y.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(Z){return new Promise(Y=>{this._executeOnStable(()=>Y(this.focusInitialElement(Z)))})}focusFirstTabbableElementWhenReady(Z){return new Promise(Y=>{this._executeOnStable(()=>Y(this.focusFirstTabbableElement(Z)))})}focusLastTabbableElementWhenReady(Z){return new Promise(Y=>{this._executeOnStable(()=>Y(this.focusLastTabbableElement(Z)))})}_getRegionBoundary(Z){const Y=this._element.querySelectorAll(`[cdk-focus-region-${Z}], [cdkFocusRegion${Z}], [cdk-focus-${Z}]`);return"start"==Z?Y.length?Y[0]:this._getFirstTabbableElement(this._element):Y.length?Y[Y.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(Z){const Y=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(Y){if(!this._checker.isFocusable(Y)){const _e=this._getFirstTabbableElement(Y);return _e?.focus(Z),!!_e}return Y.focus(Z),!0}return this.focusFirstTabbableElement(Z)}focusFirstTabbableElement(Z){const Y=this._getRegionBoundary("start");return Y&&Y.focus(Z),!!Y}focusLastTabbableElement(Z){const Y=this._getRegionBoundary("end");return Y&&Y.focus(Z),!!Y}hasAttached(){return this._hasAttached}_getFirstTabbableElement(Z){if(this._checker.isFocusable(Z)&&this._checker.isTabbable(Z))return Z;const Y=Z.children;for(let _e=0;_e<Y.length;_e++){const re=Y[_e].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(Y[_e]):null;if(re)return re}return null}_getLastTabbableElement(Z){if(this._checker.isFocusable(Z)&&this._checker.isTabbable(Z))return Z;const Y=Z.children;for(let _e=Y.length-1;_e>=0;_e--){const re=Y[_e].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(Y[_e]):null;if(re)return re}return null}_createAnchor(){const Z=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,Z),Z.classList.add("cdk-visually-hidden"),Z.classList.add("cdk-focus-trap-anchor"),Z.setAttribute("aria-hidden","true"),Z}_toggleAnchorTabIndex(Z,Y){Z?Y.setAttribute("tabindex","0"):Y.removeAttribute("tabindex")}toggleAnchors(Z){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(Z,this._startAnchor),this._toggleAnchorTabIndex(Z,this._endAnchor))}_executeOnStable(Z){this._ngZone.isStable?Z():this._ngZone.onStable.pipe((0,mt.s)(1)).subscribe(Z)}}let Mi=(()=>{class ae{constructor(Y,_e,re){this._checker=Y,this._ngZone=_e,this._document=re}create(Y,_e=!1){return new Si(Y,this._checker,this._ngZone,this._document,_e)}static{this.\u0275fac=function(_e){return new(_e||ae)(C.KVO(Wn),C.KVO(C.SKi),C.KVO(M.qQ))}}static{this.\u0275prov=C.jDH({token:ae,factory:ae.\u0275fac,providedIn:"root"})}}return ae})(),Br=(()=>{class ae{get enabled(){return this.focusTrap?.enabled||!1}set enabled(Y){this.focusTrap&&(this.focusTrap.enabled=Y)}constructor(Y,_e,re){this._elementRef=Y,this._focusTrapFactory=_e,this._previouslyFocusedElement=null,(0,C.WQX)(de.OD).isBrowser&&(this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0))}ngOnDestroy(){this.focusTrap?.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap?.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap&&!this.focusTrap.hasAttached()&&this.focusTrap.attachAnchors()}ngOnChanges(Y){const _e=Y.autoCapture;_e&&!_e.firstChange&&this.autoCapture&&this.focusTrap?.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=(0,de.vc)(),this.focusTrap?.focusInitialElementWhenReady()}static{this.\u0275fac=function(_e){return new(_e||ae)(C.rXU(C.aKT),C.rXU(Mi),C.rXU(M.qQ))}}static{this.\u0275dir=C.FsC({type:ae,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:[C.Mj6.HasDecoratorInputTransform,"cdkTrapFocus","enabled",C.L39],autoCapture:[C.Mj6.HasDecoratorInputTransform,"cdkTrapFocusAutoCapture","autoCapture",C.L39]},exportAs:["cdkTrapFocus"],standalone:!0,features:[C.GFd,C.OA$]})}}return ae})();function Ai(ae){return 0===ae.buttons||0===ae.detail}function Sn(ae){const Z=ae.touches&&ae.touches[0]||ae.changedTouches&&ae.changedTouches[0];return!(!Z||-1!==Z.identifier||null!=Z.radiusX&&1!==Z.radiusX||null!=Z.radiusY&&1!==Z.radiusY)}const On=new C.nKC("cdk-input-modality-detector-options"),st={ignoreKeys:[ee.A$,ee.W3,ee.eg,ee.Ge,ee.FX]},ye=(0,de.BQ)({passive:!0,capture:!0});let Ve=(()=>{class ae{get mostRecentModality(){return this._modality.value}constructor(Y,_e,re,Je){this._platform=Y,this._mostRecentTarget=null,this._modality=new Fe.t(null),this._lastTouchMs=0,this._onKeydown=Pt=>{this._options?.ignoreKeys?.some(Cn=>Cn===Pt.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=(0,de.Fb)(Pt))},this._onMousedown=Pt=>{Date.now()-this._lastTouchMs<650||(this._modality.next(Ai(Pt)?"keyboard":"mouse"),this._mostRecentTarget=(0,de.Fb)(Pt))},this._onTouchstart=Pt=>{Sn(Pt)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=(0,de.Fb)(Pt))},this._options={...st,...Je},this.modalityDetected=this._modality.pipe((0,$e.i)(1)),this.modalityChanged=this.modalityDetected.pipe((0,ze.F)()),Y.isBrowser&&_e.runOutsideAngular(()=>{re.addEventListener("keydown",this._onKeydown,ye),re.addEventListener("mousedown",this._onMousedown,ye),re.addEventListener("touchstart",this._onTouchstart,ye)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,ye),document.removeEventListener("mousedown",this._onMousedown,ye),document.removeEventListener("touchstart",this._onTouchstart,ye))}static{this.\u0275fac=function(_e){return new(_e||ae)(C.KVO(de.OD),C.KVO(C.SKi),C.KVO(M.qQ),C.KVO(On,8))}}static{this.\u0275prov=C.jDH({token:ae,factory:ae.\u0275fac,providedIn:"root"})}}return ae})();var ti=function(ae){return ae[ae.IMMEDIATE=0]="IMMEDIATE",ae[ae.EVENTUAL=1]="EVENTUAL",ae}(ti||{});const bi=new C.nKC("cdk-focus-monitor-default-options"),gi=(0,de.BQ)({passive:!0,capture:!0});let lt=(()=>{class ae{constructor(Y,_e,re,Je,Pt){this._ngZone=Y,this._platform=_e,this._inputModalityDetector=re,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new a.B,this._rootNodeFocusAndBlurListener=Cn=>{for(let xi=(0,de.Fb)(Cn);xi;xi=xi.parentElement)"focus"===Cn.type?this._onFocus(Cn,xi):this._onBlur(Cn,xi)},this._document=Je,this._detectionMode=Pt?.detectionMode||ti.IMMEDIATE}monitor(Y,_e=!1){const re=(0,Qt.i8)(Y);if(!this._platform.isBrowser||1!==re.nodeType)return(0,ve.of)();const Je=(0,de.KT)(re)||this._getDocument(),Pt=this._elementInfo.get(re);if(Pt)return _e&&(Pt.checkChildren=!0),Pt.subject;const Cn={checkChildren:_e,subject:new a.B,rootNode:Je};return this._elementInfo.set(re,Cn),this._registerGlobalListeners(Cn),Cn.subject}stopMonitoring(Y){const _e=(0,Qt.i8)(Y),re=this._elementInfo.get(_e);re&&(re.subject.complete(),this._setClasses(_e),this._elementInfo.delete(_e),this._removeGlobalListeners(re))}focusVia(Y,_e,re){const Je=(0,Qt.i8)(Y);Je===this._getDocument().activeElement?this._getClosestElementsInfo(Je).forEach(([Cn,ni])=>this._originChanged(Cn,_e,ni)):(this._setOrigin(_e),"function"==typeof Je.focus&&Je.focus(re))}ngOnDestroy(){this._elementInfo.forEach((Y,_e)=>this.stopMonitoring(_e))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(Y){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(Y)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:Y&&this._isLastInteractionFromInputLabel(Y)?"mouse":"program"}_shouldBeAttributedToTouch(Y){return this._detectionMode===ti.EVENTUAL||!!Y?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(Y,_e){Y.classList.toggle("cdk-focused",!!_e),Y.classList.toggle("cdk-touch-focused","touch"===_e),Y.classList.toggle("cdk-keyboard-focused","keyboard"===_e),Y.classList.toggle("cdk-mouse-focused","mouse"===_e),Y.classList.toggle("cdk-program-focused","program"===_e)}_setOrigin(Y,_e=!1){this._ngZone.runOutsideAngular(()=>{this._origin=Y,this._originFromTouchInteraction="touch"===Y&&_e,this._detectionMode===ti.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(Y,_e){const re=this._elementInfo.get(_e),Je=(0,de.Fb)(Y);!re||!re.checkChildren&&_e!==Je||this._originChanged(_e,this._getFocusOrigin(Je),re)}_onBlur(Y,_e){const re=this._elementInfo.get(_e);!re||re.checkChildren&&Y.relatedTarget instanceof Node&&_e.contains(Y.relatedTarget)||(this._setClasses(_e),this._emitOrigin(re,null))}_emitOrigin(Y,_e){Y.subject.observers.length&&this._ngZone.run(()=>Y.subject.next(_e))}_registerGlobalListeners(Y){if(!this._platform.isBrowser)return;const _e=Y.rootNode,re=this._rootNodeFocusListenerCount.get(_e)||0;re||this._ngZone.runOutsideAngular(()=>{_e.addEventListener("focus",this._rootNodeFocusAndBlurListener,gi),_e.addEventListener("blur",this._rootNodeFocusAndBlurListener,gi)}),this._rootNodeFocusListenerCount.set(_e,re+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe((0,bt.Q)(this._stopInputModalityDetector)).subscribe(Je=>{this._setOrigin(Je,!0)}))}_removeGlobalListeners(Y){const _e=Y.rootNode;if(this._rootNodeFocusListenerCount.has(_e)){const re=this._rootNodeFocusListenerCount.get(_e);re>1?this._rootNodeFocusListenerCount.set(_e,re-1):(_e.removeEventListener("focus",this._rootNodeFocusAndBlurListener,gi),_e.removeEventListener("blur",this._rootNodeFocusAndBlurListener,gi),this._rootNodeFocusListenerCount.delete(_e))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(Y,_e,re){this._setClasses(Y,_e),this._emitOrigin(re,_e),this._lastFocusOrigin=_e}_getClosestElementsInfo(Y){const _e=[];return this._elementInfo.forEach((re,Je)=>{(Je===Y||re.checkChildren&&Je.contains(Y))&&_e.push([Je,re])}),_e}_isLastInteractionFromInputLabel(Y){const{_mostRecentTarget:_e,mostRecentModality:re}=this._inputModalityDetector;if("mouse"!==re||!_e||_e===Y||"INPUT"!==Y.nodeName&&"TEXTAREA"!==Y.nodeName||Y.disabled)return!1;const Je=Y.labels;if(Je)for(let Pt=0;Pt<Je.length;Pt++)if(Je[Pt].contains(_e))return!0;return!1}static{this.\u0275fac=function(_e){return new(_e||ae)(C.KVO(C.SKi),C.KVO(de.OD),C.KVO(Ve),C.KVO(M.qQ,8),C.KVO(bi,8))}}static{this.\u0275prov=C.jDH({token:ae,factory:ae.\u0275fac,providedIn:"root"})}}return ae})(),Pe=(()=>{class ae{constructor(Y,_e){this._elementRef=Y,this._focusMonitor=_e,this._focusOrigin=null,this.cdkFocusChange=new C.bkB}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){const Y=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(Y,1===Y.nodeType&&Y.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(_e=>{this._focusOrigin=_e,this.cdkFocusChange.emit(_e)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}static{this.\u0275fac=function(_e){return new(_e||ae)(C.rXU(C.aKT),C.rXU(lt))}}static{this.\u0275dir=C.FsC({type:ae,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"],standalone:!0})}}return ae})();var Se=function(ae){return ae[ae.NONE=0]="NONE",ae[ae.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",ae[ae.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",ae}(Se||{});const dt="cdk-high-contrast-black-on-white",Oe="cdk-high-contrast-white-on-black",Ke="cdk-high-contrast-active";let Et=(()=>{class ae{constructor(Y,_e){this._platform=Y,this._document=_e,this._breakpointSubscription=(0,C.WQX)(sn.QP).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Se.NONE;const Y=this._document.createElement("div");Y.style.backgroundColor="rgb(1,2,3)",Y.style.position="absolute",this._document.body.appendChild(Y);const _e=this._document.defaultView||window,re=_e&&_e.getComputedStyle?_e.getComputedStyle(Y):null,Je=(re&&re.backgroundColor||"").replace(/ /g,"");switch(Y.remove(),Je){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Se.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Se.BLACK_ON_WHITE}return Se.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const Y=this._document.body.classList;Y.remove(Ke,dt,Oe),this._hasCheckedHighContrastMode=!0;const _e=this.getHighContrastMode();_e===Se.BLACK_ON_WHITE?Y.add(Ke,dt):_e===Se.WHITE_ON_BLACK&&Y.add(Ke,Oe)}}static{this.\u0275fac=function(_e){return new(_e||ae)(C.KVO(de.OD),C.KVO(M.qQ))}}static{this.\u0275prov=C.jDH({token:ae,factory:ae.\u0275fac,providedIn:"root"})}}return ae})(),Ie=(()=>{class ae{constructor(Y){Y._applyBodyHighContrastModeCssClasses()}static{this.\u0275fac=function(_e){return new(_e||ae)(C.KVO(Et))}}static{this.\u0275mod=C.$C({type:ae})}static{this.\u0275inj=C.G2t({imports:[xt.w5]})}}return ae})()},8203:(Nn,Ct,R)=>{"use strict";R.d(Ct,{dS:()=>ve,ig:()=>ee,jI:()=>fe});var M=R(4438),C=R(177);const de=new M.nKC("cdk-dir-doc",{providedIn:"root",factory:function a(){return(0,M.WQX)(C.qQ)}}),se=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function Fe(he){const ge=he?.toLowerCase()||"";return"auto"===ge&&typeof navigator<"u"&&navigator?.language?se.test(navigator.language)?"rtl":"ltr":"rtl"===ge?"rtl":"ltr"}let ve=(()=>{class he{constructor(at){this.value="ltr",this.change=new M.bkB,at&&(this.value=Fe((at.body?at.body.dir:null)||(at.documentElement?at.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(mt){return new(mt||he)(M.KVO(de,8))}}static{this.\u0275prov=M.jDH({token:he,factory:he.\u0275fac,providedIn:"root"})}}return he})(),ee=(()=>{class he{constructor(){this._dir="ltr",this._isInitialized=!1,this.change=new M.bkB}get dir(){return this._dir}set dir(at){const mt=this._dir;this._dir=Fe(at),this._rawDir=at,mt!==this._dir&&this._isInitialized&&this.change.emit(this._dir)}get value(){return this.dir}ngAfterContentInit(){this._isInitialized=!0}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(mt){return new(mt||he)}}static{this.\u0275dir=M.FsC({type:he,selectors:[["","dir",""]],hostVars:1,hostBindings:function(mt,$e){2&mt&&M.BMQ("dir",$e._rawDir)},inputs:{dir:"dir"},outputs:{change:"dirChange"},exportAs:["dir"],standalone:!0,features:[M.Jv_([{provide:ve,useExisting:he}])]})}}return he})(),fe=(()=>{class he{static{this.\u0275fac=function(mt){return new(mt||he)}}static{this.\u0275mod=M.$C({type:he})}static{this.\u0275inj=M.G2t({})}}return he})()},4085:(Nn,Ct,R)=>{"use strict";R.d(Ct,{FG:()=>se,OE:()=>de,a1:()=>Fe,he:()=>C,i8:()=>ve,o1:()=>a});var M=R(4438);function C(fe){return null!=fe&&"false"!=`${fe}`}function de(fe,he=0){return a(fe)?Number(fe):he}function a(fe){return!isNaN(parseFloat(fe))&&!isNaN(Number(fe))}function se(fe){return Array.isArray(fe)?fe:[fe]}function Fe(fe){return null==fe?"":"string"==typeof fe?fe:`${fe}px`}function ve(fe){return fe instanceof M.aKT?fe.nativeElement:fe}},7336:(Nn,Ct,R)=>{"use strict";R.d(Ct,{A:()=>un,A$:()=>ee,FX:()=>Fe,Fm:()=>se,G_:()=>C,Ge:()=>en,Kp:()=>ze,LE:()=>sn,UQ:()=>xt,W3:()=>ve,Z:()=>wt,_f:()=>ge,bn:()=>di,dB:()=>$e,eg:()=>lr,f2:()=>je,i7:()=>Qt,n6:()=>Yt,rp:()=>Mr,t6:()=>at,w_:()=>mt,wn:()=>de,yZ:()=>bt});const C=8,de=9,se=13,Fe=16,ve=17,ee=18,ge=27,at=32,mt=33,$e=34,ze=35,bt=36,xt=37,Qt=38,sn=39,Yt=40,je=48,di=57,un=65,wt=90,en=91,lr=224;function Mr(ii,...vi){return vi.length?vi.some(Ui=>ii[Ui]):ii.altKey||ii.shiftKey||ii.ctrlKey||ii.metaKey}},1708:(Nn,Ct,R)=>{"use strict";R.d(Ct,{DY:()=>xt,QP:()=>Yt,RH:()=>$e});var M=R(4438),C=R(4085),de=R(1413),a=R(4572),se=R(8793),Fe=R(1985),ve=R(6697),ee=R(5245),fe=R(152),he=R(6354),ge=R(9172),at=R(6977),mt=R(6860);let $e=(()=>{class It{static{this.\u0275fac=function(At){return new(At||It)}}static{this.\u0275mod=M.$C({type:It})}static{this.\u0275inj=M.G2t({})}}return It})();const ze=new Set;let bt,xt=(()=>{class It{constructor(je,At){this._platform=je,this._nonce=At,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):sn}matchMedia(je){return(this._platform.WEBKIT||this._platform.BLINK)&&function Qt(It,zt){if(!ze.has(It))try{bt||(bt=document.createElement("style"),zt&&bt.setAttribute("nonce",zt),bt.setAttribute("type","text/css"),document.head.appendChild(bt)),bt.sheet&&(bt.sheet.insertRule(`@media ${It} {body{ }}`,0),ze.add(It))}catch(je){console.error(je)}}(je,this._nonce),this._matchMedia(je)}static{this.\u0275fac=function(At){return new(At||It)(M.KVO(mt.OD),M.KVO(M.BIS,8))}}static{this.\u0275prov=M.jDH({token:It,factory:It.\u0275fac,providedIn:"root"})}}return It})();function sn(It){return{matches:"all"===It||""===It,media:It,addListener:()=>{},removeListener:()=>{}}}let Yt=(()=>{class It{constructor(je,At){this._mediaMatcher=je,this._zone=At,this._queries=new Map,this._destroySubject=new de.B}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(je){return Ut((0,C.FG)(je)).some(Ze=>this._registerQuery(Ze).mql.matches)}observe(je){const Ze=Ut((0,C.FG)(je)).map(wn=>this._registerQuery(wn).observable);let St=(0,a.z)(Ze);return St=(0,se.x)(St.pipe((0,ve.s)(1)),St.pipe((0,ee.i)(1),(0,fe.B)(0))),St.pipe((0,he.T)(wn=>{const Rn={matches:!1,breakpoints:{}};return wn.forEach(({matches:an,query:Un})=>{Rn.matches=Rn.matches||an,Rn.breakpoints[Un]=an}),Rn}))}_registerQuery(je){if(this._queries.has(je))return this._queries.get(je);const At=this._mediaMatcher.matchMedia(je),St={observable:new Fe.c(wn=>{const Rn=an=>this._zone.run(()=>wn.next(an));return At.addListener(Rn),()=>{At.removeListener(Rn)}}).pipe((0,ge.Z)(At),(0,he.T)(({matches:wn})=>({query:je,matches:wn})),(0,at.Q)(this._destroySubject)),mql:At};return this._queries.set(je,St),St}static{this.\u0275fac=function(At){return new(At||It)(M.KVO(xt),M.KVO(M.SKi))}}static{this.\u0275prov=M.jDH({token:It,factory:It.\u0275fac,providedIn:"root"})}}return It})();function Ut(It){return It.map(zt=>zt.split(",")).reduce((zt,je)=>zt.concat(je)).map(zt=>zt.trim())}},2318:(Nn,Ct,R)=>{"use strict";R.d(Ct,{w5:()=>Fe});var M=R(4438);let de=(()=>{class ve{create(fe){return typeof MutationObserver>"u"?null:new MutationObserver(fe)}static{this.\u0275fac=function(he){return new(he||ve)}}static{this.\u0275prov=M.jDH({token:ve,factory:ve.\u0275fac,providedIn:"root"})}}return ve})(),Fe=(()=>{class ve{static{this.\u0275fac=function(he){return new(he||ve)}}static{this.\u0275mod=M.$C({type:ve})}static{this.\u0275inj=M.G2t({providers:[de]})}}return ve})()},6969:(Nn,Ct,R)=>{"use strict";R.d(Ct,{WB:()=>Dn,$Q:()=>jt,uH:()=>St,hJ:()=>ji,rR:()=>Ze,z_:()=>On,yY:()=>ki});var M=R(9327),C=R(177),de=R(4438),a=R(4085),se=R(6860),Fe=R(5964),ve=R(6697),ee=R(6977),fe=R(9974),he=R(4360),at=R(8203),mt=R(6939),$e=R(1413),ze=R(8359),bt=R(7786),xt=R(7336);const Qt=(0,se.CZ)();class sn{constructor(ye,Ve){this._viewportRuler=ye,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=Ve}attach(){}enable(){if(this._canBeEnabled()){const ye=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=ye.style.left||"",this._previousHTMLStyles.top=ye.style.top||"",ye.style.left=(0,a.a1)(-this._previousScrollPosition.left),ye.style.top=(0,a.a1)(-this._previousScrollPosition.top),ye.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const ye=this._document.documentElement,gt=ye.style,wt=this._document.body.style,en=gt.scrollBehavior||"",hn=wt.scrollBehavior||"";this._isEnabled=!1,gt.left=this._previousHTMLStyles.left,gt.top=this._previousHTMLStyles.top,ye.classList.remove("cdk-global-scrollblock"),Qt&&(gt.scrollBehavior=wt.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),Qt&&(gt.scrollBehavior=en,wt.scrollBehavior=hn)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const Ve=this._document.body,gt=this._viewportRuler.getViewportSize();return Ve.scrollHeight>gt.height||Ve.scrollWidth>gt.width}}class Ut{constructor(ye,Ve,gt,wt){this._scrollDispatcher=ye,this._ngZone=Ve,this._viewportRuler=gt,this._config=wt,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(ye){this._overlayRef=ye}enable(){if(this._scrollSubscription)return;const ye=this._scrollDispatcher.scrolled(0).pipe((0,Fe.p)(Ve=>!Ve||!this._overlayRef.overlayElement.contains(Ve.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=ye.subscribe(()=>{const Ve=this._viewportRuler.getViewportScrollPosition().top;Math.abs(Ve-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=ye.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class et{enable(){}disable(){}attach(){}}function It(Xe,ye){return ye.some(Ve=>Xe.bottom<Ve.top||Xe.top>Ve.bottom||Xe.right<Ve.left||Xe.left>Ve.right)}function zt(Xe,ye){return ye.some(Ve=>Xe.top<Ve.top||Xe.bottom>Ve.bottom||Xe.left<Ve.left||Xe.right>Ve.right)}class je{constructor(ye,Ve,gt,wt){this._scrollDispatcher=ye,this._viewportRuler=Ve,this._ngZone=gt,this._config=wt,this._scrollSubscription=null}attach(ye){this._overlayRef=ye}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const Ve=this._overlayRef.overlayElement.getBoundingClientRect(),{width:gt,height:wt}=this._viewportRuler.getViewportSize();It(Ve,[{width:gt,height:wt,bottom:wt,right:gt,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let At=(()=>{class Xe{constructor(Ve,gt,wt,en){this._scrollDispatcher=Ve,this._viewportRuler=gt,this._ngZone=wt,this.noop=()=>new et,this.close=hn=>new Ut(this._scrollDispatcher,this._ngZone,this._viewportRuler,hn),this.block=()=>new sn(this._viewportRuler,this._document),this.reposition=hn=>new je(this._scrollDispatcher,this._viewportRuler,this._ngZone,hn),this._document=en}static{this.\u0275fac=function(gt){return new(gt||Xe)(de.KVO(M.R),de.KVO(M.Xj),de.KVO(de.SKi),de.KVO(C.qQ))}}static{this.\u0275prov=de.jDH({token:Xe,factory:Xe.\u0275fac,providedIn:"root"})}}return Xe})();class Ze{constructor(ye){if(this.scrollStrategy=new et,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,ye){const Ve=Object.keys(ye);for(const gt of Ve)void 0!==ye[gt]&&(this[gt]=ye[gt])}}}class St{constructor(ye,Ve,gt,wt,en){this.offsetX=gt,this.offsetY=wt,this.panelClass=en,this.originX=ye.originX,this.originY=ye.originY,this.overlayX=Ve.overlayX,this.overlayY=Ve.overlayY}}class Rn{constructor(ye,Ve){this.connectionPair=ye,this.scrollableViewProperties=Ve}}let nn=(()=>{class Xe{constructor(Ve){this._attachedOverlays=[],this._document=Ve}ngOnDestroy(){this.detach()}add(Ve){this.remove(Ve),this._attachedOverlays.push(Ve)}remove(Ve){const gt=this._attachedOverlays.indexOf(Ve);gt>-1&&this._attachedOverlays.splice(gt,1),0===this._attachedOverlays.length&&this.detach()}static{this.\u0275fac=function(gt){return new(gt||Xe)(de.KVO(C.qQ))}}static{this.\u0275prov=de.jDH({token:Xe,factory:Xe.\u0275fac,providedIn:"root"})}}return Xe})(),di=(()=>{class Xe extends nn{constructor(Ve,gt){super(Ve),this._ngZone=gt,this._keydownListener=wt=>{const en=this._attachedOverlays;for(let hn=en.length-1;hn>-1;hn--)if(en[hn]._keydownEvents.observers.length>0){const si=en[hn]._keydownEvents;this._ngZone?this._ngZone.run(()=>si.next(wt)):si.next(wt);break}}}add(Ve){super.add(Ve),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static{this.\u0275fac=function(gt){return new(gt||Xe)(de.KVO(C.qQ),de.KVO(de.SKi,8))}}static{this.\u0275prov=de.jDH({token:Xe,factory:Xe.\u0275fac,providedIn:"root"})}}return Xe})(),Wn=(()=>{class Xe extends nn{constructor(Ve,gt,wt){super(Ve),this._platform=gt,this._ngZone=wt,this._cursorStyleIsSet=!1,this._pointerDownListener=en=>{this._pointerDownEventTarget=(0,se.Fb)(en)},this._clickListener=en=>{const hn=(0,se.Fb)(en),si="click"===en.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:hn;this._pointerDownEventTarget=null;const Hi=this._attachedOverlays.slice();for(let ti=Hi.length-1;ti>-1;ti--){const bi=Hi[ti];if(bi._outsidePointerEvents.observers.length<1||!bi.hasAttached())continue;if(bi.overlayElement.contains(hn)||bi.overlayElement.contains(si))break;const gi=bi._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>gi.next(en)):gi.next(en)}}}add(Ve){if(super.add(Ve),!this._isAttached){const gt=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(gt)):this._addEventListeners(gt),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=gt.style.cursor,gt.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const Ve=this._document.body;Ve.removeEventListener("pointerdown",this._pointerDownListener,!0),Ve.removeEventListener("click",this._clickListener,!0),Ve.removeEventListener("auxclick",this._clickListener,!0),Ve.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(Ve.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(Ve){Ve.addEventListener("pointerdown",this._pointerDownListener,!0),Ve.addEventListener("click",this._clickListener,!0),Ve.addEventListener("auxclick",this._clickListener,!0),Ve.addEventListener("contextmenu",this._clickListener,!0)}static{this.\u0275fac=function(gt){return new(gt||Xe)(de.KVO(C.qQ),de.KVO(se.OD),de.KVO(de.SKi,8))}}static{this.\u0275prov=de.jDH({token:Xe,factory:Xe.\u0275fac,providedIn:"root"})}}return Xe})(),$n=(()=>{class Xe{constructor(Ve,gt){this._platform=gt,this._document=Ve}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const Ve="cdk-overlay-container";if(this._platform.isBrowser||(0,se.v8)()){const wt=this._document.querySelectorAll(`.${Ve}[platform="server"], .${Ve}[platform="test"]`);for(let en=0;en<wt.length;en++)wt[en].remove()}const gt=this._document.createElement("div");gt.classList.add(Ve),(0,se.v8)()?gt.setAttribute("platform","test"):this._platform.isBrowser||gt.setAttribute("platform","server"),this._document.body.appendChild(gt),this._containerElement=gt}static{this.\u0275fac=function(gt){return new(gt||Xe)(de.KVO(C.qQ),de.KVO(se.OD))}}static{this.\u0275prov=de.jDH({token:Xe,factory:Xe.\u0275fac,providedIn:"root"})}}return Xe})();class ki{constructor(ye,Ve,gt,wt,en,hn,si,Hi,ti,bi=!1){this._portalOutlet=ye,this._host=Ve,this._pane=gt,this._config=wt,this._ngZone=en,this._keyboardDispatcher=hn,this._document=si,this._location=Hi,this._outsideClickDispatcher=ti,this._animationsDisabled=bi,this._backdropElement=null,this._backdropClick=new $e.B,this._attachments=new $e.B,this._detachments=new $e.B,this._locationChanges=ze.yU.EMPTY,this._backdropClickHandler=gi=>this._backdropClick.next(gi),this._backdropTransitionendHandler=gi=>{this._disposeBackdrop(gi.target)},this._keydownEvents=new $e.B,this._outsidePointerEvents=new $e.B,wt.scrollStrategy&&(this._scrollStrategy=wt.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=wt.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(ye){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const Ve=this._portalOutlet.attach(ye);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe((0,ve.s)(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof Ve?.onDestroy&&Ve.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),Ve}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const ye=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),ye}dispose(){const ye=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,ye&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(ye){ye!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=ye,this.hasAttached()&&(ye.attach(this),this.updatePosition()))}updateSize(ye){this._config={...this._config,...ye},this._updateElementSize()}setDirection(ye){this._config={...this._config,direction:ye},this._updateElementDirection()}addPanelClass(ye){this._pane&&this._toggleClasses(this._pane,ye,!0)}removePanelClass(ye){this._pane&&this._toggleClasses(this._pane,ye,!1)}getDirection(){const ye=this._config.direction;return ye?"string"==typeof ye?ye:ye.value:"ltr"}updateScrollStrategy(ye){ye!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=ye,this.hasAttached()&&(ye.attach(this),ye.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const ye=this._pane.style;ye.width=(0,a.a1)(this._config.width),ye.height=(0,a.a1)(this._config.height),ye.minWidth=(0,a.a1)(this._config.minWidth),ye.minHeight=(0,a.a1)(this._config.minHeight),ye.maxWidth=(0,a.a1)(this._config.maxWidth),ye.maxHeight=(0,a.a1)(this._config.maxHeight)}_togglePointerEvents(ye){this._pane.style.pointerEvents=ye?"":"none"}_attachBackdrop(){const ye="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(ye)})}):this._backdropElement.classList.add(ye)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const ye=this._backdropElement;if(ye){if(this._animationsDisabled)return void this._disposeBackdrop(ye);ye.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{ye.addEventListener("transitionend",this._backdropTransitionendHandler)}),ye.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(ye)},500))}}_toggleClasses(ye,Ve,gt){const wt=(0,a.FG)(Ve||[]).filter(en=>!!en);wt.length&&(gt?ye.classList.add(...wt):ye.classList.remove(...wt))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const ye=this._ngZone.onStable.pipe((0,ee.Q)((0,bt.h)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),ye.unsubscribe())})})}_disposeScrollStrategy(){const ye=this._scrollStrategy;ye&&(ye.disable(),ye.detach&&ye.detach())}_disposeBackdrop(ye){ye&&(ye.removeEventListener("click",this._backdropClickHandler),ye.removeEventListener("transitionend",this._backdropTransitionendHandler),ye.remove(),this._backdropElement===ye&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const Jt="cdk-overlay-connected-position-bounding-box",un=/([A-Za-z%]+)$/;class pn{get positions(){return this._preferredPositions}constructor(ye,Ve,gt,wt,en){this._viewportRuler=Ve,this._document=gt,this._platform=wt,this._overlayContainer=en,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new $e.B,this._resizeSubscription=ze.yU.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(ye)}attach(ye){this._validatePositions(),ye.hostElement.classList.add(Jt),this._overlayRef=ye,this._boundingBox=ye.hostElement,this._pane=ye.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const ye=this._originRect,Ve=this._overlayRect,gt=this._viewportRect,wt=this._containerRect,en=[];let hn;for(let si of this._preferredPositions){let Hi=this._getOriginPoint(ye,wt,si),ti=this._getOverlayPoint(Hi,Ve,si),bi=this._getOverlayFit(ti,Ve,gt,si);if(bi.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(si,Hi);this._canFitWithFlexibleDimensions(bi,ti,gt)?en.push({position:si,origin:Hi,overlayRect:Ve,boundingBoxRect:this._calculateBoundingBoxRect(Hi,si)}):(!hn||hn.overlayFit.visibleArea<bi.visibleArea)&&(hn={overlayFit:bi,overlayPoint:ti,originPoint:Hi,position:si,overlayRect:Ve})}if(en.length){let si=null,Hi=-1;for(const ti of en){const bi=ti.boundingBoxRect.width*ti.boundingBoxRect.height*(ti.position.weight||1);bi>Hi&&(Hi=bi,si=ti)}return this._isPushed=!1,void this._applyPosition(si.position,si.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(hn.position,hn.originPoint);this._applyPosition(hn.position,hn.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&dn(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Jt),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const ye=this._lastPosition;if(ye){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const Ve=this._getOriginPoint(this._originRect,this._containerRect,ye);this._applyPosition(ye,Ve)}else this.apply()}withScrollableContainers(ye){return this._scrollables=ye,this}withPositions(ye){return this._preferredPositions=ye,-1===ye.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(ye){return this._viewportMargin=ye,this}withFlexibleDimensions(ye=!0){return this._hasFlexibleDimensions=ye,this}withGrowAfterOpen(ye=!0){return this._growAfterOpen=ye,this}withPush(ye=!0){return this._canPush=ye,this}withLockedPosition(ye=!0){return this._positionLocked=ye,this}setOrigin(ye){return this._origin=ye,this}withDefaultOffsetX(ye){return this._offsetX=ye,this}withDefaultOffsetY(ye){return this._offsetY=ye,this}withTransformOriginOn(ye){return this._transformOriginSelector=ye,this}_getOriginPoint(ye,Ve,gt){let wt,en;if("center"==gt.originX)wt=ye.left+ye.width/2;else{const hn=this._isRtl()?ye.right:ye.left,si=this._isRtl()?ye.left:ye.right;wt="start"==gt.originX?hn:si}return Ve.left<0&&(wt-=Ve.left),en="center"==gt.originY?ye.top+ye.height/2:"top"==gt.originY?ye.top:ye.bottom,Ve.top<0&&(en-=Ve.top),{x:wt,y:en}}_getOverlayPoint(ye,Ve,gt){let wt,en;return wt="center"==gt.overlayX?-Ve.width/2:"start"===gt.overlayX?this._isRtl()?-Ve.width:0:this._isRtl()?0:-Ve.width,en="center"==gt.overlayY?-Ve.height/2:"top"==gt.overlayY?0:-Ve.height,{x:ye.x+wt,y:ye.y+en}}_getOverlayFit(ye,Ve,gt,wt){const en=Yn(Ve);let{x:hn,y:si}=ye,Hi=this._getOffset(wt,"x"),ti=this._getOffset(wt,"y");Hi&&(hn+=Hi),ti&&(si+=ti);let lt=0-si,Pe=si+en.height-gt.height,Se=this._subtractOverflows(en.width,0-hn,hn+en.width-gt.width),dt=this._subtractOverflows(en.height,lt,Pe),Oe=Se*dt;return{visibleArea:Oe,isCompletelyWithinViewport:en.width*en.height===Oe,fitsInViewportVertically:dt===en.height,fitsInViewportHorizontally:Se==en.width}}_canFitWithFlexibleDimensions(ye,Ve,gt){if(this._hasFlexibleDimensions){const wt=gt.bottom-Ve.y,en=gt.right-Ve.x,hn=jn(this._overlayRef.getConfig().minHeight),si=jn(this._overlayRef.getConfig().minWidth);return(ye.fitsInViewportVertically||null!=hn&&hn<=wt)&&(ye.fitsInViewportHorizontally||null!=si&&si<=en)}return!1}_pushOverlayOnScreen(ye,Ve,gt){if(this._previousPushAmount&&this._positionLocked)return{x:ye.x+this._previousPushAmount.x,y:ye.y+this._previousPushAmount.y};const wt=Yn(Ve),en=this._viewportRect,hn=Math.max(ye.x+wt.width-en.width,0),si=Math.max(ye.y+wt.height-en.height,0),Hi=Math.max(en.top-gt.top-ye.y,0),ti=Math.max(en.left-gt.left-ye.x,0);let bi=0,gi=0;return bi=wt.width<=en.width?ti||-hn:ye.x<this._viewportMargin?en.left-gt.left-ye.x:0,gi=wt.height<=en.height?Hi||-si:ye.y<this._viewportMargin?en.top-gt.top-ye.y:0,this._previousPushAmount={x:bi,y:gi},{x:ye.x+bi,y:ye.y+gi}}_applyPosition(ye,Ve){if(this._setTransformOrigin(ye),this._setOverlayElementStyles(Ve,ye),this._setBoundingBoxStyles(Ve,ye),ye.panelClass&&this._addPanelClasses(ye.panelClass),this._positionChanges.observers.length){const gt=this._getScrollVisibility();if(ye!==this._lastPosition||!this._lastScrollVisibility||!function zn(Xe,ye){return Xe===ye||Xe.isOriginClipped===ye.isOriginClipped&&Xe.isOriginOutsideView===ye.isOriginOutsideView&&Xe.isOverlayClipped===ye.isOverlayClipped&&Xe.isOverlayOutsideView===ye.isOverlayOutsideView}(this._lastScrollVisibility,gt)){const wt=new Rn(ye,gt);this._positionChanges.next(wt)}this._lastScrollVisibility=gt}this._lastPosition=ye,this._isInitialRender=!1}_setTransformOrigin(ye){if(!this._transformOriginSelector)return;const Ve=this._boundingBox.querySelectorAll(this._transformOriginSelector);let gt,wt=ye.overlayY;gt="center"===ye.overlayX?"center":this._isRtl()?"start"===ye.overlayX?"right":"left":"start"===ye.overlayX?"left":"right";for(let en=0;en<Ve.length;en++)Ve[en].style.transformOrigin=`${gt} ${wt}`}_calculateBoundingBoxRect(ye,Ve){const gt=this._viewportRect,wt=this._isRtl();let en,hn,si,bi,gi,lt;if("top"===Ve.overlayY)hn=ye.y,en=gt.height-hn+this._viewportMargin;else if("bottom"===Ve.overlayY)si=gt.height-ye.y+2*this._viewportMargin,en=gt.height-si+this._viewportMargin;else{const Pe=Math.min(gt.bottom-ye.y+gt.top,ye.y),Se=this._lastBoundingBoxSize.height;en=2*Pe,hn=ye.y-Pe,en>Se&&!this._isInitialRender&&!this._growAfterOpen&&(hn=ye.y-Se/2)}if("end"===Ve.overlayX&&!wt||"start"===Ve.overlayX&&wt)lt=gt.width-ye.x+2*this._viewportMargin,bi=ye.x-this._viewportMargin;else if("start"===Ve.overlayX&&!wt||"end"===Ve.overlayX&&wt)gi=ye.x,bi=gt.right-ye.x;else{const Pe=Math.min(gt.right-ye.x+gt.left,ye.x),Se=this._lastBoundingBoxSize.width;bi=2*Pe,gi=ye.x-Pe,bi>Se&&!this._isInitialRender&&!this._growAfterOpen&&(gi=ye.x-Se/2)}return{top:hn,left:gi,bottom:si,right:lt,width:bi,height:en}}_setBoundingBoxStyles(ye,Ve){const gt=this._calculateBoundingBoxRect(ye,Ve);!this._isInitialRender&&!this._growAfterOpen&&(gt.height=Math.min(gt.height,this._lastBoundingBoxSize.height),gt.width=Math.min(gt.width,this._lastBoundingBoxSize.width));const wt={};if(this._hasExactPosition())wt.top=wt.left="0",wt.bottom=wt.right=wt.maxHeight=wt.maxWidth="",wt.width=wt.height="100%";else{const en=this._overlayRef.getConfig().maxHeight,hn=this._overlayRef.getConfig().maxWidth;wt.height=(0,a.a1)(gt.height),wt.top=(0,a.a1)(gt.top),wt.bottom=(0,a.a1)(gt.bottom),wt.width=(0,a.a1)(gt.width),wt.left=(0,a.a1)(gt.left),wt.right=(0,a.a1)(gt.right),wt.alignItems="center"===Ve.overlayX?"center":"end"===Ve.overlayX?"flex-end":"flex-start",wt.justifyContent="center"===Ve.overlayY?"center":"bottom"===Ve.overlayY?"flex-end":"flex-start",en&&(wt.maxHeight=(0,a.a1)(en)),hn&&(wt.maxWidth=(0,a.a1)(hn))}this._lastBoundingBoxSize=gt,dn(this._boundingBox.style,wt)}_resetBoundingBoxStyles(){dn(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){dn(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(ye,Ve){const gt={},wt=this._hasExactPosition(),en=this._hasFlexibleDimensions,hn=this._overlayRef.getConfig();if(wt){const bi=this._viewportRuler.getViewportScrollPosition();dn(gt,this._getExactOverlayY(Ve,ye,bi)),dn(gt,this._getExactOverlayX(Ve,ye,bi))}else gt.position="static";let si="",Hi=this._getOffset(Ve,"x"),ti=this._getOffset(Ve,"y");Hi&&(si+=`translateX(${Hi}px) `),ti&&(si+=`translateY(${ti}px)`),gt.transform=si.trim(),hn.maxHeight&&(wt?gt.maxHeight=(0,a.a1)(hn.maxHeight):en&&(gt.maxHeight="")),hn.maxWidth&&(wt?gt.maxWidth=(0,a.a1)(hn.maxWidth):en&&(gt.maxWidth="")),dn(this._pane.style,gt)}_getExactOverlayY(ye,Ve,gt){let wt={top:"",bottom:""},en=this._getOverlayPoint(Ve,this._overlayRect,ye);return this._isPushed&&(en=this._pushOverlayOnScreen(en,this._overlayRect,gt)),"bottom"===ye.overlayY?wt.bottom=this._document.documentElement.clientHeight-(en.y+this._overlayRect.height)+"px":wt.top=(0,a.a1)(en.y),wt}_getExactOverlayX(ye,Ve,gt){let hn,wt={left:"",right:""},en=this._getOverlayPoint(Ve,this._overlayRect,ye);return this._isPushed&&(en=this._pushOverlayOnScreen(en,this._overlayRect,gt)),hn=this._isRtl()?"end"===ye.overlayX?"left":"right":"end"===ye.overlayX?"right":"left","right"===hn?wt.right=this._document.documentElement.clientWidth-(en.x+this._overlayRect.width)+"px":wt.left=(0,a.a1)(en.x),wt}_getScrollVisibility(){const ye=this._getOriginRect(),Ve=this._pane.getBoundingClientRect(),gt=this._scrollables.map(wt=>wt.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:zt(ye,gt),isOriginOutsideView:It(ye,gt),isOverlayClipped:zt(Ve,gt),isOverlayOutsideView:It(Ve,gt)}}_subtractOverflows(ye,...Ve){return Ve.reduce((gt,wt)=>gt-Math.max(wt,0),ye)}_getNarrowedViewportRect(){const ye=this._document.documentElement.clientWidth,Ve=this._document.documentElement.clientHeight,gt=this._viewportRuler.getViewportScrollPosition();return{top:gt.top+this._viewportMargin,left:gt.left+this._viewportMargin,right:gt.left+ye-this._viewportMargin,bottom:gt.top+Ve-this._viewportMargin,width:ye-2*this._viewportMargin,height:Ve-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(ye,Ve){return"x"===Ve?null==ye.offsetX?this._offsetX:ye.offsetX:null==ye.offsetY?this._offsetY:ye.offsetY}_validatePositions(){}_addPanelClasses(ye){this._pane&&(0,a.FG)(ye).forEach(Ve=>{""!==Ve&&-1===this._appliedPanelClasses.indexOf(Ve)&&(this._appliedPanelClasses.push(Ve),this._pane.classList.add(Ve))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(ye=>{this._pane.classList.remove(ye)}),this._appliedPanelClasses=[])}_getOriginRect(){const ye=this._origin;if(ye instanceof de.aKT)return ye.nativeElement.getBoundingClientRect();if(ye instanceof Element)return ye.getBoundingClientRect();const Ve=ye.width||0,gt=ye.height||0;return{top:ye.y,bottom:ye.y+gt,left:ye.x,right:ye.x+Ve,height:gt,width:Ve}}}function dn(Xe,ye){for(let Ve in ye)ye.hasOwnProperty(Ve)&&(Xe[Ve]=ye[Ve]);return Xe}function jn(Xe){if("number"!=typeof Xe&&null!=Xe){const[ye,Ve]=Xe.split(un);return Ve&&"px"!==Ve?null:parseFloat(ye)}return Xe||null}function Yn(Xe){return{top:Math.floor(Xe.top),right:Math.floor(Xe.right),bottom:Math.floor(Xe.bottom),left:Math.floor(Xe.left),width:Math.floor(Xe.width),height:Math.floor(Xe.height)}}const Gi="cdk-global-overlay-wrapper";class Si{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(ye){const Ve=ye.getConfig();this._overlayRef=ye,this._width&&!Ve.width&&ye.updateSize({width:this._width}),this._height&&!Ve.height&&ye.updateSize({height:this._height}),ye.hostElement.classList.add(Gi),this._isDisposed=!1}top(ye=""){return this._bottomOffset="",this._topOffset=ye,this._alignItems="flex-start",this}left(ye=""){return this._xOffset=ye,this._xPosition="left",this}bottom(ye=""){return this._topOffset="",this._bottomOffset=ye,this._alignItems="flex-end",this}right(ye=""){return this._xOffset=ye,this._xPosition="right",this}start(ye=""){return this._xOffset=ye,this._xPosition="start",this}end(ye=""){return this._xOffset=ye,this._xPosition="end",this}width(ye=""){return this._overlayRef?this._overlayRef.updateSize({width:ye}):this._width=ye,this}height(ye=""){return this._overlayRef?this._overlayRef.updateSize({height:ye}):this._height=ye,this}centerHorizontally(ye=""){return this.left(ye),this._xPosition="center",this}centerVertically(ye=""){return this.top(ye),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const ye=this._overlayRef.overlayElement.style,Ve=this._overlayRef.hostElement.style,gt=this._overlayRef.getConfig(),{width:wt,height:en,maxWidth:hn,maxHeight:si}=gt,Hi=!("100%"!==wt&&"100vw"!==wt||hn&&"100%"!==hn&&"100vw"!==hn),ti=!("100%"!==en&&"100vh"!==en||si&&"100%"!==si&&"100vh"!==si),bi=this._xPosition,gi=this._xOffset,lt="rtl"===this._overlayRef.getConfig().direction;let Pe="",Se="",dt="";Hi?dt="flex-start":"center"===bi?(dt="center",lt?Se=gi:Pe=gi):lt?"left"===bi||"end"===bi?(dt="flex-end",Pe=gi):("right"===bi||"start"===bi)&&(dt="flex-start",Se=gi):"left"===bi||"start"===bi?(dt="flex-start",Pe=gi):("right"===bi||"end"===bi)&&(dt="flex-end",Se=gi),ye.position=this._cssPosition,ye.marginLeft=Hi?"0":Pe,ye.marginTop=ti?"0":this._topOffset,ye.marginBottom=this._bottomOffset,ye.marginRight=Hi?"0":Se,Ve.justifyContent=dt,Ve.alignItems=ti?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const ye=this._overlayRef.overlayElement.style,Ve=this._overlayRef.hostElement,gt=Ve.style;Ve.classList.remove(Gi),gt.justifyContent=gt.alignItems=ye.marginTop=ye.marginBottom=ye.marginLeft=ye.marginRight=ye.position="",this._overlayRef=null,this._isDisposed=!0}}let Mi=(()=>{class Xe{constructor(Ve,gt,wt,en){this._viewportRuler=Ve,this._document=gt,this._platform=wt,this._overlayContainer=en}global(){return new Si}flexibleConnectedTo(Ve){return new pn(Ve,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static{this.\u0275fac=function(gt){return new(gt||Xe)(de.KVO(M.Xj),de.KVO(C.qQ),de.KVO(se.OD),de.KVO($n))}}static{this.\u0275prov=de.jDH({token:Xe,factory:Xe.\u0275fac,providedIn:"root"})}}return Xe})(),Br=0,ji=(()=>{class Xe{constructor(Ve,gt,wt,en,hn,si,Hi,ti,bi,gi,lt,Pe){this.scrollStrategies=Ve,this._overlayContainer=gt,this._componentFactoryResolver=wt,this._positionBuilder=en,this._keyboardDispatcher=hn,this._injector=si,this._ngZone=Hi,this._document=ti,this._directionality=bi,this._location=gi,this._outsideClickDispatcher=lt,this._animationsModuleType=Pe}create(Ve){const gt=this._createHostElement(),wt=this._createPaneElement(gt),en=this._createPortalOutlet(wt),hn=new Ze(Ve);return hn.direction=hn.direction||this._directionality.value,new ki(en,gt,wt,hn,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(Ve){const gt=this._document.createElement("div");return gt.id="cdk-overlay-"+Br++,gt.classList.add("cdk-overlay-pane"),Ve.appendChild(gt),gt}_createHostElement(){const Ve=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(Ve),Ve}_createPortalOutlet(Ve){return this._appRef||(this._appRef=this._injector.get(de.o8S)),new mt.aI(Ve,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static{this.\u0275fac=function(gt){return new(gt||Xe)(de.KVO(At),de.KVO($n),de.KVO(de.OM3),de.KVO(Mi),de.KVO(di),de.KVO(de.zZn),de.KVO(de.SKi),de.KVO(C.qQ),de.KVO(at.dS),de.KVO(C.aZ),de.KVO(Wn),de.KVO(de.bc$,8))}}static{this.\u0275prov=de.jDH({token:Xe,factory:Xe.\u0275fac,providedIn:"root"})}}return Xe})();const Ln=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],Bt=new de.nKC("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{const Xe=(0,de.WQX)(ji);return()=>Xe.scrollStrategies.reposition()}});let jt=(()=>{class Xe{constructor(Ve){this.elementRef=Ve}static{this.\u0275fac=function(gt){return new(gt||Xe)(de.rXU(de.aKT))}}static{this.\u0275dir=de.FsC({type:Xe,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0})}}return Xe})(),Dn=(()=>{class Xe{get offsetX(){return this._offsetX}set offsetX(Ve){this._offsetX=Ve,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(Ve){this._offsetY=Ve,this._position&&this._updatePositionStrategy(this._position)}get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(Ve){this._disposeOnNavigation=Ve}constructor(Ve,gt,wt,en,hn){this._overlay=Ve,this._dir=hn,this._backdropSubscription=ze.yU.EMPTY,this._attachSubscription=ze.yU.EMPTY,this._detachSubscription=ze.yU.EMPTY,this._positionSubscription=ze.yU.EMPTY,this._disposeOnNavigation=!1,this._ngZone=(0,de.WQX)(de.SKi),this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.hasBackdrop=!1,this.lockPosition=!1,this.flexibleDimensions=!1,this.growAfterOpen=!1,this.push=!1,this.backdropClick=new de.bkB,this.positionChange=new de.bkB,this.attach=new de.bkB,this.detach=new de.bkB,this.overlayKeydown=new de.bkB,this.overlayOutsideClick=new de.bkB,this._templatePortal=new mt.VA(gt,wt),this._scrollStrategyFactory=en,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(Ve){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),Ve.origin&&this.open&&this._position.apply()),Ve.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=Ln);const Ve=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=Ve.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=Ve.detachments().subscribe(()=>this.detach.emit()),Ve.keydownEvents().subscribe(gt=>{this.overlayKeydown.next(gt),gt.keyCode===xt._f&&!this.disableClose&&!(0,xt.rp)(gt)&&(gt.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(gt=>{const wt=this._getOriginElement(),en=(0,se.Fb)(gt);(!wt||wt!==en&&!wt.contains(en))&&this.overlayOutsideClick.next(gt)})}_buildConfig(){const Ve=this._position=this.positionStrategy||this._createPositionStrategy(),gt=new Ze({direction:this._dir,positionStrategy:Ve,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||0===this.width)&&(gt.width=this.width),(this.height||0===this.height)&&(gt.height=this.height),(this.minWidth||0===this.minWidth)&&(gt.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(gt.minHeight=this.minHeight),this.backdropClass&&(gt.backdropClass=this.backdropClass),this.panelClass&&(gt.panelClass=this.panelClass),gt}_updatePositionStrategy(Ve){const gt=this.positions.map(wt=>({originX:wt.originX,originY:wt.originY,overlayX:wt.overlayX,overlayY:wt.overlayY,offsetX:wt.offsetX||this.offsetX,offsetY:wt.offsetY||this.offsetY,panelClass:wt.panelClass||void 0}));return Ve.setOrigin(this._getOrigin()).withPositions(gt).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const Ve=this._overlay.position().flexibleConnectedTo(this._getOrigin());return this._updatePositionStrategy(Ve),Ve}_getOrigin(){return this.origin instanceof jt?this.origin.elementRef:this.origin}_getOriginElement(){return this.origin instanceof jt?this.origin.elementRef.nativeElement:this.origin instanceof de.aKT?this.origin.nativeElement:typeof Element<"u"&&this.origin instanceof Element?this.origin:null}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(Ve=>{this.backdropClick.emit(Ve)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(function ge(Xe,ye=!1){return(0,fe.N)((Ve,gt)=>{let wt=0;Ve.subscribe((0,he._)(gt,en=>{const hn=Xe(en,wt++);(hn||ye)&&gt.next(en),!hn&&gt.complete()}))})}(()=>this.positionChange.observers.length>0)).subscribe(Ve=>{this._ngZone.run(()=>this.positionChange.emit(Ve)),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}static{this.\u0275fac=function(gt){return new(gt||Xe)(de.rXU(ji),de.rXU(de.C4Q),de.rXU(de.c1b),de.rXU(Bt),de.rXU(at.dS,8))}}static{this.\u0275dir=de.FsC({type:Xe,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[de.Mj6.None,"cdkConnectedOverlayOrigin","origin"],positions:[de.Mj6.None,"cdkConnectedOverlayPositions","positions"],positionStrategy:[de.Mj6.None,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[de.Mj6.None,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[de.Mj6.None,"cdkConnectedOverlayOffsetY","offsetY"],width:[de.Mj6.None,"cdkConnectedOverlayWidth","width"],height:[de.Mj6.None,"cdkConnectedOverlayHeight","height"],minWidth:[de.Mj6.None,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[de.Mj6.None,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[de.Mj6.None,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[de.Mj6.None,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[de.Mj6.None,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[de.Mj6.None,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[de.Mj6.None,"cdkConnectedOverlayOpen","open"],disableClose:[de.Mj6.None,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[de.Mj6.None,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[de.Mj6.HasDecoratorInputTransform,"cdkConnectedOverlayHasBackdrop","hasBackdrop",de.L39],lockPosition:[de.Mj6.HasDecoratorInputTransform,"cdkConnectedOverlayLockPosition","lockPosition",de.L39],flexibleDimensions:[de.Mj6.HasDecoratorInputTransform,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",de.L39],growAfterOpen:[de.Mj6.HasDecoratorInputTransform,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",de.L39],push:[de.Mj6.HasDecoratorInputTransform,"cdkConnectedOverlayPush","push",de.L39],disposeOnNavigation:[de.Mj6.HasDecoratorInputTransform,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",de.L39]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[de.GFd,de.OA$]})}}return Xe})();const Sn={provide:Bt,deps:[ji],useFactory:function Ai(Xe){return()=>Xe.scrollStrategies.reposition()}};let On=(()=>{class Xe{static{this.\u0275fac=function(gt){return new(gt||Xe)}}static{this.\u0275mod=de.$C({type:Xe})}static{this.\u0275inj=de.G2t({providers:[ji,Sn],imports:[at.jI,mt.jc,M.E9,M.E9]})}}return Xe})()},6860:(Nn,Ct,R)=>{"use strict";R.d(Ct,{BD:()=>bt,BQ:()=>ge,CZ:()=>ze,Fb:()=>Ut,IK:()=>se,KT:()=>sn,OD:()=>a,r5:()=>at,v8:()=>et,vc:()=>Yt});var M=R(4438),C=R(177);let de;try{de=typeof Intl<"u"&&Intl.v8BreakIterator}catch{de=!1}let fe,a=(()=>{class It{constructor(je){this._platformId=je,this.isBrowser=this._platformId?(0,C.UE)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!de)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(At){return new(At||It)(M.KVO(M.Agw))}}static{this.\u0275prov=M.jDH({token:It,factory:It.\u0275fac,providedIn:"root"})}}return It})(),se=(()=>{class It{static{this.\u0275fac=function(At){return new(At||It)}}static{this.\u0275mod=M.$C({type:It})}static{this.\u0275inj=M.G2t({})}}return It})();function ge(It){return function he(){if(null==fe&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>fe=!0}))}finally{fe=fe||!1}return fe}()?It:!!It.capture}var at=function(It){return It[It.NORMAL=0]="NORMAL",It[It.NEGATED=1]="NEGATED",It[It.INVERTED=2]="INVERTED",It}(at||{});let mt,$e,xt;function ze(){if(null==$e){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return $e=!1,$e;if("scrollBehavior"in document.documentElement.style)$e=!0;else{const It=Element.prototype.scrollTo;$e=!!It&&!/\{\s*\[native code\]\s*\}/.test(It.toString())}}return $e}function bt(){if("object"!=typeof document||!document)return at.NORMAL;if(null==mt){const It=document.createElement("div"),zt=It.style;It.dir="rtl",zt.width="1px",zt.overflow="auto",zt.visibility="hidden",zt.pointerEvents="none",zt.position="absolute";const je=document.createElement("div"),At=je.style;At.width="2px",At.height="1px",It.appendChild(je),document.body.appendChild(It),mt=at.NORMAL,0===It.scrollLeft&&(It.scrollLeft=1,mt=0===It.scrollLeft?at.NEGATED:at.INVERTED),It.remove()}return mt}function sn(It){if(function Qt(){if(null==xt){const It=typeof document<"u"?document.head:null;xt=!(!It||!It.createShadowRoot&&!It.attachShadow)}return xt}()){const zt=It.getRootNode?It.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&zt instanceof ShadowRoot)return zt}return null}function Yt(){let It=typeof document<"u"&&document?document.activeElement:null;for(;It&&It.shadowRoot;){const zt=It.shadowRoot.activeElement;if(zt===It)break;It=zt}return It}function Ut(It){return It.composedPath?It.composedPath()[0]:It.target}function et(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}},6939:(Nn,Ct,R)=>{"use strict";R.d(Ct,{A8:()=>he,I3:()=>sn,VA:()=>ge,aI:()=>ze,jc:()=>Ut,lb:()=>mt});var M=R(4438),C=R(177);class fe{attach(zt){return this._attachedHost=zt,zt.attach(this)}detach(){let zt=this._attachedHost;null!=zt&&(this._attachedHost=null,zt.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(zt){this._attachedHost=zt}}class he extends fe{constructor(zt,je,At,Ze,St){super(),this.component=zt,this.viewContainerRef=je,this.injector=At,this.componentFactoryResolver=Ze,this.projectableNodes=St}}class ge extends fe{constructor(zt,je,At,Ze){super(),this.templateRef=zt,this.viewContainerRef=je,this.context=At,this.injector=Ze}get origin(){return this.templateRef.elementRef}attach(zt,je=this.context){return this.context=je,super.attach(zt)}detach(){return this.context=void 0,super.detach()}}class at extends fe{constructor(zt){super(),this.element=zt instanceof M.aKT?zt.nativeElement:zt}}class mt{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(zt){return zt instanceof he?(this._attachedPortal=zt,this.attachComponentPortal(zt)):zt instanceof ge?(this._attachedPortal=zt,this.attachTemplatePortal(zt)):this.attachDomPortal&&zt instanceof at?(this._attachedPortal=zt,this.attachDomPortal(zt)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(zt){this._disposeFn=zt}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class ze extends mt{constructor(zt,je,At,Ze,St){super(),this.outletElement=zt,this._componentFactoryResolver=je,this._appRef=At,this._defaultInjector=Ze,this.attachDomPortal=wn=>{const Rn=wn.element,an=this._document.createComment("dom-portal");Rn.parentNode.insertBefore(an,Rn),this.outletElement.appendChild(Rn),this._attachedPortal=wn,super.setDisposeFn(()=>{an.parentNode&&an.parentNode.replaceChild(Rn,an)})},this._document=St}attachComponentPortal(zt){const At=(zt.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(zt.component);let Ze;return zt.viewContainerRef?(Ze=zt.viewContainerRef.createComponent(At,zt.viewContainerRef.length,zt.injector||zt.viewContainerRef.injector,zt.projectableNodes||void 0),this.setDisposeFn(()=>Ze.destroy())):(Ze=At.create(zt.injector||this._defaultInjector||M.zZn.NULL),this._appRef.attachView(Ze.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(Ze.hostView),Ze.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(Ze)),this._attachedPortal=zt,Ze}attachTemplatePortal(zt){let je=zt.viewContainerRef,At=je.createEmbeddedView(zt.templateRef,zt.context,{injector:zt.injector});return At.rootNodes.forEach(Ze=>this.outletElement.appendChild(Ze)),At.detectChanges(),this.setDisposeFn(()=>{let Ze=je.indexOf(At);-1!==Ze&&je.remove(Ze)}),this._attachedPortal=zt,At}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(zt){return zt.hostView.rootNodes[0]}}let sn=(()=>{class It extends mt{constructor(je,At,Ze){super(),this._componentFactoryResolver=je,this._viewContainerRef=At,this._isInitialized=!1,this.attached=new M.bkB,this.attachDomPortal=St=>{const wn=St.element,Rn=this._document.createComment("dom-portal");St.setAttachedHost(this),wn.parentNode.insertBefore(Rn,wn),this._getRootNode().appendChild(wn),this._attachedPortal=St,super.setDisposeFn(()=>{Rn.parentNode&&Rn.parentNode.replaceChild(wn,Rn)})},this._document=Ze}get portal(){return this._attachedPortal}set portal(je){this.hasAttached()&&!je&&!this._isInitialized||(this.hasAttached()&&super.detach(),je&&super.attach(je),this._attachedPortal=je||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(je){je.setAttachedHost(this);const At=null!=je.viewContainerRef?je.viewContainerRef:this._viewContainerRef,St=(je.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(je.component),wn=At.createComponent(St,At.length,je.injector||At.injector,je.projectableNodes||void 0);return At!==this._viewContainerRef&&this._getRootNode().appendChild(wn.hostView.rootNodes[0]),super.setDisposeFn(()=>wn.destroy()),this._attachedPortal=je,this._attachedRef=wn,this.attached.emit(wn),wn}attachTemplatePortal(je){je.setAttachedHost(this);const At=this._viewContainerRef.createEmbeddedView(je.templateRef,je.context,{injector:je.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=je,this._attachedRef=At,this.attached.emit(At),At}_getRootNode(){const je=this._viewContainerRef.element.nativeElement;return je.nodeType===je.ELEMENT_NODE?je:je.parentNode}static{this.\u0275fac=function(At){return new(At||It)(M.rXU(M.OM3),M.rXU(M.c1b),M.rXU(C.qQ))}}static{this.\u0275dir=M.FsC({type:It,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[M.Mj6.None,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[M.Vt3]})}}return It})(),Ut=(()=>{class It{static{this.\u0275fac=function(At){return new(At||It)}}static{this.\u0275mod=M.$C({type:It})}static{this.\u0275inj=M.G2t({})}}return It})()},9327:(Nn,Ct,R)=>{"use strict";R.d(Ct,{yg:()=>pn,Gj:()=>Dn,E$:()=>Ln,d6:()=>Br,R:()=>jn,E9:()=>Ai,Xj:()=>qn});var M=R(4085),C=R(4438),de=R(1413),a=R(7673),se=R(1985),Fe=R(3726),ve=R(536),ee=R(5007),fe=R(8359),he=R(4402),ge=R(3294),at=R(3798),mt=R(5964),$e=R(6977),ze=R(9172),bt=R(9974),xt=R(4360),sn=R(5558),Yt=R(4668),Ut=R(6860),et=R(177),It=R(8203),zt=R(17);class je{}class Ze extends je{constructor(On){super(),this._data=On}connect(){return(0,he.A)(this._data)?this._data:(0,a.of)(this._data)}disconnect(){}}var St=function(Sn){return Sn[Sn.REPLACED=0]="REPLACED",Sn[Sn.INSERTED=1]="INSERTED",Sn[Sn.MOVED=2]="MOVED",Sn[Sn.REMOVED=3]="REMOVED",Sn}(St||{});const wn=new C.nKC("_ViewRepeater");class an{constructor(){this.viewCacheSize=20,this._viewCache=[]}applyChanges(On,st,Xe,ye,Ve){On.forEachOperation((gt,wt,en)=>{let hn,si;null==gt.previousIndex?(hn=this._insertView(()=>Xe(gt,wt,en),en,st,ye(gt)),si=hn?St.INSERTED:St.REPLACED):null==en?(this._detachAndCacheView(wt,st),si=St.REMOVED):(hn=this._moveView(wt,en,st,ye(gt)),si=St.MOVED),Ve&&Ve({context:hn?.context,operation:si,record:gt})})}detach(){for(const On of this._viewCache)On.destroy();this._viewCache=[]}_insertView(On,st,Xe,ye){const Ve=this._insertViewFromCache(st,Xe);if(Ve)return void(Ve.context.$implicit=ye);const gt=On();return Xe.createEmbeddedView(gt.templateRef,gt.context,gt.index)}_detachAndCacheView(On,st){const Xe=st.detach(On);this._maybeCacheView(Xe,st)}_moveView(On,st,Xe,ye){const Ve=Xe.get(On);return Xe.move(Ve,st),Ve.context.$implicit=ye,Ve}_maybeCacheView(On,st){if(this._viewCache.length<this.viewCacheSize)this._viewCache.push(On);else{const Xe=st.indexOf(On);-1===Xe?On.destroy():st.remove(Xe)}}_insertViewFromCache(On,st){const Xe=this._viewCache.pop();return Xe&&st.insert(Xe,On),Xe||null}}const Wn=["contentWrapper"],$n=["*"],ki=new C.nKC("VIRTUAL_SCROLL_STRATEGY");class Jt{constructor(On,st,Xe){this._scrolledIndexChange=new de.B,this.scrolledIndexChange=this._scrolledIndexChange.pipe((0,ge.F)()),this._viewport=null,this._itemSize=On,this._minBufferPx=st,this._maxBufferPx=Xe}attach(On){this._viewport=On,this._updateTotalContentSize(),this._updateRenderedRange()}detach(){this._scrolledIndexChange.complete(),this._viewport=null}updateItemAndBufferSize(On,st,Xe){this._itemSize=On,this._minBufferPx=st,this._maxBufferPx=Xe,this._updateTotalContentSize(),this._updateRenderedRange()}onContentScrolled(){this._updateRenderedRange()}onDataLengthChanged(){this._updateTotalContentSize(),this._updateRenderedRange()}onContentRendered(){}onRenderedOffsetChanged(){}scrollToIndex(On,st){this._viewport&&this._viewport.scrollToOffset(On*this._itemSize,st)}_updateTotalContentSize(){this._viewport&&this._viewport.setTotalContentSize(this._viewport.getDataLength()*this._itemSize)}_updateRenderedRange(){if(!this._viewport)return;const On=this._viewport.getRenderedRange(),st={start:On.start,end:On.end},Xe=this._viewport.getViewportSize(),ye=this._viewport.getDataLength();let Ve=this._viewport.measureScrollOffset(),gt=this._itemSize>0?Ve/this._itemSize:0;if(st.end>ye){const en=Math.ceil(Xe/this._itemSize),hn=Math.max(0,Math.min(gt,ye-en));gt!=hn&&(gt=hn,Ve=hn*this._itemSize,st.start=Math.floor(gt)),st.end=Math.max(0,Math.min(ye,st.start+en))}const wt=Ve-st.start*this._itemSize;if(wt<this._minBufferPx&&0!=st.start){const en=Math.ceil((this._maxBufferPx-wt)/this._itemSize);st.start=Math.max(0,st.start-en),st.end=Math.min(ye,Math.ceil(gt+(Xe+this._minBufferPx)/this._itemSize))}else{const en=st.end*this._itemSize-(Ve+Xe);if(en<this._minBufferPx&&st.end!=ye){const hn=Math.ceil((this._maxBufferPx-en)/this._itemSize);hn>0&&(st.end=Math.min(ye,st.end+hn),st.start=Math.max(0,Math.floor(gt-this._minBufferPx/this._itemSize)))}}this._viewport.setRenderedRange(st),this._viewport.setRenderedContentOffset(this._itemSize*st.start),this._scrolledIndexChange.next(Math.floor(gt))}}function un(Sn){return Sn._scrollStrategy}let pn=(()=>{class Sn{constructor(){this._itemSize=20,this._minBufferPx=100,this._maxBufferPx=200,this._scrollStrategy=new Jt(this.itemSize,this.minBufferPx,this.maxBufferPx)}get itemSize(){return this._itemSize}set itemSize(st){this._itemSize=(0,M.OE)(st)}get minBufferPx(){return this._minBufferPx}set minBufferPx(st){this._minBufferPx=(0,M.OE)(st)}get maxBufferPx(){return this._maxBufferPx}set maxBufferPx(st){this._maxBufferPx=(0,M.OE)(st)}ngOnChanges(){this._scrollStrategy.updateItemAndBufferSize(this.itemSize,this.minBufferPx,this.maxBufferPx)}static{this.\u0275fac=function(Xe){return new(Xe||Sn)}}static{this.\u0275dir=C.FsC({type:Sn,selectors:[["cdk-virtual-scroll-viewport","itemSize",""]],inputs:{itemSize:"itemSize",minBufferPx:"minBufferPx",maxBufferPx:"maxBufferPx"},standalone:!0,features:[C.Jv_([{provide:ki,useFactory:un,deps:[(0,C.Rfq)(()=>Sn)]}]),C.OA$]})}}return Sn})(),jn=(()=>{class Sn{constructor(st,Xe,ye){this._ngZone=st,this._platform=Xe,this._scrolled=new de.B,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=ye}register(st){this.scrollContainers.has(st)||this.scrollContainers.set(st,st.elementScrolled().subscribe(()=>this._scrolled.next(st)))}deregister(st){const Xe=this.scrollContainers.get(st);Xe&&(Xe.unsubscribe(),this.scrollContainers.delete(st))}scrolled(st=20){return this._platform.isBrowser?new se.c(Xe=>{this._globalSubscription||this._addGlobalListener();const ye=st>0?this._scrolled.pipe((0,at.Z)(st)).subscribe(Xe):this._scrolled.subscribe(Xe);return this._scrolledCount++,()=>{ye.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):(0,a.of)()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((st,Xe)=>this.deregister(Xe)),this._scrolled.complete()}ancestorScrolled(st,Xe){const ye=this.getAncestorScrollContainers(st);return this.scrolled(Xe).pipe((0,mt.p)(Ve=>!Ve||ye.indexOf(Ve)>-1))}getAncestorScrollContainers(st){const Xe=[];return this.scrollContainers.forEach((ye,Ve)=>{this._scrollableContainsElement(Ve,st)&&Xe.push(Ve)}),Xe}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(st,Xe){let ye=(0,M.i8)(Xe),Ve=st.getElementRef().nativeElement;do{if(ye==Ve)return!0}while(ye=ye.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{const st=this._getWindow();return(0,Fe.R)(st.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static{this.\u0275fac=function(Xe){return new(Xe||Sn)(C.KVO(C.SKi),C.KVO(Ut.OD),C.KVO(et.qQ,8))}}static{this.\u0275prov=C.jDH({token:Sn,factory:Sn.\u0275fac,providedIn:"root"})}}return Sn})(),Yn=(()=>{class Sn{constructor(st,Xe,ye,Ve){this.elementRef=st,this.scrollDispatcher=Xe,this.ngZone=ye,this.dir=Ve,this._destroyed=new de.B,this._elementScrolled=new se.c(gt=>this.ngZone.runOutsideAngular(()=>(0,Fe.R)(this.elementRef.nativeElement,"scroll").pipe((0,$e.Q)(this._destroyed)).subscribe(gt)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(st){const Xe=this.elementRef.nativeElement,ye=this.dir&&"rtl"==this.dir.value;null==st.left&&(st.left=ye?st.end:st.start),null==st.right&&(st.right=ye?st.start:st.end),null!=st.bottom&&(st.top=Xe.scrollHeight-Xe.clientHeight-st.bottom),ye&&(0,Ut.BD)()!=Ut.r5.NORMAL?(null!=st.left&&(st.right=Xe.scrollWidth-Xe.clientWidth-st.left),(0,Ut.BD)()==Ut.r5.INVERTED?st.left=st.right:(0,Ut.BD)()==Ut.r5.NEGATED&&(st.left=st.right?-st.right:st.right)):null!=st.right&&(st.left=Xe.scrollWidth-Xe.clientWidth-st.right),this._applyScrollToOptions(st)}_applyScrollToOptions(st){const Xe=this.elementRef.nativeElement;(0,Ut.CZ)()?Xe.scrollTo(st):(null!=st.top&&(Xe.scrollTop=st.top),null!=st.left&&(Xe.scrollLeft=st.left))}measureScrollOffset(st){const Xe="left",Ve=this.elementRef.nativeElement;if("top"==st)return Ve.scrollTop;if("bottom"==st)return Ve.scrollHeight-Ve.clientHeight-Ve.scrollTop;const gt=this.dir&&"rtl"==this.dir.value;return"start"==st?st=gt?"right":Xe:"end"==st&&(st=gt?Xe:"right"),gt&&(0,Ut.BD)()==Ut.r5.INVERTED?st==Xe?Ve.scrollWidth-Ve.clientWidth-Ve.scrollLeft:Ve.scrollLeft:gt&&(0,Ut.BD)()==Ut.r5.NEGATED?st==Xe?Ve.scrollLeft+Ve.scrollWidth-Ve.clientWidth:-Ve.scrollLeft:st==Xe?Ve.scrollLeft:Ve.scrollWidth-Ve.clientWidth-Ve.scrollLeft}static{this.\u0275fac=function(Xe){return new(Xe||Sn)(C.rXU(C.aKT),C.rXU(jn),C.rXU(C.SKi),C.rXU(It.dS,8))}}static{this.\u0275dir=C.FsC({type:Sn,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0})}}return Sn})(),qn=(()=>{class Sn{constructor(st,Xe,ye){this._platform=st,this._change=new de.B,this._changeListener=Ve=>{this._change.next(Ve)},this._document=ye,Xe.runOutsideAngular(()=>{if(st.isBrowser){const Ve=this._getWindow();Ve.addEventListener("resize",this._changeListener),Ve.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const st=this._getWindow();st.removeEventListener("resize",this._changeListener),st.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const st={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),st}getViewportRect(){const st=this.getViewportScrollPosition(),{width:Xe,height:ye}=this.getViewportSize();return{top:st.top,left:st.left,bottom:st.top+ye,right:st.left+Xe,height:ye,width:Xe}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const st=this._document,Xe=this._getWindow(),ye=st.documentElement,Ve=ye.getBoundingClientRect();return{top:-Ve.top||st.body.scrollTop||Xe.scrollY||ye.scrollTop||0,left:-Ve.left||st.body.scrollLeft||Xe.scrollX||ye.scrollLeft||0}}change(st=20){return st>0?this._change.pipe((0,at.Z)(st)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const st=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:st.innerWidth,height:st.innerHeight}:{width:0,height:0}}static{this.\u0275fac=function(Xe){return new(Xe||Sn)(C.KVO(Ut.OD),C.KVO(C.SKi),C.KVO(et.qQ,8))}}static{this.\u0275prov=C.jDH({token:Sn,factory:Sn.\u0275fac,providedIn:"root"})}}return Sn})();const ar=new C.nKC("VIRTUAL_SCROLLABLE");let Gi=(()=>{class Sn extends Yn{constructor(st,Xe,ye,Ve){super(st,Xe,ye,Ve)}measureViewportSize(st){const Xe=this.elementRef.nativeElement;return"horizontal"===st?Xe.clientWidth:Xe.clientHeight}static{this.\u0275fac=function(Xe){return new(Xe||Sn)(C.rXU(C.aKT),C.rXU(jn),C.rXU(C.SKi),C.rXU(It.dS,8))}}static{this.\u0275dir=C.FsC({type:Sn,features:[C.Vt3]})}}return Sn})();const Mi=typeof requestAnimationFrame<"u"?ve.X:ee.$;let Br=(()=>{class Sn extends Gi{get orientation(){return this._orientation}set orientation(st){this._orientation!==st&&(this._orientation=st,this._calculateSpacerSize())}constructor(st,Xe,ye,Ve,gt,wt,en,hn){super(st,wt,ye,gt),this.elementRef=st,this._changeDetectorRef=Xe,this._scrollStrategy=Ve,this.scrollable=hn,this._platform=(0,C.WQX)(Ut.OD),this._detachedSubject=new de.B,this._renderedRangeSubject=new de.B,this._orientation="vertical",this.appendOnly=!1,this.scrolledIndexChange=new se.c(si=>this._scrollStrategy.scrolledIndexChange.subscribe(Hi=>Promise.resolve().then(()=>this.ngZone.run(()=>si.next(Hi))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=fe.yU.EMPTY,this._viewportChanges=en.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe((0,ze.Z)(null),(0,at.Z)(0,Mi),(0,$e.Q)(this._destroyed)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(st){this.ngZone.runOutsideAngular(()=>{this._forOf=st,this._forOf.dataStream.pipe((0,$e.Q)(this._detachedSubject)).subscribe(Xe=>{const ye=Xe.length;ye!==this._dataLength&&(this._dataLength=ye,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(st){return this.getElementRef().nativeElement.getBoundingClientRect()[st]}setTotalContentSize(st){this._totalContentSize!==st&&(this._totalContentSize=st,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(st){(function Si(Sn,On){return Sn.start==On.start&&Sn.end==On.end})(this._renderedRange,st)||(this.appendOnly&&(st={start:0,end:Math.max(this._renderedRange.end,st.end)}),this._renderedRangeSubject.next(this._renderedRange=st),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(st,Xe="to-start"){st=this.appendOnly&&"to-start"===Xe?0:st;const Ve="horizontal"==this.orientation,gt=Ve?"X":"Y";let en=`translate${gt}(${Number((Ve&&this.dir&&"rtl"==this.dir.value?-1:1)*st)}px)`;this._renderedContentOffset=st,"to-end"===Xe&&(en+=` translate${gt}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=en&&(this._renderedContentTransform=en,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(st,Xe="auto"){const ye={behavior:Xe};"horizontal"===this.orientation?ye.start=st:ye.top=st,this.scrollable.scrollTo(ye)}scrollToIndex(st,Xe="auto"){this._scrollStrategy.scrollToIndex(st,Xe)}measureScrollOffset(st){let Xe;return Xe=this.scrollable==this?ye=>super.measureScrollOffset(ye):ye=>this.scrollable.measureScrollOffset(ye),Math.max(0,Xe(st??("horizontal"===this.orientation?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(st){let Xe;const gt="rtl"==this.dir?.value;Xe="start"==st?gt?"right":"left":"end"==st?gt?"left":"right":st||("horizontal"===this.orientation?"left":"top");const wt=this.scrollable.measureBoundingClientRectWithScrollOffset(Xe);return this.elementRef.nativeElement.getBoundingClientRect()[Xe]-wt}measureRenderedContentSize(){const st=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?st.offsetWidth:st.offsetHeight}measureRangeSize(st){return this._forOf?this._forOf.measureRangeSize(st,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(st){st&&this._runAfterChangeDetection.push(st),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const st=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const Xe of st)Xe()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}static{this.\u0275fac=function(Xe){return new(Xe||Sn)(C.rXU(C.aKT),C.rXU(C.gRc),C.rXU(C.SKi),C.rXU(ki,8),C.rXU(It.dS,8),C.rXU(jn),C.rXU(qn),C.rXU(ar,8))}}static{this.\u0275cmp=C.VBU({type:Sn,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(Xe,ye){if(1&Xe&&C.GBs(Wn,7),2&Xe){let Ve;C.mGM(Ve=C.lsd())&&(ye._contentWrapper=Ve.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(Xe,ye){2&Xe&&C.AVh("cdk-virtual-scroll-orientation-horizontal","horizontal"===ye.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==ye.orientation)},inputs:{orientation:"orientation",appendOnly:[C.Mj6.HasDecoratorInputTransform,"appendOnly","appendOnly",C.L39]},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[C.Jv_([{provide:Yn,useFactory:(st,Xe)=>st||Xe,deps:[[new C.Xx1,new C.y_5(ar)],Sn]}]),C.GFd,C.Vt3,C.aNF],ngContentSelectors:$n,decls:4,vars:4,consts:[["contentWrapper",""],[1,"cdk-virtual-scroll-content-wrapper"],[1,"cdk-virtual-scroll-spacer"]],template:function(Xe,ye){1&Xe&&(C.NAR(),C.j41(0,"div",1,0),C.SdG(2),C.k0s(),C.nrm(3,"div",2)),2&Xe&&(C.R7$(3),C.xc7("width",ye._totalContentWidth)("height",ye._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0})}}return Sn})();function ji(Sn,On,st){if(!st.getBoundingClientRect)return 0;const ye=st.getBoundingClientRect();return"horizontal"===Sn?"start"===On?ye.left:ye.right:"start"===On?ye.top:ye.bottom}let Ln=(()=>{class Sn{get cdkVirtualForOf(){return this._cdkVirtualForOf}set cdkVirtualForOf(st){this._cdkVirtualForOf=st,function At(Sn){return Sn&&"function"==typeof Sn.connect&&!(Sn instanceof zt.G)}(st)?this._dataSourceChanges.next(st):this._dataSourceChanges.next(new Ze((0,he.A)(st)?st:Array.from(st||[])))}get cdkVirtualForTrackBy(){return this._cdkVirtualForTrackBy}set cdkVirtualForTrackBy(st){this._needsUpdate=!0,this._cdkVirtualForTrackBy=st?(Xe,ye)=>st(Xe+(this._renderedRange?this._renderedRange.start:0),ye):void 0}set cdkVirtualForTemplate(st){st&&(this._needsUpdate=!0,this._template=st)}get cdkVirtualForTemplateCacheSize(){return this._viewRepeater.viewCacheSize}set cdkVirtualForTemplateCacheSize(st){this._viewRepeater.viewCacheSize=(0,M.OE)(st)}constructor(st,Xe,ye,Ve,gt,wt){this._viewContainerRef=st,this._template=Xe,this._differs=ye,this._viewRepeater=Ve,this._viewport=gt,this.viewChange=new de.B,this._dataSourceChanges=new de.B,this.dataStream=this._dataSourceChanges.pipe((0,ze.Z)(null),function Qt(){return(0,bt.N)((Sn,On)=>{let st,Xe=!1;Sn.subscribe((0,xt._)(On,ye=>{const Ve=st;st=ye,Xe&&On.next([Ve,ye]),Xe=!0}))})}(),(0,sn.n)(([en,hn])=>this._changeDataSource(en,hn)),(0,Yt.t)(1)),this._differ=null,this._needsUpdate=!1,this._destroyed=new de.B,this.dataStream.subscribe(en=>{this._data=en,this._onRenderedDataChange()}),this._viewport.renderedRangeStream.pipe((0,$e.Q)(this._destroyed)).subscribe(en=>{this._renderedRange=en,this.viewChange.observers.length&&wt.run(()=>this.viewChange.next(this._renderedRange)),this._onRenderedDataChange()}),this._viewport.attach(this)}measureRangeSize(st,Xe){if(st.start>=st.end)return 0;const ye=st.start-this._renderedRange.start,Ve=st.end-st.start;let gt,wt;for(let en=0;en<Ve;en++){const hn=this._viewContainerRef.get(en+ye);if(hn&&hn.rootNodes.length){gt=wt=hn.rootNodes[0];break}}for(let en=Ve-1;en>-1;en--){const hn=this._viewContainerRef.get(en+ye);if(hn&&hn.rootNodes.length){wt=hn.rootNodes[hn.rootNodes.length-1];break}}return gt&&wt?ji(Xe,"end",wt)-ji(Xe,"start",gt):0}ngDoCheck(){if(this._differ&&this._needsUpdate){const st=this._differ.diff(this._renderedItems);st?this._applyChanges(st):this._updateContext(),this._needsUpdate=!1}}ngOnDestroy(){this._viewport.detach(),this._dataSourceChanges.next(void 0),this._dataSourceChanges.complete(),this.viewChange.complete(),this._destroyed.next(),this._destroyed.complete(),this._viewRepeater.detach()}_onRenderedDataChange(){this._renderedRange&&(this._renderedItems=this._data.slice(this._renderedRange.start,this._renderedRange.end),this._differ||(this._differ=this._differs.find(this._renderedItems).create((st,Xe)=>this.cdkVirtualForTrackBy?this.cdkVirtualForTrackBy(st,Xe):Xe)),this._needsUpdate=!0)}_changeDataSource(st,Xe){return st&&st.disconnect(this),this._needsUpdate=!0,Xe?Xe.connect(this):(0,a.of)()}_updateContext(){const st=this._data.length;let Xe=this._viewContainerRef.length;for(;Xe--;){const ye=this._viewContainerRef.get(Xe);ye.context.index=this._renderedRange.start+Xe,ye.context.count=st,this._updateComputedContextProperties(ye.context),ye.detectChanges()}}_applyChanges(st){this._viewRepeater.applyChanges(st,this._viewContainerRef,(Ve,gt,wt)=>this._getEmbeddedViewArgs(Ve,wt),Ve=>Ve.item),st.forEachIdentityChange(Ve=>{this._viewContainerRef.get(Ve.currentIndex).context.$implicit=Ve.item});const Xe=this._data.length;let ye=this._viewContainerRef.length;for(;ye--;){const Ve=this._viewContainerRef.get(ye);Ve.context.index=this._renderedRange.start+ye,Ve.context.count=Xe,this._updateComputedContextProperties(Ve.context)}}_updateComputedContextProperties(st){st.first=0===st.index,st.last=st.index===st.count-1,st.even=st.index%2==0,st.odd=!st.even}_getEmbeddedViewArgs(st,Xe){return{templateRef:this._template,context:{$implicit:st.item,cdkVirtualForOf:this._cdkVirtualForOf,index:-1,count:-1,first:!1,last:!1,odd:!1,even:!1},index:Xe}}static{this.\u0275fac=function(Xe){return new(Xe||Sn)(C.rXU(C.c1b),C.rXU(C.C4Q),C.rXU(C._q3),C.rXU(wn),C.rXU(Br,4),C.rXU(C.SKi))}}static{this.\u0275dir=C.FsC({type:Sn,selectors:[["","cdkVirtualFor","","cdkVirtualForOf",""]],inputs:{cdkVirtualForOf:"cdkVirtualForOf",cdkVirtualForTrackBy:"cdkVirtualForTrackBy",cdkVirtualForTemplate:"cdkVirtualForTemplate",cdkVirtualForTemplateCacheSize:"cdkVirtualForTemplateCacheSize"},standalone:!0,features:[C.Jv_([{provide:wn,useClass:an}])]})}}return Sn})(),Dn=(()=>{class Sn{static{this.\u0275fac=function(Xe){return new(Xe||Sn)}}static{this.\u0275mod=C.$C({type:Sn})}static{this.\u0275inj=C.G2t({})}}return Sn})(),Ai=(()=>{class Sn{static{this.\u0275fac=function(Xe){return new(Xe||Sn)}}static{this.\u0275mod=C.$C({type:Sn})}static{this.\u0275inj=C.G2t({imports:[It.jI,Dn,It.jI,Dn]})}}return Sn})()},177:(Nn,Ct,R)=>{"use strict";R.d(Ct,{AJ:()=>_a,B3:()=>Zi,EO:()=>nt,Jj:()=>Dr,MD:()=>ls,N0:()=>br,QT:()=>de,QX:()=>Ms,Sm:()=>bt,Sq:()=>An,T3:()=>hr,UE:()=>Xo,VF:()=>se,Vy:()=>Ka,Xr:()=>qa,YU:()=>xn,Yq:()=>gt,ZD:()=>a,_b:()=>Ft,aZ:()=>Qt,bT:()=>Mr,cH:()=>Ze,e1:()=>Oi,fG:()=>nr,fw:()=>xt,hb:()=>$e,hj:()=>fe,oV:()=>At,qQ:()=>ve,rd:()=>Un,ux:()=>Ri,vh:()=>vs});var M=R(4438);let C=null;function de(){return C}function a(L){C??=L}class se{}const ve=new M.nKC("");let ee=(()=>{class L{historyGo(X){throw new Error("")}static{this.\u0275fac=function(pe){return new(pe||L)}}static{this.\u0275prov=M.jDH({token:L,factory:()=>(0,M.WQX)(he),providedIn:"platform"})}}return L})();const fe=new M.nKC("");let he=(()=>{class L extends ee{constructor(){super(),this._doc=(0,M.WQX)(ve),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return de().getBaseHref(this._doc)}onPopState(X){const pe=de().getGlobalEventTarget(this._doc,"window");return pe.addEventListener("popstate",X,!1),()=>pe.removeEventListener("popstate",X)}onHashChange(X){const pe=de().getGlobalEventTarget(this._doc,"window");return pe.addEventListener("hashchange",X,!1),()=>pe.removeEventListener("hashchange",X)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(X){this._location.pathname=X}pushState(X,pe,vt){this._history.pushState(X,pe,vt)}replaceState(X,pe,vt){this._history.replaceState(X,pe,vt)}forward(){this._history.forward()}back(){this._history.back()}historyGo(X=0){this._history.go(X)}getState(){return this._history.state}static{this.\u0275fac=function(pe){return new(pe||L)}}static{this.\u0275prov=M.jDH({token:L,factory:()=>new L,providedIn:"platform"})}}return L})();function ge(L,Me){if(0==L.length)return Me;if(0==Me.length)return L;let X=0;return L.endsWith("/")&&X++,Me.startsWith("/")&&X++,2==X?L+Me.substring(1):1==X?L+Me:L+"/"+Me}function at(L){const Me=L.match(/#|\?|$/),X=Me&&Me.index||L.length;return L.slice(0,X-("/"===L[X-1]?1:0))+L.slice(X)}function mt(L){return L&&"?"!==L[0]?"?"+L:L}let $e=(()=>{class L{historyGo(X){throw new Error("")}static{this.\u0275fac=function(pe){return new(pe||L)}}static{this.\u0275prov=M.jDH({token:L,factory:()=>(0,M.WQX)(bt),providedIn:"root"})}}return L})();const ze=new M.nKC("");let bt=(()=>{class L extends $e{constructor(X,pe){super(),this._platformLocation=X,this._removeListenerFns=[],this._baseHref=pe??this._platformLocation.getBaseHrefFromDOM()??(0,M.WQX)(ve).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(X){this._removeListenerFns.push(this._platformLocation.onPopState(X),this._platformLocation.onHashChange(X))}getBaseHref(){return this._baseHref}prepareExternalUrl(X){return ge(this._baseHref,X)}path(X=!1){const pe=this._platformLocation.pathname+mt(this._platformLocation.search),vt=this._platformLocation.hash;return vt&&X?`${pe}${vt}`:pe}pushState(X,pe,vt,Nt){const tn=this.prepareExternalUrl(vt+mt(Nt));this._platformLocation.pushState(X,pe,tn)}replaceState(X,pe,vt,Nt){const tn=this.prepareExternalUrl(vt+mt(Nt));this._platformLocation.replaceState(X,pe,tn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(X=0){this._platformLocation.historyGo?.(X)}static{this.\u0275fac=function(pe){return new(pe||L)(M.KVO(ee),M.KVO(ze,8))}}static{this.\u0275prov=M.jDH({token:L,factory:L.\u0275fac,providedIn:"root"})}}return L})(),xt=(()=>{class L extends $e{constructor(X,pe){super(),this._platformLocation=X,this._baseHref="",this._removeListenerFns=[],null!=pe&&(this._baseHref=pe)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(X){this._removeListenerFns.push(this._platformLocation.onPopState(X),this._platformLocation.onHashChange(X))}getBaseHref(){return this._baseHref}path(X=!1){const pe=this._platformLocation.hash??"#";return pe.length>0?pe.substring(1):pe}prepareExternalUrl(X){const pe=ge(this._baseHref,X);return pe.length>0?"#"+pe:pe}pushState(X,pe,vt,Nt){let tn=this.prepareExternalUrl(vt+mt(Nt));0==tn.length&&(tn=this._platformLocation.pathname),this._platformLocation.pushState(X,pe,tn)}replaceState(X,pe,vt,Nt){let tn=this.prepareExternalUrl(vt+mt(Nt));0==tn.length&&(tn=this._platformLocation.pathname),this._platformLocation.replaceState(X,pe,tn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(X=0){this._platformLocation.historyGo?.(X)}static{this.\u0275fac=function(pe){return new(pe||L)(M.KVO(ee),M.KVO(ze,8))}}static{this.\u0275prov=M.jDH({token:L,factory:L.\u0275fac})}}return L})(),Qt=(()=>{class L{constructor(X){this._subject=new M.bkB,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=X;const pe=this._locationStrategy.getBaseHref();this._basePath=function et(L){if(new RegExp("^(https?:)?//").test(L)){const[,X]=L.split(/\/\/[^\/]+/);return X}return L}(at(Ut(pe))),this._locationStrategy.onPopState(vt=>{this._subject.emit({url:this.path(!0),pop:!0,state:vt.state,type:vt.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(X=!1){return this.normalize(this._locationStrategy.path(X))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(X,pe=""){return this.path()==this.normalize(X+mt(pe))}normalize(X){return L.stripTrailingSlash(function Yt(L,Me){if(!L||!Me.startsWith(L))return Me;const X=Me.substring(L.length);return""===X||["/",";","?","#"].includes(X[0])?X:Me}(this._basePath,Ut(X)))}prepareExternalUrl(X){return X&&"/"!==X[0]&&(X="/"+X),this._locationStrategy.prepareExternalUrl(X)}go(X,pe="",vt=null){this._locationStrategy.pushState(vt,"",X,pe),this._notifyUrlChangeListeners(this.prepareExternalUrl(X+mt(pe)),vt)}replaceState(X,pe="",vt=null){this._locationStrategy.replaceState(vt,"",X,pe),this._notifyUrlChangeListeners(this.prepareExternalUrl(X+mt(pe)),vt)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(X=0){this._locationStrategy.historyGo?.(X)}onUrlChange(X){return this._urlChangeListeners.push(X),this._urlChangeSubscription??=this.subscribe(pe=>{this._notifyUrlChangeListeners(pe.url,pe.state)}),()=>{const pe=this._urlChangeListeners.indexOf(X);this._urlChangeListeners.splice(pe,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(X="",pe){this._urlChangeListeners.forEach(vt=>vt(X,pe))}subscribe(X,pe,vt){return this._subject.subscribe({next:X,error:pe,complete:vt})}static{this.normalizeQueryParams=mt}static{this.joinWithSlash=ge}static{this.stripTrailingSlash=at}static{this.\u0275fac=function(pe){return new(pe||L)(M.KVO($e))}}static{this.\u0275prov=M.jDH({token:L,factory:()=>function sn(){return new Qt((0,M.KVO)($e))}(),providedIn:"root"})}}return L})();function Ut(L){return L.replace(/\/index.html$/,"")}var zt=function(L){return L[L.Decimal=0]="Decimal",L[L.Percent=1]="Percent",L[L.Currency=2]="Currency",L[L.Scientific=3]="Scientific",L}(zt||{}),At=function(L){return L[L.Format=0]="Format",L[L.Standalone=1]="Standalone",L}(At||{}),Ze=function(L){return L[L.Narrow=0]="Narrow",L[L.Abbreviated=1]="Abbreviated",L[L.Wide=2]="Wide",L[L.Short=3]="Short",L}(Ze||{}),St=function(L){return L[L.Short=0]="Short",L[L.Medium=1]="Medium",L[L.Long=2]="Long",L[L.Full=3]="Full",L}(St||{});const wn={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function Un(L,Me,X){const pe=(0,M.H5H)(L),Nt=Ln([pe[M.KH2.DayPeriodsFormat],pe[M.KH2.DayPeriodsStandalone]],Me);return Ln(Nt,X)}function Jt(L,Me){return Ln((0,M.H5H)(L)[M.KH2.DateFormat],Me)}function un(L,Me){return Ln((0,M.H5H)(L)[M.KH2.TimeFormat],Me)}function pn(L,Me){return Ln((0,M.H5H)(L)[M.KH2.DateTimeFormat],Me)}function dn(L,Me){const X=(0,M.H5H)(L),pe=X[M.KH2.NumberSymbols][Me];if(typeof pe>"u"){if(Me===wn.CurrencyDecimal)return X[M.KH2.NumberSymbols][wn.Decimal];if(Me===wn.CurrencyGroup)return X[M.KH2.NumberSymbols][wn.Group]}return pe}function Si(L){if(!L[M.KH2.ExtraData])throw new Error(`Missing extra locale data for the locale "${L[M.KH2.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Ln(L,Me){for(let X=Me;X>-1;X--)if(typeof L[X]<"u")return L[X];throw new Error("Locale data API: locale data undefined")}function Bt(L){const[Me,X]=L.split(":");return{hours:+Me,minutes:+X}}const Sn=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,On={},st=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Xe=function(L){return L[L.Short=0]="Short",L[L.ShortGMT=1]="ShortGMT",L[L.Long=2]="Long",L[L.Extended=3]="Extended",L}(Xe||{}),ye=function(L){return L[L.FullYear=0]="FullYear",L[L.Month=1]="Month",L[L.Date=2]="Date",L[L.Hours=3]="Hours",L[L.Minutes=4]="Minutes",L[L.Seconds=5]="Seconds",L[L.FractionalSeconds=6]="FractionalSeconds",L[L.Day=7]="Day",L}(ye||{}),Ve=function(L){return L[L.DayPeriods=0]="DayPeriods",L[L.Days=1]="Days",L[L.Months=2]="Months",L[L.Eras=3]="Eras",L}(Ve||{});function gt(L,Me,X,pe){let vt=function Je(L){if(Cn(L))return L;if("number"==typeof L&&!isNaN(L))return new Date(L);if("string"==typeof L){if(L=L.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(L)){const[vt,Nt=1,tn=1]=L.split("-").map(Xt=>+Xt);return wt(vt,Nt-1,tn)}const X=parseFloat(L);if(!isNaN(L-X))return new Date(X);let pe;if(pe=L.match(Sn))return function Pt(L){const Me=new Date(0);let X=0,pe=0;const vt=L[8]?Me.setUTCFullYear:Me.setFullYear,Nt=L[8]?Me.setUTCHours:Me.setHours;L[9]&&(X=Number(L[9]+L[10]),pe=Number(L[9]+L[11])),vt.call(Me,Number(L[1]),Number(L[2])-1,Number(L[3]));const tn=Number(L[4]||0)-X,Xt=Number(L[5]||0)-pe,zi=Number(L[6]||0),pr=Math.floor(1e3*parseFloat("0."+(L[7]||0)));return Nt.call(Me,tn,Xt,zi,pr),Me}(pe)}const Me=new Date(L);if(!Cn(Me))throw new Error(`Unable to convert "${L}" into a date`);return Me}(L);Me=en(X,Me)||Me;let Xt,tn=[];for(;Me;){if(Xt=st.exec(Me),!Xt){tn.push(Me);break}{tn=tn.concat(Xt.slice(1));const Pr=tn.pop();if(!Pr)break;Me=Pr}}let zi=vt.getTimezoneOffset();pe&&(zi=Y(pe,zi),vt=function re(L,Me,X){const pe=X?-1:1,vt=L.getTimezoneOffset();return function _e(L,Me){return(L=new Date(L.getTime())).setMinutes(L.getMinutes()+Me),L}(L,pe*(Y(Me,vt)-vt))}(vt,pe,!0));let pr="";return tn.forEach(Pr=>{const er=function Z(L){if(ae[L])return ae[L];let Me;switch(L){case"G":case"GG":case"GGG":Me=gi(Ve.Eras,Ze.Abbreviated);break;case"GGGG":Me=gi(Ve.Eras,Ze.Wide);break;case"GGGGG":Me=gi(Ve.Eras,Ze.Narrow);break;case"y":Me=ti(ye.FullYear,1,0,!1,!0);break;case"yy":Me=ti(ye.FullYear,2,0,!0,!0);break;case"yyy":Me=ti(ye.FullYear,3,0,!1,!0);break;case"yyyy":Me=ti(ye.FullYear,4,0,!1,!0);break;case"Y":Me=Ie(1);break;case"YY":Me=Ie(2,!0);break;case"YYY":Me=Ie(3);break;case"YYYY":Me=Ie(4);break;case"M":case"L":Me=ti(ye.Month,1,1);break;case"MM":case"LL":Me=ti(ye.Month,2,1);break;case"MMM":Me=gi(Ve.Months,Ze.Abbreviated);break;case"MMMM":Me=gi(Ve.Months,Ze.Wide);break;case"MMMMM":Me=gi(Ve.Months,Ze.Narrow);break;case"LLL":Me=gi(Ve.Months,Ze.Abbreviated,At.Standalone);break;case"LLLL":Me=gi(Ve.Months,Ze.Wide,At.Standalone);break;case"LLLLL":Me=gi(Ve.Months,Ze.Narrow,At.Standalone);break;case"w":Me=Et(1);break;case"ww":Me=Et(2);break;case"W":Me=Et(1,!0);break;case"d":Me=ti(ye.Date,1);break;case"dd":Me=ti(ye.Date,2);break;case"c":case"cc":Me=ti(ye.Day,1);break;case"ccc":Me=gi(Ve.Days,Ze.Abbreviated,At.Standalone);break;case"cccc":Me=gi(Ve.Days,Ze.Wide,At.Standalone);break;case"ccccc":Me=gi(Ve.Days,Ze.Narrow,At.Standalone);break;case"cccccc":Me=gi(Ve.Days,Ze.Short,At.Standalone);break;case"E":case"EE":case"EEE":Me=gi(Ve.Days,Ze.Abbreviated);break;case"EEEE":Me=gi(Ve.Days,Ze.Wide);break;case"EEEEE":Me=gi(Ve.Days,Ze.Narrow);break;case"EEEEEE":Me=gi(Ve.Days,Ze.Short);break;case"a":case"aa":case"aaa":Me=gi(Ve.DayPeriods,Ze.Abbreviated);break;case"aaaa":Me=gi(Ve.DayPeriods,Ze.Wide);break;case"aaaaa":Me=gi(Ve.DayPeriods,Ze.Narrow);break;case"b":case"bb":case"bbb":Me=gi(Ve.DayPeriods,Ze.Abbreviated,At.Standalone,!0);break;case"bbbb":Me=gi(Ve.DayPeriods,Ze.Wide,At.Standalone,!0);break;case"bbbbb":Me=gi(Ve.DayPeriods,Ze.Narrow,At.Standalone,!0);break;case"B":case"BB":case"BBB":Me=gi(Ve.DayPeriods,Ze.Abbreviated,At.Format,!0);break;case"BBBB":Me=gi(Ve.DayPeriods,Ze.Wide,At.Format,!0);break;case"BBBBB":Me=gi(Ve.DayPeriods,Ze.Narrow,At.Format,!0);break;case"h":Me=ti(ye.Hours,1,-12);break;case"hh":Me=ti(ye.Hours,2,-12);break;case"H":Me=ti(ye.Hours,1);break;case"HH":Me=ti(ye.Hours,2);break;case"m":Me=ti(ye.Minutes,1);break;case"mm":Me=ti(ye.Minutes,2);break;case"s":Me=ti(ye.Seconds,1);break;case"ss":Me=ti(ye.Seconds,2);break;case"S":Me=ti(ye.FractionalSeconds,1);break;case"SS":Me=ti(ye.FractionalSeconds,2);break;case"SSS":Me=ti(ye.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":Me=Pe(Xe.Short);break;case"ZZZZZ":Me=Pe(Xe.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":Me=Pe(Xe.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":Me=Pe(Xe.Long);break;default:return null}return ae[L]=Me,Me}(Pr);pr+=er?er(vt,X,zi):"''"===Pr?"'":Pr.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),pr}function wt(L,Me,X){const pe=new Date(0);return pe.setFullYear(L,Me,X),pe.setHours(0,0,0),pe}function en(L,Me){const X=function an(L){return(0,M.H5H)(L)[M.KH2.LocaleId]}(L);if(On[X]??={},On[X][Me])return On[X][Me];let pe="";switch(Me){case"shortDate":pe=Jt(L,St.Short);break;case"mediumDate":pe=Jt(L,St.Medium);break;case"longDate":pe=Jt(L,St.Long);break;case"fullDate":pe=Jt(L,St.Full);break;case"shortTime":pe=un(L,St.Short);break;case"mediumTime":pe=un(L,St.Medium);break;case"longTime":pe=un(L,St.Long);break;case"fullTime":pe=un(L,St.Full);break;case"short":const vt=en(L,"shortTime"),Nt=en(L,"shortDate");pe=hn(pn(L,St.Short),[vt,Nt]);break;case"medium":const tn=en(L,"mediumTime"),Xt=en(L,"mediumDate");pe=hn(pn(L,St.Medium),[tn,Xt]);break;case"long":const zi=en(L,"longTime"),pr=en(L,"longDate");pe=hn(pn(L,St.Long),[zi,pr]);break;case"full":const Pr=en(L,"fullTime"),er=en(L,"fullDate");pe=hn(pn(L,St.Full),[Pr,er])}return pe&&(On[X][Me]=pe),pe}function hn(L,Me){return Me&&(L=L.replace(/\{([^}]+)}/g,function(X,pe){return null!=Me&&pe in Me?Me[pe]:X})),L}function si(L,Me,X="-",pe,vt){let Nt="";(L<0||vt&&L<=0)&&(vt?L=1-L:(L=-L,Nt=X));let tn=String(L);for(;tn.length<Me;)tn="0"+tn;return pe&&(tn=tn.slice(tn.length-Me)),Nt+tn}function ti(L,Me,X=0,pe=!1,vt=!1){return function(Nt,tn){let Xt=function bi(L,Me){switch(L){case ye.FullYear:return Me.getFullYear();case ye.Month:return Me.getMonth();case ye.Date:return Me.getDate();case ye.Hours:return Me.getHours();case ye.Minutes:return Me.getMinutes();case ye.Seconds:return Me.getSeconds();case ye.FractionalSeconds:return Me.getMilliseconds();case ye.Day:return Me.getDay();default:throw new Error(`Unknown DateType value "${L}".`)}}(L,Nt);if((X>0||Xt>-X)&&(Xt+=X),L===ye.Hours)0===Xt&&-12===X&&(Xt=12);else if(L===ye.FractionalSeconds)return function Hi(L,Me){return si(L,3).substring(0,Me)}(Xt,Me);const zi=dn(tn,wn.MinusSign);return si(Xt,Me,zi,pe,vt)}}function gi(L,Me,X=At.Format,pe=!1){return function(vt,Nt){return function lt(L,Me,X,pe,vt,Nt){switch(X){case Ve.Months:return function di(L,Me,X){const pe=(0,M.H5H)(L),Nt=Ln([pe[M.KH2.MonthsFormat],pe[M.KH2.MonthsStandalone]],Me);return Ln(Nt,X)}(Me,vt,pe)[L.getMonth()];case Ve.Days:return function nn(L,Me,X){const pe=(0,M.H5H)(L),Nt=Ln([pe[M.KH2.DaysFormat],pe[M.KH2.DaysStandalone]],Me);return Ln(Nt,X)}(Me,vt,pe)[L.getDay()];case Ve.DayPeriods:const tn=L.getHours(),Xt=L.getMinutes();if(Nt){const pr=function Mi(L){const Me=(0,M.H5H)(L);return Si(Me),(Me[M.KH2.ExtraData][2]||[]).map(pe=>"string"==typeof pe?Bt(pe):[Bt(pe[0]),Bt(pe[1])])}(Me),Pr=function Br(L,Me,X){const pe=(0,M.H5H)(L);Si(pe);const Nt=Ln([pe[M.KH2.ExtraData][0],pe[M.KH2.ExtraData][1]],Me)||[];return Ln(Nt,X)||[]}(Me,vt,pe),er=pr.findIndex(_r=>{if(Array.isArray(_r)){const[rr,qr]=_r,Fr=tn>=rr.hours&&Xt>=rr.minutes,In=tn<qr.hours||tn===qr.hours&&Xt<qr.minutes;if(rr.hours<qr.hours){if(Fr&&In)return!0}else if(Fr||In)return!0}else if(_r.hours===tn&&_r.minutes===Xt)return!0;return!1});if(-1!==er)return Pr[er]}return Un(Me,vt,pe)[tn<12?0:1];case Ve.Eras:return function Wn(L,Me){return Ln((0,M.H5H)(L)[M.KH2.Eras],Me)}(Me,pe)[L.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${X}`)}}(vt,Nt,L,Me,X,pe)}}function Pe(L){return function(Me,X,pe){const vt=-1*pe,Nt=dn(X,wn.MinusSign),tn=vt>0?Math.floor(vt/60):Math.ceil(vt/60);switch(L){case Xe.Short:return(vt>=0?"+":"")+si(tn,2,Nt)+si(Math.abs(vt%60),2,Nt);case Xe.ShortGMT:return"GMT"+(vt>=0?"+":"")+si(tn,1,Nt);case Xe.Long:return"GMT"+(vt>=0?"+":"")+si(tn,2,Nt)+":"+si(Math.abs(vt%60),2,Nt);case Xe.Extended:return 0===pe?"Z":(vt>=0?"+":"")+si(tn,2,Nt)+":"+si(Math.abs(vt%60),2,Nt);default:throw new Error(`Unknown zone width "${L}"`)}}}const Se=0,dt=4;function Ke(L){const Me=L.getDay(),X=0===Me?-3:dt-Me;return wt(L.getFullYear(),L.getMonth(),L.getDate()+X)}function Et(L,Me=!1){return function(X,pe){let vt;if(Me){const Nt=new Date(X.getFullYear(),X.getMonth(),1).getDay()-1,tn=X.getDate();vt=1+Math.floor((tn+Nt)/7)}else{const Nt=Ke(X),tn=function Oe(L){const Me=wt(L,Se,1).getDay();return wt(L,0,1+(Me<=dt?dt:dt+7)-Me)}(Nt.getFullYear()),Xt=Nt.getTime()-tn.getTime();vt=1+Math.round(Xt/6048e5)}return si(vt,L,dn(pe,wn.MinusSign))}}function Ie(L,Me=!1){return function(X,pe){return si(Ke(X).getFullYear(),L,dn(pe,wn.MinusSign),Me)}}const ae={};function Y(L,Me){L=L.replace(/:/g,"");const X=Date.parse("Jan 01, 1970 00:00:00 "+L)/6e4;return isNaN(X)?Me:X}function Cn(L){return L instanceof Date&&!isNaN(L.valueOf())}const ni=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function ci(L){const Me=parseInt(L);if(isNaN(Me))throw new Error("Invalid integer literal when parsing "+L);return Me}function nt(L,Me,X){return(0,M.XSP)(L,Me,X)}function Ft(L,Me){Me=encodeURIComponent(Me);for(const X of L.split(";")){const pe=X.indexOf("="),[vt,Nt]=-1==pe?[X,""]:[X.slice(0,pe),X.slice(pe+1)];if(vt.trim()===Me)return decodeURIComponent(Nt)}return null}const Tt=/\s+/,ht=[];let xn=(()=>{class L{constructor(X,pe){this._ngEl=X,this._renderer=pe,this.initialClasses=ht,this.stateMap=new Map}set klass(X){this.initialClasses=null!=X?X.trim().split(Tt):ht}set ngClass(X){this.rawClass="string"==typeof X?X.trim().split(Tt):X}ngDoCheck(){for(const pe of this.initialClasses)this._updateState(pe,!0);const X=this.rawClass;if(Array.isArray(X)||X instanceof Set)for(const pe of X)this._updateState(pe,!0);else if(null!=X)for(const pe of Object.keys(X))this._updateState(pe,!!X[pe]);this._applyStateDiff()}_updateState(X,pe){const vt=this.stateMap.get(X);void 0!==vt?(vt.enabled!==pe&&(vt.changed=!0,vt.enabled=pe),vt.touched=!0):this.stateMap.set(X,{enabled:pe,changed:!0,touched:!0})}_applyStateDiff(){for(const X of this.stateMap){const pe=X[0],vt=X[1];vt.changed?(this._toggleClass(pe,vt.enabled),vt.changed=!1):vt.touched||(vt.enabled&&this._toggleClass(pe,!1),this.stateMap.delete(pe)),vt.touched=!1}}_toggleClass(X,pe){(X=X.trim()).length>0&&X.split(Tt).forEach(vt=>{pe?this._renderer.addClass(this._ngEl.nativeElement,vt):this._renderer.removeClass(this._ngEl.nativeElement,vt)})}static{this.\u0275fac=function(pe){return new(pe||L)(M.rXU(M.aKT),M.rXU(M.sFG))}}static{this.\u0275dir=M.FsC({type:L,selectors:[["","ngClass",""]],inputs:{klass:[M.Mj6.None,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return L})();class Ei{constructor(Me,X,pe,vt){this.$implicit=Me,this.ngForOf=X,this.index=pe,this.count=vt}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let An=(()=>{class L{set ngForOf(X){this._ngForOf=X,this._ngForOfDirty=!0}set ngForTrackBy(X){this._trackByFn=X}get ngForTrackBy(){return this._trackByFn}constructor(X,pe,vt){this._viewContainer=X,this._template=pe,this._differs=vt,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(X){X&&(this._template=X)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const X=this._ngForOf;!this._differ&&X&&(this._differ=this._differs.find(X).create(this.ngForTrackBy))}if(this._differ){const X=this._differ.diff(this._ngForOf);X&&this._applyChanges(X)}}_applyChanges(X){const pe=this._viewContainer;X.forEachOperation((vt,Nt,tn)=>{if(null==vt.previousIndex)pe.createEmbeddedView(this._template,new Ei(vt.item,this._ngForOf,-1,-1),null===tn?void 0:tn);else if(null==tn)pe.remove(null===Nt?void 0:Nt);else if(null!==Nt){const Xt=pe.get(Nt);pe.move(Xt,tn),no(Xt,vt)}});for(let vt=0,Nt=pe.length;vt<Nt;vt++){const Xt=pe.get(vt).context;Xt.index=vt,Xt.count=Nt,Xt.ngForOf=this._ngForOf}X.forEachIdentityChange(vt=>{no(pe.get(vt.currentIndex),vt)})}static ngTemplateContextGuard(X,pe){return!0}static{this.\u0275fac=function(pe){return new(pe||L)(M.rXU(M.c1b),M.rXU(M.C4Q),M.rXU(M._q3))}}static{this.\u0275dir=M.FsC({type:L,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return L})();function no(L,Me){L.context.$implicit=Me.item}let Mr=(()=>{class L{constructor(X,pe){this._viewContainer=X,this._context=new ii,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=pe}set ngIf(X){this._context.$implicit=this._context.ngIf=X,this._updateView()}set ngIfThen(X){vi("ngIfThen",X),this._thenTemplateRef=X,this._thenViewRef=null,this._updateView()}set ngIfElse(X){vi("ngIfElse",X),this._elseTemplateRef=X,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(X,pe){return!0}static{this.\u0275fac=function(pe){return new(pe||L)(M.rXU(M.c1b),M.rXU(M.C4Q))}}static{this.\u0275dir=M.FsC({type:L,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return L})();class ii{constructor(){this.$implicit=null,this.ngIf=null}}function vi(L,Me){if(Me&&!Me.createEmbeddedView)throw new Error(`${L} must be a TemplateRef, but received '${(0,M.Tbb)(Me)}'.`)}class ur{constructor(Me,X){this._viewContainerRef=Me,this._templateRef=X,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(Me){Me&&!this._created?this.create():!Me&&this._created&&this.destroy()}}let Ri=(()=>{class L{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(X){this._ngSwitch=X,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(X){this._defaultViews.push(X)}_matchCase(X){const pe=X===this._ngSwitch;return this._lastCasesMatched||=pe,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),pe}_updateDefaultCases(X){if(this._defaultViews.length>0&&X!==this._defaultUsed){this._defaultUsed=X;for(const pe of this._defaultViews)pe.enforceState(X)}}static{this.\u0275fac=function(pe){return new(pe||L)}}static{this.\u0275dir=M.FsC({type:L,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0})}}return L})(),Oi=(()=>{class L{constructor(X,pe,vt){this.ngSwitch=vt,vt._addCase(),this._view=new ur(X,pe)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}static{this.\u0275fac=function(pe){return new(pe||L)(M.rXU(M.c1b),M.rXU(M.C4Q),M.rXU(Ri,9))}}static{this.\u0275dir=M.FsC({type:L,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0})}}return L})(),nr=(()=>{class L{constructor(X,pe,vt){vt._addDefault(new ur(X,pe))}static{this.\u0275fac=function(pe){return new(pe||L)(M.rXU(M.c1b),M.rXU(M.C4Q),M.rXU(Ri,9))}}static{this.\u0275dir=M.FsC({type:L,selectors:[["","ngSwitchDefault",""]],standalone:!0})}}return L})(),Zi=(()=>{class L{constructor(X,pe,vt){this._ngEl=X,this._differs=pe,this._renderer=vt,this._ngStyle=null,this._differ=null}set ngStyle(X){this._ngStyle=X,!this._differ&&X&&(this._differ=this._differs.find(X).create())}ngDoCheck(){if(this._differ){const X=this._differ.diff(this._ngStyle);X&&this._applyChanges(X)}}_setStyle(X,pe){const[vt,Nt]=X.split("."),tn=-1===vt.indexOf("-")?void 0:M.czy.DashCase;null!=pe?this._renderer.setStyle(this._ngEl.nativeElement,vt,Nt?`${pe}${Nt}`:pe,tn):this._renderer.removeStyle(this._ngEl.nativeElement,vt,tn)}_applyChanges(X){X.forEachRemovedItem(pe=>this._setStyle(pe.key,null)),X.forEachAddedItem(pe=>this._setStyle(pe.key,pe.currentValue)),X.forEachChangedItem(pe=>this._setStyle(pe.key,pe.currentValue))}static{this.\u0275fac=function(pe){return new(pe||L)(M.rXU(M.aKT),M.rXU(M.MKu),M.rXU(M.sFG))}}static{this.\u0275dir=M.FsC({type:L,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}}return L})(),hr=(()=>{class L{constructor(X){this._viewContainerRef=X,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(X){if(this._shouldRecreateView(X)){const pe=this._viewContainerRef;if(this._viewRef&&pe.remove(pe.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const vt=this._createContextForwardProxy();this._viewRef=pe.createEmbeddedView(this.ngTemplateOutlet,vt,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(X){return!!X.ngTemplateOutlet||!!X.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(X,pe,vt)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,pe,vt),get:(X,pe,vt)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,pe,vt)}})}static{this.\u0275fac=function(pe){return new(pe||L)(M.rXU(M.c1b))}}static{this.\u0275dir=M.FsC({type:L,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[M.OA$]})}}return L})();function jo(L,Me){return new M.wOt(2100,!1)}class gl{createSubscription(Me,X){return(0,M.O8t)(()=>Me.subscribe({next:X,error:pe=>{throw pe}}))}dispose(Me){(0,M.O8t)(()=>Me.unsubscribe())}}class ol{createSubscription(Me,X){return Me.then(X,pe=>{throw pe})}dispose(Me){}}const Ga=new ol,qs=new gl;let Dr=(()=>{class L{constructor(X){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=X}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(X){if(!this._obj){if(X)try{this.markForCheckOnValueUpdate=!1,this._subscribe(X)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return X!==this._obj?(this._dispose(),this.transform(X)):this._latestValue}_subscribe(X){this._obj=X,this._strategy=this._selectStrategy(X),this._subscription=this._strategy.createSubscription(X,pe=>this._updateLatestValue(X,pe))}_selectStrategy(X){if((0,M.jNT)(X))return Ga;if((0,M.zjR)(X))return qs;throw jo()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(X,pe){X===this._obj&&(this._latestValue=pe,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static{this.\u0275fac=function(pe){return new(pe||L)(M.rXU(M.gRc,16))}}static{this.\u0275pipe=M.EJ8({name:"async",type:L,pure:!1,standalone:!0})}}return L})();const gs=new M.nKC(""),$o=new M.nKC("");let vs=(()=>{class L{constructor(X,pe,vt){this.locale=X,this.defaultTimezone=pe,this.defaultOptions=vt}transform(X,pe,vt,Nt){if(null==X||""===X||X!=X)return null;try{return gt(X,pe??this.defaultOptions?.dateFormat??"mediumDate",Nt||this.locale,vt??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(tn){throw jo()}}static{this.\u0275fac=function(pe){return new(pe||L)(M.rXU(M.xe9,16),M.rXU(gs,24),M.rXU($o,24))}}static{this.\u0275pipe=M.EJ8({name:"date",type:L,pure:!0,standalone:!0})}}return L})(),Ms=(()=>{class L{constructor(X){this._locale=X}transform(X,pe,vt){if(!function zs(L){return!(null==L||""===L||L!=L)}(X))return null;vt||=this._locale;try{return function fr(L,Me,X){return function Or(L,Me,X,pe,vt,Nt,tn=!1){let Xt="",zi=!1;if(isFinite(L)){let pr=function oo(L){let pe,vt,Nt,tn,Xt,Me=Math.abs(L)+"",X=0;for((vt=Me.indexOf("."))>-1&&(Me=Me.replace(".","")),(Nt=Me.search(/e/i))>0?(vt<0&&(vt=Nt),vt+=+Me.slice(Nt+1),Me=Me.substring(0,Nt)):vt<0&&(vt=Me.length),Nt=0;"0"===Me.charAt(Nt);Nt++);if(Nt===(Xt=Me.length))pe=[0],vt=1;else{for(Xt--;"0"===Me.charAt(Xt);)Xt--;for(vt-=Nt,pe=[],tn=0;Nt<=Xt;Nt++,tn++)pe[tn]=Number(Me.charAt(Nt))}return vt>22&&(pe=pe.splice(0,21),X=vt-1,vt=1),{digits:pe,exponent:X,integerLen:vt}}(L);tn&&(pr=function fo(L){if(0===L.digits[0])return L;const Me=L.digits.length-L.integerLen;return L.exponent?L.exponent+=2:(0===Me?L.digits.push(0,0):1===Me&&L.digits.push(0),L.integerLen+=2),L}(pr));let Pr=Me.minInt,er=Me.minFrac,_r=Me.maxFrac;if(Nt){const Tr=Nt.match(ni);if(null===Tr)throw new Error(`${Nt} is not a valid digit info`);const uo=Tr[1],ho=Tr[3],ss=Tr[5];null!=uo&&(Pr=ci(uo)),null!=ho&&(er=ci(ho)),null!=ss?_r=ci(ss):null!=ho&&er>_r&&(_r=er)}!function so(L,Me,X){if(Me>X)throw new Error(`The minimum number of digits after fraction (${Me}) is higher than the maximum (${X}).`);let pe=L.digits,vt=pe.length-L.integerLen;const Nt=Math.min(Math.max(Me,vt),X);let tn=Nt+L.integerLen,Xt=pe[tn];if(tn>0){pe.splice(Math.max(L.integerLen,tn));for(let er=tn;er<pe.length;er++)pe[er]=0}else{vt=Math.max(0,vt),L.integerLen=1,pe.length=Math.max(1,tn=Nt+1),pe[0]=0;for(let er=1;er<tn;er++)pe[er]=0}if(Xt>=5)if(tn-1<0){for(let er=0;er>tn;er--)pe.unshift(0),L.integerLen++;pe.unshift(1),L.integerLen++}else pe[tn-1]++;for(;vt<Math.max(0,Nt);vt++)pe.push(0);let zi=0!==Nt;const pr=Me+L.integerLen,Pr=pe.reduceRight(function(er,_r,rr,qr){return qr[rr]=(_r+=er)<10?_r:_r-10,zi&&(0===qr[rr]&&rr>=pr?qr.pop():zi=!1),_r>=10?1:0},0);Pr&&(pe.unshift(Pr),L.integerLen++)}(pr,er,_r);let rr=pr.digits,qr=pr.integerLen;const Fr=pr.exponent;let In=[];for(zi=rr.every(Tr=>!Tr);qr<Pr;qr++)rr.unshift(0);for(;qr<0;qr++)rr.unshift(0);qr>0?In=rr.splice(qr,rr.length):(In=rr,rr=[0]);const Ni=[];for(rr.length>=Me.lgSize&&Ni.unshift(rr.splice(-Me.lgSize,rr.length).join(""));rr.length>Me.gSize;)Ni.unshift(rr.splice(-Me.gSize,rr.length).join(""));rr.length&&Ni.unshift(rr.join("")),Xt=Ni.join(dn(X,pe)),In.length&&(Xt+=dn(X,vt)+In.join("")),Fr&&(Xt+=dn(X,wn.Exponential)+"+"+Fr)}else Xt=dn(X,wn.Infinity);return Xt=L<0&&!zi?Me.negPre+Xt+Me.negSuf:Me.posPre+Xt+Me.posSuf,Xt}(L,function Xi(L,Me="-"){const X={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},pe=L.split(";"),vt=pe[0],Nt=pe[1],tn=-1!==vt.indexOf(".")?vt.split("."):[vt.substring(0,vt.lastIndexOf("0")+1),vt.substring(vt.lastIndexOf("0")+1)],Xt=tn[0],zi=tn[1]||"";X.posPre=Xt.substring(0,Xt.indexOf("#"));for(let Pr=0;Pr<zi.length;Pr++){const er=zi.charAt(Pr);"0"===er?X.minFrac=X.maxFrac=Pr+1:"#"===er?X.maxFrac=Pr+1:X.posSuf+=er}const pr=Xt.split(",");if(X.gSize=pr[1]?pr[1].length:0,X.lgSize=pr[2]||pr[1]?(pr[2]||pr[1]).length:0,Nt){const Pr=vt.length-X.posPre.length-X.posSuf.length,er=Nt.indexOf("#");X.negPre=Nt.substring(0,er).replace(/'/g,""),X.negSuf=Nt.slice(er+Pr).replace(/'/g,"")}else X.negPre=Me+X.posPre,X.negSuf=X.posSuf;return X}(function jn(L,Me){return(0,M.H5H)(L)[M.KH2.NumberFormats][Me]}(Me,zt.Decimal),dn(Me,wn.MinusSign)),Me,wn.Group,wn.Decimal,X)}(function xr(L){if("string"==typeof L&&!isNaN(Number(L)-parseFloat(L)))return Number(L);if("number"!=typeof L)throw new Error(`${L} is not a number`);return L}(X),vt,pe)}catch(Nt){throw jo()}}static{this.\u0275fac=function(pe){return new(pe||L)(M.rXU(M.xe9,16))}}static{this.\u0275pipe=M.EJ8({name:"number",type:L,pure:!0,standalone:!0})}}return L})();let ls=(()=>{class L{static{this.\u0275fac=function(pe){return new(pe||L)}}static{this.\u0275mod=M.$C({type:L})}static{this.\u0275inj=M.G2t({})}}return L})();const _a="browser",Xs="server";function Xo(L){return L===_a}function Ka(L){return L===Xs}let qa=(()=>{class L{static{this.\u0275prov=(0,M.jDH)({token:L,providedIn:"root",factory:()=>Xo((0,M.WQX)(M.Agw))?new Go((0,M.WQX)(ve),window):new ya})}}return L})();class Go{constructor(Me,X){this.document=Me,this.window=X,this.offset=()=>[0,0]}setOffset(Me){this.offset=Array.isArray(Me)?()=>Me:Me}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(Me){this.window.scrollTo(Me[0],Me[1])}scrollToAnchor(Me){const X=function rs(L,Me){const X=L.getElementById(Me)||L.getElementsByName(Me)[0];if(X)return X;if("function"==typeof L.createTreeWalker&&L.body&&"function"==typeof L.body.attachShadow){const pe=L.createTreeWalker(L.body,NodeFilter.SHOW_ELEMENT);let vt=pe.currentNode;for(;vt;){const Nt=vt.shadowRoot;if(Nt){const tn=Nt.getElementById(Me)||Nt.querySelector(`[name="${Me}"]`);if(tn)return tn}vt=pe.nextNode()}}return null}(this.document,Me);X&&(this.scrollToElement(X),X.focus())}setHistoryScrollRestoration(Me){this.window.history.scrollRestoration=Me}scrollToElement(Me){const X=Me.getBoundingClientRect(),pe=X.left+this.window.pageXOffset,vt=X.top+this.window.pageYOffset,Nt=this.offset();this.window.scrollTo(pe-Nt[0],vt-Nt[1])}}class ya{setOffset(Me){}getScrollPosition(){return[0,0]}scrollToPosition(Me){}scrollToAnchor(Me){}setHistoryScrollRestoration(Me){}}class br{}},1626:(Nn,Ct,R)=>{"use strict";R.d(Ct,{JV:()=>mt,Qq:()=>Jt,a7:()=>Mi,hv:()=>an,q1:()=>Jr}),R(467);var C=R(4438),de=R(7673),a=R(1985),se=R(6648),Fe=R(274),ve=R(5964),ee=R(6354),fe=R(980),he=R(5558),ge=R(177);class at{}class mt{}class $e{constructor(Ft){this.normalizedNames=new Map,this.lazyUpdate=null,Ft?"string"==typeof Ft?this.lazyInit=()=>{this.headers=new Map,Ft.split("\n").forEach(Tt=>{const ht=Tt.indexOf(":");if(ht>0){const xn=Tt.slice(0,ht),Xn=xn.toLowerCase(),Zn=Tt.slice(ht+1).trim();this.maybeSetNormalizedName(xn,Xn),this.headers.has(Xn)?this.headers.get(Xn).push(Zn):this.headers.set(Xn,[Zn])}})}:typeof Headers<"u"&&Ft instanceof Headers?(this.headers=new Map,Ft.forEach((Tt,ht)=>{this.setHeaderEntries(ht,Tt)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(Ft).forEach(([Tt,ht])=>{this.setHeaderEntries(Tt,ht)})}:this.headers=new Map}has(Ft){return this.init(),this.headers.has(Ft.toLowerCase())}get(Ft){this.init();const Tt=this.headers.get(Ft.toLowerCase());return Tt&&Tt.length>0?Tt[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(Ft){return this.init(),this.headers.get(Ft.toLowerCase())||null}append(Ft,Tt){return this.clone({name:Ft,value:Tt,op:"a"})}set(Ft,Tt){return this.clone({name:Ft,value:Tt,op:"s"})}delete(Ft,Tt){return this.clone({name:Ft,value:Tt,op:"d"})}maybeSetNormalizedName(Ft,Tt){this.normalizedNames.has(Tt)||this.normalizedNames.set(Tt,Ft)}init(){this.lazyInit&&(this.lazyInit instanceof $e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(Ft=>this.applyUpdate(Ft)),this.lazyUpdate=null))}copyFrom(Ft){Ft.init(),Array.from(Ft.headers.keys()).forEach(Tt=>{this.headers.set(Tt,Ft.headers.get(Tt)),this.normalizedNames.set(Tt,Ft.normalizedNames.get(Tt))})}clone(Ft){const Tt=new $e;return Tt.lazyInit=this.lazyInit&&this.lazyInit instanceof $e?this.lazyInit:this,Tt.lazyUpdate=(this.lazyUpdate||[]).concat([Ft]),Tt}applyUpdate(Ft){const Tt=Ft.name.toLowerCase();switch(Ft.op){case"a":case"s":let ht=Ft.value;if("string"==typeof ht&&(ht=[ht]),0===ht.length)return;this.maybeSetNormalizedName(Ft.name,Tt);const xn=("a"===Ft.op?this.headers.get(Tt):void 0)||[];xn.push(...ht),this.headers.set(Tt,xn);break;case"d":const Xn=Ft.value;if(Xn){let Zn=this.headers.get(Tt);if(!Zn)return;Zn=Zn.filter(Ei=>-1===Xn.indexOf(Ei)),0===Zn.length?(this.headers.delete(Tt),this.normalizedNames.delete(Tt)):this.headers.set(Tt,Zn)}else this.headers.delete(Tt),this.normalizedNames.delete(Tt)}}setHeaderEntries(Ft,Tt){const ht=(Array.isArray(Tt)?Tt:[Tt]).map(Xn=>Xn.toString()),xn=Ft.toLowerCase();this.headers.set(xn,ht),this.maybeSetNormalizedName(Ft,xn)}forEach(Ft){this.init(),Array.from(this.normalizedNames.keys()).forEach(Tt=>Ft(this.normalizedNames.get(Tt),this.headers.get(Tt)))}}class bt{encodeKey(Ft){return Yt(Ft)}encodeValue(Ft){return Yt(Ft)}decodeKey(Ft){return decodeURIComponent(Ft)}decodeValue(Ft){return decodeURIComponent(Ft)}}const Qt=/%(\d[a-f0-9])/gi,sn={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Yt(nt){return encodeURIComponent(nt).replace(Qt,(Ft,Tt)=>sn[Tt]??Ft)}function Ut(nt){return`${nt}`}class et{constructor(Ft={}){if(this.updates=null,this.cloneFrom=null,this.encoder=Ft.encoder||new bt,Ft.fromString){if(Ft.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function xt(nt,Ft){const Tt=new Map;return nt.length>0&&nt.replace(/^\?/,"").split("&").forEach(xn=>{const Xn=xn.indexOf("="),[Zn,Ei]=-1==Xn?[Ft.decodeKey(xn),""]:[Ft.decodeKey(xn.slice(0,Xn)),Ft.decodeValue(xn.slice(Xn+1))],An=Tt.get(Zn)||[];An.push(Ei),Tt.set(Zn,An)}),Tt}(Ft.fromString,this.encoder)}else Ft.fromObject?(this.map=new Map,Object.keys(Ft.fromObject).forEach(Tt=>{const ht=Ft.fromObject[Tt],xn=Array.isArray(ht)?ht.map(Ut):[Ut(ht)];this.map.set(Tt,xn)})):this.map=null}has(Ft){return this.init(),this.map.has(Ft)}get(Ft){this.init();const Tt=this.map.get(Ft);return Tt?Tt[0]:null}getAll(Ft){return this.init(),this.map.get(Ft)||null}keys(){return this.init(),Array.from(this.map.keys())}append(Ft,Tt){return this.clone({param:Ft,value:Tt,op:"a"})}appendAll(Ft){const Tt=[];return Object.keys(Ft).forEach(ht=>{const xn=Ft[ht];Array.isArray(xn)?xn.forEach(Xn=>{Tt.push({param:ht,value:Xn,op:"a"})}):Tt.push({param:ht,value:xn,op:"a"})}),this.clone(Tt)}set(Ft,Tt){return this.clone({param:Ft,value:Tt,op:"s"})}delete(Ft,Tt){return this.clone({param:Ft,value:Tt,op:"d"})}toString(){return this.init(),this.keys().map(Ft=>{const Tt=this.encoder.encodeKey(Ft);return this.map.get(Ft).map(ht=>Tt+"="+this.encoder.encodeValue(ht)).join("&")}).filter(Ft=>""!==Ft).join("&")}clone(Ft){const Tt=new et({encoder:this.encoder});return Tt.cloneFrom=this.cloneFrom||this,Tt.updates=(this.updates||[]).concat(Ft),Tt}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(Ft=>this.map.set(Ft,this.cloneFrom.map.get(Ft))),this.updates.forEach(Ft=>{switch(Ft.op){case"a":case"s":const Tt=("a"===Ft.op?this.map.get(Ft.param):void 0)||[];Tt.push(Ut(Ft.value)),this.map.set(Ft.param,Tt);break;case"d":if(void 0===Ft.value){this.map.delete(Ft.param);break}{let ht=this.map.get(Ft.param)||[];const xn=ht.indexOf(Ut(Ft.value));-1!==xn&&ht.splice(xn,1),ht.length>0?this.map.set(Ft.param,ht):this.map.delete(Ft.param)}}}),this.cloneFrom=this.updates=null)}}class zt{constructor(){this.map=new Map}set(Ft,Tt){return this.map.set(Ft,Tt),this}get(Ft){return this.map.has(Ft)||this.map.set(Ft,Ft.defaultValue()),this.map.get(Ft)}delete(Ft){return this.map.delete(Ft),this}has(Ft){return this.map.has(Ft)}keys(){return this.map.keys()}}function At(nt){return typeof ArrayBuffer<"u"&&nt instanceof ArrayBuffer}function Ze(nt){return typeof Blob<"u"&&nt instanceof Blob}function St(nt){return typeof FormData<"u"&&nt instanceof FormData}class Rn{constructor(Ft,Tt,ht,xn){let Xn;if(this.url=Tt,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=Ft.toUpperCase(),function je(nt){switch(nt){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||xn?(this.body=void 0!==ht?ht:null,Xn=xn):Xn=ht,Xn&&(this.reportProgress=!!Xn.reportProgress,this.withCredentials=!!Xn.withCredentials,Xn.responseType&&(this.responseType=Xn.responseType),Xn.headers&&(this.headers=Xn.headers),Xn.context&&(this.context=Xn.context),Xn.params&&(this.params=Xn.params),this.transferCache=Xn.transferCache),this.headers??=new $e,this.context??=new zt,this.params){const Zn=this.params.toString();if(0===Zn.length)this.urlWithParams=Tt;else{const Ei=Tt.indexOf("?");this.urlWithParams=Tt+(-1===Ei?"?":Ei<Tt.length-1?"&":"")+Zn}}else this.params=new et,this.urlWithParams=Tt}serializeBody(){return null===this.body?null:"string"==typeof this.body||At(this.body)||Ze(this.body)||St(this.body)||function wn(nt){return typeof URLSearchParams<"u"&&nt instanceof URLSearchParams}(this.body)?this.body:this.body instanceof et?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||St(this.body)?null:Ze(this.body)?this.body.type||null:At(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof et?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(Ft={}){const Tt=Ft.method||this.method,ht=Ft.url||this.url,xn=Ft.responseType||this.responseType,Xn=Ft.transferCache??this.transferCache,Zn=void 0!==Ft.body?Ft.body:this.body,Ei=Ft.withCredentials??this.withCredentials,An=Ft.reportProgress??this.reportProgress;let no=Ft.headers||this.headers,lr=Ft.params||this.params;const Mr=Ft.context??this.context;return void 0!==Ft.setHeaders&&(no=Object.keys(Ft.setHeaders).reduce((ii,vi)=>ii.set(vi,Ft.setHeaders[vi]),no)),Ft.setParams&&(lr=Object.keys(Ft.setParams).reduce((ii,vi)=>ii.set(vi,Ft.setParams[vi]),lr)),new Rn(Tt,ht,Zn,{params:lr,headers:no,context:Mr,reportProgress:An,responseType:xn,withCredentials:Ei,transferCache:Xn})}}var an=function(nt){return nt[nt.Sent=0]="Sent",nt[nt.UploadProgress=1]="UploadProgress",nt[nt.ResponseHeader=2]="ResponseHeader",nt[nt.DownloadProgress=3]="DownloadProgress",nt[nt.Response=4]="Response",nt[nt.User=5]="User",nt}(an||{});class Un{constructor(Ft,Tt=$n.Ok,ht="OK"){this.headers=Ft.headers||new $e,this.status=void 0!==Ft.status?Ft.status:Tt,this.statusText=Ft.statusText||ht,this.url=Ft.url||null,this.ok=this.status>=200&&this.status<300}}class nn extends Un{constructor(Ft={}){super(Ft),this.type=an.ResponseHeader}clone(Ft={}){return new nn({headers:Ft.headers||this.headers,status:void 0!==Ft.status?Ft.status:this.status,statusText:Ft.statusText||this.statusText,url:Ft.url||this.url||void 0})}}class di extends Un{constructor(Ft={}){super(Ft),this.type=an.Response,this.body=void 0!==Ft.body?Ft.body:null}clone(Ft={}){return new di({body:void 0!==Ft.body?Ft.body:this.body,headers:Ft.headers||this.headers,status:void 0!==Ft.status?Ft.status:this.status,statusText:Ft.statusText||this.statusText,url:Ft.url||this.url||void 0})}}class Wn extends Un{constructor(Ft){super(Ft,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${Ft.url||"(unknown url)"}`:`Http failure response for ${Ft.url||"(unknown url)"}: ${Ft.status} ${Ft.statusText}`,this.error=Ft.error||null}}var $n=function(nt){return nt[nt.Continue=100]="Continue",nt[nt.SwitchingProtocols=101]="SwitchingProtocols",nt[nt.Processing=102]="Processing",nt[nt.EarlyHints=103]="EarlyHints",nt[nt.Ok=200]="Ok",nt[nt.Created=201]="Created",nt[nt.Accepted=202]="Accepted",nt[nt.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",nt[nt.NoContent=204]="NoContent",nt[nt.ResetContent=205]="ResetContent",nt[nt.PartialContent=206]="PartialContent",nt[nt.MultiStatus=207]="MultiStatus",nt[nt.AlreadyReported=208]="AlreadyReported",nt[nt.ImUsed=226]="ImUsed",nt[nt.MultipleChoices=300]="MultipleChoices",nt[nt.MovedPermanently=301]="MovedPermanently",nt[nt.Found=302]="Found",nt[nt.SeeOther=303]="SeeOther",nt[nt.NotModified=304]="NotModified",nt[nt.UseProxy=305]="UseProxy",nt[nt.Unused=306]="Unused",nt[nt.TemporaryRedirect=307]="TemporaryRedirect",nt[nt.PermanentRedirect=308]="PermanentRedirect",nt[nt.BadRequest=400]="BadRequest",nt[nt.Unauthorized=401]="Unauthorized",nt[nt.PaymentRequired=402]="PaymentRequired",nt[nt.Forbidden=403]="Forbidden",nt[nt.NotFound=404]="NotFound",nt[nt.MethodNotAllowed=405]="MethodNotAllowed",nt[nt.NotAcceptable=406]="NotAcceptable",nt[nt.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",nt[nt.RequestTimeout=408]="RequestTimeout",nt[nt.Conflict=409]="Conflict",nt[nt.Gone=410]="Gone",nt[nt.LengthRequired=411]="LengthRequired",nt[nt.PreconditionFailed=412]="PreconditionFailed",nt[nt.PayloadTooLarge=413]="PayloadTooLarge",nt[nt.UriTooLong=414]="UriTooLong",nt[nt.UnsupportedMediaType=415]="UnsupportedMediaType",nt[nt.RangeNotSatisfiable=416]="RangeNotSatisfiable",nt[nt.ExpectationFailed=417]="ExpectationFailed",nt[nt.ImATeapot=418]="ImATeapot",nt[nt.MisdirectedRequest=421]="MisdirectedRequest",nt[nt.UnprocessableEntity=422]="UnprocessableEntity",nt[nt.Locked=423]="Locked",nt[nt.FailedDependency=424]="FailedDependency",nt[nt.TooEarly=425]="TooEarly",nt[nt.UpgradeRequired=426]="UpgradeRequired",nt[nt.PreconditionRequired=428]="PreconditionRequired",nt[nt.TooManyRequests=429]="TooManyRequests",nt[nt.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",nt[nt.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",nt[nt.InternalServerError=500]="InternalServerError",nt[nt.NotImplemented=501]="NotImplemented",nt[nt.BadGateway=502]="BadGateway",nt[nt.ServiceUnavailable=503]="ServiceUnavailable",nt[nt.GatewayTimeout=504]="GatewayTimeout",nt[nt.HttpVersionNotSupported=505]="HttpVersionNotSupported",nt[nt.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",nt[nt.InsufficientStorage=507]="InsufficientStorage",nt[nt.LoopDetected=508]="LoopDetected",nt[nt.NotExtended=510]="NotExtended",nt[nt.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",nt}($n||{});function ki(nt,Ft){return{body:Ft,headers:nt.headers,context:nt.context,observe:nt.observe,params:nt.params,reportProgress:nt.reportProgress,responseType:nt.responseType,withCredentials:nt.withCredentials,transferCache:nt.transferCache}}let Jt=(()=>{class nt{constructor(Tt){this.handler=Tt}request(Tt,ht,xn={}){let Xn;if(Tt instanceof Rn)Xn=Tt;else{let An,no;An=xn.headers instanceof $e?xn.headers:new $e(xn.headers),xn.params&&(no=xn.params instanceof et?xn.params:new et({fromObject:xn.params})),Xn=new Rn(Tt,ht,void 0!==xn.body?xn.body:null,{headers:An,context:xn.context,params:no,reportProgress:xn.reportProgress,responseType:xn.responseType||"json",withCredentials:xn.withCredentials,transferCache:xn.transferCache})}const Zn=(0,de.of)(Xn).pipe((0,Fe.H)(An=>this.handler.handle(An)));if(Tt instanceof Rn||"events"===xn.observe)return Zn;const Ei=Zn.pipe((0,ve.p)(An=>An instanceof di));switch(xn.observe||"body"){case"body":switch(Xn.responseType){case"arraybuffer":return Ei.pipe((0,ee.T)(An=>{if(null!==An.body&&!(An.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return An.body}));case"blob":return Ei.pipe((0,ee.T)(An=>{if(null!==An.body&&!(An.body instanceof Blob))throw new Error("Response is not a Blob.");return An.body}));case"text":return Ei.pipe((0,ee.T)(An=>{if(null!==An.body&&"string"!=typeof An.body)throw new Error("Response is not a string.");return An.body}));default:return Ei.pipe((0,ee.T)(An=>An.body))}case"response":return Ei;default:throw new Error(`Unreachable: unhandled observe type ${xn.observe}}`)}}delete(Tt,ht={}){return this.request("DELETE",Tt,ht)}get(Tt,ht={}){return this.request("GET",Tt,ht)}head(Tt,ht={}){return this.request("HEAD",Tt,ht)}jsonp(Tt,ht){return this.request("JSONP",Tt,{params:(new et).append(ht,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(Tt,ht={}){return this.request("OPTIONS",Tt,ht)}patch(Tt,ht,xn={}){return this.request("PATCH",Tt,ki(xn,ht))}post(Tt,ht,xn={}){return this.request("POST",Tt,ki(xn,ht))}put(Tt,ht,xn={}){return this.request("PUT",Tt,ki(xn,ht))}static{this.\u0275fac=function(ht){return new(ht||nt)(C.KVO(at))}}static{this.\u0275prov=C.jDH({token:nt,factory:nt.\u0275fac})}}return nt})();function ar(nt,Ft){return Ft(nt)}function Gi(nt,Ft){return(Tt,ht)=>Ft.intercept(Tt,{handle:xn=>nt(xn,ht)})}const Mi=new C.nKC(""),Br=new C.nKC(""),ji=new C.nKC(""),Ln=new C.nKC("");function Bt(){let nt=null;return(Ft,Tt)=>{null===nt&&(nt=((0,C.WQX)(Mi,{optional:!0})??[]).reduceRight(Gi,ar));const ht=(0,C.WQX)(C.TgB),xn=ht.add();return nt(Ft,Tt).pipe((0,fe.j)(()=>ht.remove(xn)))}}let Ai=(()=>{class nt extends at{constructor(Tt,ht){super(),this.backend=Tt,this.injector=ht,this.chain=null,this.pendingTasks=(0,C.WQX)(C.TgB);const xn=(0,C.WQX)(Ln,{optional:!0});this.backend=xn??Tt}handle(Tt){if(null===this.chain){const xn=Array.from(new Set([...this.injector.get(Br),...this.injector.get(ji,[])]));this.chain=xn.reduceRight((Xn,Zn)=>function Si(nt,Ft,Tt){return(ht,xn)=>(0,C.N4e)(Tt,()=>Ft(ht,Xn=>nt(Xn,xn)))}(Xn,Zn,this.injector),ar)}const ht=this.pendingTasks.add();return this.chain(Tt,xn=>this.backend.handle(xn)).pipe((0,fe.j)(()=>this.pendingTasks.remove(ht)))}static{this.\u0275fac=function(ht){return new(ht||nt)(C.KVO(mt),C.KVO(C.uvJ))}}static{this.\u0275prov=C.jDH({token:nt,factory:nt.\u0275fac})}}return nt})();const Hi=/^\)\]\}',?\n/;let bi=(()=>{class nt{constructor(Tt){this.xhrFactory=Tt}handle(Tt){if("JSONP"===Tt.method)throw new C.wOt(-2800,!1);const ht=this.xhrFactory;return(ht.\u0275loadImpl?(0,se.H)(ht.\u0275loadImpl()):(0,de.of)(null)).pipe((0,he.n)(()=>new a.c(Xn=>{const Zn=ht.build();if(Zn.open(Tt.method,Tt.urlWithParams),Tt.withCredentials&&(Zn.withCredentials=!0),Tt.headers.forEach((ur,Ri)=>Zn.setRequestHeader(ur,Ri.join(","))),Tt.headers.has("Accept")||Zn.setRequestHeader("Accept","application/json, text/plain, */*"),!Tt.headers.has("Content-Type")){const ur=Tt.detectContentTypeHeader();null!==ur&&Zn.setRequestHeader("Content-Type",ur)}if(Tt.responseType){const ur=Tt.responseType.toLowerCase();Zn.responseType="json"!==ur?ur:"text"}const Ei=Tt.serializeBody();let An=null;const no=()=>{if(null!==An)return An;const ur=Zn.statusText||"OK",Ri=new $e(Zn.getAllResponseHeaders()),Oi=function ti(nt){return"responseURL"in nt&&nt.responseURL?nt.responseURL:/^X-Request-URL:/m.test(nt.getAllResponseHeaders())?nt.getResponseHeader("X-Request-URL"):null}(Zn)||Tt.url;return An=new nn({headers:Ri,status:Zn.status,statusText:ur,url:Oi}),An},lr=()=>{let{headers:ur,status:Ri,statusText:Oi,url:nr}=no(),mr=null;Ri!==$n.NoContent&&(mr=typeof Zn.response>"u"?Zn.responseText:Zn.response),0===Ri&&(Ri=mr?$n.Ok:0);let io=Ri>=200&&Ri<300;if("json"===Tt.responseType&&"string"==typeof mr){const yo=mr;mr=mr.replace(Hi,"");try{mr=""!==mr?JSON.parse(mr):null}catch(Ji){mr=yo,io&&(io=!1,mr={error:Ji,text:mr})}}io?(Xn.next(new di({body:mr,headers:ur,status:Ri,statusText:Oi,url:nr||void 0})),Xn.complete()):Xn.error(new Wn({error:mr,headers:ur,status:Ri,statusText:Oi,url:nr||void 0}))},Mr=ur=>{const{url:Ri}=no(),Oi=new Wn({error:ur,status:Zn.status||0,statusText:Zn.statusText||"Unknown Error",url:Ri||void 0});Xn.error(Oi)};let ii=!1;const vi=ur=>{ii||(Xn.next(no()),ii=!0);let Ri={type:an.DownloadProgress,loaded:ur.loaded};ur.lengthComputable&&(Ri.total=ur.total),"text"===Tt.responseType&&Zn.responseText&&(Ri.partialText=Zn.responseText),Xn.next(Ri)},Ui=ur=>{let Ri={type:an.UploadProgress,loaded:ur.loaded};ur.lengthComputable&&(Ri.total=ur.total),Xn.next(Ri)};return Zn.addEventListener("load",lr),Zn.addEventListener("error",Mr),Zn.addEventListener("timeout",Mr),Zn.addEventListener("abort",Mr),Tt.reportProgress&&(Zn.addEventListener("progress",vi),null!==Ei&&Zn.upload&&Zn.upload.addEventListener("progress",Ui)),Zn.send(Ei),Xn.next({type:an.Sent}),()=>{Zn.removeEventListener("error",Mr),Zn.removeEventListener("abort",Mr),Zn.removeEventListener("load",lr),Zn.removeEventListener("timeout",Mr),Tt.reportProgress&&(Zn.removeEventListener("progress",vi),null!==Ei&&Zn.upload&&Zn.upload.removeEventListener("progress",Ui)),Zn.readyState!==Zn.DONE&&Zn.abort()}})))}static{this.\u0275fac=function(ht){return new(ht||nt)(C.KVO(ge.N0))}}static{this.\u0275prov=C.jDH({token:nt,factory:nt.\u0275fac})}}return nt})();const gi=new C.nKC(""),Pe=new C.nKC("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),dt=new C.nKC("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Oe{}let Ke=(()=>{class nt{constructor(Tt,ht,xn){this.doc=Tt,this.platform=ht,this.cookieName=xn,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const Tt=this.doc.cookie||"";return Tt!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,ge._b)(Tt,this.cookieName),this.lastCookieString=Tt),this.lastToken}static{this.\u0275fac=function(ht){return new(ht||nt)(C.KVO(ge.qQ),C.KVO(C.Agw),C.KVO(Pe))}}static{this.\u0275prov=C.jDH({token:nt,factory:nt.\u0275fac})}}return nt})();function Et(nt,Ft){const Tt=nt.url.toLowerCase();if(!(0,C.WQX)(gi)||"GET"===nt.method||"HEAD"===nt.method||Tt.startsWith("http://")||Tt.startsWith("https://"))return Ft(nt);const ht=(0,C.WQX)(Oe).getToken(),xn=(0,C.WQX)(dt);return null!=ht&&!nt.headers.has(xn)&&(nt=nt.clone({headers:nt.headers.set(xn,ht)})),Ft(nt)}var ae=function(nt){return nt[nt.Interceptors=0]="Interceptors",nt[nt.LegacyInterceptors=1]="LegacyInterceptors",nt[nt.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",nt[nt.NoXsrfProtection=3]="NoXsrfProtection",nt[nt.JsonpSupport=4]="JsonpSupport",nt[nt.RequestsMadeViaParent=5]="RequestsMadeViaParent",nt[nt.Fetch=6]="Fetch",nt}(ae||{});function Z(nt,Ft){return{\u0275kind:nt,\u0275providers:Ft}}function Y(...nt){const Ft=[Jt,bi,Ai,{provide:at,useExisting:Ai},{provide:mt,useExisting:bi},{provide:Br,useValue:Et,multi:!0},{provide:gi,useValue:!0},{provide:Oe,useClass:Ke}];for(const Tt of nt)Ft.push(...Tt.\u0275providers);return(0,C.EmA)(Ft)}const re=new C.nKC("");let Jr=(()=>{class nt{static{this.\u0275fac=function(ht){return new(ht||nt)}}static{this.\u0275mod=C.$C({type:nt})}static{this.\u0275inj=C.G2t({providers:[Y(Z(ae.LegacyInterceptors,[{provide:re,useFactory:Bt},{provide:Br,useExisting:re,multi:!0}]))]})}}return nt})()},4438:(Nn,Ct,R)=>{"use strict";R.d(Ct,{bc$:()=>Zf,iLQ:()=>s6,sZ2:()=>g2,hnV:()=>rv,Hbi:()=>Pb,o8S:()=>z1,BIS:()=>Xf,gRc:()=>vv,Ql9:()=>tb,OM3:()=>Ou,Ocv:()=>cb,Z63:()=>Bs,aKT:()=>Wu,uvJ:()=>cr,zcH:()=>ac,bkB:()=>Ea,y_5:()=>Is,$GK:()=>Dr,nKC:()=>xn,zZn:()=>hl,_q3:()=>p6,MKu:()=>m6,xe9:()=>E8,Co$:()=>nm,Vns:()=>Wd,SKi:()=>Vs,Xx1:()=>Xo,Agw:()=>ed,PLl:()=>v2,rOR:()=>qh,sFG:()=>U3,_9s:()=>df,czy:()=>Su,WPN:()=>Tu,kdw:()=>Qs,C4Q:()=>T,NYb:()=>Kx,giA:()=>nv,ZUJ:()=>Nt,RxE:()=>K5,c1b:()=>Z3,gXe:()=>ko,mal:()=>y6,L39:()=>ow,a0P:()=>dw,Ol2:()=>cp,w6W:()=>j7,oH4:()=>fv,QZP:()=>Kv,SmG:()=>mb,Rfq:()=>Et,WQX:()=>xr,naY:()=>pb,Hps:()=>rp,QuC:()=>cs,EmA:()=>za,fpN:()=>Ab,HJs:()=>fw,N4e:()=>Ce,O8t:()=>aw,An2:()=>Ra,H3F:()=>q5,H8p:()=>mn,KH2:()=>B4,TgB:()=>b4,wOt:()=>jt,WHO:()=>ev,e01:()=>tv,lNU:()=>Bt,h9k:()=>G0,$MX:()=>fd,ZF7:()=>Ju,Kcf:()=>c1,e5t:()=>D2,UyX:()=>u1,cWb:()=>Mh,osQ:()=>T2,H5H:()=>Rp,Zy3:()=>Dn,mq5:()=>sg,JZv:()=>ti,LfX:()=>ci,plB:()=>D1,jNT:()=>r6,zjR:()=>iv,XSP:()=>Cy,TL$:()=>Zu,Tbb:()=>Se,rcV:()=>Ec,Vt3:()=>sp,Mj6:()=>Wo,GFd:()=>tm,OA$:()=>U,Jv_:()=>v5,aNF:()=>_5,R7$:()=>Y2,BMQ:()=>xp,HbH:()=>jm,ZvI:()=>Zm,STu:()=>Xm,ee0:()=>Qm,AVh:()=>Dp,wni:()=>Wg,VBU:()=>Pa,FsC:()=>el,jDH:()=>Xi,G2t:()=>oo,$C:()=>Ha,EJ8:()=>nc,rXU:()=>zh,nrm:()=>kp,eu8:()=>Op,bVm:()=>d8,qex:()=>h8,k0s:()=>u8,j41:()=>c8,RV6:()=>rg,xGo:()=>Dl,KVO:()=>vo,kS0:()=>V1,QTQ:()=>l4,bIt:()=>Vp,lsd:()=>Zg,qSk:()=>e0,XpG:()=>Rg,nI1:()=>S5,bMT:()=>A5,i5U:()=>P5,brH:()=>z5,SdG:()=>Ng,NAR:()=>Fg,Y8G:()=>Ep,FS9:()=>Up,Mz_:()=>v8,lJ4:()=>x5,eq3:()=>b5,l_i:()=>w5,mGM:()=>qg,sdS:()=>Xg,Njj:()=>gc,tSv:()=>J0,eBV:()=>nu,npT:()=>K0,B4B:()=>Du,n$t:()=>A2,Aen:()=>Lu,xc7:()=>Tp,Kam:()=>Bp,zvX:()=>Lp,DNE:()=>w4,C5r:()=>I5,EFF:()=>a5,JRh:()=>jp,SpI:()=>_8,Lme:()=>Yp,LHq:()=>$p,DH7:()=>m5,mxI:()=>Wp,R50:()=>Gp,GBs:()=>Kg}),R(467);let de=null,a=!1,se=1;const Fe=Symbol("SIGNAL");function ve(t){const n=de;return de=t,n}const ge={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function $e(t){if((!zt(t)||t.dirty)&&(t.dirty||t.lastCleanEpoch!==se)){if(!t.producerMustRecompute(t)&&!Yt(t))return t.dirty=!1,void(t.lastCleanEpoch=se);t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=se}}function xt(t){t.dirty=!0,function ze(t){if(void 0===t.liveConsumerNode)return;const n=a;a=!0;try{for(const s of t.liveConsumerNode)s.dirty||xt(s)}finally{a=n}}(t),t.consumerMarkedDirty?.(t)}function Qt(t){return t&&(t.nextProducerIndex=0),ve(t)}function sn(t,n){if(ve(n),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(zt(t))for(let s=t.nextProducerIndex;s<t.producerNode.length;s++)It(t.producerNode[s],t.producerIndexOfThis[s]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function Yt(t){je(t);for(let n=0;n<t.producerNode.length;n++){const s=t.producerNode[n],c=t.producerLastReadVersion[n];if(c!==s.version||($e(s),c!==s.version))return!0}return!1}function Ut(t){if(je(t),zt(t))for(let n=0;n<t.producerNode.length;n++)It(t.producerNode[n],t.producerIndexOfThis[n]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function It(t,n){if(function At(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}(t),je(t),1===t.liveConsumerNode.length)for(let c=0;c<t.producerNode.length;c++)It(t.producerNode[c],t.producerIndexOfThis[c]);const s=t.liveConsumerNode.length-1;if(t.liveConsumerNode[n]=t.liveConsumerNode[s],t.liveConsumerIndexOfThis[n]=t.liveConsumerIndexOfThis[s],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,n<t.liveConsumerNode.length){const c=t.liveConsumerIndexOfThis[n],f=t.liveConsumerNode[n];je(f),f.producerIndexOfThis[c]=n}}function zt(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function je(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}let nn=null;const qn=()=>{},ar={...ge,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:t=>{null!==t.schedule&&t.schedule(t.ref)},hasRun:!1,cleanupFn:qn};var Si=R(1413),Mi=R(8359),Br=R(4412),ji=R(6354);const Bt="https://g.co/ng/security#xss";class jt extends Error{constructor(n,s){super(Dn(n,s)),this.code=n}}function Dn(t,n){return`NG0${Math.abs(t)}${n?": "+n:""}`}function ye(t){return{toString:t}.toString()}const gt="__parameters__";function si(t,n,s){return ye(()=>{const c=function hn(t){return function(...s){if(t){const c=t(...s);for(const f in c)this[f]=c[f]}}}(n);function f(..._){if(this instanceof f)return c.apply(this,_),this;const E=new f(..._);return A.annotation=E,A;function A(H,ce,Re){const ct=H.hasOwnProperty(gt)?H[gt]:Object.defineProperty(H,gt,{value:[]})[gt];for(;ct.length<=Re;)ct.push(null);return(ct[Re]=ct[Re]||[]).push(E),H}}return s&&(f.prototype=Object.create(s.prototype)),f.prototype.ngMetadataName=t,f.annotationCls=f,f})}const ti=globalThis;function lt(t){for(let n in t)if(t[n]===lt)return n;throw Error("Could not find renamed property on target object.")}function Pe(t,n){for(const s in n)n.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(t[s]=n[s])}function Se(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Se).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const s=n.indexOf("\n");return-1===s?n:n.substring(0,s)}function dt(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const Ke=lt({__forward_ref__:lt});function Et(t){return t.__forward_ref__=Et,t.toString=function(){return Se(this())},t}function Ie(t){return ae(t)?t():t}function ae(t){return"function"==typeof t&&t.hasOwnProperty(Ke)&&t.__forward_ref__===Et}function Xi(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function oo(t){return{providers:t.providers||[],imports:t.imports||[]}}function so(t){return mo(t,nt)||mo(t,Tt)}function ci(t){return null!==so(t)}function mo(t,n){return t.hasOwnProperty(n)?t[n]:null}function Uo(t){return t&&(t.hasOwnProperty(Ft)||t.hasOwnProperty(ht))?t[Ft]:null}const nt=lt({\u0275prov:lt}),Ft=lt({\u0275inj:lt}),Tt=lt({ngInjectableDef:lt}),ht=lt({ngInjectorDef:lt});class xn{constructor(n,s){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof s?this.__NG_ELEMENT_ID__=s:void 0!==s&&(this.\u0275prov=Xi({token:this,providedIn:s.providedIn||"root",factory:s.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function ur(t){return t&&!!t.\u0275providers}const Ri=lt({\u0275cmp:lt}),Oi=lt({\u0275dir:lt}),nr=lt({\u0275pipe:lt}),mr=lt({\u0275mod:lt}),io=lt({\u0275fac:lt}),yo=lt({__NG_ELEMENT_ID__:lt}),Ji=lt({__NG_ENV_ID__:lt});function Zi(t){return"string"==typeof t?t:null==t?"":String(t)}function qs(t,n){throw new jt(-201,!1)}var Dr=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(Dr||{});let Ps;function Yo(){return Ps}function Rr(t){const n=Ps;return Ps=t,n}function Zs(t,n,s){const c=so(t);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:s&Dr.Optional?null:void 0!==n?n:void qs()}const $o={},vs="__NG_DI_FLAG__",_s="ngTempTokenPath",ga=/\n/gm,Io="__source";let po;function Ms(t){const n=po;return po=t,n}function Cs(t,n=Dr.Default){if(void 0===po)throw new jt(-203,!1);return null===po?Zs(t,void 0,n):po.get(t,n&Dr.Optional?null:void 0,n)}function vo(t,n=Dr.Default){return(Yo()||Cs)(Ie(t),n)}function xr(t,n=Dr.Default){return vo(t,aa(n))}function aa(t){return typeof t>"u"||"number"==typeof t?t:(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function va(t){const n=[];for(let s=0;s<t.length;s++){const c=Ie(t[s]);if(Array.isArray(c)){if(0===c.length)throw new jt(900,!1);let f,_=Dr.Default;for(let E=0;E<c.length;E++){const A=c[E],H=_a(A);"number"==typeof H?-1===H?f=A.token:_|=H:f=A}n.push(vo(f,_))}else n.push(vo(c))}return n}function ls(t,n){return t[vs]=n,t.prototype[vs]=n,t}function _a(t){return t[vs]}const Is=ls(si("Inject",t=>({token:t})),-1),Xo=ls(si("Optional"),8),Qs=ls(si("SkipSelf"),4);function ca(t,n){return t.hasOwnProperty(io)?t[io]:null}function rs(t,n){t.forEach(s=>Array.isArray(s)?rs(s,n):n(s))}function ya(t,n,s){n>=t.length?t.push(s):t.splice(n,0,s)}function br(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function Lo(t,n,s){let c=ys(t,n);return c>=0?t[1|c]=s:(c=~c,function Ts(t,n,s,c){let f=t.length;if(f==n)t.push(s,c);else if(1===f)t.push(c,t[0]),t[0]=s;else{for(f--,t.push(t[f-1],t[f]);f>n;)t[f]=t[f-2],f--;t[n]=s,t[n+1]=c}}(t,c,n,s)),c}function ks(t,n){const s=ys(t,n);if(s>=0)return t[1|s]}function ys(t,n){return function hs(t,n,s){let c=0,f=t.length>>s;for(;f!==c;){const _=c+(f-c>>1),E=t[_<<s];if(n===E)return _<<s;E>n?f=_:c=_+1}return~(f<<s)}(t,n,1)}const Eo={},Kr=[],Bs=new xn(""),Aa=new xn("",-1),Va=new xn("");class Js{get(n,s=$o){if(s===$o){const c=new Error(`NullInjectorError: No provider for ${Se(n)}!`);throw c.name="NullInjectorError",c}return s}}var Hs=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Hs||{}),ko=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(ko||{}),Wo=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Wo||{});function Hr(t,n,s){let c=t.length;for(;;){const f=t.indexOf(n,s);if(-1===f)return f;if(0===f||t.charCodeAt(f-1)<=32){const _=n.length;if(f+_===c||t.charCodeAt(f+_)<=32)return f}s=f+1}}function Ba(t,n,s){let c=0;for(;c<s.length;){const f=s[c];if("number"==typeof f){if(0!==f)break;c++;const _=s[c++],E=s[c++],A=s[c++];t.setAttribute(n,E,A,_)}else{const _=f,E=s[++c];ua(_)?t.setProperty(n,_,E):t.setAttribute(n,_,E),c++}}return c}function Qa(t){return 3===t||4===t||6===t}function ua(t){return 64===t.charCodeAt(0)}function xa(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let s=-1;for(let c=0;c<n.length;c++){const f=n[c];"number"==typeof f?s=f:0===s||Os(t,s,f,null,-1===s||2===s?n[++c]:null)}}return t}function Os(t,n,s,c,f){let _=0,E=t.length;if(-1===n)E=-1;else for(;_<t.length;){const A=t[_++];if("number"==typeof A){if(A===n){E=-1;break}if(A>n){E=_-1;break}}}for(;_<t.length;){const A=t[_];if("number"==typeof A)break;if(A===s){if(null===c)return void(null!==f&&(t[_+1]=f));if(c===t[_+1])return void(t[_+2]=f)}_++,null!==c&&_++,null!==f&&_++}-1!==E&&(t.splice(E,0,n),_=E+1),t.splice(_++,0,s),null!==c&&t.splice(_++,0,c),null!==f&&t.splice(_++,0,f)}const Pl="ng-template";function sl(t,n,s,c){let f=0;if(c){for(;f<n.length&&"string"==typeof n[f];f+=2)if("class"===n[f]&&-1!==Hr(n[f+1].toLowerCase(),s,0))return!0}else if(vl(t))return!1;if(f=n.indexOf(1,f),f>-1){let _;for(;++f<n.length&&"string"==typeof(_=n[f]);)if(_.toLowerCase()===s)return!0}return!1}function vl(t){return 4===t.type&&t.value!==Pl}function be(t,n,s){return n===(4!==t.type||s?t.value:Pl)}function Ae(t,n,s){let c=4;const f=t.attrs,_=null!==f?function Sr(t){for(let n=0;n<t.length;n++)if(Qa(t[n]))return n;return t.length}(f):0;let E=!1;for(let A=0;A<n.length;A++){const H=n[A];if("number"!=typeof H){if(!E)if(4&c){if(c=2|1&c,""!==H&&!be(t,H,s)||""===H&&1===n.length){if(K(c))return!1;E=!0}}else if(8&c){if(null===f||!sl(t,f,H,s)){if(K(c))return!1;E=!0}}else{const ce=n[++A],Re=Ge(H,f,vl(t),s);if(-1===Re){if(K(c))return!1;E=!0;continue}if(""!==ce){let ct;if(ct=Re>_?"":f[Re+1].toLowerCase(),2&c&&ce!==ct){if(K(c))return!1;E=!0}}}}else{if(!E&&!K(c)&&!K(H))return!1;if(E&&K(H))continue;E=!1,c=H|1&c}}return K(c)||E}function K(t){return!(1&t)}function Ge(t,n,s,c){if(null===n)return-1;let f=0;if(c||!s){let _=!1;for(;f<n.length;){const E=n[f];if(E===t)return f;if(3===E||6===E)_=!0;else{if(1===E||2===E){let A=n[++f];for(;"string"==typeof A;)A=n[++f];continue}if(4===E)break;if(0===E){f+=4;continue}}f+=_?1:2}return-1}return function Yr(t,n){let s=t.indexOf(4);if(s>-1)for(s++;s<t.length;){const c=t[s];if("number"==typeof c)return-1;if(c===n)return s;s++}return-1}(n,t)}function Ht(t,n,s=!1){for(let c=0;c<n.length;c++)if(Ae(t,n[c],s))return!0;return!1}function ea(t,n){e:for(let s=0;s<n.length;s++){const c=n[s];if(t.length===c.length){for(let f=0;f<t.length;f++)if(t[f]!==c[f])continue e;return!0}}return!1}function ta(t,n){return t?":not("+n.trim()+")":n}function Ja(t){let n=t[0],s=1,c=2,f="",_=!1;for(;s<t.length;){let E=t[s];if("string"==typeof E)if(2&c){const A=t[++s];f+="["+E+(A.length>0?'="'+A+'"':"")+"]"}else 8&c?f+="."+E:4&c&&(f+=" "+E);else""!==f&&!K(E)&&(n+=ta(_,f),f=""),c=E,_=_||!K(c);s++}return""!==f&&(n+=ta(_,f)),n}function Pa(t){return ye(()=>{const n=Zl(t),s={...n,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Hs.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||ko.Emulated,styles:t.styles||Kr,_:null,schemas:t.schemas||null,tView:null,id:""};Il(s);const c=t.dependencies;return s.directiveDefs=al(c,!1),s.pipeDefs=al(c,!0),s.id=function kl(t){let n=0;const s=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const f of s)n=Math.imul(31,n)+f.charCodeAt(0)|0;return n+=2147483648,"c"+n}(s),s})}function Hl(t){return Gr(t)||os(t)}function Ul(t){return null!==t}function Ha(t){return ye(()=>({type:t.type,bootstrap:t.bootstrap||Kr,declarations:t.declarations||Kr,imports:t.imports||Kr,exports:t.exports||Kr,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function zl(t,n){if(null==t)return Eo;const s={};for(const c in t)if(t.hasOwnProperty(c)){const f=t[c];let _,E,A=Wo.None;Array.isArray(f)?(A=f[0],_=f[1],E=f[2]??_):(_=f,E=f),n?(s[_]=A!==Wo.None?[c,A]:c,n[_]=E):s[_]=c}return s}function el(t){return ye(()=>{const n=Zl(t);return Il(n),n})}function nc(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function Gr(t){return t[Ri]||null}function os(t){return t[Oi]||null}function Ro(t){return t[nr]||null}function cs(t){const n=Gr(t)||os(t)||Ro(t);return null!==n&&n.standalone}function Es(t,n){const s=t[mr]||null;if(!s&&!0===n)throw new Error(`Type ${Se(t)} does not have '\u0275mod' property.`);return s}function Zl(t){const n={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:t.inputs||Eo,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||Kr,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:zl(t.inputs,n),outputs:zl(t.outputs),debugInfo:null}}function Il(t){t.features?.forEach(n=>n(t))}function al(t,n){if(!t)return null;const s=n?Ro:Hl;return()=>("function"==typeof t?t():t).map(c=>s(c)).filter(Ul)}function za(t){return{\u0275providers:t}}function _l(...t){return{\u0275providers:Ls(0,t),\u0275fromNgModule:!0}}function Ls(t,...n){const s=[],c=new Set;let f;const _=E=>{s.push(E)};return rs(n,E=>{const A=E;Ia(A,_,[],c)&&(f||=[],f.push(A))}),void 0!==f&&yl(f,_),s}function yl(t,n){for(let s=0;s<t.length;s++){const{ngModule:c,providers:f}=t[s];N(f,_=>{n(_,c)})}}function Ia(t,n,s,c){if(!(t=Ie(t)))return!1;let f=null,_=Uo(t);const E=!_&&Gr(t);if(_||E){if(E&&!E.standalone)return!1;f=t}else{const H=t.ngModule;if(_=Uo(H),!_)return!1;f=H}const A=c.has(f);if(E){if(A)return!1;if(c.add(f),E.dependencies){const H="function"==typeof E.dependencies?E.dependencies():E.dependencies;for(const ce of H)Ia(ce,n,s,c)}}else{if(!_)return!1;{if(null!=_.imports&&!A){let ce;c.add(f);try{rs(_.imports,Re=>{Ia(Re,n,s,c)&&(ce||=[],ce.push(Re))})}finally{}void 0!==ce&&yl(ce,n)}if(!A){const ce=ca(f)||(()=>new f);n({provide:f,useFactory:ce,deps:Kr},f),n({provide:Va,useValue:f,multi:!0},f),n({provide:Bs,useValue:()=>vo(f),multi:!0},f)}const H=_.providers;if(null!=H&&!A){const ce=t;N(H,Re=>{n(Re,ce)})}}}return f!==t&&void 0!==t.providers}function N(t,n){for(let s of t)ur(s)&&(s=s.\u0275providers),Array.isArray(s)?N(s,n):n(s)}const V=lt({provide:String,useValue:lt});function te(t){return null!==t&&"object"==typeof t&&V in t}function Lt(t){return"function"==typeof t}const mn=new xn(""),Pn={},Pi={};let Yi;function $r(){return void 0===Yi&&(Yi=new Js),Yi}class cr{}class ir extends cr{get destroyed(){return this._destroyed}constructor(n,s,c,f){super(),this.parent=s,this.source=c,this.scopes=f,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,W(n,E=>this.processProvider(E)),this.records.set(Aa,Ue(void 0,this)),f.has("environment")&&this.records.set(cr,Ue(void 0,this));const _=this.records.get(mn);null!=_&&"string"==typeof _.value&&this.scopes.add(_.value),this.injectorDefTypes=new Set(this.get(Va,Kr,Dr.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const n=ve(null);try{for(const c of this._ngOnDestroyHooks)c.ngOnDestroy();const s=this._onDestroyHooks;this._onDestroyHooks=[];for(const c of s)c()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ve(n)}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();const s=Ms(this),c=Rr(void 0);try{return n()}finally{Ms(s),Rr(c)}}get(n,s=$o,c=Dr.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(Ji))return n[Ji](this);c=aa(c);const _=Ms(this),E=Rr(void 0);try{if(!(c&Dr.SkipSelf)){let H=this.records.get(n);if(void 0===H){const ce=function le(t){return"function"==typeof t||"object"==typeof t&&t instanceof xn}(n)&&so(n);H=ce&&this.injectableDefInScope(ce)?Ue(Ar(n),Pn):null,this.records.set(n,H)}if(null!=H)return this.hydrate(n,H)}return(c&Dr.Self?$r():this.parent).get(n,s=c&Dr.Optional&&s===$o?null:s)}catch(A){if("NullInjectorError"===A.name){if((A[_s]=A[_s]||[]).unshift(Se(n)),_)throw A;return function Xs(t,n,s,c){const f=t[_s];throw n[Io]&&f.unshift(n[Io]),t.message=function la(t,n,s,c=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let f=Se(n);if(Array.isArray(n))f=n.map(Se).join(" -> ");else if("object"==typeof n){let _=[];for(let E in n)if(n.hasOwnProperty(E)){let A=n[E];_.push(E+":"+("string"==typeof A?JSON.stringify(A):Se(A)))}f=`{${_.join(", ")}}`}return`${s}${c?"("+c+")":""}[${f}]: ${t.replace(ga,"\n  ")}`}("\n"+t.message,f,s,c),t.ngTokenPath=f,t[_s]=null,t}(A,n,"R3InjectorError",this.source)}throw A}finally{Rr(E),Ms(_)}}resolveInjectorInitializers(){const n=ve(null),s=Ms(this),c=Rr(void 0);try{const _=this.get(Bs,Kr,Dr.Self);for(const E of _)E()}finally{Ms(s),Rr(c),ve(n)}}toString(){const n=[],s=this.records;for(const c of s.keys())n.push(Se(c));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new jt(205,!1)}processProvider(n){let s=Lt(n=Ie(n))?n:Ie(n&&n.provide);const c=function vr(t){return te(t)?Ue(void 0,t.useValue):Ue(Qo(t),Pn)}(n);if(!Lt(n)&&!0===n.multi){let f=this.records.get(s);f||(f=Ue(void 0,Pn,!0),f.factory=()=>va(f.multi),this.records.set(s,f)),s=n,f.multi.push(n)}this.records.set(s,c)}hydrate(n,s){const c=ve(null);try{return s.value===Pn&&(s.value=Pi,s.value=s.factory()),"object"==typeof s.value&&s.value&&function ie(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(s.value)&&this._ngOnDestroyHooks.add(s.value),s.value}finally{ve(c)}}injectableDefInScope(n){if(!n.providedIn)return!1;const s=Ie(n.providedIn);return"string"==typeof s?"any"===s||this.scopes.has(s):this.injectorDefTypes.has(s)}removeOnDestroy(n){const s=this._onDestroyHooks.indexOf(n);-1!==s&&this._onDestroyHooks.splice(s,1)}}function Ar(t){const n=so(t),s=null!==n?n.factory:ca(t);if(null!==s)return s;if(t instanceof xn)throw new jt(204,!1);if(t instanceof Function)return function bo(t){if(t.length>0)throw new jt(204,!1);const s=function yr(t){return t&&(t[nt]||t[Tt])||null}(t);return null!==s?()=>s.factory(t):()=>new t}(t);throw new jt(204,!1)}function Qo(t,n,s){let c;if(Lt(t)){const f=Ie(t);return ca(f)||Ar(f)}if(te(t))c=()=>Ie(t.useValue);else if(function ot(t){return!(!t||!t.useFactory)}(t))c=()=>t.useFactory(...va(t.deps||[]));else if(function Le(t){return!(!t||!t.useExisting)}(t))c=()=>vo(Ie(t.useExisting));else{const f=Ie(t&&(t.useClass||t.provide));if(!function De(t){return!!t.deps}(t))return ca(f)||Ar(f);c=()=>new f(...va(t.deps))}return c}function Ue(t,n,s=!1){return{factory:t,value:n,multi:s?[]:void 0}}function W(t,n){for(const s of t)Array.isArray(s)?W(s,n):s&&ur(s)?W(s.\u0275providers,n):n(s)}function Ce(t,n){t instanceof ir&&t.assertNotDestroyed();const c=Ms(t),f=Rr(void 0);try{return n()}finally{Ms(c),Rr(f)}}function xe(){return void 0!==Yo()||null!=function sa(){return po}()}function ei(t){if(!xe())throw new jt(-203,!1)}const Nt=Function;const Fr=0,In=1,Ni=2,Tr=3,uo=4,ho=5,ss=6,ba=7,Nr=8,_o=9,Ds=10,Ir=11,ll=12,ic=13,ka=14,ao=15,jl=16,cl=17,ul=18,Ua=19,Yl=20,Fo=21,wo=22,Ss=23,kr=25,dc=1,No=7,pc=9,Rs=10;var eu=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(eu||{});function Jo(t){return Array.isArray(t)&&"object"==typeof t[dc]}function wa(t){return Array.isArray(t)&&!0===t[dc]}function Pc(t){return!!(4&t.flags)}function ha(t){return t.componentOffset>-1}function ja(t){return!(1&~t.flags)}function da(t){return!!t.template}function mc(t){return!!(512&t[Ni])}class S{constructor(n,s,c){this.previousValue=n,this.currentValue=s,this.firstChange=c}isFirstChange(){return this.firstChange}}function z(t,n,s,c){null!==n?n.applyValueToInputSignal(n,c):t[s]=c}function U(){return J}function J(t){return t.type.prototype.ngOnChanges&&(t.setInput=we),Q}function Q(){const t=Qe(this),n=t?.current;if(n){const s=t.previous;if(s===Eo)t.previous=n;else for(let c in n)s[c]=n[c];t.current=null,this.ngOnChanges(n)}}function we(t,n,s,c,f){const _=this.declaredInputs[c],E=Qe(t)||function ut(t,n){return t[Ye]=n}(t,{previous:Eo,current:null}),A=E.current||(E.current={}),H=E.previous,ce=H[_];A[_]=new S(ce&&ce.currentValue,s,H===Eo),z(t,n,f,s)}U.ngInherit=!0;const Ye="__ngSimpleChanges__";function Qe(t){return t[Ye]||null}const Ee=function(t,n,s){},qe="svg";let Mt=!1;function Ot(t){for(;Array.isArray(t);)t=t[Fr];return t}function Zt(t,n){return Ot(n[t])}function cn(t,n){return Ot(n[t.index])}function fn(t,n){return t.data[n]}function Fn(t,n){return t[n]}function gn(t,n){const s=n[t];return Jo(s)?s:s[Fr]}function vn(t){return!(128&~t[Ni])}function ri(t,n){return null==n?null:t[n]}function Qn(t){t[cl]=0}function fi(t){1024&t[Ni]||(t[Ni]|=1024,vn(t)&&or(t))}function wr(t){return!!(9216&t[Ni]||t[Ss]?.dirty)}function Vi(t){t[Ds].changeDetectionScheduler?.notify(1),wr(t)?or(t):64&t[Ni]&&(function $t(){return Mt}()?(t[Ni]|=1024,or(t)):t[Ds].changeDetectionScheduler?.notify())}function or(t){t[Ds].changeDetectionScheduler?.notify();let n=Qi(t);for(;null!==n&&!(8192&n[Ni])&&(n[Ni]|=8192,vn(n));)n=Qi(n)}function Ur(t,n){if(!(256&~t[Ni]))throw new jt(911,!1);null===t[Fo]&&(t[Fo]=[]),t[Fo].push(n)}function Qi(t){const n=t[Tr];return wa(n)?n[Tr]:n}const Wi={lFrame:fa(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function bl(){return Wi.bindingsEnabled}function tl(){return null!==Wi.skipHydrationRootTNode}function Mn(){return Wi.lFrame.lView}function Vr(){return Wi.lFrame.tView}function nu(t){return Wi.lFrame.contextLView=t,t[Nr]}function gc(t){return Wi.lFrame.contextLView=null,t}function So(){let t=v();for(;null!==t&&64===t.type;)t=t.parent;return t}function v(){return Wi.lFrame.currentTNode}function F(t,n){const s=Wi.lFrame;s.currentTNode=t,s.isParent=n}function oe(){return Wi.lFrame.isParent}function ne(){Wi.lFrame.isParent=!1}function pt(){const t=Wi.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function Gt(){return Wi.lFrame.bindingIndex}function ln(){return Wi.lFrame.bindingIndex++}function Bn(t){const n=Wi.lFrame,s=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,s}function Di(t,n){const s=Wi.lFrame;s.bindingIndex=s.bindingRootIndex=t,Er(n)}function Er(t){Wi.lFrame.currentDirectiveIndex=t}function lo(t){const n=Wi.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}function go(){return Wi.lFrame.currentQueryIndex}function Bo(t){Wi.lFrame.currentQueryIndex=t}function To(t){const n=t[In];return 2===n.type?n.declTNode:1===n.type?t[ho]:null}function Ao(t,n,s){if(s&Dr.SkipSelf){let f=n,_=t;for(;!(f=f.parent,null!==f||s&Dr.Host||(f=To(_),null===f||(_=_[ka],10&f.type))););if(null===f)return!1;n=f,t=_}const c=Wi.lFrame=ts();return c.currentTNode=n,c.lView=t,!0}function $s(t){const n=ts(),s=t[In];Wi.lFrame=n,n.currentTNode=s.firstChild,n.lView=t,n.tView=s,n.contextLView=t,n.bindingIndex=s.bindingStartIndex,n.inI18n=!1}function ts(){const t=Wi.lFrame,n=null===t?null:t.child;return null===n?fa(t):n}function fa(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function wl(){const t=Wi.lFrame;return Wi.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Ml=wl;function Ql(){const t=wl();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Ol(){return Wi.lFrame.selectedIndex}function Bu(t){Wi.lFrame.selectedIndex=t}function Fs(){const t=Wi.lFrame;return fn(t.tView,t.selectedIndex)}function e0(){Wi.lFrame.currentNamespace=qe}let na=!0;function dr(){return na}function El(t){na=t}function Cl(t,n){for(let s=n.directiveStart,c=n.directiveEnd;s<c;s++){const _=t.data[s].type.prototype,{ngAfterContentInit:E,ngAfterContentChecked:A,ngAfterViewInit:H,ngAfterViewChecked:ce,ngOnDestroy:Re}=_;E&&(t.contentHooks??=[]).push(-s,E),A&&((t.contentHooks??=[]).push(s,A),(t.contentCheckHooks??=[]).push(s,A)),H&&(t.viewHooks??=[]).push(-s,H),ce&&((t.viewHooks??=[]).push(s,ce),(t.viewCheckHooks??=[]).push(s,ce)),null!=Re&&(t.destroyHooks??=[]).push(s,Re)}}function Hh(t,n,s){O1(t,n,3,s)}function Uh(t,n,s,c){(3&t[Ni])===s&&O1(t,n,s,c)}function oc(t,n){let s=t[Ni];(3&s)===n&&(s&=16383,s+=1,t[Ni]=s)}function O1(t,n,s,c){const _=c??-1,E=n.length-1;let A=0;for(let H=void 0!==c?65535&t[cl]:0;H<E;H++)if("number"==typeof n[H+1]){if(A=n[H],null!=c&&A>=c)break}else n[H]<0&&(t[cl]+=65536),(A<_||-1==_)&&(jh(t,s,n,H),t[cl]=(4294901760&t[cl])+H+2),H++}function mu(t,n){Ee(4,t,n);const s=ve(null);try{n.call(t)}finally{ve(s),Ee(5,t,n)}}function jh(t,n,s,c){const f=s[c]<0,_=s[c+1],A=t[f?-s[c]:s[c]];f?t[Ni]>>14<t[cl]>>16&&(3&t[Ni])===n&&(t[Ni]+=16384,mu(A,_)):mu(A,_)}const vc=-1;class Hu{constructor(n,s,c){this.factory=n,this.resolving=!1,this.canSeeViewProviders=s,this.injectImpl=c}}function gu(t){return t!==vc}function sc(t){return 32767&t}function dh(t,n){let s=function n0(t){return t>>16}(t),c=n;for(;s>0;)c=c[ka],s--;return c}let Uu=!0;function vu(t){const n=Uu;return Uu=t,n}const fh=255,Tl=5;let yc=0;const xc={};function Yh(t,n){const s=bc(t,n);if(-1!==s)return s;const c=n[In];c.firstCreatePass&&(t.injectorIndex=n.length,ju(c.data,t),ju(n,null),ju(c.blueprint,null));const f=N1(t,n),_=t.injectorIndex;if(gu(f)){const E=sc(f),A=dh(f,n),H=A[In].data;for(let ce=0;ce<8;ce++)n[_+ce]=A[E+ce]|H[E+ce]}return n[_+8]=f,_}function ju(t,n){t.push(0,0,0,0,0,0,0,0,n)}function bc(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function N1(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let s=0,c=null,f=n;for(;null!==f;){if(c=kc(f),null===c)return vc;if(s++,f=f[ka],-1!==c.injectorIndex)return c.injectorIndex|s<<16}return vc}function r0(t,n,s){!function ia(t,n,s){let c;"string"==typeof s?c=s.charCodeAt(0)||0:s.hasOwnProperty(yo)&&(c=s[yo]),null==c&&(c=s[yo]=yc++);const f=c&fh;n.data[t+(f>>Tl)]|=1<<f}(t,n,s)}function o0(t,n,s){if(s&Dr.Optional||void 0!==t)return t;qs()}function _u(t,n,s,c){if(s&Dr.Optional&&void 0===c&&(c=null),!(s&(Dr.Self|Dr.Host))){const f=t[_o],_=Rr(void 0);try{return f?f.get(n,c,s&Dr.Optional):Zs(n,c,s&Dr.Optional)}finally{Rr(_)}}return o0(c,0,s)}function s0(t,n,s,c=Dr.Default,f){if(null!==t){if(2048&n[Ni]&&!(c&Dr.Self)){const E=function X4(t,n,s,c,f){let _=t,E=n;for(;null!==_&&null!==E&&2048&E[Ni]&&!(512&E[Ni]);){const A=a0(_,E,s,c|Dr.Self,xc);if(A!==xc)return A;let H=_.parent;if(!H){const ce=E[Yl];if(ce){const Re=ce.get(s,xc,c);if(Re!==xc)return Re}H=kc(E),E=E[ka]}_=H}return f}(t,n,s,c,xc);if(E!==xc)return E}const _=a0(t,n,s,c,xc);if(_!==xc)return _}return _u(n,s,c,f)}function a0(t,n,s,c,f){const _=function jf(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(yo)?t[yo]:void 0;return"number"==typeof n?n>=0?n&fh:u0:n}(s);if("function"==typeof _){if(!Ao(n,t,c))return c&Dr.Host?o0(f,0,c):_u(n,s,c,f);try{let E;if(E=_(c),null!=E||c&Dr.Optional)return E;qs()}finally{Ml()}}else if("number"==typeof _){let E=null,A=bc(t,n),H=vc,ce=c&Dr.Host?n[ao][ho]:null;for((-1===A||c&Dr.SkipSelf)&&(H=-1===A?N1(t,n):n[A+8],H!==vc&&c0(c,!1)?(E=n[In],A=sc(H),n=dh(H,n)):A=-1);-1!==A;){const Re=n[In];if(l0(_,A,Re.data)){const ct=Z4(A,n,s,E,c,ce);if(ct!==xc)return ct}H=n[A+8],H!==vc&&c0(c,n[In].data[A+8]===ce)&&l0(_,A,n)?(E=Re,A=sc(H),n=dh(H,n)):A=-1}}return f}function Z4(t,n,s,c,f,_){const E=n[In],A=E.data[t+8],Re=$h(A,E,s,null==c?ha(A)&&Uu:c!=E&&!!(3&A.type),f&Dr.Host&&_===A);return null!==Re?Yu(n,E,Re,A):xc}function $h(t,n,s,c,f){const _=t.providerIndexes,E=n.data,A=1048575&_,H=t.directiveStart,Re=_>>20,qt=f?A+Re:t.directiveEnd;for(let rn=c?A:A+Re;rn<qt;rn++){const yn=E[rn];if(rn<H&&s===yn||rn>=H&&yn.type===s)return rn}if(f){const rn=E[H];if(rn&&da(rn)&&rn.type===s)return H}return null}function Yu(t,n,s,c){let f=t[s];const _=n.data;if(function L1(t){return t instanceof Hu}(f)){const E=f;E.resolving&&function gl(t,n){throw n&&n.join(" > "),new jt(-200,t)}(function hr(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Zi(t)}(_[s]));const A=vu(E.canSeeViewProviders);E.resolving=!0;const ce=E.injectImpl?Rr(E.injectImpl):null;Ao(t,c,Dr.Default);try{f=t[s]=E.factory(void 0,_,t,c),n.firstCreatePass&&s>=c.directiveStart&&function k1(t,n,s){const{ngOnChanges:c,ngOnInit:f,ngDoCheck:_}=n.type.prototype;if(c){const E=J(n);(s.preOrderHooks??=[]).push(t,E),(s.preOrderCheckHooks??=[]).push(t,E)}f&&(s.preOrderHooks??=[]).push(0-t,f),_&&((s.preOrderHooks??=[]).push(t,_),(s.preOrderCheckHooks??=[]).push(t,_))}(s,_[s],n)}finally{null!==ce&&Rr(ce),vu(A),E.resolving=!1,Ml()}}return f}function l0(t,n,s){return!!(s[n+(t>>Tl)]&1<<t)}function c0(t,n){return!(t&Dr.Self||t&Dr.Host&&n)}class Oa{constructor(n,s){this._tNode=n,this._lView=s}get(n,s,c){return s0(this._tNode,this._lView,n,aa(c),s)}}function u0(){return new Oa(So(),Mn())}function Dl(t){return ye(()=>{const n=t.prototype.constructor,s=n[io]||Gh(n),c=Object.prototype;let f=Object.getPrototypeOf(t.prototype).constructor;for(;f&&f!==c;){const _=f[io]||Gh(f);if(_&&_!==s)return _;f=Object.getPrototypeOf(f)}return _=>new _})}function Gh(t){return ae(t)?()=>{const n=Gh(Ie(t));return n&&n()}:ca(t)}function kc(t){const n=t[In],s=n.type;return 2===s?n.declTNode:1===s?t[ho]:null}function V1(t){return function q4(t,n){if("class"===n)return t.classes;if("style"===n)return t.styles;const s=t.attrs;if(s){const c=s.length;let f=0;for(;f<c;){const _=s[f];if(Qa(_))break;if(0===_)f+=2;else if("number"==typeof _)for(f++;f<c&&"string"==typeof s[f];)f++;else{if(_===n)return s[f+1];f+=2}}}return null}(So(),t)}function Wh(t,n=null,s=null,c){const f=U1(t,n,s,c);return f.resolveInjectorInitializers(),f}function U1(t,n=null,s=null,c,f=new Set){const _=[s||Kr,_l(t)];return c=c||("object"==typeof t?void 0:Se(t)),new ir(_,n||$r(),c||null,f)}let hl=(()=>{class t{static{this.THROW_IF_NOT_FOUND=$o}static{this.NULL=new Js}static create(s,c){if(Array.isArray(s))return Wh({name:""},c,s,"");{const f=s.name??"";return Wh({name:f},s.parent,s.providers,f)}}static{this.\u0275prov=Xi({token:t,providedIn:"any",factory:()=>vo(Aa)})}static{this.__NG_ELEMENT_ID__=-1}}return t})();function j1(t){return t.ngOriginalError}class ac{constructor(){this._console=console}handleError(n){const s=this._findOriginalError(n);this._console.error("ERROR",n),s&&this._console.error("ORIGINAL ERROR",s)}_findOriginalError(n){let s=n&&j1(n);for(;s&&j1(s);)s=j1(s);return s||null}}const Y1=new xn("",{providedIn:"root",factory:()=>xr(ac).handleError.bind(void 0)});let Gu=(()=>{class t{static{this.__NG_ELEMENT_ID__=e2}static{this.__NG_ENV_ID__=s=>s}}return t})();class gh extends Gu{constructor(n){super(),this._lView=n}onDestroy(n){return Ur(this._lView,n),()=>function Zr(t,n){if(null===t[Fo])return;const s=t[Fo].indexOf(n);-1!==s&&t[Fo].splice(s,1)}(this._lView,n)}}function e2(){return new gh(Mn())}function bu(){return Po(So(),Mn())}function Po(t,n){return new Wu(cn(t,n))}let Wu=(()=>{class t{constructor(s){this.nativeElement=s}static{this.__NG_ELEMENT_ID__=bu}}return t})();function wc(t){return t instanceof Wu?t.nativeElement:t}function lc(t){return n=>{setTimeout(t,void 0,n)}}const Ea=class Yc extends Si.B{constructor(n=!1){super(),this.destroyRef=void 0,this.__isAsync=n,xe()&&(this.destroyRef=xr(Gu,{optional:!0})??void 0)}emit(n){const s=ve(null);try{super.next(n)}finally{ve(s)}}subscribe(n,s,c){let f=n,_=s||(()=>null),E=c;if(n&&"object"==typeof n){const H=n;f=H.next?.bind(H),_=H.error?.bind(H),E=H.complete?.bind(H)}this.__isAsync&&(_=lc(_),f&&(f=lc(f)),E&&(E=lc(E)));const A=super.subscribe({next:f,error:_,complete:E});return n instanceof Mi.yU&&n.add(A),A}};function dl(){return this._results[Symbol.iterator]()}class qh{get changes(){return this._changes??=new Ea}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const s=qh.prototype;s[Symbol.iterator]||(s[Symbol.iterator]=dl)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,s){return this._results.reduce(n,s)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,s){this.dirty=!1;const c=function Go(t){return t.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function qa(t,n,s){if(t.length!==n.length)return!1;for(let c=0;c<t.length;c++){let f=t[c],_=n[c];if(s&&(f=s(f),_=s(_)),_!==f)return!1}return!0}(this._results,c,s))&&(this._results=c,this.length=c.length,this.last=c[this.length-1],this.first=c[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(n){this._onDirty=n}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function Zh(t){return!(128&~t.flags)}const p0=new Map;let m0=0;const v0="__ngContext__";function Al(t,n){Jo(n)?(t[v0]=n[Ua],function Gf(t){p0.set(t[Ua],t)}(n)):t[v0]=n}function u2(t){return b0(t[ll])}function h2(t){return b0(t[uo])}function b0(t){for(;null!==t&&!wa(t);)t=t[uo];return t}let J1;function Zu(t){J1=t}function Mc(){if(void 0!==J1)return J1;if(typeof document<"u")return document;throw new jt(210,!1)}const g2=new xn("",{providedIn:"root",factory:()=>qf}),qf="ng",v2=new xn(""),ed=new xn("",{providedIn:"platform",factory:()=>"unknown"}),Zf=new xn(""),Xf=new xn("",{providedIn:"root",factory:()=>Mc().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let _2=()=>null;function wh(t,n,s=!1){return _2(t,n,s)}const o1=new xn("",{providedIn:"root",factory:()=>!1});let ud,l1;function Wc(t){return function O0(){if(void 0===ud&&(ud=null,ti.trustedTypes))try{ud=ti.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return ud}()?.createHTML(t)||t}function L0(){if(void 0===l1&&(l1=null,ti.trustedTypes))try{l1=ti.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return l1}function R0(t){return L0()?.createHTML(t)||t}function dd(t){return L0()?.createScriptURL(t)||t}class Cu{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Bt})`}}class M2 extends Cu{getTypeName(){return"HTML"}}class E2 extends Cu{getTypeName(){return"Style"}}class r3 extends Cu{getTypeName(){return"Script"}}class o3 extends Cu{getTypeName(){return"URL"}}class C2 extends Cu{getTypeName(){return"ResourceURL"}}function Ec(t){return t instanceof Cu?t.changingThisBreaksApplicationSecurity:t}function Ju(t,n){const s=function Ll(t){return t instanceof Cu&&t.getTypeName()||null}(t);if(null!=s&&s!==n){if("ResourceURL"===s&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${s} (see ${Bt})`)}return s===n}function c1(t){return new M2(t)}function Mh(t){return new E2(t)}function u1(t){return new r3(t)}function T2(t){return new o3(t)}function D2(t){return new C2(t)}class s3{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const s=(new window.DOMParser).parseFromString(Wc(n),"text/html").body;return null===s?this.inertDocumentHelper.getInertBodyElement(n):(s.removeChild(s.firstChild),s)}catch{return null}}}class a3{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const s=this.inertDocument.createElement("template");return s.innerHTML=Wc(n),s}}const c3=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function fd(t){return(t=String(t)).match(c3)?t:"unsafe:"+t}function Cc(t){const n={};for(const s of t.split(","))n[s]=!0;return n}function h1(...t){const n={};for(const s of t)for(const c in s)s.hasOwnProperty(c)&&(n[c]=!0);return n}const N0=Cc("area,br,col,hr,img,wbr"),V0=Cc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),B0=Cc("rp,rt"),H0=h1(N0,h1(V0,Cc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),h1(B0,Cc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),h1(B0,V0)),U0=Cc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),$a=h1(U0,Cc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Cc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Oc=Cc("script,style,template");class j0{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let s=n.firstChild,c=!0,f=[];for(;s;)if(s.nodeType===Node.ELEMENT_NODE?c=this.startElement(s):s.nodeType===Node.TEXT_NODE?this.chars(s.nodeValue):this.sanitizedSomething=!0,c&&s.firstChild)f.push(s),s=d3(s);else for(;s;){s.nodeType===Node.ELEMENT_NODE&&this.endElement(s);let _=Eh(s);if(_){s=_;break}s=f.pop()}return this.buf.join("")}startElement(n){const s=Y0(n).toLowerCase();if(!H0.hasOwnProperty(s))return this.sanitizedSomething=!0,!Oc.hasOwnProperty(s);this.buf.push("<"),this.buf.push(s);const c=n.attributes;for(let f=0;f<c.length;f++){const _=c.item(f),E=_.name,A=E.toLowerCase();if(!$a.hasOwnProperty(A)){this.sanitizedSomething=!0;continue}let H=_.value;U0[A]&&(H=fd(H)),this.buf.push(" ",E,'="',$0(H),'"')}return this.buf.push(">"),!0}endElement(n){const s=Y0(n).toLowerCase();H0.hasOwnProperty(s)&&!N0.hasOwnProperty(s)&&(this.buf.push("</"),this.buf.push(s),this.buf.push(">"))}chars(n){this.buf.push($0(n))}}function Eh(t){const n=t.nextSibling;if(n&&t!==n.previousSibling)throw Ch(n);return n}function d3(t){const n=t.firstChild;if(n&&function pd(t,n){return(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(t,n))throw Ch(n);return n}function Y0(t){const n=t.nodeName;return"string"==typeof n?n:"FORM"}function Ch(t){return new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`)}const f3=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,p3=/([^\#-~ |!])/g;function $0(t){return t.replace(/&/g,"&amp;").replace(f3,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(p3,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let d1;function G0(t,n){let s=null;try{d1=d1||function S2(t){const n=new a3(t);return function l3(){try{return!!(new window.DOMParser).parseFromString(Wc(""),"text/html")}catch{return!1}}()?new s3(n):n}(t);let c=n?String(n):"";s=d1.getInertBodyElement(c);let f=5,_=c;do{if(0===f)throw new Error("Failed to sanitize html because the input is unstable");f--,c=_,_=s.innerHTML,s=d1.getInertBodyElement(c)}while(c!==_);return Wc((new j0).sanitizeChildren(qo(s)||s))}finally{if(s){const c=qo(s)||s;for(;c.firstChild;)c.removeChild(c.firstChild)}}}function qo(t){return"content"in t&&function W0(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Tu=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Tu||{});function K0(t){const n=f1();return n?R0(n.sanitize(Tu.HTML,t)||""):Ju(t,"HTML")?R0(Ec(t)):G0(Mc(),Zi(t))}function Du(t){const n=f1();return n?n.sanitize(Tu.URL,t)||"":Ju(t,"URL")?Ec(t):fd(Zi(t))}function q0(t){const n=f1();if(n)return dd(n.sanitize(Tu.RESOURCE_URL,t)||"");if(Ju(t,"ResourceURL"))return dd(Ec(t));throw new jt(904,!1)}function A2(t,n,s){return function _3(t,n){return"src"===n&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===n&&("base"===t||"link"===t)?q0:Du}(n,s)(t)}function f1(){const t=Mn();return t&&t[Ds].sanitizer}const y3=/^>|^->|<!--|-->|--!>|<!-$/g,md=/(<|>)/g,Th="\u200b$1\u200b";function J0(t){return t.ownerDocument.defaultView}function tc(t){return t instanceof Function?t():t}var Su=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Su||{});let bd;function wd(t,n){return bd(t,n)}function Au(t,n,s,c,f){if(null!=c){let _,E=!1;wa(c)?_=c:Jo(c)&&(E=!0,c=c[Fr]);const A=Ot(c);0===t&&null!==s?null==f?V2(n,s,A):lu(n,s,A,f||null,!0):1===t&&null!==s?lu(n,s,A,f||null,!0):2===t?function uu(t,n,s){const c=x1(t,n);c&&function Iu(t,n,s,c){t.removeChild(n,s,c)}(t,c,n,s)}(n,A,E):3===t&&n.destroyNode(A),null!=_&&function Ad(t,n,s,c,f){const _=s[No];_!==Ot(s)&&Au(n,t,c,_,f);for(let A=Rs;A<s.length;A++){const H=s[A];Sd(H[In],H,t,n,c,_)}}(n,t,_,s,f)}}function Md(t,n){return t.createComment(function Z0(t){return t.replace(y3,n=>n.replace(md,Th))}(n))}function eh(t,n,s){return t.createElement(n,s)}function _1(t,n){n[Ds].changeDetectionScheduler?.notify(1),Sd(t,n,n[Ir],2,null,null)}function F2(t,n){const s=t[pc],c=s.indexOf(n);s.splice(c,1)}function y1(t,n){if(t.length<=Rs)return;const s=Rs+n,c=t[s];if(c){const f=c[jl];null!==f&&f!==t&&F2(f,c),n>0&&(t[s-1][uo]=c[uo]);const _=br(t,Rs+n);!function R2(t,n){_1(t,n),n[Fr]=null,n[ho]=null}(c[In],c);const E=_[ul];null!==E&&E.detachView(_[In]),c[Tr]=null,c[uo]=null,c[Ni]&=-129}return c}function au(t,n){if(!(256&n[Ni])){const s=n[Ir];s.destroyNode&&Sd(t,n,s,3,null,null),function D3(t){let n=t[ll];if(!n)return zu(t[In],t);for(;n;){let s=null;if(Jo(n))s=n[ll];else{const c=n[Rs];c&&(s=c)}if(!s){for(;n&&!n[uo]&&n!==t;)Jo(n)&&zu(n[In],n),n=n[Tr];null===n&&(n=t),Jo(n)&&zu(n[In],n),s=n&&n[uo]}n=s}}(n)}}function zu(t,n){if(256&n[Ni])return;const s=ve(null);try{n[Ni]&=-129,n[Ni]|=256,n[Ss]&&Ut(n[Ss]),function P3(t,n){let s;if(null!=t&&null!=(s=t.destroyHooks))for(let c=0;c<s.length;c+=2){const f=n[s[c]];if(!(f instanceof Hu)){const _=s[c+1];if(Array.isArray(_))for(let E=0;E<_.length;E+=2){const A=f[_[E]],H=_[E+1];Ee(4,A,H);try{H.call(A)}finally{Ee(5,A,H)}}else{Ee(4,f,_);try{_.call(f)}finally{Ee(5,f,_)}}}}}(t,n),function r4(t,n){const s=t.cleanup,c=n[ba];if(null!==s)for(let _=0;_<s.length-1;_+=2)if("string"==typeof s[_]){const E=s[_+3];E>=0?c[E]():c[-E].unsubscribe(),_+=2}else s[_].call(c[s[_+1]]);null!==c&&(n[ba]=null);const f=n[Fo];if(null!==f){n[Fo]=null;for(let _=0;_<f.length;_++)(0,f[_])()}}(t,n),1===n[In].type&&n[Ir].destroy();const c=n[jl];if(null!==c&&wa(n[Tr])){c!==n[Tr]&&F2(c,n);const f=n[ul];null!==f&&f.detachView(t)}!function qu(t){p0.delete(t[Ua])}(n)}finally{ve(s)}}function Cd(t,n,s){return function N2(t,n,s){let c=n;for(;null!==c&&40&c.type;)c=(n=c).parent;if(null===c)return s[Fr];{const{componentOffset:f}=c;if(f>-1){const{encapsulation:_}=t.data[c.directiveStart+f];if(_===ko.None||_===ko.Emulated)return null}return cn(c,s)}}(t,n.parent,s)}function lu(t,n,s,c,f){t.insertBefore(n,s,c,f)}function V2(t,n,s){t.appendChild(n,s)}function th(t,n,s,c,f){null!==c?lu(t,n,s,c,f):V2(t,n,s)}function x1(t,n){return t.parentNode(n)}function Dd(t,n,s){return o4(t,n,s)}let cu,o4=function B2(t,n,s){return 40&t.type?cn(t,s):null};function Rc(t,n,s,c){const f=Cd(t,c,n),_=n[Ir],A=Dd(c.parent||n[ho],c,n);if(null!=f)if(Array.isArray(s))for(let H=0;H<s.length;H++)th(_,f,s[H],A,!1);else th(_,f,s,A,!1);void 0!==cu&&cu(_,c,n,s,f)}function b1(t,n){if(null!==n){const s=n.type;if(3&s)return cn(n,t);if(4&s)return nh(-1,t[n.index]);if(8&s){const c=n.child;if(null!==c)return b1(t,c);{const f=t[n.index];return wa(f)?nh(-1,f):Ot(f)}}if(32&s)return wd(n,t)()||Ot(t[n.index]);{const c=Sh(t,n);return null!==c?Array.isArray(c)?c[0]:b1(Qi(t[ao]),c):b1(t,n.next)}}return null}function Sh(t,n){return null!==n?t[ao][ho].projection[n.projection]:null}function nh(t,n){const s=Rs+t+1;if(s<n.length){const c=n[s],f=c[In].firstChild;if(null!==f)return b1(c,f)}return n[No]}function Ph(t,n,s,c,f,_,E){for(;null!=s;){const A=c[s.index],H=s.type;if(E&&0===n&&(A&&Al(Ot(A),c),s.flags|=2),32&~s.flags)if(8&H)Ph(t,n,s.child,c,f,_,!1),Au(n,t,f,A,_);else if(32&H){const ce=wd(s,c);let Re;for(;Re=ce();)Au(n,t,f,Re,_);Au(n,t,f,A,_)}else 16&H?ih(t,n,c,s,f,_):Au(n,t,f,A,_);s=E?s.projectionNext:s.next}}function Sd(t,n,s,c,f,_){Ph(s,c,t.firstChild,n,f,_,!1)}function ih(t,n,s,c,f,_){const E=s[ao],H=E[ho].projection[c.projection];if(Array.isArray(H))for(let ce=0;ce<H.length;ce++)Au(n,t,f,H[ce],_);else{let ce=H;const Re=E[Tr];Zh(c)&&(ce.flags|=128),Ph(t,n,ce,Re,f,_,!0)}}function s4(t,n,s){""===s?t.removeAttribute(n,"class"):t.setAttribute(n,"class",s)}function j2(t,n,s){const{mergedAttrs:c,classes:f,styles:_}=s;null!==c&&Ba(t,n,c),null!==f&&s4(t,n,f),null!==_&&function U2(t,n,s){t.setAttribute(n,"style",s)}(t,n,_)}const co={};function Y2(t=1){a4(Vr(),Mn(),Ol()+t,!1)}function a4(t,n,s,c){if(!c)if(3&~n[Ni]){const _=t.preOrderHooks;null!==_&&Uh(n,_,0,s)}else{const _=t.preOrderCheckHooks;null!==_&&Hh(n,_,s)}Bu(s)}function zh(t,n=Dr.Default){const s=Mn();return null===s?vo(t,n):s0(So(),s,Ie(t),n)}function l4(){throw new Error("invalid")}function $2(t,n,s,c,f,_){const E=ve(null);try{let A=null;f&Wo.SignalBased&&(A=n[c][Fe]),null!==A&&void 0!==A.transformFn&&(_=A.transformFn(_)),f&Wo.HasDecoratorInputTransform&&(_=t.inputTransforms[c].call(n,_)),null!==t.setInput?t.setInput(n,A,_,s,c):z(n,A,c,_)}finally{ve(E)}}function rh(t,n,s,c,f,_,E,A,H,ce,Re){const ct=n.blueprint.slice();return ct[Fr]=f,ct[Ni]=204|c,(null!==ce||t&&2048&t[Ni])&&(ct[Ni]|=2048),Qn(ct),ct[Tr]=ct[ka]=t,ct[Nr]=s,ct[Ds]=E||t&&t[Ds],ct[Ir]=A||t&&t[Ir],ct[_o]=H||t&&t[_o]||null,ct[ho]=_,ct[Ua]=function r2(){return m0++}(),ct[ss]=Re,ct[Yl]=ce,ct[ao]=2==n.type?t[ao]:ct,ct}function hu(t,n,s,c,f){let _=t.data[n];if(null===_)_=function Ih(t,n,s,c,f){const _=v(),E=oe(),H=t.data[n]=function E1(t,n,s,c,f,_){let E=n?n.injectorIndex:-1,A=0;return tl()&&(A|=128),{type:s,index:c,insertBeforeIndex:null,injectorIndex:E,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:A,providerIndexes:0,value:f,attrs:_,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,E?_:_&&_.parent,s,n,c,f);return null===t.firstChild&&(t.firstChild=H),null!==_&&(E?null==_.child&&null!==H.parent&&(_.child=H):null===_.next&&(_.next=H,H.prev=_)),H}(t,n,s,c,f),function _i(){return Wi.lFrame.inI18n}()&&(_.flags|=32);else if(64&_.type){_.type=s,_.value=c,_.attrs=f;const E=function D(){const t=Wi.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();_.injectorIndex=null===E?-1:E.injectorIndex}return F(_,!0),_}function w1(t,n,s,c){if(0===s)return-1;const f=n.length;for(let _=0;_<s;_++)n.push(c),t.blueprint.push(c),t.data.push(null);return f}function Pd(t,n,s,c,f){const _=Ol(),E=2&c;try{Bu(-1),E&&n.length>kr&&a4(t,n,kr,!1),Ee(E?2:0,f),s(c,f)}finally{Bu(_),Ee(E?3:1,f)}}function M1(t,n,s){if(Pc(n)){const c=ve(null);try{const _=n.directiveEnd;for(let E=n.directiveStart;E<_;E++){const A=t.data[E];A.contentQueries&&A.contentQueries(1,s[E],E)}}finally{ve(c)}}}function Kc(t,n,s){bl()&&(function f4(t,n,s,c){const f=s.directiveStart,_=s.directiveEnd;ha(s)&&function J2(t,n,s){const c=cn(n,t),f=zd(s);let E=16;s.signals?E=4096:s.onPush&&(E=64);const A=Rd(t,rh(t,f,null,E,c,n,null,t[Ds].rendererFactory.createRenderer(c,s),null,null,null));t[n.index]=A}(n,s,t.data[f+s.componentOffset]),t.firstCreatePass||Yh(s,n),Al(c,n);const E=s.initialInputs;for(let A=f;A<_;A++){const H=t.data[A],ce=Yu(n,t,A,s);Al(ce,n),null!==E&&ef(0,A-f,ce,H,0,E),da(H)&&(gn(s.index,n)[Nr]=Yu(n,t,A,s))}}(t,n,s,cn(s,n)),!(64&~s.flags)&&p4(t,n,s))}function c4(t,n,s=cn){const c=n.localNames;if(null!==c){let f=n.index+1;for(let _=0;_<c.length;_+=2){const E=c[_+1],A=-1===E?s(n,t):t[E];t[f++]=A}}}function zd(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=Id(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):n}function Id(t,n,s,c,f,_,E,A,H,ce,Re){const ct=kr+c,qt=ct+f,rn=function kd(t,n){const s=[];for(let c=0;c<n;c++)s.push(c<t?null:co);return s}(ct,qt),yn="function"==typeof ce?ce():ce;return rn[In]={type:t,blueprint:rn,template:s,queries:null,viewQuery:A,declTNode:n,data:rn.slice().fill(null,ct),bindingStartIndex:ct,expandoStartIndex:qt,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof _?_():_,pipeRegistry:"function"==typeof E?E():E,firstChild:null,schemas:H,consts:yn,incompleteFirstPass:!1,ssrId:Re}}let G2=()=>null;function W2(t,n,s,c,f){for(let _ in n){if(!n.hasOwnProperty(_))continue;const E=n[_];if(void 0===E)continue;c??={};let A,H=Wo.None;Array.isArray(E)?(A=E[0],H=E[1]):A=E;let ce=_;if(null!==f){if(!f.hasOwnProperty(_))continue;ce=f[_]}0===t?h4(c,s,ce,A,H):h4(c,s,ce,A)}return c}function h4(t,n,s,c,f){let _;t.hasOwnProperty(s)?(_=t[s]).push(n,c):_=t[s]=[n,c],void 0!==f&&_.push(f)}function Wl(t,n,s,c,f,_,E,A){const H=cn(n,s);let Re,ce=n.inputs;!A&&null!=ce&&(Re=ce[c])?(cc(t,s,Re,c,f),ha(n)&&function Dc(t,n){const s=gn(n,t);16&s[Ni]||(s[Ni]|=64)}(s,n.index)):3&n.type&&(c=function V3(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(c),f=null!=E?E(f,n.value||"",c):f,_.setProperty(H,c,f))}function Sc(t,n,s,c){if(bl()){const f=null===c?null:{"":-1},_=function B3(t,n){const s=t.directiveRegistry;let c=null,f=null;if(s)for(let _=0;_<s.length;_++){const E=s[_];if(Ht(n,E.selectors,!1))if(c||(c=[]),da(E))if(null!==E.findHostDirectiveDefs){const A=[];f=f||new Map,E.findHostDirectiveDefs(E,A,f),c.unshift(...A,E),Ld(t,n,A.length)}else c.unshift(E),Ld(t,n,0);else f=f||new Map,E.findHostDirectiveDefs?.(E,c,f),c.push(E)}return null===c?null:[c,f]}(t,s);let E,A;null===_?E=A=null:[E,A]=_,null!==E&&du(t,n,s,E,f,A),f&&function q2(t,n,s){if(n){const c=t.localNames=[];for(let f=0;f<n.length;f+=2){const _=s[n[f+1]];if(null==_)throw new jt(-301,!1);c.push(n[f],_)}}}(s,c,f)}s.mergedAttrs=xa(s.mergedAttrs,s.attrs)}function du(t,n,s,c,f,_){for(let ce=0;ce<c.length;ce++)r0(Yh(s,n),t,c[ce].type);!function X2(t,n,s){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+s,t.providerIndexes=n}(s,t.data.length,c.length);for(let ce=0;ce<c.length;ce++){const Re=c[ce];Re.providersResolver&&Re.providersResolver(Re)}let E=!1,A=!1,H=w1(t,n,c.length,null);for(let ce=0;ce<c.length;ce++){const Re=c[ce];s.mergedAttrs=xa(s.mergedAttrs,Re.hostAttrs),Q2(t,s,n,H,Re),Z2(H,Re,f),null!==Re.contentQueries&&(s.flags|=4),(null!==Re.hostBindings||null!==Re.hostAttrs||0!==Re.hostVars)&&(s.flags|=64);const ct=Re.type.prototype;!E&&(ct.ngOnChanges||ct.ngOnInit||ct.ngDoCheck)&&((t.preOrderHooks??=[]).push(s.index),E=!0),!A&&(ct.ngOnChanges||ct.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(s.index),A=!0),H++}!function d4(t,n,s){const f=n.directiveEnd,_=t.data,E=n.attrs,A=[];let H=null,ce=null;for(let Re=n.directiveStart;Re<f;Re++){const ct=_[Re],qt=s?s.get(ct):null,yn=qt?qt.outputs:null;H=W2(0,ct.inputs,Re,H,qt?qt.inputs:null),ce=W2(1,ct.outputs,Re,ce,yn);const Jn=null===H||null===E||vl(n)?null:H3(H,Re,E);A.push(Jn)}null!==H&&(H.hasOwnProperty("class")&&(n.flags|=8),H.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=A,n.inputs=H,n.outputs=ce}(t,s,_)}function p4(t,n,s){const c=s.directiveStart,f=s.directiveEnd,_=s.index,E=function Bi(){return Wi.lFrame.currentDirectiveIndex}();try{Bu(_);for(let A=c;A<f;A++){const H=t.data[A],ce=n[A];Er(A),(null!==H.hostBindings||0!==H.hostVars||null!==H.hostAttrs)&&m4(H,ce)}}finally{Bu(-1),Er(E)}}function m4(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function Ld(t,n,s){n.componentOffset=s,(t.components??=[]).push(n.index)}function Z2(t,n,s){if(s){if(n.exportAs)for(let c=0;c<n.exportAs.length;c++)s[n.exportAs[c]]=t;da(n)&&(s[""]=t)}}function Q2(t,n,s,c,f){t.data[c]=f;const _=f.factory||(f.factory=ca(f.type)),E=new Hu(_,da(f),zh);t.blueprint[c]=E,s[c]=E,function Od(t,n,s,c,f){const _=f.hostBindings;if(_){let E=t.hostBindingOpCodes;null===E&&(E=t.hostBindingOpCodes=[]);const A=~n.index;(function K2(t){let n=t.length;for(;n>0;){const s=t[--n];if("number"==typeof s&&s<0)return s}return 0})(E)!=A&&E.push(A),E.push(s,c,_)}}(t,n,c,w1(t,s,f.hostVars,co),f)}function Fc(t,n,s,c,f,_){const E=cn(t,n);!function Zc(t,n,s,c,f,_,E){if(null==_)t.removeAttribute(n,f,s);else{const A=null==E?Zi(_):E(_,c||"",f);t.setAttribute(n,f,A,s)}}(n[Ir],E,_,t.value,s,c,f)}function ef(t,n,s,c,f,_){const E=_[n];if(null!==E)for(let A=0;A<E.length;)$2(c,s,E[A++],E[A++],E[A++],E[A++])}function H3(t,n,s){let c=null,f=0;for(;f<s.length;){const _=s[f];if(0!==_)if(5!==_){if("number"==typeof _)break;if(t.hasOwnProperty(_)){null===c&&(c=[]);const E=t[_];for(let A=0;A<E.length;A+=3)if(E[A]===n){c.push(_,E[A+1],E[A+2],s[f+1]);break}}f+=2}else f+=2;else f+=4}return c}function tf(t,n,s,c){return[t,!0,0,n,null,c,null,s,null,null]}function C1(t,n){const s=t.contentQueries;if(null!==s){const c=ve(null);try{for(let f=0;f<s.length;f+=2){const E=s[f+1];if(-1!==E){const A=t.data[E];Bo(s[f]),A.contentQueries(2,n[E],E)}}}finally{ve(c)}}}function Rd(t,n){return t[ll]?t[ic][uo]=n:t[ll]=n,t[ic]=n,n}function ku(t,n,s){Bo(0);const c=ve(null);try{n(t,s)}finally{ve(c)}}function Fd(t){return t[ba]||(t[ba]=[])}function Nc(t){return t.cleanup||(t.cleanup=[])}function Nd(t,n,s){return(null===t||da(t))&&(s=function on(t){for(;Array.isArray(t);){if("object"==typeof t[dc])return t;t=t[Fr]}return null}(s[n.index])),s[Ir]}function kh(t,n){const s=t[_o],c=s?s.get(ac,null):null;c&&c.handleError(n)}function cc(t,n,s,c,f){for(let _=0;_<s.length;){const E=s[_++],A=s[_++],H=s[_++];$2(t.data[E],n[E],c,A,H,f)}}function Kl(t,n,s){const c=Zt(n,t);!function su(t,n,s){t.setValue(n,s)}(t[Ir],c,s)}function rf(t,n){const s=gn(n,t),c=s[In];!function sf(t,n){for(let s=n.length;s<t.blueprint.length;s++)n.push(t.blueprint[s])}(c,s);const f=s[Fr];null!==f&&null===s[ss]&&(s[ss]=wh(f,s[_o])),sh(c,s,s[Nr])}function sh(t,n,s){$s(n);try{const c=t.viewQuery;null!==c&&ku(1,c,s);const f=t.template;null!==f&&Pd(t,n,f,1,s),t.firstCreatePass&&(t.firstCreatePass=!1),n[ul]?.finishViewCreation(t),t.staticContentQueries&&C1(t,n),t.staticViewQueries&&ku(2,t.viewQuery,s);const _=t.components;null!==_&&function Vd(t,n){for(let s=0;s<n.length;s++)rf(t,n[s])}(n,_)}catch(c){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),c}finally{n[Ni]&=-5,Ql()}}function Lh(t,n){return!n||null===n.firstChild||Zh(t)}function Rh(t,n,s,c=!0){const f=n[In];if(function S3(t,n,s,c){const f=Rs+c,_=s.length;c>0&&(s[f-1][uo]=n),c<_-Rs?(n[uo]=s[f],ya(s,Rs+c,n)):(s.push(n),n[uo]=null),n[Tr]=s;const E=n[jl];null!==E&&s!==E&&function A3(t,n){const s=t[pc];n[ao]!==n[Tr][Tr][ao]&&(t[Ni]|=eu.HasTransplantedViews),null===s?t[pc]=[n]:s.push(n)}(E,n);const A=n[ul];null!==A&&A.insertView(t),Vi(n),n[Ni]|=128}(f,n,t,s),c){const E=nh(s,t),A=n[Ir],H=x1(A,t[No]);null!==H&&function Ed(t,n,s,c,f,_){c[Fr]=f,c[ho]=n,Sd(t,c,s,1,f,_)}(f,t[ho],A,n,H,E)}const _=n[ss];null!==_&&null!==_.firstChild&&(_.firstChild=null)}function Fh(t,n,s,c,f=!1){for(;null!==s;){const _=n[s.index];null!==_&&c.push(Ot(_)),wa(_)&&af(_,c);const E=s.type;if(8&E)Fh(t,n,s.child,c);else if(32&E){const A=wd(s,n);let H;for(;H=A();)c.push(H)}else if(16&E){const A=Sh(n,s);if(Array.isArray(A))c.push(...A);else{const H=Qi(n[ao]);Fh(H[In],H,A,c,!0)}}s=f?s.projectionNext:s.next}return c}function af(t,n){for(let s=Rs;s<t.length;s++){const c=t[s],f=c[In].firstChild;null!==f&&Fh(c[In],c,f,n)}t[No]!==t[Fr]&&n.push(t[No])}let Hd=[];const _4={...ge,consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{or(t.lView)},consumerOnSignalRead(){this.lView[Ss]=this}},Ud=100;function Nh(t,n=!0,s=0){const c=t[Ds],f=c.rendererFactory;f.begin?.();try{!function T1(t,n){p(t,n);let s=0;for(;wr(t);){if(s===Ud)throw new jt(103,!1);s++,p(t,1)}}(t,s)}catch(E){throw n&&kh(t,E),E}finally{f.end?.(),c.inlineEffectRunner?.flush()}}function hf(t,n,s,c){const f=n[Ni];if(!(256&~f))return;n[Ds].inlineEffectRunner?.flush(),$s(n);let E=null,A=null;(function i(t){return 2!==t.type})(t)&&(A=function lf(t){return t[Ss]??function v4(t){const n=Hd.pop()??Object.create(_4);return n.lView=t,n}(t)}(n),E=Qt(A));try{Qn(n),function Tn(t){return Wi.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==s&&Pd(t,n,s,2,c);const H=!(3&~f);if(H){const ct=t.preOrderCheckHooks;null!==ct&&Hh(n,ct,null)}else{const ct=t.preOrderHooks;null!==ct&&Uh(n,ct,0,null),oc(n,0)}if(function o(t){for(let n=u2(t);null!==n;n=h2(n)){if(!(n[Ni]&eu.HasTransplantedViews))continue;const s=n[pc];for(let c=0;c<s.length;c++){fi(s[c])}}}(n),e(n,0),null!==t.contentQueries&&C1(t,n),H){const ct=t.contentCheckHooks;null!==ct&&Hh(n,ct)}else{const ct=t.contentHooks;null!==ct&&Uh(n,ct,1),oc(n,1)}!function O3(t,n){const s=t.hostBindingOpCodes;if(null!==s)try{for(let c=0;c<s.length;c++){const f=s[c];if(f<0)Bu(~f);else{const _=f,E=s[++c],A=s[++c];Di(E,_),A(2,n[_])}}}finally{Bu(-1)}}(t,n);const ce=t.components;null!==ce&&g(n,ce,0);const Re=t.viewQuery;if(null!==Re&&ku(2,Re,c),H){const ct=t.viewCheckHooks;null!==ct&&Hh(n,ct)}else{const ct=t.viewHooks;null!==ct&&Uh(n,ct,2),oc(n,2)}if(!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[wo]){for(const ct of n[wo])ct();n[wo]=null}n[Ni]&=-73}catch(H){throw or(n),H}finally{null!==A&&(sn(A,E),function cf(t){t.lView[Ss]!==t&&(t.lView=null,Hd.push(t))}(A)),Ql()}}function e(t,n){for(let s=u2(t);null!==s;s=h2(s))for(let c=Rs;c<s.length;c++)h(s[c],n)}function l(t,n,s){h(gn(n,t),s)}function h(t,n){vn(t)&&p(t,n)}function p(t,n){const c=t[In],f=t[Ni],_=t[Ss];let E=!!(0===n&&16&f);if(E||=!!(64&f&&0===n),E||=!!(1024&f),E||=!(!_?.dirty||!Yt(_)),_&&(_.dirty=!1),t[Ni]&=-9217,E)hf(c,t,c.template,t[Nr]);else if(8192&f){e(t,1);const A=c.components;null!==A&&g(t,A,1)}}function g(t,n,s){for(let c=0;c<n.length;c++)l(t,n[c],s)}function x(t){for(t[Ds].changeDetectionScheduler?.notify();t;){t[Ni]|=64;const n=Qi(t);if(mc(t)&&!n)return t;t=n}return null}class w{get rootNodes(){const n=this._lView,s=n[In];return Fh(s,n,s.firstChild,[])}constructor(n,s,c=!0){this._lView=n,this._cdRefInjectingView=s,this.notifyErrorHandler=c,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Nr]}set context(n){this._lView[Nr]=n}get destroyed(){return!(256&~this._lView[Ni])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[Tr];if(wa(n)){const s=n[8],c=s?s.indexOf(this):-1;c>-1&&(y1(n,c),br(s,c))}this._attachedToViewContainer=!1}au(this._lView[In],this._lView)}onDestroy(n){Ur(this._lView,n)}markForCheck(){x(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ni]&=-129}reattach(){Vi(this._lView),this._lView[Ni]|=128}detectChanges(){this._lView[Ni]|=1024,Nh(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new jt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,_1(this._lView[In],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new jt(902,!1);this._appRef=n,Vi(this._lView)}}let T=(()=>{class t{static{this.__NG_ELEMENT_ID__=k}}return t})();const P=T,O=class extends P{constructor(n,s,c){super(),this._declarationLView=n,this._declarationTContainer=s,this.elementRef=c}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,s){return this.createEmbeddedViewImpl(n,s)}createEmbeddedViewImpl(n,s,c){const f=function Oh(t,n,s,c){const f=ve(null);try{const _=n.tView,H=rh(t,_,s,4096&t[Ni]?4096:16,null,n,null,null,c?.injector??null,c?.embeddedViewInjector??null,c?.dehydratedView??null);H[jl]=t[n.index];const Re=t[ul];return null!==Re&&(H[ul]=Re.createEmbeddedView(_)),sh(_,H,s),H}finally{ve(f)}}(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:s,dehydratedView:c});return new w(f)}};function k(){return j(So(),Mn())}function j(t,n){return 4&t.type?new O(n,t,Po(t,n)):null}class Ra{}class il{}class Rl{}class Yd{resolveComponentFactory(n){throw function rl(t){const n=Error(`No component factory found for ${Se(t)}.`);return n.ngComponent=t,n}(n)}}let Ou=(()=>{class t{static{this.NULL=new Yd}}return t})();class df{}let U3=(()=>{class t{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>function j3(){const t=Mn(),s=gn(So().index,t);return(Jo(s)?s:t)[Ir]}()}}return t})(),Y3=(()=>{class t{static{this.\u0275prov=Xi({token:t,providedIn:"root",factory:()=>null})}}return t})();const $d={},Xc=new Set;function Qc(t){Xc.has(t)||(Xc.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function ah(...t){}class Vs{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:s=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ea(!1),this.onMicrotaskEmpty=new Ea(!1),this.onStable=new Ea(!1),this.onError=new Ea(!1),typeof Zone>"u")throw new jt(908,!1);Zone.assertZonePatched();const f=this;f._nesting=0,f._outer=f._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(f._inner=f._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(f._inner=f._inner.fork(Zone.longStackTraceZoneSpec)),f.shouldCoalesceEventChangeDetection=!c&&s,f.shouldCoalesceRunChangeDetection=c,f.lastRequestAnimationFrameId=-1,f.nativeRequestAnimationFrame=function ff(){const t="function"==typeof ti.requestAnimationFrame;let n=ti[t?"requestAnimationFrame":"setTimeout"],s=ti[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&s){const c=n[Zone.__symbol__("OriginalDelegate")];c&&(n=c);const f=s[Zone.__symbol__("OriginalDelegate")];f&&(s=f)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:s}}().nativeRequestAnimationFrame,function hc(t){const n=()=>{!function uc(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(ti,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Vh(t),t.isCheckStableRunning=!0,mf(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Vh(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(s,c,f,_,E,A)=>{if(function Xv(t){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0].data?.__ignore_ng_zone__}(A))return s.invokeTask(f,_,E,A);try{return y4(t),s.invokeTask(f,_,E,A)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===_.type||t.shouldCoalesceRunChangeDetection)&&n(),gf(t)}},onInvoke:(s,c,f,_,E,A,H)=>{try{return y4(t),s.invoke(f,_,E,A,H)}finally{t.shouldCoalesceRunChangeDetection&&n(),gf(t)}},onHasTask:(s,c,f,_)=>{s.hasTask(f,_),c===f&&("microTask"==_.change?(t._hasPendingMicrotasks=_.microTask,Vh(t),mf(t)):"macroTask"==_.change&&(t.hasPendingMacrotasks=_.macroTask))},onHandleError:(s,c,f,_)=>(s.handleError(f,_),t.runOutsideAngular(()=>t.onError.emit(_)),!1)})}(f)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Vs.isInAngularZone())throw new jt(909,!1)}static assertNotInAngularZone(){if(Vs.isInAngularZone())throw new jt(909,!1)}run(n,s,c){return this._inner.run(n,s,c)}runTask(n,s,c,f){const _=this._inner,E=_.scheduleEventTask("NgZoneEvent: "+f,n,pf,ah,ah);try{return _.runTask(E,s,c)}finally{_.cancelTask(E)}}runGuarded(n,s,c){return this._inner.runGuarded(n,s,c)}runOutsideAngular(n){return this._outer.run(n)}}const pf={};function mf(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Vh(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function y4(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function gf(t){t._nesting--,mf(t)}class lh{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ea,this.onMicrotaskEmpty=new Ea,this.onStable=new Ea,this.onError=new Ea}run(n,s,c){return n.apply(s,c)}runGuarded(n,s,c){return n.apply(s,c)}runOutsideAngular(n){return n()}runTask(n,s,c,f){return n.apply(s,c)}}var Gd=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Gd||{});const _6={destroy(){}};function y6(t,n){!n&&ei();const s=n?.injector??xr(hl);if(!function nl(t){return"browser"===(t??xr(hl)).get(ed)}(s))return _6;Qc("NgAfterNextRender");const c=s.get(vf),f=c.handler??=new b6,_=n?.phase??Gd.MixedReadWrite,E=()=>{f.unregister(H),A()},A=s.get(Gu).onDestroy(E),H=Ce(s,()=>new x6(_,()=>{E(),t()}));return f.register(H),{destroy:E}}class x6{constructor(n,s){this.phase=n,this.callbackFn=s,this.zone=xr(Vs),this.errorHandler=xr(ac,{optional:!0}),xr(Ra,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(n){this.errorHandler?.handleError(n)}}}class b6{constructor(){this.executingCallbacks=!1,this.buckets={[Gd.EarlyRead]:new Set,[Gd.Write]:new Set,[Gd.MixedReadWrite]:new Set,[Gd.Read]:new Set},this.deferredCallbacks=new Set}register(n){(this.executingCallbacks?this.deferredCallbacks:this.buckets[n.phase]).add(n)}unregister(n){this.buckets[n.phase].delete(n),this.deferredCallbacks.delete(n)}execute(){this.executingCallbacks=!0;for(const n of Object.values(this.buckets))for(const s of n)s.invoke();this.executingCallbacks=!1;for(const n of this.deferredCallbacks)this.buckets[n.phase].add(n);this.deferredCallbacks.clear()}destroy(){for(const n of Object.values(this.buckets))n.clear();this.deferredCallbacks.clear()}}let vf=(()=>{class t{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){const s=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const c of s)c()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static{this.\u0275prov=Xi({token:t,providedIn:"root",factory:()=>new t})}}return t})();function D1(t){return!!Es(t)}function K3(t,n,s){let c=s?t.styles:null,f=s?t.classes:null,_=0;if(null!==n)for(let E=0;E<n.length;E++){const A=n[E];"number"==typeof A?_=A:1==_?f=dt(f,A):2==_&&(c=dt(c,A+": "+n[++E]+";"))}s?t.styles=c:t.stylesWithoutHost=c,s?t.classes=f:t.classesWithoutHost=f}class E6 extends Ou{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const s=Gr(n);return new xf(s,this.ngModule)}}function C6(t){const n=[];for(const s in t){if(!t.hasOwnProperty(s))continue;const c=t[s];void 0!==c&&n.push({propName:Array.isArray(c)?c[0]:c,templateName:s})}return n}class q3{constructor(n,s){this.injector=n,this.parentInjector=s}get(n,s,c){c=aa(c);const f=this.injector.get(n,$d,c);return f!==$d||s===$d?f:this.parentInjector.get(n,s,c)}}class xf extends Rl{get inputs(){const n=this.componentDef,s=n.inputTransforms,c=C6(n.inputs);if(null!==s)for(const f of c)s.hasOwnProperty(f.propName)&&(f.transform=s[f.propName]);return c}get outputs(){return C6(this.componentDef.outputs)}constructor(n,s){super(),this.componentDef=n,this.ngModule=s,this.componentType=n.type,this.selector=function Us(t){return t.map(Ja).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!s}create(n,s,c,f){const _=ve(null);try{let E=(f=f||this.ngModule)instanceof cr?f:f?.injector;E&&null!==this.componentDef.getStandaloneInjector&&(E=this.componentDef.getStandaloneInjector(E)||E);const A=E?new q3(n,E):n,H=A.get(df,null);if(null===H)throw new jt(407,!1);const ce=A.get(Y3,null),qt={rendererFactory:H,sanitizer:ce,inlineEffectRunner:null,afterRenderEventManager:A.get(vf,null),changeDetectionScheduler:A.get(Ra,null)},rn=H.createRenderer(null,this.componentDef),yn=this.componentDef.selectors[0][0]||"div",Jn=c?function L3(t,n,s,c){const _=c.get(o1,!1)||s===ko.ShadowDom,E=t.selectRootElement(n,_);return function R3(t){G2(t)}(E),E}(rn,c,this.componentDef.encapsulation,A):eh(rn,yn,function n7(t){const n=t.toLowerCase();return"svg"===n?qe:"math"===n?"math":null}(yn));let wi=512;this.componentDef.signals?wi|=4096:this.componentDef.onPush||(wi|=16);let Ki=null;null!==Jn&&(Ki=wh(Jn,A,!0));const mi=Id(0,null,null,1,0,null,null,null,null,null,null),ro=rh(null,mi,null,wi,null,null,qt,rn,A,null,Ki);let us,Ks;$s(ro);try{const Vl=this.componentDef;let Hc,$4=null;Vl.findHostDirectiveDefs?(Hc=[],$4=new Map,Vl.findHostDirectiveDefs(Vl,Hc,$4),Hc.push(Vl)):Hc=[Vl];const qv=function r7(t,n){const s=t[In],c=kr;return t[c]=n,hu(s,c,2,"#host",null)}(ro,Jn),pw=function o7(t,n,s,c,f,_,E){const A=f[In];!function s7(t,n,s,c){for(const f of t)n.mergedAttrs=xa(n.mergedAttrs,f.hostAttrs);null!==n.mergedAttrs&&(K3(n,n.mergedAttrs,!0),null!==s&&j2(c,s,n))}(c,t,n,E);let H=null;null!==n&&(H=wh(n,f[_o]));const ce=_.rendererFactory.createRenderer(n,s);let Re=16;s.signals?Re=4096:s.onPush&&(Re=64);const ct=rh(f,zd(s),null,Re,f[t.index],t,_,ce,null,null,H);return A.firstCreatePass&&Ld(A,t,c.length-1),Rd(f,ct),f[t.index]=ct}(qv,Jn,Vl,Hc,ro,qt,rn);Ks=fn(mi,kr),Jn&&function l7(t,n,s,c){if(c)Ba(t,s,["ng-version","17.3.12"]);else{const{attrs:f,classes:_}=function Bl(t){const n=[],s=[];let c=1,f=2;for(;c<t.length;){let _=t[c];if("string"==typeof _)2===f?""!==_&&n.push(_,t[++c]):8===f&&s.push(_);else{if(!K(f))break;f=_}c++}return{attrs:n,classes:s}}(n.selectors[0]);f&&Ba(t,s,f),_&&_.length>0&&s4(t,s,_.join(" "))}}(rn,Vl,Jn,c),void 0!==s&&function c7(t,n,s){const c=t.projection=[];for(let f=0;f<n.length;f++){const _=s[f];c.push(null!=_?Array.from(_):null)}}(Ks,this.ngContentSelectors,s),us=function a7(t,n,s,c,f,_){const E=So(),A=f[In],H=cn(E,f);du(A,f,E,s,null,c);for(let Re=0;Re<s.length;Re++)Al(Yu(f,A,E.directiveStart+Re,E),f);p4(A,f,E),H&&Al(H,f);const ce=Yu(f,A,E.directiveStart+E.componentOffset,E);if(t[Nr]=f[Nr]=ce,null!==_)for(const Re of _)Re(ce,n);return M1(A,E,f),ce}(pw,Vl,Hc,$4,ro,[u7]),sh(mi,ro,null)}finally{Ql()}return new i7(this.componentType,us,Po(Ks,ro),ro,Ks)}finally{ve(_)}}}class i7 extends il{constructor(n,s,c,f,_){super(),this.location=c,this._rootLView=f,this._tNode=_,this.previousInputValues=null,this.instance=s,this.hostView=this.changeDetectorRef=new w(f,void 0,!1),this.componentType=n}setInput(n,s){const c=this._tNode.inputs;let f;if(null!==c&&(f=c[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),s))return;const _=this._rootLView;cc(_[In],_,f,n,s),this.previousInputValues.set(n,s),x(gn(this._tNode.index,_))}}get injector(){return new Oa(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function u7(){const t=So();Cl(Mn()[In],t)}let Z3=(()=>{class t{static{this.__NG_ELEMENT_ID__=h7}}return t})();function h7(){return S6(So(),Mn())}const d7=Z3,T6=class extends d7{constructor(n,s,c){super(),this._lContainer=n,this._hostTNode=s,this._hostLView=c}get element(){return Po(this._hostTNode,this._hostLView)}get injector(){return new Oa(this._hostTNode,this._hostLView)}get parentInjector(){const n=N1(this._hostTNode,this._hostLView);if(gu(n)){const s=dh(n,this._hostLView),c=sc(n);return new Oa(s[In].data[c+8],s)}return new Oa(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const s=D6(this._lContainer);return null!==s&&s[n]||null}get length(){return this._lContainer.length-Rs}createEmbeddedView(n,s,c){let f,_;"number"==typeof c?f=c:null!=c&&(f=c.index,_=c.injector);const A=n.createEmbeddedViewImpl(s||{},_,null);return this.insertImpl(A,f,Lh(this._hostTNode,null)),A}createComponent(n,s,c,f,_){const E=n&&!function tn(t){return"function"==typeof t}(n);let A;if(E)A=s;else{const yn=s||{};A=yn.index,c=yn.injector,f=yn.projectableNodes,_=yn.environmentInjector||yn.ngModuleRef}const H=E?n:new xf(Gr(n)),ce=c||this.parentInjector;if(!_&&null==H.ngModule){const Jn=(E?ce:this.parentInjector).get(cr,null);Jn&&(_=Jn)}Gr(H.componentType??{});const rn=H.create(ce,f,null,_);return this.insertImpl(rn.hostView,A,Lh(this._hostTNode,null)),rn}insert(n,s){return this.insertImpl(n,s,!0)}insertImpl(n,s,c){const f=n._lView;if(function Hn(t){return wa(t[Tr])}(f)){const A=this.indexOf(n);if(-1!==A)this.detach(A);else{const H=f[Tr],ce=new T6(H,H[ho],H[Tr]);ce.detach(ce.indexOf(n))}}const _=this._adjustIndex(s),E=this._lContainer;return Rh(E,f,_,c),n.attachToViewContainerRef(),ya(q8(E),_,n),n}move(n,s){return this.insert(n,s)}indexOf(n){const s=D6(this._lContainer);return null!==s?s.indexOf(n):-1}remove(n){const s=this._adjustIndex(n,-1),c=y1(this._lContainer,s);c&&(br(q8(this._lContainer),s),au(c[In],c))}detach(n){const s=this._adjustIndex(n,-1),c=y1(this._lContainer,s);return c&&null!=br(q8(this._lContainer),s)?new w(c):null}_adjustIndex(n,s=0){return n??this.length+s}};function D6(t){return t[8]}function q8(t){return t[8]||(t[8]=[])}function S6(t,n){let s;const c=n[t.index];return wa(c)?s=c:(s=tf(c,n,null,t),n[t.index]=s,Rd(n,s)),A6(s,n,t,c),new T6(s,t,n)}let A6=function z6(t,n,s,c){if(t[No])return;let f;f=8&s.type?Ot(c):function f7(t,n){const s=t[Ir],c=s.createComment(""),f=cn(n,t);return lu(s,x1(s,f),c,function Td(t,n){return t.nextSibling(n)}(s,f),!1),c}(n,s),t[No]=f},Z8=()=>!1;class X8{constructor(n){this.queryList=n,this.matches=null}clone(){return new X8(this.queryList)}setDirty(){this.queryList.setDirty()}}class Q8{constructor(n=[]){this.queries=n}createEmbeddedView(n){const s=n.queries;if(null!==s){const c=null!==n.contentQueries?n.contentQueries[0]:s.length,f=[];for(let _=0;_<c;_++){const E=s.getByIndex(_);f.push(this.queries[E.indexInDeclarationView].clone())}return new Q8(f)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}finishViewCreation(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let s=0;s<this.queries.length;s++)null!==ip(n,s).matches&&this.queries[s].setDirty()}}class I6{constructor(n,s,c=null){this.flags=s,this.read=c,this.predicate="string"==typeof n?function b7(t){return t.split(",").map(n=>n.trim())}(n):n}}class J8{constructor(n=[]){this.queries=n}elementStart(n,s){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(n,s)}elementEnd(n){for(let s=0;s<this.queries.length;s++)this.queries[s].elementEnd(n)}embeddedTView(n){let s=null;for(let c=0;c<this.length;c++){const f=null!==s?s.length:0,_=this.getByIndex(c).embeddedTView(n,f);_&&(_.indexInDeclarationView=c,null!==s?s.push(_):s=[_])}return null!==s?new J8(s):null}template(n,s){for(let c=0;c<this.queries.length;c++)this.queries[c].template(n,s)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class ep{constructor(n,s=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=s}elementStart(n,s){this.isApplyingToNode(s)&&this.matchTNode(n,s)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,s){this.elementStart(n,s)}embeddedTView(n,s){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,s),new ep(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1&~this.metadata.flags){const s=this._declarationNodeIndex;let c=n.parent;for(;null!==c&&8&c.type&&c.index!==s;)c=c.parent;return s===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(n,s){const c=this.metadata.predicate;if(Array.isArray(c))for(let f=0;f<c.length;f++){const _=c[f];this.matchTNodeWithReadOption(n,s,v7(s,_)),this.matchTNodeWithReadOption(n,s,$h(s,n,_,!1,!1))}else c===T?4&s.type&&this.matchTNodeWithReadOption(n,s,-1):this.matchTNodeWithReadOption(n,s,$h(s,n,c,!1,!1))}matchTNodeWithReadOption(n,s,c){if(null!==c){const f=this.metadata.read;if(null!==f)if(f===Wu||f===Z3||f===T&&4&s.type)this.addMatch(s.index,-2);else{const _=$h(s,n,f,!1,!1);null!==_&&this.addMatch(s.index,_)}else this.addMatch(s.index,c)}}addMatch(n,s){null===this.matches?this.matches=[n,s]:this.matches.push(n,s)}}function v7(t,n){const s=t.localNames;if(null!==s)for(let c=0;c<s.length;c+=2)if(s[c]===n)return s[c+1];return null}function y7(t,n,s,c){return-1===s?function _7(t,n){return 11&t.type?Po(t,n):4&t.type?j(t,n):null}(n,t):-2===s?function x7(t,n,s){return s===Wu?Po(n,t):s===T?j(n,t):s===Z3?S6(n,t):void 0}(t,n,c):Yu(t,t[In],s,n)}function k6(t,n,s,c){const f=n[ul].queries[c];if(null===f.matches){const _=t.data,E=s.matches,A=[];for(let H=0;null!==E&&H<E.length;H+=2){const ce=E[H];A.push(ce<0?null:y7(n,_[ce],E[H+1],s.metadata.read))}f.matches=A}return f.matches}function tp(t,n,s,c){const f=t.queries.getByIndex(s),_=f.matches;if(null!==_){const E=k6(t,n,f,s);for(let A=0;A<_.length;A+=2){const H=_[A];if(H>0)c.push(E[A/2]);else{const ce=_[A+1],Re=n[-H];for(let ct=Rs;ct<Re.length;ct++){const qt=Re[ct];qt[jl]===qt[Tr]&&tp(qt[In],qt,ce,c)}if(null!==Re[pc]){const ct=Re[pc];for(let qt=0;qt<ct.length;qt++){const rn=ct[qt];tp(rn[In],rn,ce,c)}}}}}return c}function O6(t,n,s){const c=new qh(!(4&~s));return function N3(t,n,s,c){const f=Fd(n);f.push(s),t.firstCreatePass&&Nc(t).push(c,f.length-1)}(t,n,c,c.destroy),(n[ul]??=new Q8).queries.push(new X8(c))-1}function F6(t,n,s){null===t.queries&&(t.queries=new J8),t.queries.track(new ep(n,s))}function ip(t,n){return t.queries.getByIndex(n)}function N6(t,n){const s=t[In],c=ip(s,n);return c.crossesNgTemplate?tp(s,t,n,[]):k6(s,t,c,n)}function rp(t){return"function"==typeof t&&void 0!==t[Fe]}function B6(t){return rp(t)&&"function"==typeof t.set}function sp(t){let n=function X6(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),s=!0;const c=[t];for(;n;){let f;if(da(t))f=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new jt(903,!1);f=n.\u0275dir}if(f){if(s){c.push(f);const E=t;E.inputs=Q3(t.inputs),E.inputTransforms=Q3(t.inputTransforms),E.declaredInputs=Q3(t.declaredInputs),E.outputs=Q3(t.outputs);const A=f.hostBindings;A&&F7(t,A);const H=f.viewQuery,ce=f.contentQueries;if(H&&L7(t,H),ce&&R7(t,ce),k7(t,f),Pe(t.outputs,f.outputs),da(f)&&f.data.animation){const Re=t.data;Re.animation=(Re.animation||[]).concat(f.data.animation)}}const _=f.features;if(_)for(let E=0;E<_.length;E++){const A=_[E];A&&A.ngInherit&&A(t),A===sp&&(s=!1)}}n=Object.getPrototypeOf(n)}!function O7(t){let n=0,s=null;for(let c=t.length-1;c>=0;c--){const f=t[c];f.hostVars=n+=f.hostVars,f.hostAttrs=xa(f.hostAttrs,s=xa(s,f.hostAttrs))}}(c)}function k7(t,n){for(const s in n.inputs){if(!n.inputs.hasOwnProperty(s)||t.inputs.hasOwnProperty(s))continue;const c=n.inputs[s];if(void 0!==c&&(t.inputs[s]=c,t.declaredInputs[s]=n.declaredInputs[s],null!==n.inputTransforms)){const f=Array.isArray(c)?c[0]:c;if(!n.inputTransforms.hasOwnProperty(f))continue;t.inputTransforms??={},t.inputTransforms[f]=n.inputTransforms[f]}}}function Q3(t){return t===Eo?{}:t===Kr?[]:t}function L7(t,n){const s=t.viewQuery;t.viewQuery=s?(c,f)=>{n(c,f),s(c,f)}:n}function R7(t,n){const s=t.contentQueries;t.contentQueries=s?(c,f,_)=>{n(c,f,_),s(c,f,_)}:n}function F7(t,n){const s=t.hostBindings;t.hostBindings=s?(c,f)=>{n(c,f),s(c,f)}:n}function tm(t){const n=t.inputConfig,s={};for(const c in n)if(n.hasOwnProperty(c)){const f=n[c];Array.isArray(f)&&f[3]&&(s[c]=f[3])}t.inputTransforms=s}class Wd{}class nm{}function j7(t,n){return new ap(t,n??null,[])}class ap extends Wd{constructor(n,s,c){super(),this._parent=s,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new E6(this);const f=Es(n);this._bootstrapComponents=tc(f.bootstrap),this._r3Injector=U1(n,s,[{provide:Wd,useValue:this},{provide:Ou,useValue:this.componentFactoryResolver},...c],Se(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(s=>s()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class lp extends nm{constructor(n){super(),this.moduleType=n}create(n){return new ap(this.moduleType,n,[])}}class im extends Wd{constructor(n){super(),this.componentFactoryResolver=new E6(this),this.instance=null;const s=new ir([...n.providers,{provide:Wd,useValue:this},{provide:Ou,useValue:this.componentFactoryResolver}],n.parent||$r(),n.debugName,new Set(["environment"]));this.injector=s,n.runEnvironmentInitializers&&s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function cp(t,n,s=null){return new im({providers:t,parent:n,debugName:s,runEnvironmentInitializers:!0}).injector}let b4=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Br.t(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const s=this.taskId++;return this.pendingTasks.add(s),s}remove(s){this.pendingTasks.delete(s),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275fac=function(c){return new(c||t)}}static{this.\u0275prov=Xi({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function e8(t){return!!up(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function up(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function ch(t,n,s){return t[n]=s}function fl(t,n,s){return!Object.is(t[n],s)&&(t[n]=s,!0)}function Kd(t,n,s,c){const f=fl(t,n,s);return fl(t,n+1,c)||f}function w4(t,n,s,c,f,_,E,A){const H=Mn(),ce=Vr(),Re=t+kr,ct=ce.firstCreatePass?function Z7(t,n,s,c,f,_,E,A,H){const ce=n.consts,Re=hu(n,t,4,E||null,ri(ce,A));Sc(n,s,Re,ri(ce,H)),Cl(n,Re);const ct=Re.tView=Id(2,Re,c,f,_,n.directiveRegistry,n.pipeRegistry,null,n.schemas,ce,null);return null!==n.queries&&(n.queries.template(n,Re),ct.queries=n.queries.embeddedTView(Re)),Re}(Re,ce,H,n,s,c,f,_,E):ce.data[Re];F(ct,!1);const qt=rm(ce,H,ct,t);dr()&&Rc(ce,H,qt,ct),Al(qt,H);const rn=tf(qt,H,qt,ct);return H[Re]=rn,Rd(H,rn),function P6(t,n,s){return Z8(t,n,s)}(rn,ct,H),ja(ct)&&Kc(ce,H,ct),null!=E&&c4(H,ct,A),w4}let rm=function om(t,n,s,c){return El(!0),n[Ir].createComment("")};function xp(t,n,s,c){const f=Mn();return fl(f,ln(),n)&&(Vr(),Fc(Fs(),f,t,n,s,c)),xp}function P4(t,n,s,c){return fl(t,ln(),s)?n+Zi(s)+c:co}function z4(t,n,s,c,f,_){const A=Kd(t,Gt(),s,f);return Bn(2),A?n+Zi(s)+c+Zi(f)+_:co}function k4(t,n,s,c,f,_,E,A,H,ce){const ct=function fu(t,n,s,c,f,_){const E=Kd(t,n,s,c);return Kd(t,n+2,f,_)||E}(t,Gt(),s,f,E,H);return Bn(4),ct?n+Zi(s)+c+Zi(f)+_+Zi(E)+A+Zi(H)+ce:co}function a8(t,n){return t<<17|n<<2}function P1(t){return t>>17&32767}function bp(t){return 2|t}function Zd(t){return(131068&t)>>2}function wp(t,n){return-131069&t|n<<2}function Mp(t){return 1|t}function Rm(t,n,s,c){const f=t[s+1],_=null===n;let E=c?P1(f):Zd(f),A=!1;for(;0!==E&&(!1===A||_);){const ce=t[E+1];R_(t[E],n)&&(A=!0,t[E+1]=c?Mp(ce):bp(ce)),E=c?P1(ce):Zd(ce)}A&&(t[s+1]=c?bp(f):Mp(f))}function R_(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&ys(t,n)>=0}const Fl={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Fm(t){return t.substring(Fl.key,Fl.keyEnd)}function F_(t){return t.substring(Fl.value,Fl.valueEnd)}function Nm(t,n){const s=Fl.textEnd;return s===n?-1:(n=Fl.keyEnd=function B_(t,n,s){for(;n<s&&t.charCodeAt(n)>32;)n++;return n}(t,Fl.key=n,s),N4(t,n,s))}function Vm(t,n){const s=Fl.textEnd;let c=Fl.key=N4(t,n,s);return s===c?-1:(c=Fl.keyEnd=function H_(t,n,s){let c;for(;n<s&&(45===(c=t.charCodeAt(n))||95===c||(-33&c)>=65&&(-33&c)<=90||c>=48&&c<=57);)n++;return n}(t,c,s),c=Hm(t,c,s),c=Fl.value=N4(t,c,s),c=Fl.valueEnd=function U_(t,n,s){let c=-1,f=-1,_=-1,E=n,A=E;for(;E<s;){const H=t.charCodeAt(E++);if(59===H)return A;34===H||39===H?A=E=Um(t,H,E,s):n===E-4&&85===_&&82===f&&76===c&&40===H?A=E=Um(t,41,E,s):H>32&&(A=E),_=f,f=c,c=-33&H}return A}(t,c,s),Hm(t,c,s))}function Bm(t){Fl.key=0,Fl.keyEnd=0,Fl.value=0,Fl.valueEnd=0,Fl.textEnd=t.length}function N4(t,n,s){for(;n<s&&t.charCodeAt(n)<=32;)n++;return n}function Hm(t,n,s,c){return(n=N4(t,n,s))<s&&n++,n}function Um(t,n,s,c){let f=-1,_=s;for(;_<c;){const E=t.charCodeAt(_++);if(E==n&&92!==f)return _;f=92==E&&92===f?0:E}throw new Error}function Ep(t,n,s){const c=Mn();return fl(c,ln(),n)&&Wl(Vr(),Fs(),c,t,n,c[Ir],s,!1),Ep}function Cp(t,n,s,c,f){const E=f?"class":"style";cc(t,s,n.inputs[E],E,c)}function Tp(t,n,s){return Ru(t,n,s,!1),Tp}function Dp(t,n){return Ru(t,n,null,!0),Dp}function Lu(t){Fu(Gm,j_,t,!1)}function j_(t,n){for(let s=function V_(t){return Bm(t),Vm(t,N4(t,0,Fl.textEnd))}(n);s>=0;s=Vm(n,s))Gm(t,Fm(n),F_(n))}function jm(t){Fu(q_,uh,t,!0)}function uh(t,n){for(let s=function N_(t){return Bm(t),Nm(t,N4(t,0,Fl.textEnd))}(n);s>=0;s=Nm(n,s))Lo(t,Fm(n),!0)}function Ru(t,n,s,c){const f=Mn(),_=Vr(),E=Bn(2);_.firstUpdatePass&&$m(_,t,E,c),n!==co&&fl(f,E,n)&&Wm(_,_.data[Ol()],f,f[Ir],t,f[E+1]=function X_(t,n){return null==t||""===t||("string"==typeof n?t+=n:"object"==typeof t&&(t=Se(Ec(t)))),t}(n,s),c,E)}function Fu(t,n,s,c){const f=Vr(),_=Bn(2);f.firstUpdatePass&&$m(f,null,_,c);const E=Mn();if(s!==co&&fl(E,_,s)){const A=f.data[Ol()];if(qm(A,c)&&!Ym(f,_)){let H=c?A.classesWithoutHost:A.stylesWithoutHost;null!==H&&(s=dt(H,s||"")),Cp(f,A,E,s,c)}else!function Z_(t,n,s,c,f,_,E,A){f===co&&(f=Kr);let H=0,ce=0,Re=0<f.length?f[0]:null,ct=0<_.length?_[0]:null;for(;null!==Re||null!==ct;){const qt=H<f.length?f[H+1]:void 0,rn=ce<_.length?_[ce+1]:void 0;let Jn,yn=null;Re===ct?(H+=2,ce+=2,qt!==rn&&(yn=ct,Jn=rn)):null===ct||null!==Re&&Re<ct?(H+=2,yn=Re):(ce+=2,yn=ct,Jn=rn),null!==yn&&Wm(t,n,s,c,yn,Jn,E,A),Re=H<f.length?f[H]:null,ct=ce<_.length?_[ce]:null}}(f,A,E,E[Ir],E[_+1],E[_+1]=function K_(t,n,s){if(null==s||""===s)return Kr;const c=[],f=Ec(s);if(Array.isArray(f))for(let _=0;_<f.length;_++)t(c,f[_],!0);else if("object"==typeof f)for(const _ in f)f.hasOwnProperty(_)&&t(c,_,f[_]);else"string"==typeof f&&n(c,f);return c}(t,n,s),c,_)}}function Ym(t,n){return n>=t.expandoStartIndex}function $m(t,n,s,c){const f=t.data;if(null===f[s+1]){const _=f[Ol()],E=Ym(t,s);qm(_,c)&&null===n&&!E&&(n=!1),n=function Y_(t,n,s,c){const f=lo(t);let _=c?n.residualClasses:n.residualStyles;if(null===f)0===(c?n.classBindings:n.styleBindings)&&(s=Df(s=Sp(null,t,n,s,c),n.attrs,c),_=null);else{const E=n.directiveStylingLast;if(-1===E||t[E]!==f)if(s=Sp(f,t,n,s,c),null===_){let H=function $_(t,n,s){const c=s?n.classBindings:n.styleBindings;if(0!==Zd(c))return t[P1(c)]}(t,n,c);void 0!==H&&Array.isArray(H)&&(H=Sp(null,t,n,H[1],c),H=Df(H,n.attrs,c),function G_(t,n,s,c){t[P1(s?n.classBindings:n.styleBindings)]=c}(t,n,c,H))}else _=function W_(t,n,s){let c;const f=n.directiveEnd;for(let _=1+n.directiveStylingLast;_<f;_++)c=Df(c,t[_].hostAttrs,s);return Df(c,n.attrs,s)}(t,n,c)}return void 0!==_&&(c?n.residualClasses=_:n.residualStyles=_),s}(f,_,n,c),function O_(t,n,s,c,f,_){let E=_?n.classBindings:n.styleBindings,A=P1(E),H=Zd(E);t[c]=s;let Re,ce=!1;if(Array.isArray(s)?(Re=s[1],(null===Re||ys(s,Re)>0)&&(ce=!0)):Re=s,f)if(0!==H){const qt=P1(t[A+1]);t[c+1]=a8(qt,A),0!==qt&&(t[qt+1]=wp(t[qt+1],c)),t[A+1]=function I_(t,n){return 131071&t|n<<17}(t[A+1],c)}else t[c+1]=a8(A,0),0!==A&&(t[A+1]=wp(t[A+1],c)),A=c;else t[c+1]=a8(H,0),0===A?A=c:t[H+1]=wp(t[H+1],c),H=c;ce&&(t[c+1]=bp(t[c+1])),Rm(t,Re,c,!0),Rm(t,Re,c,!1),function L_(t,n,s,c,f){const _=f?t.residualClasses:t.residualStyles;null!=_&&"string"==typeof n&&ys(_,n)>=0&&(s[c+1]=Mp(s[c+1]))}(n,Re,t,c,_),E=a8(A,H),_?n.classBindings=E:n.styleBindings=E}(f,_,n,s,E,c)}}function Sp(t,n,s,c,f){let _=null;const E=s.directiveEnd;let A=s.directiveStylingLast;for(-1===A?A=s.directiveStart:A++;A<E&&(_=n[A],c=Df(c,_.hostAttrs,f),_!==t);)A++;return null!==t&&(s.directiveStylingLast=A),c}function Df(t,n,s){const c=s?1:2;let f=-1;if(null!==n)for(let _=0;_<n.length;_++){const E=n[_];"number"==typeof E?f=E:f===c&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Lo(t,E,!!s||n[++_]))}return void 0===t?null:t}function Gm(t,n,s){Lo(t,n,Ec(s))}function q_(t,n,s){const c=String(n);""!==c&&!c.includes(" ")&&Lo(t,c,s)}function Wm(t,n,s,c,f,_,E,A){if(!(3&n.type))return;const H=t.data,ce=H[A+1],Re=function k_(t){return!(1&~t)}(ce)?Km(H,n,s,f,Zd(ce),E):void 0;l8(Re)||(l8(_)||function z_(t){return!(2&~t)}(ce)&&(_=Km(H,null,s,f,A,E)),function k3(t,n,s,c,f){if(n)f?t.addClass(s,c):t.removeClass(s,c);else{let _=-1===c.indexOf("-")?void 0:Su.DashCase;null==f?t.removeStyle(s,c,_):("string"==typeof f&&f.endsWith("!important")&&(f=f.slice(0,-10),_|=Su.Important),t.setStyle(s,c,f,_))}}(c,E,Zt(Ol(),s),f,_))}function Km(t,n,s,c,f,_){const E=null===n;let A;for(;f>0;){const H=t[f],ce=Array.isArray(H),Re=ce?H[1]:H,ct=null===Re;let qt=s[f+1];qt===co&&(qt=ct?Kr:void 0);let rn=ct?ks(qt,c):Re===c?qt:void 0;if(ce&&!l8(rn)&&(rn=ks(H,c)),l8(rn)&&(A=rn,E))return A;const yn=t[f+1];f=E?P1(yn):Zd(yn)}if(null!==n){let H=_?n.residualClasses:n.residualStyles;null!=H&&(A=ks(H,c))}return A}function l8(t){return void 0!==t}function qm(t,n){return!!(t.flags&(n?8:16))}function Zm(t,n,s){Fu(Lo,uh,P4(Mn(),t,n,s),!0)}function Xm(t,n,s,c,f){Fu(Lo,uh,z4(Mn(),t,n,s,c,f),!0)}function Qm(t,n,s,c,f,_,E,A,H){Fu(Lo,uh,k4(Mn(),t,n,s,c,f,_,E,A,H),!0)}function c8(t,n,s,c){const f=Mn(),_=Vr(),E=kr+t,A=f[Ir],H=_.firstCreatePass?function vy(t,n,s,c,f,_){const E=n.consts,H=hu(n,t,2,c,ri(E,f));return Sc(n,s,H,ri(E,_)),null!==H.attrs&&K3(H,H.attrs,!1),null!==H.mergedAttrs&&K3(H,H.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,H),H}(E,_,f,n,s,c):_.data[E],ce=ng(_,f,H,A,n,t);f[E]=ce;const Re=ja(H);return F(H,!0),j2(A,ce,H),!function Mf(t){return!(32&~t.flags)}(H)&&dr()&&Rc(_,f,ce,H),0===function Co(){return Wi.lFrame.elementDepthCount}()&&Al(ce,f),function Ya(){Wi.lFrame.elementDepthCount++}(),Re&&(Kc(_,f,H),M1(_,H,f)),null!==c&&c4(f,H),c8}function u8(){let t=So();oe()?ne():(t=t.parent,F(t,!1));const n=t;(function ds(t){return Wi.skipHydrationRootTNode===t})(n)&&function Ys(){Wi.skipHydrationRootTNode=null}(),function Ma(){Wi.lFrame.elementDepthCount--}();const s=Vr();return s.firstCreatePass&&(Cl(s,t),Pc(t)&&s.queries.elementEnd(t)),null!=n.classesWithoutHost&&function Hf(t){return!!(8&t.flags)}(n)&&Cp(s,n,Mn(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function t0(t){return!!(16&t.flags)}(n)&&Cp(s,n,Mn(),n.stylesWithoutHost,!1),u8}function kp(t,n,s,c){return c8(t,n,s,c),u8(),kp}let ng=(t,n,s,c,f,_)=>(El(!0),eh(c,f,function W4(){return Wi.lFrame.currentNamespace}()));function h8(t,n,s){const c=Mn(),f=Vr(),_=t+kr,E=f.firstCreatePass?function xy(t,n,s,c,f){const _=n.consts,E=ri(_,c),A=hu(n,t,8,"ng-container",E);return null!==E&&K3(A,E,!0),Sc(n,s,A,ri(_,f)),null!==n.queries&&n.queries.elementStart(n,A),A}(_,f,c,n,s):f.data[_];F(E,!0);const A=ig(f,c,E,t);return c[_]=A,dr()&&Rc(f,c,A,E),Al(A,c),ja(E)&&(Kc(f,c,E),M1(f,E,c)),null!=s&&c4(c,E),h8}function d8(){let t=So();const n=Vr();return oe()?ne():(t=t.parent,F(t,!1)),n.firstCreatePass&&(Cl(n,t),Pc(t)&&n.queries.elementEnd(t)),d8}function Op(t,n,s){return h8(t,n,s),d8(),Op}let ig=(t,n,s,c)=>(El(!0),Md(n[Ir],""));function rg(){return Mn()}function Lp(t,n,s){const c=Mn();if(fl(c,ln(),n)){const _=Vr(),E=Fs();Wl(_,E,c,t,n,Nd(lo(_.data),E,c),s,!0)}return Lp}const Xd=void 0;var Ey=["en",[["a","p"],["AM","PM"],Xd],[["AM","PM"],Xd,Xd],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Xd,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Xd,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Xd,"{1} 'at' {0}",Xd],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function My(t){const s=Math.floor(Math.abs(t)),c=t.toString().replace(/^[^.]*\.?/,"").length;return 1===s&&0===c?1:5}];let V4={};function Cy(t,n,s){"string"!=typeof n&&(s=n,n=t[B4.LocaleId]),n=n.toLowerCase().replace(/_/g,"-"),V4[n]=t,s&&(V4[n][B4.ExtraData]=s)}function Rp(t){const n=function Ty(t){return t.toLowerCase().replace(/_/g,"-")}(t);let s=ag(n);if(s)return s;const c=n.split("-")[0];if(s=ag(c),s)return s;if("en"===c)return Ey;throw new jt(701,!1)}function sg(t){return Rp(t)[B4.PluralCase]}function ag(t){return t in V4||(V4[t]=ti.ng&&ti.ng.common&&ti.ng.common.locales&&ti.ng.common.locales[t]),V4[t]}var B4=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(B4||{});const H4="en-US";let lg=H4;function Vp(t,n,s,c){const f=Mn(),_=Vr(),E=So();return Hp(_,f,f[Ir],E,t,n,c),Vp}function Bp(t,n){const s=So(),c=Mn(),f=Vr();return Hp(f,c,Nd(lo(f.data),s,c),s,t,n),Bp}function Hp(t,n,s,c,f,_,E){const A=ja(c),ce=t.firstCreatePass&&Nc(t),Re=n[Nr],ct=Fd(n);let qt=!0;if(3&c.type||E){const Jn=cn(c,n),wi=E?E(Jn):Jn,Ki=ct.length,mi=E?us=>E(Ot(us[c.index])):c.index;let ro=null;if(!E&&A&&(ro=function w9(t,n,s,c){const f=t.cleanup;if(null!=f)for(let _=0;_<f.length-1;_+=2){const E=f[_];if(E===s&&f[_+1]===c){const A=n[ba],H=f[_+2];return A.length>H?A[H]:null}"string"==typeof E&&(_+=2)}return null}(t,n,f,c.index)),null!==ro)(ro.__ngLastListenerFn__||ro).__ngNextListenerFn__=_,ro.__ngLastListenerFn__=_,qt=!1;else{_=Lg(c,n,Re,_,!1);const us=s.listen(wi,f,_);ct.push(_,us),ce&&ce.push(f,mi,Ki,Ki+1)}}else _=Lg(c,n,Re,_,!1);const rn=c.outputs;let yn;if(qt&&null!==rn&&(yn=rn[f])){const Jn=yn.length;if(Jn)for(let wi=0;wi<Jn;wi+=2){const Ks=n[yn[wi]][yn[wi+1]].subscribe(_),Vl=ct.length;ct.push(_,Ks),ce&&ce.push(f,c.index,Vl,-(Vl+1))}}}function Og(t,n,s,c){const f=ve(null);try{return Ee(6,n,s),!1!==s(c)}catch(_){return kh(t,_),!1}finally{Ee(7,n,s),ve(f)}}function Lg(t,n,s,c,f){return function _(E){if(E===Function)return c;x(t.componentOffset>-1?gn(t.index,n):n);let H=Og(n,s,c,E),ce=_.__ngNextListenerFn__;for(;ce;)H=Og(n,s,ce,E)&&H,ce=ce.__ngNextListenerFn__;return f&&!1===H&&E.preventDefault(),H}}function Rg(t=1){return function Jd(t){return(Wi.lFrame.contextLView=function tr(t,n){for(;t>0;)n=n[ka],t--;return n}(t,Wi.lFrame.contextLView))[Nr]}(t)}function M9(t,n){let s=null;const c=function Fi(t){const n=t.attrs;if(null!=n){const s=n.indexOf(5);if(!(1&s))return n[s+1]}return null}(t);for(let f=0;f<n.length;f++){const _=n[f];if("*"!==_){if(null===c?Ht(t,_,!0):ea(c,_))return f}else s=f}return s}function Fg(t){const n=Mn()[ao][ho];if(!n.projection){const c=n.projection=function Fa(t,n){const s=[];for(let c=0;c<t;c++)s.push(n);return s}(t?t.length:1,null),f=c.slice();let _=n.child;for(;null!==_;){const E=t?M9(_,t):0;null!==E&&(f[E]?f[E].projectionNext=_:c[E]=_,f[E]=_),_=_.next}}}function Ng(t,n=0,s){const c=Mn(),f=Vr(),_=hu(f,kr+t,16,null,s||null);null===_.projection&&(_.projection=n),ne(),(!c[ss]||tl())&&32&~_.flags&&function I3(t,n,s){ih(n[Ir],0,n,s,Cd(t,s,n),Dd(s.parent||n[ho],s,n))}(f,c,_)}function Up(t,n,s){return v8(t,"",n,"",s),Up}function v8(t,n,s,c,f){const _=Mn(),E=P4(_,n,s,c);return E!==co&&Wl(Vr(),Fs(),_,t,E,_[Ir],f,!1),v8}function Wg(t,n,s,c){!function R6(t,n,s,c){const f=Vr();if(f.firstCreatePass){const _=So();F6(f,new I6(n,s,c),_.index),function w7(t,n){const s=t.contentQueries||(t.contentQueries=[]);n!==(s.length?s[s.length-1]:-1)&&s.push(t.queries.length-1,n)}(f,t),!(2&~s)&&(f.staticContentQueries=!0)}return O6(f,Mn(),s)}(t,n,s,c)}function Kg(t,n,s){!function L6(t,n,s){const c=Vr();return c.firstCreatePass&&(F6(c,new I6(t,n,s),-1),!(2&~n)&&(c.staticViewQueries=!0)),O6(c,Mn(),n)}(t,n,s)}function qg(t){const n=Mn(),s=Vr(),c=go();Bo(c+1);const f=ip(s,c);if(t.dirty&&function ai(t){return!(4&~t[Ni])}(n)===!(2&~f.metadata.flags)){if(null===f.matches)t.reset([]);else{const _=N6(n,c);t.reset(_,wc),t.notifyOnChanges()}return!0}return!1}function Zg(){return function np(t,n){return t[ul].queries[n].queryList}(Mn(),go())}function Xg(t){return Fn(function Te(){return Wi.lFrame.contextLView}(),kr+t)}function a5(t,n=""){const s=Mn(),c=Vr(),f=t+kr,_=c.firstCreatePass?hu(c,f,1,n,null):c.data[f],E=l5(c,s,_,n,t);s[f]=E,dr()&&Rc(c,s,E,_),F(_,!1)}let l5=(t,n,s,c,f)=>(El(!0),function Pu(t,n){return t.createText(n)}(n[Ir],c));function jp(t){return _8("",t,""),jp}function _8(t,n,s){const c=Mn(),f=P4(c,t,n,s);return f!==co&&Kl(c,Ol(),f),_8}function Yp(t,n,s,c,f){const _=Mn(),E=z4(_,t,n,s,c,f);return E!==co&&Kl(_,Ol(),E),Yp}function $p(t,n,s,c,f,_,E,A,H){const ce=Mn(),Re=k4(ce,t,n,s,c,f,_,E,A,H);return Re!==co&&Kl(ce,Ol(),Re),$p}function Gp(t,n,s){B6(n)&&(n=n());const c=Mn();return fl(c,ln(),n)&&Wl(Vr(),Fs(),c,t,n,c[Ir],s,!1),Gp}function m5(t,n){const s=B6(t);return s&&t.set(n),s}function Wp(t,n){const s=Mn(),c=Vr(),f=So();return Hp(c,s,s[Ir],f,t,n),Wp}function Kp(t,n,s,c,f){if(t=Ie(t),Array.isArray(t))for(let _=0;_<t.length;_++)Kp(t[_],n,s,c,f);else{const _=Vr(),E=Mn(),A=So();let H=Lt(t)?t:Ie(t.provide);const ce=Qo(t),Re=1048575&A.providerIndexes,ct=A.directiveStart,qt=A.providerIndexes>>20;if(Lt(t)||!t.multi){const rn=new Hu(ce,f,zh),yn=Zp(H,n,f?Re:Re+qt,ct);-1===yn?(r0(Yh(A,E),_,H),qp(_,t,n.length),n.push(H),A.directiveStart++,A.directiveEnd++,f&&(A.providerIndexes+=1048576),s.push(rn),E.push(rn)):(s[yn]=rn,E[yn]=rn)}else{const rn=Zp(H,n,Re+qt,ct),yn=Zp(H,n,Re,Re+qt),wi=yn>=0&&s[yn];if(f&&!wi||!f&&!(rn>=0&&s[rn])){r0(Yh(A,E),_,H);const Ki=function U9(t,n,s,c,f){const _=new Hu(t,s,zh);return _.multi=[],_.index=n,_.componentProviders=0,g5(_,f,c&&!s),_}(f?H9:B9,s.length,f,c,ce);!f&&wi&&(s[yn].providerFactory=Ki),qp(_,t,n.length,0),n.push(H),A.directiveStart++,A.directiveEnd++,f&&(A.providerIndexes+=1048576),s.push(Ki),E.push(Ki)}else qp(_,t,rn>-1?rn:yn,g5(s[f?yn:rn],ce,!f&&c));!f&&c&&wi&&s[yn].componentProviders++}}}function qp(t,n,s,c){const f=Lt(n),_=function Kt(t){return!!t.useClass}(n);if(f||_){const H=(_?Ie(n.useClass):n).prototype.ngOnDestroy;if(H){const ce=t.destroyHooks||(t.destroyHooks=[]);if(!f&&n.multi){const Re=ce.indexOf(s);-1===Re?ce.push(s,[c,H]):ce[Re+1].push(c,H)}else ce.push(s,H)}}}function g5(t,n,s){return s&&t.componentProviders++,t.multi.push(n)-1}function Zp(t,n,s,c){for(let f=s;f<c;f++)if(n[f]===t)return f;return-1}function B9(t,n,s,c){return Xp(this.multi,[])}function H9(t,n,s,c){const f=this.multi;let _;if(this.providerFactory){const E=this.providerFactory.componentProviders,A=Yu(s,s[In],this.providerFactory.index,c);_=A.slice(0,E),Xp(f,_);for(let H=E;H<A.length;H++)_.push(A[H])}else _=[],Xp(f,_);return _}function Xp(t,n){for(let s=0;s<t.length;s++)n.push((0,t[s])());return n}function v5(t,n=[]){return s=>{s.providersResolver=(c,f)=>function V9(t,n,s){const c=Vr();if(c.firstCreatePass){const f=da(t);Kp(s,c.data,c.blueprint,f,!0),Kp(n,c.data,c.blueprint,f,!1)}}(c,f?f(t):t,n)}}let j9=(()=>{class t{constructor(s){this._injector=s,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(s){if(!s.standalone)return null;if(!this.cachedInjectors.has(s)){const c=Ls(0,s.type),f=c.length>0?cp([c],this._injector,`Standalone[${s.type.name}]`):null;this.cachedInjectors.set(s,f)}return this.cachedInjectors.get(s)}ngOnDestroy(){try{for(const s of this.cachedInjectors.values())null!==s&&s.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=Xi({token:t,providedIn:"environment",factory:()=>new t(vo(cr))})}}return t})();function _5(t){Qc("NgStandalone"),t.getStandaloneInjector=n=>n.get(j9).getOrCreateStandaloneInjector(t)}function x5(t,n,s){const c=pt()+t,f=Mn();return f[c]===co?ch(f,c,s?n.call(s):n()):function wf(t,n){return t[n]}(f,c)}function b5(t,n,s,c){return M5(Mn(),pt(),t,n,s,c)}function w5(t,n,s,c,f){return E5(Mn(),pt(),t,n,s,c,f)}function Of(t,n){const s=t[n];return s===co?void 0:s}function M5(t,n,s,c,f,_){const E=n+s;return fl(t,E,f)?ch(t,E+1,_?c.call(_,f):c(f)):Of(t,E+1)}function E5(t,n,s,c,f,_,E){const A=n+s;return Kd(t,A,f,_)?ch(t,A+2,E?c.call(E,f,_):c(f,_)):Of(t,A+2)}function C5(t,n,s,c,f,_,E,A){const H=n+s;return function t8(t,n,s,c,f){const _=Kd(t,n,s,c);return fl(t,n+2,f)||_}(t,H,f,_,E)?ch(t,H+3,A?c.call(A,f,_,E):c(f,_,E)):Of(t,H+3)}function S5(t,n){const s=Vr();let c;const f=t+kr;s.firstCreatePass?(c=function J9(t,n){if(n)for(let s=n.length-1;s>=0;s--){const c=n[s];if(t===c.name)return c}}(n,s.pipeRegistry),s.data[f]=c,c.onDestroy&&(s.destroyHooks??=[]).push(f,c.onDestroy)):c=s.data[f];const _=c.factory||(c.factory=ca(c.type)),A=Rr(zh);try{const H=vu(!1),ce=_();return vu(H),function D9(t,n,s,c){s>=t.data.length&&(t.data[s]=null,t.blueprint[s]=null),n[s]=c}(s,Mn(),f,ce),ce}finally{Rr(A)}}function A5(t,n,s){const c=t+kr,f=Mn(),_=Fn(f,c);return Lf(f,c)?M5(f,pt(),n,_.transform,s,_):_.transform(s)}function P5(t,n,s,c){const f=t+kr,_=Mn(),E=Fn(_,f);return Lf(_,f)?E5(_,pt(),n,E.transform,s,c,E):E.transform(s,c)}function z5(t,n,s,c,f){const _=t+kr,E=Mn(),A=Fn(E,_);return Lf(E,_)?C5(E,pt(),n,A.transform,s,c,f,A):A.transform(s,c,f)}function Lf(t,n){return t[In].data[n].pure}function I5(t,n){return j(t,n)}class K5{constructor(n){this.full=n;const s=n.split(".");this.major=s[0],this.minor=s[1],this.patch=s.slice(2).join(".")}}let q5=(()=>{class t{log(s){console.log(s)}warn(s){console.warn(s)}static{this.\u0275fac=function(c){return new(c||t)}}static{this.\u0275prov=Xi({token:t,factory:t.\u0275fac,providedIn:"platform"})}}return t})();const ev=new xn(""),tv=new xn("");let i6,Kx=(()=>{class t{constructor(s,c,f){this._ngZone=s,this.registry=c,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,i6||(function qx(t){i6=t}(f),f.addToWindow(c)),this._watchAngularEvents(),s.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Vs.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let s=this._callbacks.pop();clearTimeout(s.timeoutId),s.doneCb()}});else{let s=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(s)||(clearTimeout(c.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(s=>({source:s.source,creationLocation:s.creationLocation,data:s.data})):[]}addCallback(s,c,f){let _=-1;c&&c>0&&(_=setTimeout(()=>{this._callbacks=this._callbacks.filter(E=>E.timeoutId!==_),s()},c)),this._callbacks.push({doneCb:s,timeoutId:_,updateCb:f})}whenStable(s,c,f){if(f&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(s,c,f),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(s){this.registry.registerApplication(s,this)}unregisterApplication(s){this.registry.unregisterApplication(s)}findProviders(s,c,f){return[]}static{this.\u0275fac=function(c){return new(c||t)(vo(Vs),vo(nv),vo(tv))}}static{this.\u0275prov=Xi({token:t,factory:t.\u0275fac})}}return t})(),nv=(()=>{class t{constructor(){this._applications=new Map}registerApplication(s,c){this._applications.set(s,c)}unregisterApplication(s){this._applications.delete(s)}unregisterAllApplications(){this._applications.clear()}getTestability(s){return this._applications.get(s)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(s,c=!0){return i6?.findTestabilityInTree(this,s,c)??null}static{this.\u0275fac=function(c){return new(c||t)}}static{this.\u0275prov=Xi({token:t,factory:t.\u0275fac,providedIn:"platform"})}}return t})();function r6(t){return!!t&&"function"==typeof t.then}function iv(t){return!!t&&"function"==typeof t.subscribe}const rv=new xn("");let o6=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((s,c)=>{this.resolve=s,this.reject=c}),this.appInits=xr(rv,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const s=[];for(const f of this.appInits){const _=f();if(r6(_))s.push(_);else if(iv(_)){const E=new Promise((A,H)=>{_.subscribe({complete:A,error:H})});s.push(E)}}const c=()=>{this.done=!0,this.resolve()};Promise.all(s).then(()=>{c()}).catch(f=>{this.reject(f)}),0===s.length&&c(),this.initialized=!0}static{this.\u0275fac=function(c){return new(c||t)}}static{this.\u0275prov=Xi({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();const s6=new xn("");function av(t,n){return Array.isArray(n)?n.reduce(av,t):{...t,...n}}let z1=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=xr(Y1),this.afterRenderEffectManager=xr(vf),this.externalTestViews=new Set,this.beforeRender=new Si.B,this.afterTick=new Si.B,this.componentTypes=[],this.components=[],this.isStable=xr(b4).hasPendingTasks.pipe((0,ji.T)(s=>!s)),this._injector=xr(cr)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(s,c){const f=s instanceof Rl;if(!this._injector.get(o6).done)throw!f&&cs(s),new jt(405,!1);let E;E=f?s:this._injector.get(Ou).resolveComponentFactory(s),this.componentTypes.push(E.componentType);const A=function Zx(t){return t.isBoundToModule}(E)?void 0:this._injector.get(Wd),ce=E.create(hl.NULL,[],c||E.selector,A),Re=ce.location.nativeElement,ct=ce.injector.get(ev,null);return ct?.registerApplication(Re),ce.onDestroy(()=>{this.detachView(ce.hostView),w8(this.components,ce),ct?.unregisterApplication(Re)}),this._loadComponent(ce),ce}tick(){this._tick(!0)}_tick(s){if(this._runningTick)throw new jt(101,!1);const c=ve(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(s)}catch(f){this.internalErrorHandler(f)}finally{this.afterTick.next(),this._runningTick=!1,ve(c)}}detectChangesInAttachedViews(s){let c=0;const f=this.afterRenderEffectManager;for(;;){if(c===Ud)throw new jt(103,!1);if(s){const _=0===c;this.beforeRender.next(_);for(let{_lView:E,notifyErrorHandler:A}of this._views)Qx(E,_,A)}if(c++,f.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:_})=>a6(_))&&(f.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:_})=>a6(_))))break}}attachView(s){const c=s;this._views.push(c),c.attachToAppRef(this)}detachView(s){const c=s;w8(this._views,c),c.detachFromAppRef()}_loadComponent(s){this.attachView(s.hostView),this.tick(),this.components.push(s);const c=this._injector.get(s6,[]);[...this._bootstrapListeners,...c].forEach(f=>f(s))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(s=>s()),this._views.slice().forEach(s=>s.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(s){return this._destroyListeners.push(s),()=>w8(this._destroyListeners,s)}destroy(){if(this._destroyed)throw new jt(406,!1);const s=this._injector;s.destroy&&!s.destroyed&&s.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(c){return new(c||t)}}static{this.\u0275prov=Xi({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function w8(t,n){const s=t.indexOf(n);s>-1&&t.splice(s,1)}function Qx(t,n,s){!n&&!a6(t)||function Jx(t,n,s){let c;s?(c=0,t[Ni]|=1024):c=64&t[Ni]?0:1,Nh(t,n,c)}(t,s,n)}function a6(t){return wr(t)}class eb{constructor(n,s){this.ngModuleFactory=n,this.componentFactories=s}}let tb=(()=>{class t{compileModuleSync(s){return new lp(s)}compileModuleAsync(s){return Promise.resolve(this.compileModuleSync(s))}compileModuleAndAllComponentsSync(s){const c=this.compileModuleSync(s),_=tc(Es(s).declarations).reduce((E,A)=>{const H=Gr(A);return H&&E.push(new xf(H)),E},[]);return new eb(c,_)}compileModuleAndAllComponentsAsync(s){return Promise.resolve(this.compileModuleAndAllComponentsSync(s))}clearCache(){}clearCacheFor(s){}getModuleId(s){}static{this.\u0275fac=function(c){return new(c||t)}}static{this.\u0275prov=Xi({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),rb=(()=>{class t{constructor(){this.zone=xr(Vs),this.applicationRef=xr(z1)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(c){return new(c||t)}}static{this.\u0275prov=Xi({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function ob(){const t=xr(Vs),n=xr(ac);return s=>t.runOutsideAngular(()=>n.handleError(s))}let ab=(()=>{class t{constructor(){this.subscription=new Mi.yU,this.initialized=!1,this.zone=xr(Vs),this.pendingTasks=xr(b4)}initialize(){if(this.initialized)return;this.initialized=!0;let s=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(s=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Vs.assertNotInAngularZone(),queueMicrotask(()=>{null!==s&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(s),s=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Vs.assertInAngularZone(),s??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(c){return new(c||t)}}static{this.\u0275prov=Xi({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();const E8=new xn("",{providedIn:"root",factory:()=>xr(E8,Dr.Optional|Dr.SkipSelf)||function lb(){return typeof $localize<"u"&&$localize.locale||H4}()}),cb=new xn("",{providedIn:"root",factory:()=>"USD"}),l6=new xn("");let hv=(()=>{class t{constructor(s){this._injector=s,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(s,c){const f=function Qv(t="zone.js",n){return"noop"===t?new lh:"zone.js"===t?new Vs(n):t}(c?.ngZone,function uv(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:c?.ngZoneEventCoalescing,runCoalescing:c?.ngZoneRunCoalescing}));return f.run(()=>{const _=function Y7(t,n,s){return new ap(t,n,s)}(s.moduleType,this.injector,function cv(t){return[{provide:Vs,useFactory:t},{provide:Bs,multi:!0,useFactory:()=>{const n=xr(rb,{optional:!0});return()=>n.initialize()}},{provide:Bs,multi:!0,useFactory:()=>{const n=xr(ab);return()=>{n.initialize()}}},{provide:Y1,useFactory:ob}]}(()=>f)),E=_.injector.get(ac,null);return f.runOutsideAngular(()=>{const A=f.onError.subscribe({next:H=>{E.handleError(H)}});_.onDestroy(()=>{w8(this._modules,_),A.unsubscribe()})}),function sv(t,n,s){try{const c=s();return r6(c)?c.catch(f=>{throw n.runOutsideAngular(()=>t.handleError(f)),f}):c}catch(c){throw n.runOutsideAngular(()=>t.handleError(c)),c}}(E,f,()=>{const A=_.injector.get(o6);return A.runInitializers(),A.donePromise.then(()=>(function cg(t){"string"==typeof t&&(lg=t.toLowerCase().replace(/_/g,"-"))}(_.injector.get(E8,H4)||H4),this._moduleDoBootstrap(_),_))})})}bootstrapModule(s,c=[]){const f=av({},c);return function ib(t,n,s){const c=new lp(s);return Promise.resolve(c)}(0,0,s).then(_=>this.bootstrapModuleFactory(_,f))}_moduleDoBootstrap(s){const c=s.injector.get(z1);if(s._bootstrapComponents.length>0)s._bootstrapComponents.forEach(f=>c.bootstrap(f));else{if(!s.instance.ngDoBootstrap)throw new jt(-403,!1);s.instance.ngDoBootstrap(c)}this._modules.push(s)}onDestroy(s){this._destroyListeners.push(s)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new jt(404,!1);this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const s=this._injector.get(l6,null);s&&(s.forEach(c=>c()),s.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static{this.\u0275fac=function(c){return new(c||t)(vo(hl))}}static{this.\u0275prov=Xi({token:t,factory:t.\u0275fac,providedIn:"platform"})}}return t})(),I1=null;const dv=new xn("");function fv(t,n,s=[]){const c=`Platform: ${n}`,f=new xn(c);return(_=[])=>{let E=c6();if(!E||E.injector.get(dv,!1)){const A=[...s,..._,{provide:f,useValue:!0}];t?t(A):function hb(t){if(I1&&!I1.get(dv,!1))throw new jt(400,!1);(function ov(){!function Wn(t){nn=t}(()=>{throw new jt(600,!1)})})(),I1=t;const n=t.get(hv);(function mv(t){t.get(v2,null)?.forEach(s=>s())})(t)}(function pv(t=[],n){return hl.create({name:n,providers:[{provide:mn,useValue:"platform"},{provide:l6,useValue:new Set([()=>I1=null])},...t]})}(A,c))}return function db(t){const n=c6();if(!n)throw new jt(401,!1);return n}()}}function c6(){return I1?.get(hv)??null}function pb(){return!1}function mb(){}let vv=(()=>{class t{static{this.__NG_ELEMENT_ID__=gb}}return t})();function gb(t){return function vb(t,n,s){if(ha(t)&&!s){const c=gn(t.index,n);return new w(c,c)}return 47&t.type?new w(n[ao],n):null}(So(),Mn(),!(16&~t))}class bv{constructor(){}supports(n){return e8(n)}create(n){return new wb(n)}}const bb=(t,n)=>n;class wb{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||bb}forEachItem(n){let s;for(s=this._itHead;null!==s;s=s._next)n(s)}forEachOperation(n){let s=this._itHead,c=this._removalsHead,f=0,_=null;for(;s||c;){const E=!c||s&&s.currentIndex<Mv(c,f,_)?s:c,A=Mv(E,f,_),H=E.currentIndex;if(E===c)f--,c=c._nextRemoved;else if(s=s._next,null==E.previousIndex)f++;else{_||(_=[]);const ce=A-f,Re=H-f;if(ce!=Re){for(let qt=0;qt<ce;qt++){const rn=qt<_.length?_[qt]:_[qt]=0,yn=rn+qt;Re<=yn&&yn<ce&&(_[qt]=rn+1)}_[E.previousIndex]=Re-ce}}A!==H&&n(E,A,H)}}forEachPreviousItem(n){let s;for(s=this._previousItHead;null!==s;s=s._nextPrevious)n(s)}forEachAddedItem(n){let s;for(s=this._additionsHead;null!==s;s=s._nextAdded)n(s)}forEachMovedItem(n){let s;for(s=this._movesHead;null!==s;s=s._nextMoved)n(s)}forEachRemovedItem(n){let s;for(s=this._removalsHead;null!==s;s=s._nextRemoved)n(s)}forEachIdentityChange(n){let s;for(s=this._identityChangesHead;null!==s;s=s._nextIdentityChange)n(s)}diff(n){if(null==n&&(n=[]),!e8(n))throw new jt(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let f,_,E,s=this._itHead,c=!1;if(Array.isArray(n)){this.length=n.length;for(let A=0;A<this.length;A++)_=n[A],E=this._trackByFn(A,_),null!==s&&Object.is(s.trackById,E)?(c&&(s=this._verifyReinsertion(s,_,E,A)),Object.is(s.item,_)||this._addIdentityChange(s,_)):(s=this._mismatch(s,_,E,A),c=!0),s=s._next}else f=0,function K7(t,n){if(Array.isArray(t))for(let s=0;s<t.length;s++)n(t[s]);else{const s=t[Symbol.iterator]();let c;for(;!(c=s.next()).done;)n(c.value)}}(n,A=>{E=this._trackByFn(f,A),null!==s&&Object.is(s.trackById,E)?(c&&(s=this._verifyReinsertion(s,A,E,f)),Object.is(s.item,A)||this._addIdentityChange(s,A)):(s=this._mismatch(s,A,E,f),c=!0),s=s._next,f++}),this.length=f;return this._truncate(s),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,s,c,f){let _;return null===n?_=this._itTail:(_=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(n.item,s)||this._addIdentityChange(n,s),this._reinsertAfter(n,_,f)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(c,f))?(Object.is(n.item,s)||this._addIdentityChange(n,s),this._moveAfter(n,_,f)):n=this._addAfter(new Mb(s,c),_,f),n}_verifyReinsertion(n,s,c,f){let _=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==_?n=this._reinsertAfter(_,n._prev,f):n.currentIndex!=f&&(n.currentIndex=f,this._addToMoves(n,f)),n}_truncate(n){for(;null!==n;){const s=n._next;this._addToRemovals(this._unlink(n)),n=s}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,s,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const f=n._prevRemoved,_=n._nextRemoved;return null===f?this._removalsHead=_:f._nextRemoved=_,null===_?this._removalsTail=f:_._prevRemoved=f,this._insertAfter(n,s,c),this._addToMoves(n,c),n}_moveAfter(n,s,c){return this._unlink(n),this._insertAfter(n,s,c),this._addToMoves(n,c),n}_addAfter(n,s,c){return this._insertAfter(n,s,c),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,s,c){const f=null===s?this._itHead:s._next;return n._next=f,n._prev=s,null===f?this._itTail=n:f._prev=n,null===s?this._itHead=n:s._next=n,null===this._linkedRecords&&(this._linkedRecords=new wv),this._linkedRecords.put(n),n.currentIndex=c,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const s=n._prev,c=n._next;return null===s?this._itHead=c:s._next=c,null===c?this._itTail=s:c._prev=s,n}_addToMoves(n,s){return n.previousIndex===s||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new wv),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,s){return n.item=s,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class Mb{constructor(n,s){this.item=n,this.trackById=s,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Eb{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,s){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===s||s<=c.currentIndex)&&Object.is(c.trackById,n))return c;return null}remove(n){const s=n._prevDup,c=n._nextDup;return null===s?this._head=c:s._nextDup=c,null===c?this._tail=s:c._prevDup=s,null===this._head}}class wv{constructor(){this.map=new Map}put(n){const s=n.trackById;let c=this.map.get(s);c||(c=new Eb,this.map.set(s,c)),c.add(n)}get(n,s){const f=this.map.get(n);return f?f.get(n,s):null}remove(n){const s=n.trackById;return this.map.get(s).remove(n)&&this.map.delete(s),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Mv(t,n,s){const c=t.previousIndex;if(null===c)return c;let f=0;return s&&c<s.length&&(f=s[c]),c+n+f}class Ev{constructor(){}supports(n){return n instanceof Map||up(n)}create(){return new Cb}}class Cb{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let s;for(s=this._mapHead;null!==s;s=s._next)n(s)}forEachPreviousItem(n){let s;for(s=this._previousMapHead;null!==s;s=s._nextPrevious)n(s)}forEachChangedItem(n){let s;for(s=this._changesHead;null!==s;s=s._nextChanged)n(s)}forEachAddedItem(n){let s;for(s=this._additionsHead;null!==s;s=s._nextAdded)n(s)}forEachRemovedItem(n){let s;for(s=this._removalsHead;null!==s;s=s._nextRemoved)n(s)}diff(n){if(n){if(!(n instanceof Map||up(n)))throw new jt(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let s=this._mapHead;if(this._appendAfter=null,this._forEach(n,(c,f)=>{if(s&&s.key===f)this._maybeAddToChanges(s,c),this._appendAfter=s,s=s._next;else{const _=this._getOrCreateRecordForKey(f,c);s=this._insertBeforeOrAppend(s,_)}}),s){s._prev&&(s._prev._next=null),this._removalsHead=s;for(let c=s;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,s){if(n){const c=n._prev;return s._next=n,s._prev=c,n._prev=s,c&&(c._next=s),n===this._mapHead&&(this._mapHead=s),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=s,s._prev=this._appendAfter):this._mapHead=s,this._appendAfter=s,null}_getOrCreateRecordForKey(n,s){if(this._records.has(n)){const f=this._records.get(n);this._maybeAddToChanges(f,s);const _=f._prev,E=f._next;return _&&(_._next=E),E&&(E._prev=_),f._next=null,f._prev=null,f}const c=new Tb(n);return this._records.set(n,c),c.currentValue=s,this._addToAdditions(c),c}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,s){Object.is(s,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=s,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,s){n instanceof Map?n.forEach(s):Object.keys(n).forEach(c=>s(n[c],c))}}class Tb{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Cv(){return new p6([new bv])}let p6=(()=>{class t{static{this.\u0275prov=Xi({token:t,providedIn:"root",factory:Cv})}constructor(s){this.factories=s}static create(s,c){if(null!=c){const f=c.factories.slice();s=s.concat(f)}return new t(s)}static extend(s){return{provide:t,useFactory:c=>t.create(s,c||Cv()),deps:[[t,new Qs,new Xo]]}}find(s){const c=this.factories.find(f=>f.supports(s));if(null!=c)return c;throw new jt(901,!1)}}return t})();function Tv(){return new m6([new Ev])}let m6=(()=>{class t{static{this.\u0275prov=Xi({token:t,providedIn:"root",factory:Tv})}constructor(s){this.factories=s}static create(s,c){if(c){const f=c.factories.slice();s=s.concat(f)}return new t(s)}static extend(s){return{provide:t,useFactory:c=>t.create(s,c||Tv()),deps:[[t,new Qs,new Xo]]}}find(s){const c=this.factories.find(f=>f.supports(s));if(c)return c;throw new jt(901,!1)}}return t})();const Ab=fv(null,"core",[]);let Pb=(()=>{class t{constructor(s){}static{this.\u0275fac=function(c){return new(c||t)(vo(z1))}}static{this.\u0275mod=Ha({type:t})}static{this.\u0275inj=oo({})}}return t})();function ow(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}function aw(t){const n=ve(null);try{return t()}finally{ve(n)}}const lw=new xn("",{providedIn:"root",factory:()=>xr(cw)});let cw=(()=>{class t{static{this.\u0275prov=Xi({token:t,providedIn:"root",factory:()=>new uw})}}return t})();class uw{constructor(){this.queuedEffectCount=0,this.queues=new Map,this.pendingTasks=xr(b4),this.taskId=null}scheduleEffect(n){if(this.enqueue(n),null===this.taskId){const s=this.taskId=this.pendingTasks.add();queueMicrotask(()=>{this.flush(),this.pendingTasks.remove(s),this.taskId=null})}}enqueue(n){const s=n.creationZone;this.queues.has(s)||this.queues.set(s,new Set);const c=this.queues.get(s);c.has(n)||(this.queuedEffectCount++,c.add(n))}flush(){for(;this.queuedEffectCount>0;)for(const[n,s]of this.queues)null===n?this.flushQueue(s):n.run(()=>this.flushQueue(s))}flushQueue(n){for(const s of n)n.delete(s),this.queuedEffectCount--,s.run()}}class hw{constructor(n,s,c,f,_,E){this.scheduler=n,this.effectFn=s,this.creationZone=c,this.injector=_,this.watcher=function zn(t,n,s){const c=Object.create(ar);s&&(c.consumerAllowSignalWrites=!0),c.fn=t,c.schedule=n;const f=H=>{c.cleanupFn=H};return c.ref={notify:()=>xt(c),run:()=>{if(null===c.fn)return;if(function fe(){return a}())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(c.dirty=!1,c.hasRun&&!Yt(c))return;c.hasRun=!0;const H=Qt(c);try{c.cleanupFn(),c.cleanupFn=qn,c.fn(f)}finally{sn(c,H)}},cleanup:()=>c.cleanupFn(),destroy:()=>function E(H){(function _(H){return null===H.fn&&null===H.schedule})(H)||(Ut(H),H.cleanupFn(),H.fn=null,H.schedule=null,H.cleanupFn=qn)}(c),[Fe]:c},c.ref}(A=>this.runEffect(A),()=>this.schedule(),E),this.unregisterOnDestroy=f?.onDestroy(()=>this.destroy())}runEffect(n){try{this.effectFn(n)}catch(s){this.injector.get(ac,null,{optional:!0})?.handleError(s)}}run(){this.watcher.run()}schedule(){this.scheduler.scheduleEffect(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}}function Kv(t,n){Qc("NgSignals"),!n?.injector&&ei();const s=n?.injector??xr(hl),c=!0!==n?.manualCleanup?s.get(Gu):null,f=new hw(s.get(lw),t,typeof Zone>"u"?null:Zone.current,c,s,n?.allowSignalWrites??!1),_=s.get(vv,null,{optional:!0});return _&&8&_._lView[Ni]?(_._lView[wo]??=[]).push(f.watcher.notify):f.watcher.notify(),f}function dw(t,n){const s=Gr(t),c=n.elementInjector||$r();return new xf(s).create(c,n.projectableNodes,n.hostElement,n.environmentInjector)}function fw(t){const n=Gr(t);if(!n)return null;const s=new xf(n);return{get selector(){return s.selector},get type(){return s.componentType},get inputs(){return s.inputs},get outputs(){return s.outputs},get ngContentSelectors(){return s.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}},4341:(Nn,Ct,R)=>{"use strict";R.d(Ct,{EL:()=>sr,mP:()=>Yt,Zm:()=>xt,me:()=>Ut,ok:()=>ua,l_:()=>Da,JD:()=>aa,j4:()=>po,YN:()=>sl,kq:()=>ze,vO:()=>Ai,BC:()=>Xe,cb:()=>ye,cV:()=>Ri,vS:()=>Dr,Q0:()=>Rr,R_:()=>Aa,X1:()=>vl,ze:()=>Os,hs:()=>io,k0:()=>Ze,qT:()=>Ps});var M=R(4438),C=R(177),de=R(6648),a=R(1985),se=R(3073),Fe=R(8750),ve=R(9326),ee=R(4360),fe=R(6450),he=R(8496),at=R(6354);let mt=(()=>{class be{constructor(K,Ge){this._renderer=K,this._elementRef=Ge,this.onChange=Ht=>{},this.onTouched=()=>{}}setProperty(K,Ge){this._renderer.setProperty(this._elementRef.nativeElement,K,Ge)}registerOnTouched(K){this.onTouched=K}registerOnChange(K){this.onChange=K}setDisabledState(K){this.setProperty("disabled",K)}static{this.\u0275fac=function(Ge){return new(Ge||be)(M.rXU(M.sFG),M.rXU(M.aKT))}}static{this.\u0275dir=M.FsC({type:be})}}return be})(),$e=(()=>{class be extends mt{static{this.\u0275fac=(()=>{let K;return function(Ht){return(K||(K=M.xGo(be)))(Ht||be)}})()}static{this.\u0275dir=M.FsC({type:be,features:[M.Vt3]})}}return be})();const ze=new M.nKC(""),bt={provide:ze,useExisting:(0,M.Rfq)(()=>xt),multi:!0};let xt=(()=>{class be extends $e{writeValue(K){this.setProperty("checked",K)}static{this.\u0275fac=(()=>{let K;return function(Ht){return(K||(K=M.xGo(be)))(Ht||be)}})()}static{this.\u0275dir=M.FsC({type:be,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(Ge,Ht){1&Ge&&M.bIt("change",function(Sr){return Ht.onChange(Sr.target.checked)})("blur",function(){return Ht.onTouched()})},features:[M.Jv_([bt]),M.Vt3]})}}return be})();const Qt={provide:ze,useExisting:(0,M.Rfq)(()=>Ut),multi:!0},Yt=new M.nKC("");let Ut=(()=>{class be extends mt{constructor(K,Ge,Ht){super(K,Ge),this._compositionMode=Ht,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function sn(){const be=(0,C.QT)()?(0,C.QT)().getUserAgent():"";return/android (\d+)/.test(be.toLowerCase())}())}writeValue(K){this.setProperty("value",K??"")}_handleInput(K){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(K)}_compositionStart(){this._composing=!0}_compositionEnd(K){this._composing=!1,this._compositionMode&&this.onChange(K)}static{this.\u0275fac=function(Ge){return new(Ge||be)(M.rXU(M.sFG),M.rXU(M.aKT),M.rXU(Yt,8))}}static{this.\u0275dir=M.FsC({type:be,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(Ge,Ht){1&Ge&&M.bIt("input",function(Sr){return Ht._handleInput(Sr.target.value)})("blur",function(){return Ht.onTouched()})("compositionstart",function(){return Ht._compositionStart()})("compositionend",function(Sr){return Ht._compositionEnd(Sr.target.value)})},features:[M.Jv_([Qt]),M.Vt3]})}}return be})();function et(be){return null==be||("string"==typeof be||Array.isArray(be))&&0===be.length}function It(be){return null!=be&&"number"==typeof be.length}const zt=new M.nKC(""),je=new M.nKC(""),At=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Ze{static min(Ae){return function St(be){return Ae=>{if(et(Ae.value)||et(be))return null;const K=parseFloat(Ae.value);return!isNaN(K)&&K<be?{min:{min:be,actual:Ae.value}}:null}}(Ae)}static max(Ae){return function wn(be){return Ae=>{if(et(Ae.value)||et(be))return null;const K=parseFloat(Ae.value);return!isNaN(K)&&K>be?{max:{max:be,actual:Ae.value}}:null}}(Ae)}static required(Ae){return function Rn(be){return et(be.value)?{required:!0}:null}(Ae)}static requiredTrue(Ae){return function an(be){return!0===be.value?null:{required:!0}}(Ae)}static email(Ae){return function Un(be){return et(be.value)||At.test(be.value)?null:{email:!0}}(Ae)}static minLength(Ae){return function nn(be){return Ae=>et(Ae.value)||!It(Ae.value)?null:Ae.value.length<be?{minlength:{requiredLength:be,actualLength:Ae.value.length}}:null}(Ae)}static maxLength(Ae){return function di(be){return Ae=>It(Ae.value)&&Ae.value.length>be?{maxlength:{requiredLength:be,actualLength:Ae.value.length}}:null}(Ae)}static pattern(Ae){return Wn(Ae)}static nullValidator(Ae){return null}static compose(Ae){return Yn(Ae)}static composeAsync(Ae){return qn(Ae)}}function Wn(be){if(!be)return $n;let Ae,K;return"string"==typeof be?(K="","^"!==be.charAt(0)&&(K+="^"),K+=be,"$"!==be.charAt(be.length-1)&&(K+="$"),Ae=new RegExp(K)):(K=be.toString(),Ae=be),Ge=>{if(et(Ge.value))return null;const Ht=Ge.value;return Ae.test(Ht)?null:{pattern:{requiredPattern:K,actualValue:Ht}}}}function $n(be){return null}function ki(be){return null!=be}function Jt(be){return(0,M.jNT)(be)?(0,de.H)(be):be}function un(be){let Ae={};return be.forEach(K=>{Ae=null!=K?{...Ae,...K}:Ae}),0===Object.keys(Ae).length?null:Ae}function pn(be,Ae){return Ae.map(K=>K(be))}function jn(be){return be.map(Ae=>function dn(be){return!be.validate}(Ae)?Ae:K=>Ae.validate(K))}function Yn(be){if(!be)return null;const Ae=be.filter(ki);return 0==Ae.length?null:function(K){return un(pn(K,Ae))}}function zn(be){return null!=be?Yn(jn(be)):null}function qn(be){if(!be)return null;const Ae=be.filter(ki);return 0==Ae.length?null:function(K){return function ge(...be){const Ae=(0,ve.ms)(be),{args:K,keys:Ge}=(0,se.D)(be),Ht=new a.c(Fi=>{const{length:Sr}=K;if(!Sr)return void Fi.complete();const Yr=new Array(Sr);let ea=Sr,ta=Sr;for(let Ja=0;Ja<Sr;Ja++){let Us=!1;(0,Fe.Tg)(K[Ja]).subscribe((0,ee._)(Fi,Bl=>{Us||(Us=!0,ta--),Yr[Ja]=Bl},()=>ea--,void 0,()=>{(!ea||!Us)&&(ta||Fi.next(Ge?(0,he.e)(Ge,Yr):Yr),Fi.complete())}))}});return Ae?Ht.pipe((0,fe.I)(Ae)):Ht}(pn(K,Ae).map(Jt)).pipe((0,at.T)(un))}}function ar(be){return null!=be?qn(jn(be)):null}function Gi(be,Ae){return null===be?[Ae]:Array.isArray(be)?[...be,Ae]:[be,Ae]}function Si(be){return be._rawValidators}function Mi(be){return be._rawAsyncValidators}function Br(be){return be?Array.isArray(be)?be:[be]:[]}function ji(be,Ae){return Array.isArray(be)?be.includes(Ae):be===Ae}function Ln(be,Ae){const K=Br(Ae);return Br(be).forEach(Ht=>{ji(K,Ht)||K.push(Ht)}),K}function Bt(be,Ae){return Br(Ae).filter(K=>!ji(be,K))}class jt{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(Ae){this._rawValidators=Ae||[],this._composedValidatorFn=zn(this._rawValidators)}_setAsyncValidators(Ae){this._rawAsyncValidators=Ae||[],this._composedAsyncValidatorFn=ar(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(Ae){this._onDestroyCallbacks.push(Ae)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(Ae=>Ae()),this._onDestroyCallbacks=[]}reset(Ae=void 0){this.control&&this.control.reset(Ae)}hasError(Ae,K){return!!this.control&&this.control.hasError(Ae,K)}getError(Ae,K){return this.control?this.control.getError(Ae,K):null}}class Dn extends jt{get formDirective(){return null}get path(){return null}}class Ai extends jt{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Sn{constructor(Ae){this._cd=Ae}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Xe=(()=>{class be extends Sn{constructor(K){super(K)}static{this.\u0275fac=function(Ge){return new(Ge||be)(M.rXU(Ai,2))}}static{this.\u0275dir=M.FsC({type:be,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(Ge,Ht){2&Ge&&M.AVh("ng-untouched",Ht.isUntouched)("ng-touched",Ht.isTouched)("ng-pristine",Ht.isPristine)("ng-dirty",Ht.isDirty)("ng-valid",Ht.isValid)("ng-invalid",Ht.isInvalid)("ng-pending",Ht.isPending)},features:[M.Vt3]})}}return be})(),ye=(()=>{class be extends Sn{constructor(K){super(K)}static{this.\u0275fac=function(Ge){return new(Ge||be)(M.rXU(Dn,10))}}static{this.\u0275dir=M.FsC({type:be,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(Ge,Ht){2&Ge&&M.AVh("ng-untouched",Ht.isUntouched)("ng-touched",Ht.isTouched)("ng-pristine",Ht.isPristine)("ng-dirty",Ht.isDirty)("ng-valid",Ht.isValid)("ng-invalid",Ht.isInvalid)("ng-pending",Ht.isPending)("ng-submitted",Ht.isSubmitted)},features:[M.Vt3]})}}return be})();const Ie="VALID",ae="INVALID",Z="PENDING",Y="DISABLED";function _e(be){return(Cn(be)?be.validators:be)||null}function Je(be,Ae){return(Cn(Ae)?Ae.asyncValidators:be)||null}function Cn(be){return null!=be&&!Array.isArray(be)&&"object"==typeof be}function ni(be,Ae,K){const Ge=be.controls;if(!(Ae?Object.keys(Ge):Ge).length)throw new M.wOt(1e3,"");if(!Ge[K])throw new M.wOt(1001,"")}function xi(be,Ae,K){be._forEachChild((Ge,Ht)=>{if(void 0===K[Ht])throw new M.wOt(1002,"")})}class sr{constructor(Ae,K){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(Ae),this._assignAsyncValidators(K)}get validator(){return this._composedValidatorFn}set validator(Ae){this._rawValidators=this._composedValidatorFn=Ae}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(Ae){this._rawAsyncValidators=this._composedAsyncValidatorFn=Ae}get parent(){return this._parent}get valid(){return this.status===Ie}get invalid(){return this.status===ae}get pending(){return this.status==Z}get disabled(){return this.status===Y}get enabled(){return this.status!==Y}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(Ae){this._assignValidators(Ae)}setAsyncValidators(Ae){this._assignAsyncValidators(Ae)}addValidators(Ae){this.setValidators(Ln(Ae,this._rawValidators))}addAsyncValidators(Ae){this.setAsyncValidators(Ln(Ae,this._rawAsyncValidators))}removeValidators(Ae){this.setValidators(Bt(Ae,this._rawValidators))}removeAsyncValidators(Ae){this.setAsyncValidators(Bt(Ae,this._rawAsyncValidators))}hasValidator(Ae){return ji(this._rawValidators,Ae)}hasAsyncValidator(Ae){return ji(this._rawAsyncValidators,Ae)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(Ae={}){this.touched=!0,this._parent&&!Ae.onlySelf&&this._parent.markAsTouched(Ae)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(Ae=>Ae.markAllAsTouched())}markAsUntouched(Ae={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(K=>{K.markAsUntouched({onlySelf:!0})}),this._parent&&!Ae.onlySelf&&this._parent._updateTouched(Ae)}markAsDirty(Ae={}){this.pristine=!1,this._parent&&!Ae.onlySelf&&this._parent.markAsDirty(Ae)}markAsPristine(Ae={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(K=>{K.markAsPristine({onlySelf:!0})}),this._parent&&!Ae.onlySelf&&this._parent._updatePristine(Ae)}markAsPending(Ae={}){this.status=Z,!1!==Ae.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!Ae.onlySelf&&this._parent.markAsPending(Ae)}disable(Ae={}){const K=this._parentMarkedDirty(Ae.onlySelf);this.status=Y,this.errors=null,this._forEachChild(Ge=>{Ge.disable({...Ae,onlySelf:!0})}),this._updateValue(),!1!==Ae.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...Ae,skipPristineCheck:K}),this._onDisabledChange.forEach(Ge=>Ge(!0))}enable(Ae={}){const K=this._parentMarkedDirty(Ae.onlySelf);this.status=Ie,this._forEachChild(Ge=>{Ge.enable({...Ae,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:Ae.emitEvent}),this._updateAncestors({...Ae,skipPristineCheck:K}),this._onDisabledChange.forEach(Ge=>Ge(!1))}_updateAncestors(Ae){this._parent&&!Ae.onlySelf&&(this._parent.updateValueAndValidity(Ae),Ae.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(Ae){this._parent=Ae}getRawValue(){return this.value}updateValueAndValidity(Ae={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ie||this.status===Z)&&this._runAsyncValidator(Ae.emitEvent)),!1!==Ae.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!Ae.onlySelf&&this._parent.updateValueAndValidity(Ae)}_updateTreeValidity(Ae={emitEvent:!0}){this._forEachChild(K=>K._updateTreeValidity(Ae)),this.updateValueAndValidity({onlySelf:!0,emitEvent:Ae.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Y:Ie}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(Ae){if(this.asyncValidator){this.status=Z,this._hasOwnPendingAsyncValidator=!0;const K=Jt(this.asyncValidator(this));this._asyncValidationSubscription=K.subscribe(Ge=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(Ge,{emitEvent:Ae})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(Ae,K={}){this.errors=Ae,this._updateControlsErrors(!1!==K.emitEvent)}get(Ae){let K=Ae;return null==K||(Array.isArray(K)||(K=K.split(".")),0===K.length)?null:K.reduce((Ge,Ht)=>Ge&&Ge._find(Ht),this)}getError(Ae,K){const Ge=K?this.get(K):this;return Ge&&Ge.errors?Ge.errors[Ae]:null}hasError(Ae,K){return!!this.getError(Ae,K)}get root(){let Ae=this;for(;Ae._parent;)Ae=Ae._parent;return Ae}_updateControlsErrors(Ae){this.status=this._calculateStatus(),Ae&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(Ae)}_initObservables(){this.valueChanges=new M.bkB,this.statusChanges=new M.bkB}_calculateStatus(){return this._allControlsDisabled()?Y:this.errors?ae:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Z)?Z:this._anyControlsHaveStatus(ae)?ae:Ie}_anyControlsHaveStatus(Ae){return this._anyControls(K=>K.status===Ae)}_anyControlsDirty(){return this._anyControls(Ae=>Ae.dirty)}_anyControlsTouched(){return this._anyControls(Ae=>Ae.touched)}_updatePristine(Ae={}){this.pristine=!this._anyControlsDirty(),this._parent&&!Ae.onlySelf&&this._parent._updatePristine(Ae)}_updateTouched(Ae={}){this.touched=this._anyControlsTouched(),this._parent&&!Ae.onlySelf&&this._parent._updateTouched(Ae)}_registerOnCollectionChange(Ae){this._onCollectionChange=Ae}_setUpdateStrategy(Ae){Cn(Ae)&&null!=Ae.updateOn&&(this._updateOn=Ae.updateOn)}_parentMarkedDirty(Ae){return!Ae&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(Ae){return null}_assignValidators(Ae){this._rawValidators=Array.isArray(Ae)?Ae.slice():Ae,this._composedValidatorFn=function re(be){return Array.isArray(be)?zn(be):be||null}(this._rawValidators)}_assignAsyncValidators(Ae){this._rawAsyncValidators=Array.isArray(Ae)?Ae.slice():Ae,this._composedAsyncValidatorFn=function Pt(be){return Array.isArray(be)?ar(be):be||null}(this._rawAsyncValidators)}}class Cr extends sr{constructor(Ae,K,Ge){super(_e(K),Je(Ge,K)),this.controls=Ae,this._initObservables(),this._setUpdateStrategy(K),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(Ae,K){return this.controls[Ae]?this.controls[Ae]:(this.controls[Ae]=K,K.setParent(this),K._registerOnCollectionChange(this._onCollectionChange),K)}addControl(Ae,K,Ge={}){this.registerControl(Ae,K),this.updateValueAndValidity({emitEvent:Ge.emitEvent}),this._onCollectionChange()}removeControl(Ae,K={}){this.controls[Ae]&&this.controls[Ae]._registerOnCollectionChange(()=>{}),delete this.controls[Ae],this.updateValueAndValidity({emitEvent:K.emitEvent}),this._onCollectionChange()}setControl(Ae,K,Ge={}){this.controls[Ae]&&this.controls[Ae]._registerOnCollectionChange(()=>{}),delete this.controls[Ae],K&&this.registerControl(Ae,K),this.updateValueAndValidity({emitEvent:Ge.emitEvent}),this._onCollectionChange()}contains(Ae){return this.controls.hasOwnProperty(Ae)&&this.controls[Ae].enabled}setValue(Ae,K={}){xi(this,0,Ae),Object.keys(Ae).forEach(Ge=>{ni(this,!0,Ge),this.controls[Ge].setValue(Ae[Ge],{onlySelf:!0,emitEvent:K.emitEvent})}),this.updateValueAndValidity(K)}patchValue(Ae,K={}){null!=Ae&&(Object.keys(Ae).forEach(Ge=>{const Ht=this.controls[Ge];Ht&&Ht.patchValue(Ae[Ge],{onlySelf:!0,emitEvent:K.emitEvent})}),this.updateValueAndValidity(K))}reset(Ae={},K={}){this._forEachChild((Ge,Ht)=>{Ge.reset(Ae?Ae[Ht]:null,{onlySelf:!0,emitEvent:K.emitEvent})}),this._updatePristine(K),this._updateTouched(K),this.updateValueAndValidity(K)}getRawValue(){return this._reduceChildren({},(Ae,K,Ge)=>(Ae[Ge]=K.getRawValue(),Ae))}_syncPendingControls(){let Ae=this._reduceChildren(!1,(K,Ge)=>!!Ge._syncPendingControls()||K);return Ae&&this.updateValueAndValidity({onlySelf:!0}),Ae}_forEachChild(Ae){Object.keys(this.controls).forEach(K=>{const Ge=this.controls[K];Ge&&Ae(Ge,K)})}_setUpControls(){this._forEachChild(Ae=>{Ae.setParent(this),Ae._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(Ae){for(const[K,Ge]of Object.entries(this.controls))if(this.contains(K)&&Ae(Ge))return!0;return!1}_reduceValue(){return this._reduceChildren({},(K,Ge,Ht)=>((Ge.enabled||this.disabled)&&(K[Ht]=Ge.value),K))}_reduceChildren(Ae,K){let Ge=Ae;return this._forEachChild((Ht,Fi)=>{Ge=K(Ge,Ht,Fi)}),Ge}_allControlsDisabled(){for(const Ae of Object.keys(this.controls))if(this.controls[Ae].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(Ae){return this.controls.hasOwnProperty(Ae)?this.controls[Ae]:null}}class Ci extends Cr{}const Or=new M.nKC("CallSetDisabledState",{providedIn:"root",factory:()=>ms}),ms="always";function as(be,Ae){return[...Ae.path,be]}function fr(be,Ae,K=ms){so(be,Ae),Ae.valueAccessor.writeValue(be.value),(be.disabled||"always"===K)&&Ae.valueAccessor.setDisabledState?.(be.disabled),function mo(be,Ae){Ae.valueAccessor.registerOnChange(K=>{be._pendingValue=K,be._pendingChange=!0,be._pendingDirty=!0,"change"===be.updateOn&&Uo(be,Ae)})}(be,Ae),function nt(be,Ae){const K=(Ge,Ht)=>{Ae.valueAccessor.writeValue(Ge),Ht&&Ae.viewToModelUpdate(Ge)};be.registerOnChange(K),Ae._registerOnDestroy(()=>{be._unregisterOnChange(K)})}(be,Ae),function yr(be,Ae){Ae.valueAccessor.registerOnTouched(()=>{be._pendingTouched=!0,"blur"===be.updateOn&&be._pendingChange&&Uo(be,Ae),"submit"!==be.updateOn&&be.markAsTouched()})}(be,Ae),function oo(be,Ae){if(Ae.valueAccessor.setDisabledState){const K=Ge=>{Ae.valueAccessor.setDisabledState(Ge)};be.registerOnDisabledChange(K),Ae._registerOnDestroy(()=>{be._unregisterOnDisabledChange(K)})}}(be,Ae)}function Xi(be,Ae,K=!0){const Ge=()=>{};Ae.valueAccessor&&(Ae.valueAccessor.registerOnChange(Ge),Ae.valueAccessor.registerOnTouched(Ge)),ci(be,Ae),be&&(Ae._invokeOnDestroyCallbacks(),be._registerOnCollectionChange(()=>{}))}function fo(be,Ae){be.forEach(K=>{K.registerOnValidatorChange&&K.registerOnValidatorChange(Ae)})}function so(be,Ae){const K=Si(be);null!==Ae.validator?be.setValidators(Gi(K,Ae.validator)):"function"==typeof K&&be.setValidators([K]);const Ge=Mi(be);null!==Ae.asyncValidator?be.setAsyncValidators(Gi(Ge,Ae.asyncValidator)):"function"==typeof Ge&&be.setAsyncValidators([Ge]);const Ht=()=>be.updateValueAndValidity();fo(Ae._rawValidators,Ht),fo(Ae._rawAsyncValidators,Ht)}function ci(be,Ae){let K=!1;if(null!==be){if(null!==Ae.validator){const Ht=Si(be);if(Array.isArray(Ht)&&Ht.length>0){const Fi=Ht.filter(Sr=>Sr!==Ae.validator);Fi.length!==Ht.length&&(K=!0,be.setValidators(Fi))}}if(null!==Ae.asyncValidator){const Ht=Mi(be);if(Array.isArray(Ht)&&Ht.length>0){const Fi=Ht.filter(Sr=>Sr!==Ae.asyncValidator);Fi.length!==Ht.length&&(K=!0,be.setAsyncValidators(Fi))}}}const Ge=()=>{};return fo(Ae._rawValidators,Ge),fo(Ae._rawAsyncValidators,Ge),K}function Uo(be,Ae){be._pendingDirty&&be.markAsDirty(),be.setValue(be._pendingValue,{emitModelToViewChange:!1}),Ae.viewToModelUpdate(be._pendingValue),be._pendingChange=!1}function Ft(be,Ae){so(be,Ae)}function An(be,Ae){if(!be.hasOwnProperty("model"))return!1;const K=be.model;return!!K.isFirstChange()||!Object.is(Ae,K.currentValue)}function lr(be,Ae){be._syncPendingControls(),Ae.forEach(K=>{const Ge=K.control;"submit"===Ge.updateOn&&Ge._pendingChange&&(K.viewToModelUpdate(Ge._pendingValue),Ge._pendingChange=!1)})}function Mr(be,Ae){if(!Ae)return null;let K,Ge,Ht;return Array.isArray(Ae),Ae.forEach(Fi=>{Fi.constructor===Ut?K=Fi:function no(be){return Object.getPrototypeOf(be.constructor)===$e}(Fi)?Ge=Fi:Ht=Fi}),Ht||Ge||K||null}const Ui={provide:Dn,useExisting:(0,M.Rfq)(()=>Ri)},ur=Promise.resolve();let Ri=(()=>{class be extends Dn{constructor(K,Ge,Ht){super(),this.callSetDisabledState=Ht,this.submitted=!1,this._directives=new Set,this.ngSubmit=new M.bkB,this.form=new Cr({},zn(K),ar(Ge))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(K){ur.then(()=>{const Ge=this._findContainer(K.path);K.control=Ge.registerControl(K.name,K.control),fr(K.control,K,this.callSetDisabledState),K.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(K)})}getControl(K){return this.form.get(K.path)}removeControl(K){ur.then(()=>{const Ge=this._findContainer(K.path);Ge&&Ge.removeControl(K.name),this._directives.delete(K)})}addFormGroup(K){ur.then(()=>{const Ge=this._findContainer(K.path),Ht=new Cr({});Ft(Ht,K),Ge.registerControl(K.name,Ht),Ht.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(K){ur.then(()=>{const Ge=this._findContainer(K.path);Ge&&Ge.removeControl(K.name)})}getFormGroup(K){return this.form.get(K.path)}updateModel(K,Ge){ur.then(()=>{this.form.get(K.path).setValue(Ge)})}setValue(K){this.control.setValue(K)}onSubmit(K){return this.submitted=!0,lr(this.form,this._directives),this.ngSubmit.emit(K),"dialog"===K?.target?.method}onReset(){this.resetForm()}resetForm(K=void 0){this.form.reset(K),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(K){return K.pop(),K.length?this.form.get(K):this.form}static{this.\u0275fac=function(Ge){return new(Ge||be)(M.rXU(zt,10),M.rXU(je,10),M.rXU(Or,8))}}static{this.\u0275dir=M.FsC({type:be,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(Ge,Ht){1&Ge&&M.bIt("submit",function(Sr){return Ht.onSubmit(Sr)})("reset",function(){return Ht.onReset()})},inputs:{options:[M.Mj6.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[M.Jv_([Ui]),M.Vt3]})}}return be})();function Oi(be,Ae){const K=be.indexOf(Ae);K>-1&&be.splice(K,1)}function nr(be){return"object"==typeof be&&null!==be&&2===Object.keys(be).length&&"value"in be&&"disabled"in be}const mr=class extends sr{constructor(Ae=null,K,Ge){super(_e(K),Je(Ge,K)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(Ae),this._setUpdateStrategy(K),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Cn(K)&&(K.nonNullable||K.initialValueIsDefault)&&(this.defaultValue=nr(Ae)?Ae.value:Ae)}setValue(Ae,K={}){this.value=this._pendingValue=Ae,this._onChange.length&&!1!==K.emitModelToViewChange&&this._onChange.forEach(Ge=>Ge(this.value,!1!==K.emitViewToModelChange)),this.updateValueAndValidity(K)}patchValue(Ae,K={}){this.setValue(Ae,K)}reset(Ae=this.defaultValue,K={}){this._applyFormState(Ae),this.markAsPristine(K),this.markAsUntouched(K),this.setValue(this.value,K),this._pendingChange=!1}_updateValue(){}_anyControls(Ae){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(Ae){this._onChange.push(Ae)}_unregisterOnChange(Ae){Oi(this._onChange,Ae)}registerOnDisabledChange(Ae){this._onDisabledChange.push(Ae)}_unregisterOnDisabledChange(Ae){Oi(this._onDisabledChange,Ae)}_forEachChild(Ae){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(Ae){nr(Ae)?(this.value=this._pendingValue=Ae.value,Ae.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=Ae}},io=mr,Ga={provide:Ai,useExisting:(0,M.Rfq)(()=>Dr)},qs=Promise.resolve();let Dr=(()=>{class be extends Ai{constructor(K,Ge,Ht,Fi,Sr,Yr){super(),this._changeDetectorRef=Sr,this.callSetDisabledState=Yr,this.control=new mr,this._registered=!1,this.name="",this.update=new M.bkB,this._parent=K,this._setValidators(Ge),this._setAsyncValidators(Ht),this.valueAccessor=Mr(0,Fi)}ngOnChanges(K){if(this._checkForErrors(),!this._registered||"name"in K){if(this._registered&&(this._checkName(),this.formDirective)){const Ge=K.name.previousValue;this.formDirective.removeControl({name:Ge,path:this._getPath(Ge)})}this._setUpControl()}"isDisabled"in K&&this._updateDisabled(K),An(K,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(K){this.viewModel=K,this.update.emit(K)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){fr(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(K){qs.then(()=>{this.control.setValue(K,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(K){const Ge=K.isDisabled.currentValue,Ht=0!==Ge&&(0,M.L39)(Ge);qs.then(()=>{Ht&&!this.control.disabled?this.control.disable():!Ht&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(K){return this._parent?as(K,this._parent):[K]}static{this.\u0275fac=function(Ge){return new(Ge||be)(M.rXU(Dn,9),M.rXU(zt,10),M.rXU(je,10),M.rXU(ze,10),M.rXU(M.gRc,8),M.rXU(Or,8))}}static{this.\u0275dir=M.FsC({type:be,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[M.Mj6.None,"disabled","isDisabled"],model:[M.Mj6.None,"ngModel","model"],options:[M.Mj6.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[M.Jv_([Ga]),M.Vt3,M.OA$]})}}return be})(),Ps=(()=>{class be{static{this.\u0275fac=function(Ge){return new(Ge||be)}}static{this.\u0275dir=M.FsC({type:be,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return be})();const Yo={provide:ze,useExisting:(0,M.Rfq)(()=>Rr),multi:!0};let Rr=(()=>{class be extends $e{writeValue(K){this.setProperty("value",K??"")}registerOnChange(K){this.onChange=Ge=>{K(""==Ge?null:parseFloat(Ge))}}static{this.\u0275fac=(()=>{let K;return function(Ht){return(K||(K=M.xGo(be)))(Ht||be)}})()}static{this.\u0275dir=M.FsC({type:be,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(Ge,Ht){1&Ge&&M.bIt("input",function(Sr){return Ht.onChange(Sr.target.value)})("blur",function(){return Ht.onTouched()})},features:[M.Jv_([Yo]),M.Vt3]})}}return be})();const xo=new M.nKC(""),ga={provide:Ai,useExisting:(0,M.Rfq)(()=>Da)};let Da=(()=>{class be extends Ai{set isDisabled(K){}static{this._ngModelWarningSentOnce=!1}constructor(K,Ge,Ht,Fi,Sr){super(),this._ngModelWarningConfig=Fi,this.callSetDisabledState=Sr,this.update=new M.bkB,this._ngModelWarningSent=!1,this._setValidators(K),this._setAsyncValidators(Ge),this.valueAccessor=Mr(0,Ht)}ngOnChanges(K){if(this._isControlChanged(K)){const Ge=K.form.previousValue;Ge&&Xi(Ge,this,!1),fr(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}An(K,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Xi(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(K){this.viewModel=K,this.update.emit(K)}_isControlChanged(K){return K.hasOwnProperty("form")}static{this.\u0275fac=function(Ge){return new(Ge||be)(M.rXU(zt,10),M.rXU(je,10),M.rXU(ze,10),M.rXU(xo,8),M.rXU(Or,8))}}static{this.\u0275dir=M.FsC({type:be,selectors:[["","formControl",""]],inputs:{form:[M.Mj6.None,"formControl","form"],isDisabled:[M.Mj6.None,"disabled","isDisabled"],model:[M.Mj6.None,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[M.Jv_([ga]),M.Vt3,M.OA$]})}}return be})();const Io={provide:Dn,useExisting:(0,M.Rfq)(()=>po)};let po=(()=>{class be extends Dn{constructor(K,Ge,Ht){super(),this.callSetDisabledState=Ht,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new M.bkB,this._setValidators(K),this._setAsyncValidators(Ge)}ngOnChanges(K){this._checkFormPresent(),K.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(ci(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(K){const Ge=this.form.get(K.path);return fr(Ge,K,this.callSetDisabledState),Ge.updateValueAndValidity({emitEvent:!1}),this.directives.push(K),Ge}getControl(K){return this.form.get(K.path)}removeControl(K){Xi(K.control||null,K,!1),function ii(be,Ae){const K=be.indexOf(Ae);K>-1&&be.splice(K,1)}(this.directives,K)}addFormGroup(K){this._setUpFormContainer(K)}removeFormGroup(K){this._cleanUpFormContainer(K)}getFormGroup(K){return this.form.get(K.path)}addFormArray(K){this._setUpFormContainer(K)}removeFormArray(K){this._cleanUpFormContainer(K)}getFormArray(K){return this.form.get(K.path)}updateModel(K,Ge){this.form.get(K.path).setValue(Ge)}onSubmit(K){return this.submitted=!0,lr(this.form,this.directives),this.ngSubmit.emit(K),"dialog"===K?.target?.method}onReset(){this.resetForm()}resetForm(K=void 0){this.form.reset(K),this.submitted=!1}_updateDomValue(){this.directives.forEach(K=>{const Ge=K.control,Ht=this.form.get(K.path);Ge!==Ht&&(Xi(Ge||null,K),(be=>be instanceof mr)(Ht)&&(fr(Ht,K,this.callSetDisabledState),K.control=Ht))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(K){const Ge=this.form.get(K.path);Ft(Ge,K),Ge.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(K){if(this.form){const Ge=this.form.get(K.path);Ge&&function Tt(be,Ae){return ci(be,Ae)}(Ge,K)&&Ge.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){so(this.form,this),this._oldForm&&ci(this._oldForm,this)}_checkFormPresent(){}static{this.\u0275fac=function(Ge){return new(Ge||be)(M.rXU(zt,10),M.rXU(je,10),M.rXU(Or,8))}}static{this.\u0275dir=M.FsC({type:be,selectors:[["","formGroup",""]],hostBindings:function(Ge,Ht){1&Ge&&M.bIt("submit",function(Sr){return Ht.onSubmit(Sr)})("reset",function(){return Ht.onReset()})},inputs:{form:[M.Mj6.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[M.Jv_([Io]),M.Vt3,M.OA$]})}}return be})();const xr={provide:Ai,useExisting:(0,M.Rfq)(()=>aa)};let aa=(()=>{class be extends Ai{set isDisabled(K){}static{this._ngModelWarningSentOnce=!1}constructor(K,Ge,Ht,Fi,Sr){super(),this._ngModelWarningConfig=Sr,this._added=!1,this.name=null,this.update=new M.bkB,this._ngModelWarningSent=!1,this._parent=K,this._setValidators(Ge),this._setAsyncValidators(Ht),this.valueAccessor=Mr(0,Fi)}ngOnChanges(K){this._added||this._setUpControl(),An(K,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(K){this.viewModel=K,this.update.emit(K)}get path(){return as(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(Ge){return new(Ge||be)(M.rXU(Dn,13),M.rXU(zt,10),M.rXU(je,10),M.rXU(ze,10),M.rXU(xo,8))}}static{this.\u0275dir=M.FsC({type:be,selectors:[["","formControlName",""]],inputs:{name:[M.Mj6.None,"formControlName","name"],isDisabled:[M.Mj6.None,"disabled","isDisabled"],model:[M.Mj6.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[M.Jv_([xr]),M.Vt3,M.OA$]})}}return be})(),rs=(()=>{class be{constructor(){this._validator=$n}ngOnChanges(K){if(this.inputName in K){const Ge=this.normalizeInput(K[this.inputName].currentValue);this._enabled=this.enabled(Ge),this._validator=this._enabled?this.createValidator(Ge):$n,this._onChange&&this._onChange()}}validate(K){return this._validator(K)}registerOnValidatorChange(K){this._onChange=K}enabled(K){return null!=K}static{this.\u0275fac=function(Ge){return new(Ge||be)}}static{this.\u0275dir=M.FsC({type:be,features:[M.OA$]})}}return be})();const Bs={provide:zt,useExisting:(0,M.Rfq)(()=>Aa),multi:!0};let Aa=(()=>{class be extends rs{constructor(){super(...arguments),this.inputName="pattern",this.normalizeInput=K=>K,this.createValidator=K=>Wn(K)}static{this.\u0275fac=(()=>{let K;return function(Ht){return(K||(K=M.xGo(be)))(Ht||be)}})()}static{this.\u0275dir=M.FsC({type:be,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(Ge,Ht){2&Ge&&M.BMQ("pattern",Ht._enabled?Ht.pattern:null)},inputs:{pattern:"pattern"},features:[M.Jv_([Bs]),M.Vt3]})}}return be})(),ko=(()=>{class be{static{this.\u0275fac=function(Ge){return new(Ge||be)}}static{this.\u0275mod=M.$C({type:be})}static{this.\u0275inj=M.G2t({})}}return be})();class Wo extends sr{constructor(Ae,K,Ge){super(_e(K),Je(Ge,K)),this.controls=Ae,this._initObservables(),this._setUpdateStrategy(K),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(Ae){return this.controls[this._adjustIndex(Ae)]}push(Ae,K={}){this.controls.push(Ae),this._registerControl(Ae),this.updateValueAndValidity({emitEvent:K.emitEvent}),this._onCollectionChange()}insert(Ae,K,Ge={}){this.controls.splice(Ae,0,K),this._registerControl(K),this.updateValueAndValidity({emitEvent:Ge.emitEvent})}removeAt(Ae,K={}){let Ge=this._adjustIndex(Ae);Ge<0&&(Ge=0),this.controls[Ge]&&this.controls[Ge]._registerOnCollectionChange(()=>{}),this.controls.splice(Ge,1),this.updateValueAndValidity({emitEvent:K.emitEvent})}setControl(Ae,K,Ge={}){let Ht=this._adjustIndex(Ae);Ht<0&&(Ht=0),this.controls[Ht]&&this.controls[Ht]._registerOnCollectionChange(()=>{}),this.controls.splice(Ht,1),K&&(this.controls.splice(Ht,0,K),this._registerControl(K)),this.updateValueAndValidity({emitEvent:Ge.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(Ae,K={}){xi(this,0,Ae),Ae.forEach((Ge,Ht)=>{ni(this,!1,Ht),this.at(Ht).setValue(Ge,{onlySelf:!0,emitEvent:K.emitEvent})}),this.updateValueAndValidity(K)}patchValue(Ae,K={}){null!=Ae&&(Ae.forEach((Ge,Ht)=>{this.at(Ht)&&this.at(Ht).patchValue(Ge,{onlySelf:!0,emitEvent:K.emitEvent})}),this.updateValueAndValidity(K))}reset(Ae=[],K={}){this._forEachChild((Ge,Ht)=>{Ge.reset(Ae[Ht],{onlySelf:!0,emitEvent:K.emitEvent})}),this._updatePristine(K),this._updateTouched(K),this.updateValueAndValidity(K)}getRawValue(){return this.controls.map(Ae=>Ae.getRawValue())}clear(Ae={}){this.controls.length<1||(this._forEachChild(K=>K._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:Ae.emitEvent}))}_adjustIndex(Ae){return Ae<0?Ae+this.length:Ae}_syncPendingControls(){let Ae=this.controls.reduce((K,Ge)=>!!Ge._syncPendingControls()||K,!1);return Ae&&this.updateValueAndValidity({onlySelf:!0}),Ae}_forEachChild(Ae){this.controls.forEach((K,Ge)=>{Ae(K,Ge)})}_updateValue(){this.value=this.controls.filter(Ae=>Ae.enabled||this.disabled).map(Ae=>Ae.value)}_anyControls(Ae){return this.controls.some(K=>K.enabled&&Ae(K))}_setUpControls(){this._forEachChild(Ae=>this._registerControl(Ae))}_allControlsDisabled(){for(const Ae of this.controls)if(Ae.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(Ae){Ae.setParent(this),Ae._registerOnCollectionChange(this._onCollectionChange)}_find(Ae){return this.at(Ae)??null}}function Qa(be){return!!be&&(void 0!==be.asyncValidators||void 0!==be.validators||void 0!==be.updateOn)}let ua=(()=>{class be{constructor(){this.useNonNullable=!1}get nonNullable(){const K=new be;return K.useNonNullable=!0,K}group(K,Ge=null){const Ht=this._reduceControls(K);let Fi={};return Qa(Ge)?Fi=Ge:null!==Ge&&(Fi.validators=Ge.validator,Fi.asyncValidators=Ge.asyncValidator),new Cr(Ht,Fi)}record(K,Ge=null){const Ht=this._reduceControls(K);return new Ci(Ht,Ge)}control(K,Ge,Ht){let Fi={};return this.useNonNullable?(Qa(Ge)?Fi=Ge:(Fi.validators=Ge,Fi.asyncValidators=Ht),new mr(K,{...Fi,nonNullable:!0})):new mr(K,Ge,Ht)}array(K,Ge,Ht){const Fi=K.map(Sr=>this._createControl(Sr));return new Wo(Fi,Ge,Ht)}_reduceControls(K){const Ge={};return Object.keys(K).forEach(Ht=>{Ge[Ht]=this._createControl(K[Ht])}),Ge}_createControl(K){return K instanceof mr||K instanceof sr?K:Array.isArray(K)?this.control(K[0],K.length>1?K[1]:null,K.length>2?K[2]:null):this.control(K)}static{this.\u0275fac=function(Ge){return new(Ge||be)}}static{this.\u0275prov=M.jDH({token:be,factory:be.\u0275fac,providedIn:"root"})}}return be})(),Os=(()=>{class be extends ua{group(K,Ge=null){return super.group(K,Ge)}control(K,Ge,Ht){return super.control(K,Ge,Ht)}array(K,Ge,Ht){return super.array(K,Ge,Ht)}static{this.\u0275fac=(()=>{let K;return function(Ht){return(K||(K=M.xGo(be)))(Ht||be)}})()}static{this.\u0275prov=M.jDH({token:be,factory:be.\u0275fac,providedIn:"root"})}}return be})(),sl=(()=>{class be{static withConfig(K){return{ngModule:be,providers:[{provide:Or,useValue:K.callSetDisabledState??ms}]}}static{this.\u0275fac=function(Ge){return new(Ge||be)}}static{this.\u0275mod=M.$C({type:be})}static{this.\u0275inj=M.G2t({imports:[ko]})}}return be})(),vl=(()=>{class be{static withConfig(K){return{ngModule:be,providers:[{provide:xo,useValue:K.warnOnNgModelWithFormControl??"always"},{provide:Or,useValue:K.callSetDisabledState??ms}]}}static{this.\u0275fac=function(Ge){return new(Ge||be)}}static{this.\u0275mod=M.$C({type:be})}static{this.\u0275inj=M.G2t({imports:[ko]})}}return be})()},345:(Nn,Ct,R)=>{"use strict";R.d(Ct,{B7:()=>je,Bb:()=>Br,hE:()=>Bt,sG:()=>ar,up:()=>Hi});var M=R(4438),C=R(177);class de extends C.VF{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class a extends de{static makeCurrent(){(0,C.ZD)(new a)}onAndCancel(ae,Z,Y){return ae.addEventListener(Z,Y),()=>{ae.removeEventListener(Z,Y)}}dispatchEvent(ae,Z){ae.dispatchEvent(Z)}remove(ae){ae.parentNode&&ae.parentNode.removeChild(ae)}createElement(ae,Z){return(Z=Z||this.getDefaultDocument()).createElement(ae)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(ae){return ae.nodeType===Node.ELEMENT_NODE}isShadowRoot(ae){return ae instanceof DocumentFragment}getGlobalEventTarget(ae,Z){return"window"===Z?window:"document"===Z?ae:"body"===Z?ae.body:null}getBaseHref(ae){const Z=function Fe(){return se=se||document.querySelector("base"),se?se.getAttribute("href"):null}();return null==Z?null:function ve(Ie){return new URL(Ie,document.baseURI).pathname}(Z)}resetBaseElement(){se=null}getUserAgent(){return window.navigator.userAgent}getCookie(ae){return(0,C._b)(document.cookie,ae)}}let se=null,fe=(()=>{class Ie{build(){return new XMLHttpRequest}static{this.\u0275fac=function(Y){return new(Y||Ie)}}static{this.\u0275prov=M.jDH({token:Ie,factory:Ie.\u0275fac})}}return Ie})();const he=new M.nKC("");let ge=(()=>{class Ie{constructor(Z,Y){this._zone=Y,this._eventNameToPlugin=new Map,Z.forEach(_e=>{_e.manager=this}),this._plugins=Z.slice().reverse()}addEventListener(Z,Y,_e){return this._findPluginFor(Y).addEventListener(Z,Y,_e)}getZone(){return this._zone}_findPluginFor(Z){let Y=this._eventNameToPlugin.get(Z);if(Y)return Y;if(Y=this._plugins.find(re=>re.supports(Z)),!Y)throw new M.wOt(5101,!1);return this._eventNameToPlugin.set(Z,Y),Y}static{this.\u0275fac=function(Y){return new(Y||Ie)(M.KVO(he),M.KVO(M.SKi))}}static{this.\u0275prov=M.jDH({token:Ie,factory:Ie.\u0275fac})}}return Ie})();class at{constructor(ae){this._doc=ae}}const mt="ng-app-id";let $e=(()=>{class Ie{constructor(Z,Y,_e,re={}){this.doc=Z,this.appId=Y,this.nonce=_e,this.platformId=re,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,C.Vy)(re),this.resetHostNodes()}addStyles(Z){for(const Y of Z)1===this.changeUsageCount(Y,1)&&this.onStyleAdded(Y)}removeStyles(Z){for(const Y of Z)this.changeUsageCount(Y,-1)<=0&&this.onStyleRemoved(Y)}ngOnDestroy(){const Z=this.styleNodesInDOM;Z&&(Z.forEach(Y=>Y.remove()),Z.clear());for(const Y of this.getAllStyles())this.onStyleRemoved(Y);this.resetHostNodes()}addHost(Z){this.hostNodes.add(Z);for(const Y of this.getAllStyles())this.addStyleToHost(Z,Y)}removeHost(Z){this.hostNodes.delete(Z)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(Z){for(const Y of this.hostNodes)this.addStyleToHost(Y,Z)}onStyleRemoved(Z){const Y=this.styleRef;Y.get(Z)?.elements?.forEach(_e=>_e.remove()),Y.delete(Z)}collectServerRenderedStyles(){const Z=this.doc.head?.querySelectorAll(`style[${mt}="${this.appId}"]`);if(Z?.length){const Y=new Map;return Z.forEach(_e=>{null!=_e.textContent&&Y.set(_e.textContent,_e)}),Y}return null}changeUsageCount(Z,Y){const _e=this.styleRef;if(_e.has(Z)){const re=_e.get(Z);return re.usage+=Y,re.usage}return _e.set(Z,{usage:Y,elements:[]}),Y}getStyleElement(Z,Y){const _e=this.styleNodesInDOM,re=_e?.get(Y);if(re?.parentNode===Z)return _e.delete(Y),re.removeAttribute(mt),re;{const Je=this.doc.createElement("style");return this.nonce&&Je.setAttribute("nonce",this.nonce),Je.textContent=Y,this.platformIsServer&&Je.setAttribute(mt,this.appId),Z.appendChild(Je),Je}}addStyleToHost(Z,Y){const _e=this.getStyleElement(Z,Y),re=this.styleRef,Je=re.get(Y)?.elements;Je?Je.push(_e):re.set(Y,{elements:[_e],usage:1})}resetHostNodes(){const Z=this.hostNodes;Z.clear(),Z.add(this.doc.head)}static{this.\u0275fac=function(Y){return new(Y||Ie)(M.KVO(C.qQ),M.KVO(M.sZ2),M.KVO(M.BIS,8),M.KVO(M.Agw))}}static{this.\u0275prov=M.jDH({token:Ie,factory:Ie.\u0275fac})}}return Ie})();const ze={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},bt=/%COMP%/g,Ut=new M.nKC("",{providedIn:"root",factory:()=>!0});function zt(Ie,ae){return ae.map(Z=>Z.replace(bt,Ie))}let je=(()=>{class Ie{constructor(Z,Y,_e,re,Je,Pt,Cn,ni=null){this.eventManager=Z,this.sharedStylesHost=Y,this.appId=_e,this.removeStylesOnCompDestroy=re,this.doc=Je,this.platformId=Pt,this.ngZone=Cn,this.nonce=ni,this.rendererByCompId=new Map,this.platformIsServer=(0,C.Vy)(Pt),this.defaultRenderer=new At(Z,Je,Cn,this.platformIsServer)}createRenderer(Z,Y){if(!Z||!Y)return this.defaultRenderer;this.platformIsServer&&Y.encapsulation===M.gXe.ShadowDom&&(Y={...Y,encapsulation:M.gXe.Emulated});const _e=this.getOrCreateRenderer(Z,Y);return _e instanceof Un?_e.applyToHost(Z):_e instanceof an&&_e.applyStyles(),_e}getOrCreateRenderer(Z,Y){const _e=this.rendererByCompId;let re=_e.get(Y.id);if(!re){const Je=this.doc,Pt=this.ngZone,Cn=this.eventManager,ni=this.sharedStylesHost,xi=this.removeStylesOnCompDestroy,sr=this.platformIsServer;switch(Y.encapsulation){case M.gXe.Emulated:re=new Un(Cn,ni,Y,this.appId,xi,Je,Pt,sr);break;case M.gXe.ShadowDom:return new Rn(Cn,ni,Z,Y,Je,Pt,this.nonce,sr);default:re=new an(Cn,ni,Y,xi,Je,Pt,sr)}_e.set(Y.id,re)}return re}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(Y){return new(Y||Ie)(M.KVO(ge),M.KVO($e),M.KVO(M.sZ2),M.KVO(Ut),M.KVO(C.qQ),M.KVO(M.Agw),M.KVO(M.SKi),M.KVO(M.BIS))}}static{this.\u0275prov=M.jDH({token:Ie,factory:Ie.\u0275fac})}}return Ie})();class At{constructor(ae,Z,Y,_e){this.eventManager=ae,this.doc=Z,this.ngZone=Y,this.platformIsServer=_e,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(ae,Z){return Z?this.doc.createElementNS(ze[Z]||Z,ae):this.doc.createElement(ae)}createComment(ae){return this.doc.createComment(ae)}createText(ae){return this.doc.createTextNode(ae)}appendChild(ae,Z){(wn(ae)?ae.content:ae).appendChild(Z)}insertBefore(ae,Z,Y){ae&&(wn(ae)?ae.content:ae).insertBefore(Z,Y)}removeChild(ae,Z){ae&&ae.removeChild(Z)}selectRootElement(ae,Z){let Y="string"==typeof ae?this.doc.querySelector(ae):ae;if(!Y)throw new M.wOt(-5104,!1);return Z||(Y.textContent=""),Y}parentNode(ae){return ae.parentNode}nextSibling(ae){return ae.nextSibling}setAttribute(ae,Z,Y,_e){if(_e){Z=_e+":"+Z;const re=ze[_e];re?ae.setAttributeNS(re,Z,Y):ae.setAttribute(Z,Y)}else ae.setAttribute(Z,Y)}removeAttribute(ae,Z,Y){if(Y){const _e=ze[Y];_e?ae.removeAttributeNS(_e,Z):ae.removeAttribute(`${Y}:${Z}`)}else ae.removeAttribute(Z)}addClass(ae,Z){ae.classList.add(Z)}removeClass(ae,Z){ae.classList.remove(Z)}setStyle(ae,Z,Y,_e){_e&(M.czy.DashCase|M.czy.Important)?ae.style.setProperty(Z,Y,_e&M.czy.Important?"important":""):ae.style[Z]=Y}removeStyle(ae,Z,Y){Y&M.czy.DashCase?ae.style.removeProperty(Z):ae.style[Z]=""}setProperty(ae,Z,Y){null!=ae&&(ae[Z]=Y)}setValue(ae,Z){ae.nodeValue=Z}listen(ae,Z,Y){if("string"==typeof ae&&!(ae=(0,C.QT)().getGlobalEventTarget(this.doc,ae)))throw new Error(`Unsupported event target ${ae} for event ${Z}`);return this.eventManager.addEventListener(ae,Z,this.decoratePreventDefault(Y))}decoratePreventDefault(ae){return Z=>{if("__ngUnwrap__"===Z)return ae;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>ae(Z)):ae(Z))&&Z.preventDefault()}}}function wn(Ie){return"TEMPLATE"===Ie.tagName&&void 0!==Ie.content}class Rn extends At{constructor(ae,Z,Y,_e,re,Je,Pt,Cn){super(ae,re,Je,Cn),this.sharedStylesHost=Z,this.hostEl=Y,this.shadowRoot=Y.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const ni=zt(_e.id,_e.styles);for(const xi of ni){const sr=document.createElement("style");Pt&&sr.setAttribute("nonce",Pt),sr.textContent=xi,this.shadowRoot.appendChild(sr)}}nodeOrShadowRoot(ae){return ae===this.hostEl?this.shadowRoot:ae}appendChild(ae,Z){return super.appendChild(this.nodeOrShadowRoot(ae),Z)}insertBefore(ae,Z,Y){return super.insertBefore(this.nodeOrShadowRoot(ae),Z,Y)}removeChild(ae,Z){return super.removeChild(this.nodeOrShadowRoot(ae),Z)}parentNode(ae){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(ae)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class an extends At{constructor(ae,Z,Y,_e,re,Je,Pt,Cn){super(ae,re,Je,Pt),this.sharedStylesHost=Z,this.removeStylesOnCompDestroy=_e,this.styles=Cn?zt(Cn,Y.styles):Y.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class Un extends an{constructor(ae,Z,Y,_e,re,Je,Pt,Cn){const ni=_e+"-"+Y.id;super(ae,Z,Y,re,Je,Pt,Cn,ni),this.contentAttr=function et(Ie){return"_ngcontent-%COMP%".replace(bt,Ie)}(ni),this.hostAttr=function It(Ie){return"_nghost-%COMP%".replace(bt,Ie)}(ni)}applyToHost(ae){this.applyStyles(),this.setAttribute(ae,this.hostAttr,"")}createElement(ae,Z){const Y=super.createElement(ae,Z);return super.setAttribute(Y,this.contentAttr,""),Y}}let nn=(()=>{class Ie extends at{constructor(Z){super(Z)}supports(Z){return!0}addEventListener(Z,Y,_e){return Z.addEventListener(Y,_e,!1),()=>this.removeEventListener(Z,Y,_e)}removeEventListener(Z,Y,_e){return Z.removeEventListener(Y,_e)}static{this.\u0275fac=function(Y){return new(Y||Ie)(M.KVO(C.qQ))}}static{this.\u0275prov=M.jDH({token:Ie,factory:Ie.\u0275fac})}}return Ie})();const di=["alt","control","meta","shift"],Wn={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},$n={alt:Ie=>Ie.altKey,control:Ie=>Ie.ctrlKey,meta:Ie=>Ie.metaKey,shift:Ie=>Ie.shiftKey};let ki=(()=>{class Ie extends at{constructor(Z){super(Z)}supports(Z){return null!=Ie.parseEventName(Z)}addEventListener(Z,Y,_e){const re=Ie.parseEventName(Y),Je=Ie.eventCallback(re.fullKey,_e,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,C.QT)().onAndCancel(Z,re.domEventName,Je))}static parseEventName(Z){const Y=Z.toLowerCase().split("."),_e=Y.shift();if(0===Y.length||"keydown"!==_e&&"keyup"!==_e)return null;const re=Ie._normalizeKey(Y.pop());let Je="",Pt=Y.indexOf("code");if(Pt>-1&&(Y.splice(Pt,1),Je="code."),di.forEach(ni=>{const xi=Y.indexOf(ni);xi>-1&&(Y.splice(xi,1),Je+=ni+".")}),Je+=re,0!=Y.length||0===re.length)return null;const Cn={};return Cn.domEventName=_e,Cn.fullKey=Je,Cn}static matchEventFullKeyCode(Z,Y){let _e=Wn[Z.key]||Z.key,re="";return Y.indexOf("code.")>-1&&(_e=Z.code,re="code."),!(null==_e||!_e)&&(_e=_e.toLowerCase()," "===_e?_e="space":"."===_e&&(_e="dot"),di.forEach(Je=>{Je!==_e&&(0,$n[Je])(Z)&&(re+=Je+".")}),re+=_e,re===Y)}static eventCallback(Z,Y,_e){return re=>{Ie.matchEventFullKeyCode(re,Z)&&_e.runGuarded(()=>Y(re))}}static _normalizeKey(Z){return"esc"===Z?"escape":Z}static{this.\u0275fac=function(Y){return new(Y||Ie)(M.KVO(C.qQ))}}static{this.\u0275prov=M.jDH({token:Ie,factory:Ie.\u0275fac})}}return Ie})();const ar=(0,M.oH4)(M.fpN,"browser",[{provide:M.Agw,useValue:C.AJ},{provide:M.PLl,useValue:function jn(){a.makeCurrent()},multi:!0},{provide:C.qQ,useFactory:function zn(){return(0,M.TL$)(document),document},deps:[]}]),Gi=new M.nKC(""),Si=[{provide:M.e01,useClass:class ee{addToWindow(ae){M.JZv.getAngularTestability=(Y,_e=!0)=>{const re=ae.findTestabilityInTree(Y,_e);if(null==re)throw new M.wOt(5103,!1);return re},M.JZv.getAllAngularTestabilities=()=>ae.getAllTestabilities(),M.JZv.getAllAngularRootElements=()=>ae.getAllRootElements(),M.JZv.frameworkStabilizers||(M.JZv.frameworkStabilizers=[]),M.JZv.frameworkStabilizers.push(Y=>{const _e=M.JZv.getAllAngularTestabilities();let re=_e.length;const Je=function(){re--,0==re&&Y()};_e.forEach(Pt=>{Pt.whenStable(Je)})})}findTestabilityInTree(ae,Z,Y){return null==Z?null:ae.getTestability(Z)??(Y?(0,C.QT)().isShadowRoot(Z)?this.findTestabilityInTree(ae,Z.host,!0):this.findTestabilityInTree(ae,Z.parentElement,!0):null)}},deps:[]},{provide:M.WHO,useClass:M.NYb,deps:[M.SKi,M.giA,M.e01]},{provide:M.NYb,useClass:M.NYb,deps:[M.SKi,M.giA,M.e01]}],Mi=[{provide:M.H8p,useValue:"root"},{provide:M.zcH,useFactory:function Yn(){return new M.zcH},deps:[]},{provide:he,useClass:nn,multi:!0,deps:[C.qQ,M.SKi,M.Agw]},{provide:he,useClass:ki,multi:!0,deps:[C.qQ]},je,$e,ge,{provide:M._9s,useExisting:je},{provide:C.N0,useClass:fe,deps:[]},[]];let Br=(()=>{class Ie{constructor(Z){}static withServerTransition(Z){return{ngModule:Ie,providers:[{provide:M.sZ2,useValue:Z.appId}]}}static{this.\u0275fac=function(Y){return new(Y||Ie)(M.KVO(Gi,12))}}static{this.\u0275mod=M.$C({type:Ie})}static{this.\u0275inj=M.G2t({providers:[...Mi,...Si],imports:[C.MD,M.Hbi]})}}return Ie})(),Bt=(()=>{class Ie{constructor(Z){this._doc=Z}getTitle(){return this._doc.title}setTitle(Z){this._doc.title=Z||""}static{this.\u0275fac=function(Y){return new(Y||Ie)(M.KVO(C.qQ))}}static{this.\u0275prov=M.jDH({token:Ie,factory:Ie.\u0275fac,providedIn:"root"})}}return Ie})(),Hi=(()=>{class Ie{static{this.\u0275fac=function(Y){return new(Y||Ie)}}static{this.\u0275prov=M.jDH({token:Ie,factory:function(Y){let _e=null;return _e=Y?new(Y||Ie):M.KVO(ti),_e},providedIn:"root"})}}return Ie})(),ti=(()=>{class Ie extends Hi{constructor(Z){super(),this._doc=Z}sanitize(Z,Y){if(null==Y)return null;switch(Z){case M.WPN.NONE:return Y;case M.WPN.HTML:return(0,M.ZF7)(Y,"HTML")?(0,M.rcV)(Y):(0,M.h9k)(this._doc,String(Y)).toString();case M.WPN.STYLE:return(0,M.ZF7)(Y,"Style")?(0,M.rcV)(Y):Y;case M.WPN.SCRIPT:if((0,M.ZF7)(Y,"Script"))return(0,M.rcV)(Y);throw new M.wOt(5200,!1);case M.WPN.URL:return(0,M.ZF7)(Y,"URL")?(0,M.rcV)(Y):(0,M.$MX)(String(Y));case M.WPN.RESOURCE_URL:if((0,M.ZF7)(Y,"ResourceURL"))return(0,M.rcV)(Y);throw new M.wOt(5201,!1);default:throw new M.wOt(5202,!1)}}bypassSecurityTrustHtml(Z){return(0,M.Kcf)(Z)}bypassSecurityTrustStyle(Z){return(0,M.cWb)(Z)}bypassSecurityTrustScript(Z){return(0,M.UyX)(Z)}bypassSecurityTrustUrl(Z){return(0,M.osQ)(Z)}bypassSecurityTrustResourceUrl(Z){return(0,M.e5t)(Z)}static{this.\u0275fac=function(Y){return new(Y||Ie)(M.KVO(C.qQ))}}static{this.\u0275prov=M.jDH({token:Ie,factory:Ie.\u0275fac,providedIn:"root"})}}return Ie})()},6530:(Nn,Ct,R)=>{"use strict";R.d(Ct,{nX:()=>Io,wF:()=>vi,Ix:()=>In,Wk:()=>uo,iI:()=>ja,n3:()=>va});var M=R(467),C=R(4438),de=R(4402),a=R(6648),se=R(7673),Fe=R(4412),ve=R(4572),ee=R(9350),fe=R(8793),he=R(9030),ge=R(1203),at=R(1985),mt=R(8071);function $e(I,G){const B=(0,mt.T)(I)?I:()=>I,$=me=>me.error(B());return new at.c(G?me=>G.schedule($,0,me):$)}var ze=R(983),bt=R(17),xt=R(1413),Qt=R(8359),sn=R(177),Yt=R(6354),Ut=R(5558),et=R(6697),It=R(9172),zt=R(5964),je=R(1397),At=R(1594),Ze=R(274),St=R(8141),wn=R(9437),Rn=R(9974),an=R(4360);var di=R(9901);function Wn(I){return I<=0?()=>ze.w:(0,Rn.N)((G,B)=>{let $=[];G.subscribe((0,an._)(B,me=>{$.push(me),I<$.length&&$.shift()},()=>{for(const me of $)B.next(me);B.complete()},void 0,()=>{$=null}))})}var $n=R(3774),ki=R(3669),un=R(3703),pn=R(980),dn=R(9898),jn=R(6977),Yn=R(6365),zn=R(345);const qn="primary",ar=Symbol("RouteTitle");class Gi{constructor(G){this.params=G||{}}has(G){return Object.prototype.hasOwnProperty.call(this.params,G)}get(G){if(this.has(G)){const B=this.params[G];return Array.isArray(B)?B[0]:B}return null}getAll(G){if(this.has(G)){const B=this.params[G];return Array.isArray(B)?B:[B]}return[]}get keys(){return Object.keys(this.params)}}function Si(I){return new Gi(I)}function Mi(I,G,B){const $=B.path.split("/");if($.length>I.length||"full"===B.pathMatch&&(G.hasChildren()||$.length<I.length))return null;const me={};for(let We=0;We<$.length;We++){const kt=$[We],d=I[We];if(kt.startsWith(":"))me[kt.substring(1)]=d;else if(kt!==d.path)return null}return{consumed:I.slice(0,$.length),posParams:me}}function ji(I,G){const B=I?Ln(I):void 0,$=G?Ln(G):void 0;if(!B||!$||B.length!=$.length)return!1;let me;for(let We=0;We<B.length;We++)if(me=B[We],!Bt(I[me],G[me]))return!1;return!0}function Ln(I){return[...Object.keys(I),...Object.getOwnPropertySymbols(I)]}function Bt(I,G){if(Array.isArray(I)&&Array.isArray(G)){if(I.length!==G.length)return!1;const B=[...I].sort(),$=[...G].sort();return B.every((me,We)=>$[We]===me)}return I===G}function jt(I){return I.length>0?I[I.length-1]:null}function Dn(I){return(0,de.A)(I)?I:(0,C.jNT)(I)?(0,a.H)(Promise.resolve(I)):(0,se.of)(I)}const Ai={exact:function Xe(I,G,B){if(!ti(I.segments,G.segments)||!wt(I.segments,G.segments,B)||I.numberOfChildren!==G.numberOfChildren)return!1;for(const $ in G.children)if(!I.children[$]||!Xe(I.children[$],G.children[$],B))return!1;return!0},subset:Ve},Sn={exact:function st(I,G){return ji(I,G)},subset:function ye(I,G){return Object.keys(G).length<=Object.keys(I).length&&Object.keys(G).every(B=>Bt(I[B],G[B]))},ignored:()=>!0};function On(I,G,B){return Ai[B.paths](I.root,G.root,B.matrixParams)&&Sn[B.queryParams](I.queryParams,G.queryParams)&&!("exact"===B.fragment&&I.fragment!==G.fragment)}function Ve(I,G,B){return gt(I,G,G.segments,B)}function gt(I,G,B,$){if(I.segments.length>B.length){const me=I.segments.slice(0,B.length);return!(!ti(me,B)||G.hasChildren()||!wt(me,B,$))}if(I.segments.length===B.length){if(!ti(I.segments,B)||!wt(I.segments,B,$))return!1;for(const me in G.children)if(!I.children[me]||!Ve(I.children[me],G.children[me],$))return!1;return!0}{const me=B.slice(0,I.segments.length),We=B.slice(I.segments.length);return!!(ti(I.segments,me)&&wt(I.segments,me,$)&&I.children[qn])&&gt(I.children[qn],G,We,$)}}function wt(I,G,B){return G.every(($,me)=>Sn[B](I[me].parameters,$.parameters))}class en{constructor(G=new hn([],{}),B={},$=null){this.root=G,this.queryParams=B,this.fragment=$}get queryParamMap(){return this._queryParamMap??=Si(this.queryParams),this._queryParamMap}toString(){return Pe.serialize(this)}}class hn{constructor(G,B){this.segments=G,this.children=B,this.parent=null,Object.values(B).forEach($=>$.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Se(this)}}class si{constructor(G,B){this.path=G,this.parameters=B}get parameterMap(){return this._parameterMap??=Si(this.parameters),this._parameterMap}toString(){return Y(this)}}function ti(I,G){return I.length===G.length&&I.every((B,$)=>B.path===G[$].path)}let gi=(()=>{class I{static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275prov=C.jDH({token:I,factory:()=>new lt,providedIn:"root"})}}return I})();class lt{parse(G){const B=new eo(G);return new en(B.parseRootSegment(),B.parseQueryParams(),B.parseFragment())}serialize(G){const B=`/${dt(G.root,!0)}`,$=function re(I){const G=Object.entries(I).map(([B,$])=>Array.isArray($)?$.map(me=>`${Ke(B)}=${Ke(me)}`).join("&"):`${Ke(B)}=${Ke($)}`).filter(B=>B);return G.length?`?${G.join("&")}`:""}(G.queryParams);return`${B}${$}${"string"==typeof G.fragment?`#${function Et(I){return encodeURI(I)}(G.fragment)}`:""}`}}const Pe=new lt;function Se(I){return I.segments.map(G=>Y(G)).join("/")}function dt(I,G){if(!I.hasChildren())return Se(I);if(G){const B=I.children[qn]?dt(I.children[qn],!1):"",$=[];return Object.entries(I.children).forEach(([me,We])=>{me!==qn&&$.push(`${me}:${dt(We,!1)}`)}),$.length>0?`${B}(${$.join("//")})`:B}{const B=function bi(I,G){let B=[];return Object.entries(I.children).forEach(([$,me])=>{$===qn&&(B=B.concat(G(me,$)))}),Object.entries(I.children).forEach(([$,me])=>{$!==qn&&(B=B.concat(G(me,$)))}),B}(I,($,me)=>me===qn?[dt(I.children[qn],!1)]:[`${me}:${dt($,!1)}`]);return 1===Object.keys(I.children).length&&null!=I.children[qn]?`${Se(I)}/${B[0]}`:`${Se(I)}/(${B.join("//")})`}}function Oe(I){return encodeURIComponent(I).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ke(I){return Oe(I).replace(/%3B/gi,";")}function Ie(I){return Oe(I).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ae(I){return decodeURIComponent(I)}function Z(I){return ae(I.replace(/\+/g,"%20"))}function Y(I){return`${Ie(I.path)}${function _e(I){return Object.entries(I).map(([G,B])=>`;${Ie(G)}=${Ie(B)}`).join("")}(I.parameters)}`}const Je=/^[^\/()?;#]+/;function Pt(I){const G=I.match(Je);return G?G[0]:""}const Cn=/^[^\/()?;=#]+/,xi=/^[^=?&#]+/,Cr=/^[^&#]+/;class eo{constructor(G){this.url=G,this.remaining=G}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new hn([],{}):new hn([],this.parseChildren())}parseQueryParams(){const G={};if(this.consumeOptional("?"))do{this.parseQueryParam(G)}while(this.consumeOptional("&"));return G}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const G=[];for(this.peekStartsWith("(")||G.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),G.push(this.parseSegment());let B={};this.peekStartsWith("/(")&&(this.capture("/"),B=this.parseParens(!0));let $={};return this.peekStartsWith("(")&&($=this.parseParens(!1)),(G.length>0||Object.keys(B).length>0)&&($[qn]=new hn(G,B)),$}parseSegment(){const G=Pt(this.remaining);if(""===G&&this.peekStartsWith(";"))throw new C.wOt(4009,!1);return this.capture(G),new si(ae(G),this.parseMatrixParams())}parseMatrixParams(){const G={};for(;this.consumeOptional(";");)this.parseParam(G);return G}parseParam(G){const B=function ni(I){const G=I.match(Cn);return G?G[0]:""}(this.remaining);if(!B)return;this.capture(B);let $="";if(this.consumeOptional("=")){const me=Pt(this.remaining);me&&($=me,this.capture($))}G[ae(B)]=ae($)}parseQueryParam(G){const B=function sr(I){const G=I.match(xi);return G?G[0]:""}(this.remaining);if(!B)return;this.capture(B);let $="";if(this.consumeOptional("=")){const kt=function Jr(I){const G=I.match(Cr);return G?G[0]:""}(this.remaining);kt&&($=kt,this.capture($))}const me=Z(B),We=Z($);if(G.hasOwnProperty(me)){let kt=G[me];Array.isArray(kt)||(kt=[kt],G[me]=kt),kt.push(We)}else G[me]=We}parseParens(G){const B={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const $=Pt(this.remaining),me=this.remaining[$.length];if("/"!==me&&")"!==me&&";"!==me)throw new C.wOt(4010,!1);let We;$.indexOf(":")>-1?(We=$.slice(0,$.indexOf(":")),this.capture(We),this.capture(":")):G&&(We=qn);const kt=this.parseChildren();B[We]=1===Object.keys(kt).length?kt[qn]:new hn([],kt),this.consumeOptional("//")}return B}peekStartsWith(G){return this.remaining.startsWith(G)}consumeOptional(G){return!!this.peekStartsWith(G)&&(this.remaining=this.remaining.substring(G.length),!0)}capture(G){if(!this.consumeOptional(G))throw new C.wOt(4011,!1)}}function Lr(I){return I.segments.length>0?new hn([],{[qn]:I}):I}function Ci(I){const G={};for(const[$,me]of Object.entries(I.children)){const We=Ci(me);if($===qn&&0===We.segments.length&&We.hasChildren())for(const[kt,d]of Object.entries(We.children))G[kt]=d;else(We.segments.length>0||We.hasChildren())&&(G[$]=We)}return function Do(I){if(1===I.numberOfChildren&&I.children[qn]){const G=I.children[qn];return new hn(I.segments.concat(G.segments),G.children)}return I}(new hn(I.segments,G))}function Or(I){return I instanceof en}function as(I){let G;const me=Lr(function B(We){const kt={};for(const r of We.children){const u=B(r);kt[r.outlet]=u}const d=new hn(We.url,kt);return We===I&&(G=d),d}(I.root));return G??me}function fr(I,G,B,$){let me=I;for(;me.parent;)me=me.parent;if(0===G.length)return oo(me,me,me,B,$);const We=function mo(I){if("string"==typeof I[0]&&1===I.length&&"/"===I[0])return new ci(!0,0,I);let G=0,B=!1;const $=I.reduce((me,We,kt)=>{if("object"==typeof We&&null!=We){if(We.outlets){const d={};return Object.entries(We.outlets).forEach(([r,u])=>{d[r]="string"==typeof u?u.split("/"):u}),[...me,{outlets:d}]}if(We.segmentPath)return[...me,We.segmentPath]}return"string"!=typeof We?[...me,We]:0===kt?(We.split("/").forEach((d,r)=>{0==r&&"."===d||(0==r&&""===d?B=!0:".."===d?G++:""!=d&&me.push(d))}),me):[...me,We]},[]);return new ci(B,G,$)}(G);if(We.toRoot())return oo(me,me,new hn([],{}),B,$);const kt=function Uo(I,G,B){if(I.isAbsolute)return new yr(G,!0,0);if(!B)return new yr(G,!1,NaN);if(null===B.parent)return new yr(B,!0,0);const $=Xi(I.commands[0])?0:1;return function nt(I,G,B){let $=I,me=G,We=B;for(;We>me;){if(We-=me,$=$.parent,!$)throw new C.wOt(4005,!1);me=$.segments.length}return new yr($,!1,me-We)}(B,B.segments.length-1+$,I.numberOfDoubleDots)}(We,me,I),d=kt.processChildren?ht(kt.segmentGroup,kt.index,We.commands):Tt(kt.segmentGroup,kt.index,We.commands);return oo(me,kt.segmentGroup,d,B,$)}function Xi(I){return"object"==typeof I&&null!=I&&!I.outlets&&!I.segmentPath}function fo(I){return"object"==typeof I&&null!=I&&I.outlets}function oo(I,G,B,$,me){let kt,We={};$&&Object.entries($).forEach(([r,u])=>{We[r]=Array.isArray(u)?u.map(m=>`${m}`):`${u}`}),kt=I===G?B:so(I,G,B);const d=Lr(Ci(kt));return new en(d,We,me)}function so(I,G,B){const $={};return Object.entries(I.children).forEach(([me,We])=>{$[me]=We===G?B:so(We,G,B)}),new hn(I.segments,$)}class ci{constructor(G,B,$){if(this.isAbsolute=G,this.numberOfDoubleDots=B,this.commands=$,G&&$.length>0&&Xi($[0]))throw new C.wOt(4003,!1);const me=$.find(fo);if(me&&me!==jt($))throw new C.wOt(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class yr{constructor(G,B,$){this.segmentGroup=G,this.processChildren=B,this.index=$}}function Tt(I,G,B){if(I??=new hn([],{}),0===I.segments.length&&I.hasChildren())return ht(I,G,B);const $=function xn(I,G,B){let $=0,me=G;const We={match:!1,pathIndex:0,commandIndex:0};for(;me<I.segments.length;){if($>=B.length)return We;const kt=I.segments[me],d=B[$];if(fo(d))break;const r=`${d}`,u=$<B.length-1?B[$+1]:null;if(me>0&&void 0===r)break;if(r&&u&&"object"==typeof u&&void 0===u.outlets){if(!An(r,u,kt))return We;$+=2}else{if(!An(r,{},kt))return We;$++}me++}return{match:!0,pathIndex:me,commandIndex:$}}(I,G,B),me=B.slice($.commandIndex);if($.match&&$.pathIndex<I.segments.length){const We=new hn(I.segments.slice(0,$.pathIndex),{});return We.children[qn]=new hn(I.segments.slice($.pathIndex),I.children),ht(We,0,me)}return $.match&&0===me.length?new hn(I.segments,{}):$.match&&!I.hasChildren()?Xn(I,G,B):$.match?ht(I,0,me):Xn(I,G,B)}function ht(I,G,B){if(0===B.length)return new hn(I.segments,{});{const $=function Ft(I){return fo(I[0])?I[0].outlets:{[qn]:I}}(B),me={};if(Object.keys($).some(We=>We!==qn)&&I.children[qn]&&1===I.numberOfChildren&&0===I.children[qn].segments.length){const We=ht(I.children[qn],G,B);return new hn(I.segments,We.children)}return Object.entries($).forEach(([We,kt])=>{"string"==typeof kt&&(kt=[kt]),null!==kt&&(me[We]=Tt(I.children[We],G,kt))}),Object.entries(I.children).forEach(([We,kt])=>{void 0===$[We]&&(me[We]=kt)}),new hn(I.segments,me)}}function Xn(I,G,B){const $=I.segments.slice(0,G);let me=0;for(;me<B.length;){const We=B[me];if(fo(We)){const r=Zn(We.outlets);return new hn($,r)}if(0===me&&Xi(B[0])){$.push(new si(I.segments[G].path,Ei(B[0]))),me++;continue}const kt=fo(We)?We.outlets[qn]:`${We}`,d=me<B.length-1?B[me+1]:null;kt&&d&&Xi(d)?($.push(new si(kt,Ei(d))),me+=2):($.push(new si(kt,{})),me++)}return new hn($,{})}function Zn(I){const G={};return Object.entries(I).forEach(([B,$])=>{"string"==typeof $&&($=[$]),null!==$&&(G[B]=Xn(new hn([],{}),0,$))}),G}function Ei(I){const G={};return Object.entries(I).forEach(([B,$])=>G[B]=`${$}`),G}function An(I,G,B){return I==B.path&&ji(G,B.parameters)}const no="imperative";var lr=function(I){return I[I.NavigationStart=0]="NavigationStart",I[I.NavigationEnd=1]="NavigationEnd",I[I.NavigationCancel=2]="NavigationCancel",I[I.NavigationError=3]="NavigationError",I[I.RoutesRecognized=4]="RoutesRecognized",I[I.ResolveStart=5]="ResolveStart",I[I.ResolveEnd=6]="ResolveEnd",I[I.GuardsCheckStart=7]="GuardsCheckStart",I[I.GuardsCheckEnd=8]="GuardsCheckEnd",I[I.RouteConfigLoadStart=9]="RouteConfigLoadStart",I[I.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",I[I.ChildActivationStart=11]="ChildActivationStart",I[I.ChildActivationEnd=12]="ChildActivationEnd",I[I.ActivationStart=13]="ActivationStart",I[I.ActivationEnd=14]="ActivationEnd",I[I.Scroll=15]="Scroll",I[I.NavigationSkipped=16]="NavigationSkipped",I}(lr||{});class Mr{constructor(G,B){this.id=G,this.url=B}}class ii extends Mr{constructor(G,B,$="imperative",me=null){super(G,B),this.type=lr.NavigationStart,this.navigationTrigger=$,this.restoredState=me}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class vi extends Mr{constructor(G,B,$){super(G,B),this.urlAfterRedirects=$,this.type=lr.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var Ui=function(I){return I[I.Redirect=0]="Redirect",I[I.SupersededByNewNavigation=1]="SupersededByNewNavigation",I[I.NoDataFromResolver=2]="NoDataFromResolver",I[I.GuardRejected=3]="GuardRejected",I}(Ui||{}),ur=function(I){return I[I.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",I[I.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",I}(ur||{});class Ri extends Mr{constructor(G,B,$,me){super(G,B),this.reason=$,this.code=me,this.type=lr.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Oi extends Mr{constructor(G,B,$,me){super(G,B),this.reason=$,this.code=me,this.type=lr.NavigationSkipped}}class nr extends Mr{constructor(G,B,$,me){super(G,B),this.error=$,this.target=me,this.type=lr.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class mr extends Mr{constructor(G,B,$,me){super(G,B),this.urlAfterRedirects=$,this.state=me,this.type=lr.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class io extends Mr{constructor(G,B,$,me){super(G,B),this.urlAfterRedirects=$,this.state=me,this.type=lr.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class yo extends Mr{constructor(G,B,$,me,We){super(G,B),this.urlAfterRedirects=$,this.state=me,this.shouldActivate=We,this.type=lr.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Ji extends Mr{constructor(G,B,$,me){super(G,B),this.urlAfterRedirects=$,this.state=me,this.type=lr.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zi extends Mr{constructor(G,B,$,me){super(G,B),this.urlAfterRedirects=$,this.state=me,this.type=lr.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class hr{constructor(G){this.route=G,this.type=lr.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class oa{constructor(G){this.route=G,this.type=lr.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class jo{constructor(G){this.snapshot=G,this.type=lr.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class gl{constructor(G){this.snapshot=G,this.type=lr.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ol{constructor(G){this.snapshot=G,this.type=lr.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ga{constructor(G){this.snapshot=G,this.type=lr.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class qs{constructor(G,B,$){this.routerEvent=G,this.position=B,this.anchor=$,this.type=lr.Scroll}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Dr{}class Ps{constructor(G){this.url=G}}class Rr{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Zs,this.attachRef=null}}let Zs=(()=>{class I{constructor(){this.contexts=new Map}onChildOutletCreated(B,$){const me=this.getOrCreateContext(B);me.outlet=$,this.contexts.set(B,me)}onChildOutletDestroyed(B){const $=this.getContext(B);$&&($.outlet=null,$.attachRef=null)}onOutletDeactivated(){const B=this.contexts;return this.contexts=new Map,B}onOutletReAttached(B){this.contexts=B}getOrCreateContext(B){let $=this.getContext(B);return $||($=new Rr,this.contexts.set(B,$)),$}getContext(B){return this.contexts.get(B)||null}static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275prov=C.jDH({token:I,factory:I.\u0275fac,providedIn:"root"})}}return I})();class Wa{constructor(G){this._root=G}get root(){return this._root.value}parent(G){const B=this.pathFromRoot(G);return B.length>1?B[B.length-2]:null}children(G){const B=gs(G,this._root);return B?B.children.map($=>$.value):[]}firstChild(G){const B=gs(G,this._root);return B&&B.children.length>0?B.children[0].value:null}siblings(G){const B=$o(G,this._root);return B.length<2?[]:B[B.length-2].children.map(me=>me.value).filter(me=>me!==G)}pathFromRoot(G){return $o(G,this._root).map(B=>B.value)}}function gs(I,G){if(I===G.value)return G;for(const B of G.children){const $=gs(I,B);if($)return $}return null}function $o(I,G){if(I===G.value)return[G];for(const B of G.children){const $=$o(I,B);if($.length)return $.unshift(G),$}return[]}class vs{constructor(G,B){this.value=G,this.children=B}toString(){return`TreeNode(${this.value})`}}function _s(I){const G={};return I&&I.children.forEach(B=>G[B.value.outlet]=B),G}class xo extends Wa{constructor(G,B){super(G),this.snapshot=B,Cs(this,G)}toString(){return this.snapshot.toString()}}function ga(I){const G=function Da(I){const We=new sa([],{},{},"",{},qn,I,null,{});return new Ms("",new vs(We,[]))}(I),B=new Fe.t([new si("",{})]),$=new Fe.t({}),me=new Fe.t({}),We=new Fe.t({}),kt=new Fe.t(""),d=new Io(B,$,We,kt,me,qn,I,G.root);return d.snapshot=G.root,new xo(new vs(d,[]),G)}class Io{constructor(G,B,$,me,We,kt,d,r){this.urlSubject=G,this.paramsSubject=B,this.queryParamsSubject=$,this.fragmentSubject=me,this.dataSubject=We,this.outlet=kt,this.component=d,this._futureSnapshot=r,this.title=this.dataSubject?.pipe((0,Yt.T)(u=>u[ar]))??(0,se.of)(void 0),this.url=G,this.params=B,this.queryParams=$,this.fragment=me,this.data=We}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe((0,Yt.T)(G=>Si(G))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe((0,Yt.T)(G=>Si(G))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function po(I,G,B="emptyOnly"){let $;const{routeConfig:me}=I;return $=null===G||"always"!==B&&""!==me?.path&&(G.component||G.routeConfig?.loadComponent)?{params:{...I.params},data:{...I.data},resolve:{...I.data,...I._resolvedData??{}}}:{params:{...G.params,...I.params},data:{...G.data,...I.data},resolve:{...I.data,...G.data,...me?.data,...I._resolvedData}},me&&aa(me)&&($.resolve[ar]=me.title),$}class sa{get title(){return this.data?.[ar]}constructor(G,B,$,me,We,kt,d,r,u){this.url=G,this.params=B,this.queryParams=$,this.fragment=me,this.data=We,this.outlet=kt,this.component=d,this.routeConfig=r,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Si(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Si(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map($=>$.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ms extends Wa{constructor(G,B){super(B),this.url=G,Cs(this,B)}toString(){return vo(this._root)}}function Cs(I,G){G.value._routerState=I,G.children.forEach(B=>Cs(I,B))}function vo(I){const G=I.children.length>0?` { ${I.children.map(vo).join(", ")} } `:"";return`${I.value}${G}`}function zs(I){if(I.snapshot){const G=I.snapshot,B=I._futureSnapshot;I.snapshot=B,ji(G.queryParams,B.queryParams)||I.queryParamsSubject.next(B.queryParams),G.fragment!==B.fragment&&I.fragmentSubject.next(B.fragment),ji(G.params,B.params)||I.paramsSubject.next(B.params),function Br(I,G){if(I.length!==G.length)return!1;for(let B=0;B<I.length;++B)if(!ji(I[B],G[B]))return!1;return!0}(G.url,B.url)||I.urlSubject.next(B.url),ji(G.data,B.data)||I.dataSubject.next(B.data)}else I.snapshot=I._futureSnapshot,I.dataSubject.next(I._futureSnapshot.data)}function xr(I,G){const B=ji(I.params,G.params)&&function Hi(I,G){return ti(I,G)&&I.every((B,$)=>ji(B.parameters,G[$].parameters))}(I.url,G.url);return B&&!(!I.parent!=!G.parent)&&(!I.parent||xr(I.parent,G.parent))}function aa(I){return"string"==typeof I.title||null===I.title}let va=(()=>{class I{constructor(){this.activated=null,this._activatedRoute=null,this.name=qn,this.activateEvents=new C.bkB,this.deactivateEvents=new C.bkB,this.attachEvents=new C.bkB,this.detachEvents=new C.bkB,this.parentContexts=(0,C.WQX)(Zs),this.location=(0,C.WQX)(C.c1b),this.changeDetector=(0,C.WQX)(C.gRc),this.environmentInjector=(0,C.WQX)(C.uvJ),this.inputBinder=(0,C.WQX)(_a,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(B){if(B.name){const{firstChange:$,previousValue:me}=B.name;if($)return;this.isTrackedInParentContexts(me)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(me)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(B){return this.parentContexts.getContext(B)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const B=this.parentContexts.getContext(this.name);B?.route&&(B.attachRef?this.attach(B.attachRef,B.route):this.activateWith(B.route,B.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new C.wOt(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new C.wOt(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new C.wOt(4012,!1);this.location.detach();const B=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(B.instance),B}attach(B,$){this.activated=B,this._activatedRoute=$,this.location.insert(B.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(B.instance)}deactivate(){if(this.activated){const B=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(B)}}activateWith(B,$){if(this.isActivated)throw new C.wOt(4013,!1);this._activatedRoute=B;const me=this.location,kt=B.snapshot.component,d=this.parentContexts.getOrCreateContext(this.name).children,r=new ls(B,d,me.injector);this.activated=me.createComponent(kt,{index:me.length,injector:r,environmentInjector:$??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275dir=C.FsC({type:I,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[C.OA$]})}}return I})();class ls{__ngOutletInjector(G){return new ls(this.route,this.childContexts,G)}constructor(G,B,$){this.route=G,this.childContexts=B,this.parent=$}get(G,B){return G===Io?this.route:G===Zs?this.childContexts:this.parent.get(G,B)}}const _a=new C.nKC("");let Xs=(()=>{class I{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(B){this.unsubscribeFromRouteData(B),this.subscribeToRouteData(B)}unsubscribeFromRouteData(B){this.outletDataSubscriptions.get(B)?.unsubscribe(),this.outletDataSubscriptions.delete(B)}subscribeToRouteData(B){const{activatedRoute:$}=B,me=(0,ve.z)([$.queryParams,$.params,$.data]).pipe((0,Ut.n)(([We,kt,d],r)=>(d={...We,...kt,...d},0===r?(0,se.of)(d):Promise.resolve(d)))).subscribe(We=>{if(!B.isActivated||!B.activatedComponentRef||B.activatedRoute!==$||null===$.component)return void this.unsubscribeFromRouteData(B);const kt=(0,C.HJs)($.component);if(kt)for(const{templateName:d}of kt.inputs)B.activatedComponentRef.setInput(d,We[d]);else this.unsubscribeFromRouteData(B)});this.outletDataSubscriptions.set(B,me)}static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275prov=C.jDH({token:I,factory:I.\u0275fac})}}return I})();function Is(I,G,B){if(B&&I.shouldReuseRoute(G.value,B.value.snapshot)){const $=B.value;$._futureSnapshot=G.value;const me=function Xo(I,G,B){return G.children.map($=>{for(const me of B.children)if(I.shouldReuseRoute($.value,me.value.snapshot))return Is(I,$,me);return Is(I,$)})}(I,G,B);return new vs($,me)}{if(I.shouldAttach(G.value)){const We=I.retrieve(G.value);if(null!==We){const kt=We.route;return kt.value._futureSnapshot=G.value,kt.children=G.children.map(d=>Is(I,d)),kt}}const $=function Ka(I){return new Io(new Fe.t(I.url),new Fe.t(I.params),new Fe.t(I.queryParams),new Fe.t(I.fragment),new Fe.t(I.data),I.outlet,I.component,I)}(G.value),me=G.children.map(We=>Is(I,We));return new vs($,me)}}const Qs="ngNavigationCancelingError";function Sa(I,G){const{redirectTo:B,navigationBehaviorOptions:$}=Or(G)?{redirectTo:G,navigationBehaviorOptions:void 0}:G,me=ca(!1,Ui.Redirect);return me.url=B,me.navigationBehaviorOptions=$,me}function ca(I,G){const B=new Error(`NavigationCancelingError: ${I||""}`);return B[Qs]=!0,B.cancellationCode=G,B}function Go(I){return!!I&&I[Qs]}let rs=(()=>{class I{static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275cmp=C.VBU({type:I,selectors:[["ng-component"]],standalone:!0,features:[C.aNF],decls:1,vars:0,template:function($,me){1&$&&C.nrm(0,"router-outlet")},dependencies:[va],encapsulation:2})}}return I})();function ys(I){const G=I.children&&I.children.map(ys),B=G?{...I,children:G}:{...I};return!B.component&&!B.loadComponent&&(G||B.loadChildren)&&B.outlet&&B.outlet!==qn&&(B.component=rs),B}function xs(I){return I.outlet||qn}function Eo(I){if(!I)return null;if(I.routeConfig?._injector)return I.routeConfig._injector;for(let G=I.parent;G;G=G.parent){const B=G.routeConfig;if(B?._loadedInjector)return B._loadedInjector;if(B?._injector)return B._injector}return null}class Aa{constructor(G,B,$,me,We){this.routeReuseStrategy=G,this.futureState=B,this.currState=$,this.forwardEvent=me,this.inputBindingEnabled=We}activate(G){const B=this.futureState._root,$=this.currState?this.currState._root:null;this.deactivateChildRoutes(B,$,G),zs(this.futureState.root),this.activateChildRoutes(B,$,G)}deactivateChildRoutes(G,B,$){const me=_s(B);G.children.forEach(We=>{const kt=We.value.outlet;this.deactivateRoutes(We,me[kt],$),delete me[kt]}),Object.values(me).forEach(We=>{this.deactivateRouteAndItsChildren(We,$)})}deactivateRoutes(G,B,$){const me=G.value,We=B?B.value:null;if(me===We)if(me.component){const kt=$.getContext(me.outlet);kt&&this.deactivateChildRoutes(G,B,kt.children)}else this.deactivateChildRoutes(G,B,$);else We&&this.deactivateRouteAndItsChildren(B,$)}deactivateRouteAndItsChildren(G,B){G.value.component&&this.routeReuseStrategy.shouldDetach(G.value.snapshot)?this.detachAndStoreRouteSubtree(G,B):this.deactivateRouteAndOutlet(G,B)}detachAndStoreRouteSubtree(G,B){const $=B.getContext(G.value.outlet),me=$&&G.value.component?$.children:B,We=_s(G);for(const kt of Object.values(We))this.deactivateRouteAndItsChildren(kt,me);if($&&$.outlet){const kt=$.outlet.detach(),d=$.children.onOutletDeactivated();this.routeReuseStrategy.store(G.value.snapshot,{componentRef:kt,route:G,contexts:d})}}deactivateRouteAndOutlet(G,B){const $=B.getContext(G.value.outlet),me=$&&G.value.component?$.children:B,We=_s(G);for(const kt of Object.values(We))this.deactivateRouteAndItsChildren(kt,me);$&&($.outlet&&($.outlet.deactivate(),$.children.onOutletDeactivated()),$.attachRef=null,$.route=null)}activateChildRoutes(G,B,$){const me=_s(B);G.children.forEach(We=>{this.activateRoutes(We,me[We.value.outlet],$),this.forwardEvent(new Ga(We.value.snapshot))}),G.children.length&&this.forwardEvent(new gl(G.value.snapshot))}activateRoutes(G,B,$){const me=G.value,We=B?B.value:null;if(zs(me),me===We)if(me.component){const kt=$.getOrCreateContext(me.outlet);this.activateChildRoutes(G,B,kt.children)}else this.activateChildRoutes(G,B,$);else if(me.component){const kt=$.getOrCreateContext(me.outlet);if(this.routeReuseStrategy.shouldAttach(me.snapshot)){const d=this.routeReuseStrategy.retrieve(me.snapshot);this.routeReuseStrategy.store(me.snapshot,null),kt.children.onOutletReAttached(d.contexts),kt.attachRef=d.componentRef,kt.route=d.route.value,kt.outlet&&kt.outlet.attach(d.componentRef,d.route.value),zs(d.route.value),this.activateChildRoutes(G,null,kt.children)}else{const d=Eo(me.snapshot);kt.attachRef=null,kt.route=me,kt.injector=d,kt.outlet&&kt.outlet.activateWith(me,kt.injector),this.activateChildRoutes(G,null,kt.children)}}else this.activateChildRoutes(G,null,$)}}class Va{constructor(G){this.path=G,this.route=this.path[this.path.length-1]}}class Js{constructor(G,B){this.component=G,this.route=B}}function Hs(I,G,B){const $=I._root;return Hr($,G?G._root:null,B,[$.value])}function Wo(I,G){const B=Symbol(),$=G.get(I,B);return $===B?"function"!=typeof I||(0,C.LfX)(I)?G.get(I):I:$}function Hr(I,G,B,$,me={canDeactivateChecks:[],canActivateChecks:[]}){const We=_s(G);return I.children.forEach(kt=>{(function Ba(I,G,B,$,me={canDeactivateChecks:[],canActivateChecks:[]}){const We=I.value,kt=G?G.value:null,d=B?B.getContext(I.value.outlet):null;if(kt&&We.routeConfig===kt.routeConfig){const r=function Qa(I,G,B){if("function"==typeof B)return B(I,G);switch(B){case"pathParamsChange":return!ti(I.url,G.url);case"pathParamsOrQueryParamsChange":return!ti(I.url,G.url)||!ji(I.queryParams,G.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!xr(I,G)||!ji(I.queryParams,G.queryParams);default:return!xr(I,G)}}(kt,We,We.routeConfig.runGuardsAndResolvers);r?me.canActivateChecks.push(new Va($)):(We.data=kt.data,We._resolvedData=kt._resolvedData),Hr(I,G,We.component?d?d.children:null:B,$,me),r&&d&&d.outlet&&d.outlet.isActivated&&me.canDeactivateChecks.push(new Js(d.outlet.component,kt))}else kt&&ua(G,d,me),me.canActivateChecks.push(new Va($)),Hr(I,null,We.component?d?d.children:null:B,$,me)})(kt,We[kt.value.outlet],B,$.concat([kt.value]),me),delete We[kt.value.outlet]}),Object.entries(We).forEach(([kt,d])=>ua(d,B.getContext(kt),me)),me}function ua(I,G,B){const $=_s(I),me=I.value;Object.entries($).forEach(([We,kt])=>{ua(kt,me.component?G?G.children.getContext(We):null:G,B)}),B.canDeactivateChecks.push(new Js(me.component&&G&&G.outlet&&G.outlet.isActivated?G.outlet.component:null,me))}function xa(I){return"function"==typeof I}function K(I){return I instanceof ee.G||"EmptyError"===I?.name}const Ge=Symbol("INITIAL_VALUE");function Ht(){return(0,Ut.n)(I=>(0,ve.z)(I.map(G=>G.pipe((0,et.s)(1),(0,It.Z)(Ge)))).pipe((0,Yt.T)(G=>{for(const B of G)if(!0!==B){if(B===Ge)return Ge;if(!1===B||B instanceof en)return B}return!0}),(0,zt.p)(G=>G!==Ge),(0,et.s)(1)))}function Hl(I){return(0,ge.F)((0,St.M)(G=>{if(Or(G))throw Sa(0,G)}),(0,Yt.T)(G=>!0===G))}class Ha{constructor(G){this.segmentGroup=G||null}}class zl extends Error{constructor(G){super(),this.urlTree=G}}function el(I){return $e(new Ha(I))}class Ro{constructor(G,B){this.urlSerializer=G,this.urlTree=B}lineralizeSegments(G,B){let $=[],me=B.root;for(;;){if($=$.concat(me.segments),0===me.numberOfChildren)return(0,se.of)($);if(me.numberOfChildren>1||!me.children[qn])return $e(new C.wOt(4e3,!1));me=me.children[qn]}}applyRedirectCommands(G,B,$){const me=this.applyRedirectCreateUrlTree(B,this.urlSerializer.parse(B),G,$);if(B.startsWith("/"))throw new zl(me);return me}applyRedirectCreateUrlTree(G,B,$,me){const We=this.createSegmentGroup(G,B.root,$,me);return new en(We,this.createQueryParams(B.queryParams,this.urlTree.queryParams),B.fragment)}createQueryParams(G,B){const $={};return Object.entries(G).forEach(([me,We])=>{if("string"==typeof We&&We.startsWith(":")){const d=We.substring(1);$[me]=B[d]}else $[me]=We}),$}createSegmentGroup(G,B,$,me){const We=this.createSegments(G,B.segments,$,me);let kt={};return Object.entries(B.children).forEach(([d,r])=>{kt[d]=this.createSegmentGroup(G,r,$,me)}),new hn(We,kt)}createSegments(G,B,$,me){return B.map(We=>We.path.startsWith(":")?this.findPosParam(G,We,me):this.findOrReturn(We,$))}findPosParam(G,B,$){const me=$[B.path.substring(1)];if(!me)throw new C.wOt(4001,!1);return me}findOrReturn(G,B){let $=0;for(const me of B){if(me.path===G.path)return B.splice($),me;$++}return G}}const cs={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Es(I,G,B,$,me){const We=Zl(I,G,B);return We.matched?($=function ya(I,G){return I.providers&&!I._injector&&(I._injector=(0,C.Ol2)(I.providers,G,`Route: ${I.path}`)),I._injector??G}(G,$),function Ul(I,G,B,$){const me=G.canMatch;if(!me||0===me.length)return(0,se.of)(!0);const We=me.map(kt=>{const d=Wo(kt,I);return Dn(function Ae(I){return I&&xa(I.canMatch)}(d)?d.canMatch(G,B):(0,C.N4e)(I,()=>d(G,B)))});return(0,se.of)(We).pipe(Ht(),Hl())}($,G,B).pipe((0,Yt.T)(kt=>!0===kt?We:{...cs}))):(0,se.of)(We)}function Zl(I,G,B){if("**"===G.path)return function Il(I){return{matched:!0,parameters:I.length>0?jt(I).parameters:{},consumedSegments:I,remainingSegments:[],positionalParamSegments:{}}}(B);if(""===G.path)return"full"===G.pathMatch&&(I.hasChildren()||B.length>0)?{...cs}:{matched:!0,consumedSegments:[],remainingSegments:B,parameters:{},positionalParamSegments:{}};const me=(G.matcher||Mi)(B,I,G);if(!me)return{...cs};const We={};Object.entries(me.posParams??{}).forEach(([d,r])=>{We[d]=r.path});const kt=me.consumed.length>0?{...We,...me.consumed[me.consumed.length-1].parameters}:We;return{matched:!0,consumedSegments:me.consumed,remainingSegments:B.slice(me.consumed.length),parameters:kt,positionalParamSegments:me.posParams??{}}}function al(I,G,B,$){return B.length>0&&function za(I,G,B){return B.some($=>Ls(I,G,$)&&xs($)!==qn)}(I,B,$)?{segmentGroup:new hn(G,kl($,new hn(B,I.children))),slicedSegments:[]}:0===B.length&&function _l(I,G,B){return B.some($=>Ls(I,G,$))}(I,B,$)?{segmentGroup:new hn(I.segments,bs(I,B,$,I.children)),slicedSegments:B}:{segmentGroup:new hn(I.segments,I.children),slicedSegments:B}}function bs(I,G,B,$){const me={};for(const We of B)if(Ls(I,G,We)&&!$[xs(We)]){const kt=new hn([],{});me[xs(We)]=kt}return{...$,...me}}function kl(I,G){const B={};B[qn]=G;for(const $ of I)if(""===$.path&&xs($)!==qn){const me=new hn([],{});B[xs($)]=me}return B}function Ls(I,G,B){return(!(I.hasChildren()||G.length>0)||"full"!==B.pathMatch)&&""===B.path}class Ne{}class te{constructor(G,B,$,me,We,kt,d){this.injector=G,this.configLoader=B,this.rootComponentType=$,this.config=me,this.urlTree=We,this.paramsInheritanceStrategy=kt,this.urlSerializer=d,this.applyRedirects=new Ro(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(G){return new C.wOt(4002,`'${G.segmentGroup}'`)}recognize(){const G=al(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(G).pipe((0,Yt.T)(B=>{const $=new sa([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},qn,this.rootComponentType,null,{}),me=new vs($,B),We=new Ms("",me),kt=function ms(I,G,B=null,$=null){return fr(as(I),G,B,$)}($,[],this.urlTree.queryParams,this.urlTree.fragment);return kt.queryParams=this.urlTree.queryParams,We.url=this.urlSerializer.serialize(kt),this.inheritParamsAndData(We._root,null),{state:We,tree:kt}}))}match(G){return this.processSegmentGroup(this.injector,this.config,G,qn).pipe((0,wn.W)($=>{if($ instanceof zl)return this.urlTree=$.urlTree,this.match($.urlTree.root);throw $ instanceof Ha?this.noMatchError($):$}))}inheritParamsAndData(G,B){const $=G.value,me=po($,B,this.paramsInheritanceStrategy);$.params=Object.freeze(me.params),$.data=Object.freeze(me.data),G.children.forEach(We=>this.inheritParamsAndData(We,$))}processSegmentGroup(G,B,$,me){return 0===$.segments.length&&$.hasChildren()?this.processChildren(G,B,$):this.processSegment(G,B,$,$.segments,me,!0).pipe((0,Yt.T)(We=>We instanceof vs?[We]:[]))}processChildren(G,B,$){const me=[];for(const We of Object.keys($.children))"primary"===We?me.unshift(We):me.push(We);return(0,a.H)(me).pipe((0,Ze.H)(We=>{const kt=$.children[We],d=function hs(I,G){const B=I.filter($=>xs($)===G);return B.push(...I.filter($=>xs($)!==G)),B}(B,We);return this.processSegmentGroup(G,d,kt,We)}),function nn(I,G){return(0,Rn.N)(function Un(I,G,B,$,me){return(We,kt)=>{let d=B,r=G,u=0;We.subscribe((0,an._)(kt,m=>{const y=u++;r=d?I(r,m,y):(d=!0,m),$&&kt.next(r)},me&&(()=>{d&&kt.next(r),kt.complete()})))}}(I,G,arguments.length>=2,!0))}((We,kt)=>(We.push(...kt),We)),(0,di.U)(null),function Jt(I,G){const B=arguments.length>=2;return $=>$.pipe(I?(0,zt.p)((me,We)=>I(me,We,$)):ki.D,Wn(1),B?(0,di.U)(G):(0,$n.v)(()=>new ee.G))}(),(0,je.Z)(We=>{if(null===We)return el($);const kt=Lt(We);return function Le(I){I.sort((G,B)=>G.value.outlet===qn?-1:B.value.outlet===qn?1:G.value.outlet.localeCompare(B.value.outlet))}(kt),(0,se.of)(kt)}))}processSegment(G,B,$,me,We,kt){return(0,a.H)(B).pipe((0,Ze.H)(d=>this.processSegmentAgainstRoute(d._injector??G,B,d,$,me,We,kt).pipe((0,wn.W)(r=>{if(r instanceof Ha)return(0,se.of)(null);throw r}))),(0,At.$)(d=>!!d),(0,wn.W)(d=>{if(K(d))return function Ia(I,G,B){return 0===G.length&&!I.children[B]}($,me,We)?(0,se.of)(new Ne):el($);throw d}))}processSegmentAgainstRoute(G,B,$,me,We,kt,d){return function yl(I,G,B,$){return!!(xs(I)===$||$!==qn&&Ls(G,B,I))&&Zl(G,I,B).matched}($,me,We,kt)?void 0===$.redirectTo?this.matchSegmentAgainstRoute(G,me,$,We,kt):this.allowRedirects&&d?this.expandSegmentAgainstRouteUsingRedirect(G,me,B,$,We,kt):el(me):el(me)}expandSegmentAgainstRouteUsingRedirect(G,B,$,me,We,kt){const{matched:d,consumedSegments:r,positionalParamSegments:u,remainingSegments:m}=Zl(B,me,We);if(!d)return el(B);me.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const y=this.applyRedirects.applyRedirectCommands(r,me.redirectTo,u);return this.applyRedirects.lineralizeSegments(me,y).pipe((0,je.Z)(b=>this.processSegment(G,$,B,b.concat(m),kt,!1)))}matchSegmentAgainstRoute(G,B,$,me,We){const kt=Es(B,$,me,G);return"**"===$.path&&(B.children={}),kt.pipe((0,Ut.n)(d=>d.matched?this.getChildConfig(G=$._injector??G,$,me).pipe((0,Ut.n)(({routes:r})=>{const u=$._loadedInjector??G,{consumedSegments:m,remainingSegments:y,parameters:b}=d,S=new sa(m,b,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function mn(I){return I.data||{}}($),xs($),$.component??$._loadedComponent??null,$,function Pn(I){return I.resolve||{}}($)),{segmentGroup:z,slicedSegments:U}=al(B,m,y,r);if(0===U.length&&z.hasChildren())return this.processChildren(u,r,z).pipe((0,Yt.T)(Q=>null===Q?null:new vs(S,Q)));if(0===r.length&&0===U.length)return(0,se.of)(new vs(S,[]));const J=xs($)===We;return this.processSegment(u,r,z,U,J?qn:We,!0).pipe((0,Yt.T)(Q=>new vs(S,Q instanceof vs?[Q]:[])))})):el(B)))}getChildConfig(G,B,$){return B.children?(0,se.of)({routes:B.children,injector:G}):B.loadChildren?void 0!==B._loadedRoutes?(0,se.of)({routes:B._loadedRoutes,injector:B._loadedInjector}):function Pa(I,G,B,$){const me=G.canLoad;if(void 0===me||0===me.length)return(0,se.of)(!0);const We=me.map(kt=>{const d=Wo(kt,I);return Dn(function Pl(I){return I&&xa(I.canLoad)}(d)?d.canLoad(G,B):(0,C.N4e)(I,()=>d(G,B)))});return(0,se.of)(We).pipe(Ht(),Hl())}(G,B,$).pipe((0,je.Z)(me=>me?this.configLoader.loadChildren(G,B).pipe((0,St.M)(We=>{B._loadedRoutes=We.routes,B._loadedInjector=We.injector})):function os(I){return $e(ca(!1,Ui.GuardRejected))}())):(0,se.of)({routes:[],injector:G})}}function ot(I){const G=I.value.routeConfig;return G&&""===G.path}function Lt(I){const G=[],B=new Set;for(const $ of I){if(!ot($)){G.push($);continue}const me=G.find(We=>$.value.routeConfig===We.value.routeConfig);void 0!==me?(me.children.push(...$.children),B.add(me)):G.push($)}for(const $ of B){const me=Lt($.children);G.push(new vs($.value,me))}return G.filter($=>!B.has($))}function $r(I){const G=I.children.map(B=>$r(B)).flat();return[I,...G]}function bo(I){return(0,Ut.n)(G=>{const B=I(G);return B?(0,a.H)(B).pipe((0,Yt.T)(()=>G)):(0,se.of)(G)})}let vr=(()=>{class I{buildTitle(B){let $,me=B.root;for(;void 0!==me;)$=this.getResolvedTitleForRoute(me)??$,me=me.children.find(We=>We.outlet===qn);return $}getResolvedTitleForRoute(B){return B.data[ar]}static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275prov=C.jDH({token:I,factory:()=>(0,C.WQX)(Qo),providedIn:"root"})}}return I})(),Qo=(()=>{class I extends vr{constructor(B){super(),this.title=B}updateTitle(B){const $=this.buildTitle(B);void 0!==$&&this.title.setTitle($)}static{this.\u0275fac=function($){return new($||I)(C.KVO(zn.hE))}}static{this.\u0275prov=C.jDH({token:I,factory:I.\u0275fac,providedIn:"root"})}}return I})();const Ue=new C.nKC("",{providedIn:"root",factory:()=>({})}),De=new C.nKC("");let ie=(()=>{class I{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,C.WQX)(C.Ql9)}loadComponent(B){if(this.componentLoaders.get(B))return this.componentLoaders.get(B);if(B._loadedComponent)return(0,se.of)(B._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(B);const $=Dn(B.loadComponent()).pipe((0,Yt.T)(Ce),(0,St.M)(We=>{this.onLoadEndListener&&this.onLoadEndListener(B),B._loadedComponent=We}),(0,pn.j)(()=>{this.componentLoaders.delete(B)})),me=new bt.G($,()=>new xt.B).pipe((0,dn.B)());return this.componentLoaders.set(B,me),me}loadChildren(B,$){if(this.childrenLoaders.get($))return this.childrenLoaders.get($);if($._loadedRoutes)return(0,se.of)({routes:$._loadedRoutes,injector:$._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener($);const We=function le(I,G,B,$){return Dn(I.loadChildren()).pipe((0,Yt.T)(Ce),(0,je.Z)(me=>me instanceof C.Co$||Array.isArray(me)?(0,se.of)(me):(0,a.H)(G.compileModuleAsync(me))),(0,Yt.T)(me=>{$&&$(I);let We,kt,d=!1;return Array.isArray(me)?(kt=me,!0):(We=me.create(B).injector,kt=We.get(De,[],{optional:!0,self:!0}).flat()),{routes:kt.map(ys),injector:We}}))}($,this.compiler,B,this.onLoadEndListener).pipe((0,pn.j)(()=>{this.childrenLoaders.delete($)})),kt=new bt.G(We,()=>new xt.B).pipe((0,dn.B)());return this.childrenLoaders.set($,kt),kt}static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275prov=C.jDH({token:I,factory:I.\u0275fac,providedIn:"root"})}}return I})();function Ce(I){return function W(I){return I&&"object"==typeof I&&"default"in I}(I)?I.default:I}let xe=(()=>{class I{static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275prov=C.jDH({token:I,factory:()=>(0,C.WQX)(ei),providedIn:"root"})}}return I})(),ei=(()=>{class I{shouldProcessUrl(B){return!0}extract(B){return B}merge(B,$){return B}static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275prov=C.jDH({token:I,factory:I.\u0275fac,providedIn:"root"})}}return I})();const L=new C.nKC(""),Me=new C.nKC("");function X(I,G,B){const $=I.get(Me),me=I.get(sn.qQ);return I.get(C.SKi).runOutsideAngular(()=>{if(!me.startViewTransition||$.skipNextTransition)return $.skipNextTransition=!1,new Promise(u=>setTimeout(u));let We;const kt=new Promise(u=>{We=u}),d=me.startViewTransition(()=>(We(),function pe(I){return new Promise(G=>{(0,C.mal)(G,{injector:I})})}(I))),{onViewTransitionCreated:r}=$;return r&&(0,C.N4e)(I,()=>r({transition:d,from:G,to:B})),kt})}let vt=(()=>{class I{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new xt.B,this.transitionAbortSubject=new xt.B,this.configLoader=(0,C.WQX)(ie),this.environmentInjector=(0,C.WQX)(C.uvJ),this.urlSerializer=(0,C.WQX)(gi),this.rootContexts=(0,C.WQX)(Zs),this.location=(0,C.WQX)(sn.aZ),this.inputBindingEnabled=null!==(0,C.WQX)(_a,{optional:!0}),this.titleStrategy=(0,C.WQX)(vr),this.options=(0,C.WQX)(Ue,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=(0,C.WQX)(xe),this.createViewTransition=(0,C.WQX)(L,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,se.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=me=>this.events.next(new oa(me)),this.configLoader.onLoadStartListener=me=>this.events.next(new hr(me))}complete(){this.transitions?.complete()}handleNavigationRequest(B){const $=++this.navigationId;this.transitions?.next({...this.transitions.value,...B,id:$})}setupNavigations(B,$,me){return this.transitions=new Fe.t({id:0,currentUrlTree:$,currentRawUrl:$,extractedUrl:this.urlHandlingStrategy.extract($),urlAfterRedirects:this.urlHandlingStrategy.extract($),rawUrl:$,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:no,restoredState:null,currentSnapshot:me.snapshot,targetSnapshot:null,currentRouterState:me,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,zt.p)(We=>0!==We.id),(0,Yt.T)(We=>({...We,extractedUrl:this.urlHandlingStrategy.extract(We.rawUrl)})),(0,Ut.n)(We=>{let kt=!1,d=!1;return(0,se.of)(We).pipe((0,Ut.n)(r=>{if(this.navigationId>We.id)return this.cancelNavigationTransition(We,"",Ui.SupersededByNewNavigation),ze.w;this.currentTransition=We,this.currentNavigation={id:r.id,initialUrl:r.rawUrl,extractedUrl:r.extractedUrl,trigger:r.source,extras:r.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null};const u=!B.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!u&&"reload"!==(r.extras.onSameUrlNavigation??B.onSameUrlNavigation)){const y="";return this.events.next(new Oi(r.id,this.urlSerializer.serialize(r.rawUrl),y,ur.IgnoredSameUrlNavigation)),r.resolve(null),ze.w}if(this.urlHandlingStrategy.shouldProcessUrl(r.rawUrl))return(0,se.of)(r).pipe((0,Ut.n)(y=>{const b=this.transitions?.getValue();return this.events.next(new ii(y.id,this.urlSerializer.serialize(y.extractedUrl),y.source,y.restoredState)),b!==this.transitions?.getValue()?ze.w:Promise.resolve(y)}),function Pi(I,G,B,$,me,We){return(0,je.Z)(kt=>function N(I,G,B,$,me,We,kt="emptyOnly"){return new te(I,G,B,$,me,kt,We).recognize()}(I,G,B,$,kt.extractedUrl,me,We).pipe((0,Yt.T)(({state:d,tree:r})=>({...kt,targetSnapshot:d,urlAfterRedirects:r}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,B.config,this.urlSerializer,this.paramsInheritanceStrategy),(0,St.M)(y=>{We.targetSnapshot=y.targetSnapshot,We.urlAfterRedirects=y.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:y.urlAfterRedirects};const b=new mr(y.id,this.urlSerializer.serialize(y.extractedUrl),this.urlSerializer.serialize(y.urlAfterRedirects),y.targetSnapshot);this.events.next(b)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(r.currentRawUrl)){const{id:y,extractedUrl:b,source:S,restoredState:z,extras:U}=r,J=new ii(y,this.urlSerializer.serialize(b),S,z);this.events.next(J);const Q=ga(this.rootComponentType).snapshot;return this.currentTransition=We={...r,targetSnapshot:Q,urlAfterRedirects:b,extras:{...U,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=b,(0,se.of)(We)}{const y="";return this.events.next(new Oi(r.id,this.urlSerializer.serialize(r.extractedUrl),y,ur.IgnoredByUrlHandlingStrategy)),r.resolve(null),ze.w}}),(0,St.M)(r=>{const u=new io(r.id,this.urlSerializer.serialize(r.extractedUrl),this.urlSerializer.serialize(r.urlAfterRedirects),r.targetSnapshot);this.events.next(u)}),(0,Yt.T)(r=>(this.currentTransition=We={...r,guards:Hs(r.targetSnapshot,r.currentSnapshot,this.rootContexts)},We)),function Fi(I,G){return(0,je.Z)(B=>{const{targetSnapshot:$,currentSnapshot:me,guards:{canActivateChecks:We,canDeactivateChecks:kt}}=B;return 0===kt.length&&0===We.length?(0,se.of)({...B,guardsResult:!0}):function Sr(I,G,B,$){return(0,a.H)(I).pipe((0,je.Z)(me=>function Bl(I,G,B,$,me){const We=G&&G.routeConfig?G.routeConfig.canDeactivate:null;if(!We||0===We.length)return(0,se.of)(!0);const kt=We.map(d=>{const r=Eo(G)??me,u=Wo(d,r);return Dn(function be(I){return I&&xa(I.canDeactivate)}(u)?u.canDeactivate(I,G,B,$):(0,C.N4e)(r,()=>u(I,G,B,$))).pipe((0,At.$)())});return(0,se.of)(kt).pipe(Ht())}(me.component,me.route,B,G,$)),(0,At.$)(me=>!0!==me,!0))}(kt,$,me,I).pipe((0,je.Z)(d=>d&&function Os(I){return"boolean"==typeof I}(d)?function Yr(I,G,B,$){return(0,a.H)(G).pipe((0,Ze.H)(me=>(0,fe.x)(function ta(I,G){return null!==I&&G&&G(new jo(I)),(0,se.of)(!0)}(me.route.parent,$),function ea(I,G){return null!==I&&G&&G(new ol(I)),(0,se.of)(!0)}(me.route,$),function Us(I,G,B){const $=G[G.length-1],We=G.slice(0,G.length-1).reverse().map(kt=>function ko(I){const G=I.routeConfig?I.routeConfig.canActivateChild:null;return G&&0!==G.length?{node:I,guards:G}:null}(kt)).filter(kt=>null!==kt).map(kt=>(0,he.v)(()=>{const d=kt.guards.map(r=>{const u=Eo(kt.node)??B,m=Wo(r,u);return Dn(function vl(I){return I&&xa(I.canActivateChild)}(m)?m.canActivateChild($,I):(0,C.N4e)(u,()=>m($,I))).pipe((0,At.$)())});return(0,se.of)(d).pipe(Ht())}));return(0,se.of)(We).pipe(Ht())}(I,me.path,B),function Ja(I,G,B){const $=G.routeConfig?G.routeConfig.canActivate:null;if(!$||0===$.length)return(0,se.of)(!0);const me=$.map(We=>(0,he.v)(()=>{const kt=Eo(G)??B,d=Wo(We,kt);return Dn(function sl(I){return I&&xa(I.canActivate)}(d)?d.canActivate(G,I):(0,C.N4e)(kt,()=>d(G,I))).pipe((0,At.$)())}));return(0,se.of)(me).pipe(Ht())}(I,me.route,B))),(0,At.$)(me=>!0!==me,!0))}($,We,I,G):(0,se.of)(d)),(0,Yt.T)(d=>({...B,guardsResult:d})))})}(this.environmentInjector,r=>this.events.next(r)),(0,St.M)(r=>{if(We.guardsResult=r.guardsResult,Or(r.guardsResult))throw Sa(0,r.guardsResult);const u=new yo(r.id,this.urlSerializer.serialize(r.extractedUrl),this.urlSerializer.serialize(r.urlAfterRedirects),r.targetSnapshot,!!r.guardsResult);this.events.next(u)}),(0,zt.p)(r=>!!r.guardsResult||(this.cancelNavigationTransition(r,"",Ui.GuardRejected),!1)),bo(r=>{if(r.guards.canActivateChecks.length)return(0,se.of)(r).pipe((0,St.M)(u=>{const m=new Ji(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(m)}),(0,Ut.n)(u=>{let m=!1;return(0,se.of)(u).pipe(function Yi(I,G){return(0,je.Z)(B=>{const{targetSnapshot:$,guards:{canActivateChecks:me}}=B;if(!me.length)return(0,se.of)(B);const We=new Set(me.map(r=>r.route)),kt=new Set;for(const r of We)if(!kt.has(r))for(const u of $r(r))kt.add(u);let d=0;return(0,a.H)(kt).pipe((0,Ze.H)(r=>We.has(r)?function cr(I,G,B,$){const me=I.routeConfig,We=I._resolve;return void 0!==me?.title&&!aa(me)&&(We[ar]=me.title),function ir(I,G,B,$){const me=Ln(I);if(0===me.length)return(0,se.of)({});const We={};return(0,a.H)(me).pipe((0,je.Z)(kt=>function Ar(I,G,B,$){const me=Eo(G)??$,We=Wo(I,me);return Dn(We.resolve?We.resolve(G,B):(0,C.N4e)(me,()=>We(G,B)))}(I[kt],G,B,$).pipe((0,At.$)(),(0,St.M)(d=>{We[kt]=d}))),Wn(1),(0,un.u)(We),(0,wn.W)(kt=>K(kt)?ze.w:$e(kt)))}(We,I,G,$).pipe((0,Yt.T)(kt=>(I._resolvedData=kt,I.data=po(I,I.parent,B).resolve,null)))}(r,$,I,G):(r.data=po(r,r.parent,I).resolve,(0,se.of)(void 0))),(0,St.M)(()=>d++),Wn(1),(0,je.Z)(r=>d===kt.size?(0,se.of)(B):ze.w))})}(this.paramsInheritanceStrategy,this.environmentInjector),(0,St.M)({next:()=>m=!0,complete:()=>{m||this.cancelNavigationTransition(u,"",Ui.NoDataFromResolver)}}))}),(0,St.M)(u=>{const m=new Zi(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(m)}))}),bo(r=>{const u=m=>{const y=[];m.routeConfig?.loadComponent&&!m.routeConfig._loadedComponent&&y.push(this.configLoader.loadComponent(m.routeConfig).pipe((0,St.M)(b=>{m.component=b}),(0,Yt.T)(()=>{})));for(const b of m.children)y.push(...u(b));return y};return(0,ve.z)(u(r.targetSnapshot.root)).pipe((0,di.U)(null),(0,et.s)(1))}),bo(()=>this.afterPreactivation()),(0,Ut.n)(()=>{const{currentSnapshot:r,targetSnapshot:u}=We,m=this.createViewTransition?.(this.environmentInjector,r.root,u.root);return m?(0,a.H)(m).pipe((0,Yt.T)(()=>We)):(0,se.of)(We)}),(0,Yt.T)(r=>{const u=function la(I,G,B){const $=Is(I,G._root,B?B._root:void 0);return new xo($,G)}(B.routeReuseStrategy,r.targetSnapshot,r.currentRouterState);return this.currentTransition=We={...r,targetRouterState:u},this.currentNavigation.targetRouterState=u,We}),(0,St.M)(()=>{this.events.next(new Dr)}),((I,G,B,$)=>(0,Yt.T)(me=>(new Aa(G,me.targetRouterState,me.currentRouterState,B,$).activate(I),me)))(this.rootContexts,B.routeReuseStrategy,r=>this.events.next(r),this.inputBindingEnabled),(0,et.s)(1),(0,St.M)({next:r=>{kt=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new vi(r.id,this.urlSerializer.serialize(r.extractedUrl),this.urlSerializer.serialize(r.urlAfterRedirects))),this.titleStrategy?.updateTitle(r.targetRouterState.snapshot),r.resolve(!0)},complete:()=>{kt=!0}}),(0,jn.Q)(this.transitionAbortSubject.pipe((0,St.M)(r=>{throw r}))),(0,pn.j)(()=>{!kt&&!d&&this.cancelNavigationTransition(We,"",Ui.SupersededByNewNavigation),this.currentTransition?.id===We.id&&(this.currentNavigation=null,this.currentTransition=null)}),(0,wn.W)(r=>{if(d=!0,Go(r))this.events.next(new Ri(We.id,this.urlSerializer.serialize(We.extractedUrl),r.message,r.cancellationCode)),function qa(I){return Go(I)&&Or(I.url)}(r)?this.events.next(new Ps(r.url)):We.resolve(!1);else{this.events.next(new nr(We.id,this.urlSerializer.serialize(We.extractedUrl),r,We.targetSnapshot??void 0));try{We.resolve(B.errorHandler(r))}catch(u){this.options.resolveNavigationPromiseOnError?We.resolve(!1):We.reject(u)}}return ze.w}))}))}cancelNavigationTransition(B,$,me){const We=new Ri(B.id,this.urlSerializer.serialize(B.extractedUrl),$,me);this.events.next(We),B.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275prov=C.jDH({token:I,factory:I.\u0275fac,providedIn:"root"})}}return I})();function Nt(I){return I!==no}let tn=(()=>{class I{static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275prov=C.jDH({token:I,factory:()=>(0,C.WQX)(zi),providedIn:"root"})}}return I})();class Xt{shouldDetach(G){return!1}store(G,B){}shouldAttach(G){return!1}retrieve(G){return null}shouldReuseRoute(G,B){return G.routeConfig===B.routeConfig}}let zi=(()=>{class I extends Xt{static{this.\u0275fac=(()=>{let B;return function(me){return(B||(B=C.xGo(I)))(me||I)}})()}static{this.\u0275prov=C.jDH({token:I,factory:I.\u0275fac,providedIn:"root"})}}return I})(),pr=(()=>{class I{static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275prov=C.jDH({token:I,factory:()=>(0,C.WQX)(Pr),providedIn:"root"})}}return I})(),Pr=(()=>{class I extends pr{constructor(){super(...arguments),this.location=(0,C.WQX)(sn.aZ),this.urlSerializer=(0,C.WQX)(gi),this.options=(0,C.WQX)(Ue,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=(0,C.WQX)(xe),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new en,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=ga(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(B){return this.location.subscribe($=>{"popstate"===$.type&&B($.url,$.state)})}handleRouterEvent(B,$){if(B instanceof ii)this.stateMemento=this.createStateMemento();else if(B instanceof Oi)this.rawUrlTree=$.initialUrl;else if(B instanceof mr){if("eager"===this.urlUpdateStrategy&&!$.extras.skipLocationChange){const me=this.urlHandlingStrategy.merge($.finalUrl,$.initialUrl);this.setBrowserUrl(me,$)}}else B instanceof Dr?(this.currentUrlTree=$.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge($.finalUrl,$.initialUrl),this.routerState=$.targetRouterState,"deferred"===this.urlUpdateStrategy&&($.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,$))):B instanceof Ri&&(B.code===Ui.GuardRejected||B.code===Ui.NoDataFromResolver)?this.restoreHistory($):B instanceof nr?this.restoreHistory($,!0):B instanceof vi&&(this.lastSuccessfulId=B.id,this.currentPageId=this.browserPageId)}setBrowserUrl(B,$){const me=this.urlSerializer.serialize(B);if(this.location.isCurrentPathEqualTo(me)||$.extras.replaceUrl){const kt={...$.extras.state,...this.generateNgRouterState($.id,this.browserPageId)};this.location.replaceState(me,"",kt)}else{const We={...$.extras.state,...this.generateNgRouterState($.id,this.browserPageId+1)};this.location.go(me,"",We)}}restoreHistory(B,$=!1){if("computed"===this.canceledNavigationResolution){const We=this.currentPageId-this.browserPageId;0!==We?this.location.historyGo(We):this.currentUrlTree===B.finalUrl&&0===We&&(this.resetState(B),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&($&&this.resetState(B),this.resetUrlToCurrentUrlTree())}resetState(B){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,B.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(B,$){return"computed"===this.canceledNavigationResolution?{navigationId:B,\u0275routerPageId:$}:{navigationId:B}}static{this.\u0275fac=(()=>{let B;return function(me){return(B||(B=C.xGo(I)))(me||I)}})()}static{this.\u0275prov=C.jDH({token:I,factory:I.\u0275fac,providedIn:"root"})}}return I})();var er=function(I){return I[I.COMPLETE=0]="COMPLETE",I[I.FAILED=1]="FAILED",I[I.REDIRECTING=2]="REDIRECTING",I}(er||{});function _r(I,G){I.events.pipe((0,zt.p)(B=>B instanceof vi||B instanceof Ri||B instanceof nr||B instanceof Oi),(0,Yt.T)(B=>B instanceof vi||B instanceof Oi?er.COMPLETE:B instanceof Ri&&(B.code===Ui.Redirect||B.code===Ui.SupersededByNewNavigation)?er.REDIRECTING:er.FAILED),(0,zt.p)(B=>B!==er.REDIRECTING),(0,et.s)(1)).subscribe(()=>{G()})}function rr(I){throw I}const qr={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Fr={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let In=(()=>{class I{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=(0,C.WQX)(C.H3F),this.stateManager=(0,C.WQX)(pr),this.options=(0,C.WQX)(Ue,{optional:!0})||{},this.pendingTasks=(0,C.WQX)(C.TgB),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=(0,C.WQX)(vt),this.urlSerializer=(0,C.WQX)(gi),this.location=(0,C.WQX)(sn.aZ),this.urlHandlingStrategy=(0,C.WQX)(xe),this._events=new xt.B,this.errorHandler=this.options.errorHandler||rr,this.navigated=!1,this.routeReuseStrategy=(0,C.WQX)(tn),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=(0,C.WQX)(De,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!(0,C.WQX)(_a,{optional:!0}),this.eventsSubscription=new Qt.yU,this.isNgZoneEnabled=(0,C.WQX)(C.SKi)instanceof C.SKi&&C.SKi.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:B=>{this.console.warn(B)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const B=this.navigationTransitions.events.subscribe($=>{try{const me=this.navigationTransitions.currentTransition,We=this.navigationTransitions.currentNavigation;if(null!==me&&null!==We)if(this.stateManager.handleRouterEvent($,We),$ instanceof Ri&&$.code!==Ui.Redirect&&$.code!==Ui.SupersededByNewNavigation)this.navigated=!0;else if($ instanceof vi)this.navigated=!0;else if($ instanceof Ps){const kt=this.urlHandlingStrategy.merge($.url,me.currentRawUrl),d={info:me.extras.info,skipLocationChange:me.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Nt(me.source)};this.scheduleNavigation(kt,no,null,d,{resolve:me.resolve,reject:me.reject,promise:me.promise})}(function Tr(I){return!(I instanceof Dr||I instanceof Ps)})($)&&this._events.next($)}catch(me){this.navigationTransitions.transitionAbortSubject.next(me)}});this.eventsSubscription.add(B)}resetRootComponentType(B){this.routerState.root.component=B,this.navigationTransitions.rootComponentType=B}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),no,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((B,$)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(B,"popstate",$)},0)})}navigateToSyncWithBrowser(B,$,me){const We={replaceUrl:!0},kt=me?.navigationId?me:null;if(me){const r={...me};delete r.navigationId,delete r.\u0275routerPageId,0!==Object.keys(r).length&&(We.state=r)}const d=this.parseUrl(B);this.scheduleNavigation(d,$,kt,We)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(B){this.config=B.map(ys),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(B,$={}){const{relativeTo:me,queryParams:We,fragment:kt,queryParamsHandling:d,preserveFragment:r}=$,u=r?this.currentUrlTree.fragment:kt;let y,m=null;switch(d){case"merge":m={...this.currentUrlTree.queryParams,...We};break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=We||null}null!==m&&(m=this.removeEmptyProps(m));try{y=as(me?me.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof B[0]||!B[0].startsWith("/"))&&(B=[]),y=this.currentUrlTree.root}return fr(y,B,m,u??null)}navigateByUrl(B,$={skipLocationChange:!1}){const me=Or(B)?B:this.parseUrl(B),We=this.urlHandlingStrategy.merge(me,this.rawUrlTree);return this.scheduleNavigation(We,no,null,$)}navigate(B,$={skipLocationChange:!1}){return function Ni(I){for(let G=0;G<I.length;G++)if(null==I[G])throw new C.wOt(4008,!1)}(B),this.navigateByUrl(this.createUrlTree(B,$),$)}serializeUrl(B){return this.urlSerializer.serialize(B)}parseUrl(B){try{return this.urlSerializer.parse(B)}catch{return this.urlSerializer.parse("/")}}isActive(B,$){let me;if(me=!0===$?{...qr}:!1===$?{...Fr}:$,Or(B))return On(this.currentUrlTree,B,me);const We=this.parseUrl(B);return On(this.currentUrlTree,We,me)}removeEmptyProps(B){return Object.entries(B).reduce(($,[me,We])=>(null!=We&&($[me]=We),$),{})}scheduleNavigation(B,$,me,We,kt){if(this.disposed)return Promise.resolve(!1);let d,r,u;kt?(d=kt.resolve,r=kt.reject,u=kt.promise):u=new Promise((y,b)=>{d=y,r=b});const m=this.pendingTasks.add();return _r(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(m))}),this.navigationTransitions.handleNavigationRequest({source:$,restoredState:me,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:B,extras:We,resolve:d,reject:r,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(y=>Promise.reject(y))}static{this.\u0275fac=function($){return new($||I)}}static{this.\u0275prov=C.jDH({token:I,factory:I.\u0275fac,providedIn:"root"})}}return I})(),uo=(()=>{class I{constructor(B,$,me,We,kt,d){this.router=B,this.route=$,this.tabIndexAttribute=me,this.renderer=We,this.el=kt,this.locationStrategy=d,this.href=null,this.commands=null,this.onChanges=new xt.B,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const r=kt.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===r||"area"===r,this.isAnchorElement?this.subscription=B.events.subscribe(u=>{u instanceof vi&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(B){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",B)}ngOnChanges(B){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(B){null!=B?(this.commands=Array.isArray(B)?B:[B],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(B,$,me,We,kt){const d=this.urlTree;return!!(null===d||this.isAnchorElement&&(0!==B||$||me||We||kt||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(d,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const B=this.urlTree;this.href=null!==B&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(B)):null;const $=null===this.href?null:(0,C.n$t)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",$)}applyAttributeValue(B,$){const me=this.renderer,We=this.el.nativeElement;null!==$?me.setAttribute(We,B,$):me.removeAttribute(We,B)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function($){return new($||I)(C.rXU(In),C.rXU(Io),C.kS0("tabindex"),C.rXU(C.sFG),C.rXU(C.aKT),C.rXU(sn.hb))}}static{this.\u0275dir=C.FsC({type:I,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function($,me){1&$&&C.bIt("click",function(kt){return me.onClick(kt.button,kt.ctrlKey,kt.shiftKey,kt.altKey,kt.metaKey)}),2&$&&C.BMQ("target",me.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[C.Mj6.HasDecoratorInputTransform,"preserveFragment","preserveFragment",C.L39],skipLocationChange:[C.Mj6.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",C.L39],replaceUrl:[C.Mj6.HasDecoratorInputTransform,"replaceUrl","replaceUrl",C.L39],routerLink:"routerLink"},standalone:!0,features:[C.GFd,C.OA$]})}}return I})();class ba{}let Ds=(()=>{class I{constructor(B,$,me,We,kt){this.router=B,this.injector=me,this.preloadingStrategy=We,this.loader=kt}setUpPreloading(){this.subscription=this.router.events.pipe((0,zt.p)(B=>B instanceof vi),(0,Ze.H)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(B,$){const me=[];for(const We of $){We.providers&&!We._injector&&(We._injector=(0,C.Ol2)(We.providers,B,`Route: ${We.path}`));const kt=We._injector??B,d=We._loadedInjector??kt;(We.loadChildren&&!We._loadedRoutes&&void 0===We.canLoad||We.loadComponent&&!We._loadedComponent)&&me.push(this.preloadConfig(kt,We)),(We.children||We._loadedRoutes)&&me.push(this.processRoutes(d,We.children??We._loadedRoutes))}return(0,a.H)(me).pipe((0,Yn.U)())}preloadConfig(B,$){return this.preloadingStrategy.preload($,()=>{let me;me=$.loadChildren&&void 0===$.canLoad?this.loader.loadChildren(B,$):(0,se.of)(null);const We=me.pipe((0,je.Z)(kt=>null===kt?(0,se.of)(void 0):($._loadedRoutes=kt.routes,$._loadedInjector=kt.injector,this.processRoutes(kt.injector??B,kt.routes))));if($.loadComponent&&!$._loadedComponent){const kt=this.loader.loadComponent($);return(0,a.H)([We,kt]).pipe((0,Yn.U)())}return We})}static{this.\u0275fac=function($){return new($||I)(C.KVO(In),C.KVO(C.Ql9),C.KVO(C.uvJ),C.KVO(ba),C.KVO(ie))}}static{this.\u0275prov=C.jDH({token:I,factory:I.\u0275fac,providedIn:"root"})}}return I})();const Ir=new C.nKC("");let ll=(()=>{class I{constructor(B,$,me,We,kt={}){this.urlSerializer=B,this.transitions=$,this.viewportScroller=me,this.zone=We,this.options=kt,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=(0,C.WQX)(C.uvJ),kt.scrollPositionRestoration||="disabled",kt.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(B=>{B instanceof ii?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=B.navigationTrigger,this.restoredId=B.restoredState?B.restoredState.navigationId:0):B instanceof vi?(this.lastId=B.id,this.scheduleScrollEvent(B,this.urlSerializer.parse(B.urlAfterRedirects).fragment)):B instanceof Oi&&B.code===ur.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(B,this.urlSerializer.parse(B.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(B=>{B instanceof qs&&(B.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(B.position):B.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(B.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(B,$){var me=this;this.zone.runOutsideAngular((0,M.A)(function*(){yield new Promise(We=>{setTimeout(()=>{We()}),(0,C.mal)(()=>{We()},{injector:me.environmentInjector})}),me.zone.run(()=>{me.transitions.events.next(new qs(B,"popstate"===me.lastSource?me.store[me.restoredId]:null,$))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function($){C.QTQ()}}static{this.\u0275prov=C.jDH({token:I,factory:I.\u0275fac})}}return I})();function ao(I,G){return{\u0275kind:I,\u0275providers:G}}function Yl(){const I=(0,C.WQX)(C.zZn);return G=>{const B=I.get(C.o8S);if(G!==B.components[0])return;const $=I.get(In),me=I.get(Fo);1===I.get(wo)&&$.initialNavigation(),I.get(xl,null,C.$GK.Optional)?.setUpPreloading(),I.get(Ir,null,C.$GK.Optional)?.init(),$.resetRootComponentType(B.componentTypes[0]),me.closed||(me.next(),me.complete(),me.unsubscribe())}}const Fo=new C.nKC("",{factory:()=>new xt.B}),wo=new C.nKC("",{providedIn:"root",factory:()=>1}),xl=new C.nKC("");function No(I){return ao(0,[{provide:xl,useExisting:Ds},{provide:ba,useExisting:I}])}function Jo(I){return ao(9,[{provide:L,useValue:X},{provide:Me,useValue:{skipNextTransition:!!I?.skipInitialTransition,...I}}])}const Pc=new C.nKC("ROUTER_FORROOT_GUARD"),ha=[sn.aZ,{provide:gi,useClass:lt},In,Zs,{provide:Io,useFactory:function ka(I){return I.routerState.root},deps:[In]},ie,[]];let ja=(()=>{class I{constructor(B){}static forRoot(B,$){return{ngModule:I,providers:[ha,[],{provide:De,multi:!0,useValue:B},{provide:Pc,useFactory:tu,deps:[[In,new C.Xx1,new C.kdw]]},{provide:Ue,useValue:$||{}},$?.useHash?{provide:sn.hb,useClass:sn.fw}:{provide:sn.hb,useClass:sn.Sm},{provide:Ir,useFactory:()=>{const I=(0,C.WQX)(sn.Xr),G=(0,C.WQX)(C.SKi),B=(0,C.WQX)(Ue),$=(0,C.WQX)(vt),me=(0,C.WQX)(gi);return B.scrollOffset&&I.setOffset(B.scrollOffset),new ll(me,$,I,G,B)}},$?.preloadingStrategy?No($.preloadingStrategy).\u0275providers:[],$?.initialNavigation?zc($):[],$?.bindToComponentInputs?ao(8,[Xs,{provide:_a,useExisting:Xs}]).\u0275providers:[],$?.enableViewTransitions?Jo().\u0275providers:[],[{provide:Xl,useFactory:Yl},{provide:C.iLQ,multi:!0,useExisting:Xl}]]}}static forChild(B){return{ngModule:I,providers:[{provide:De,multi:!0,useValue:B}]}}static{this.\u0275fac=function($){return new($||I)(C.KVO(Pc,8))}}static{this.\u0275mod=C.$C({type:I})}static{this.\u0275inj=C.G2t({})}}return I})();function tu(I){return"guarded"}function zc(I){return["disabled"===I.initialNavigation?ao(3,[{provide:C.hnV,multi:!0,useFactory:()=>{const G=(0,C.WQX)(In);return()=>{G.setUpLocationChangeListener()}}},{provide:wo,useValue:2}]).\u0275providers:[],"enabledBlocking"===I.initialNavigation?ao(2,[{provide:wo,useValue:0},{provide:C.hnV,multi:!0,deps:[C.zZn],useFactory:G=>{const B=G.get(sn.hj,Promise.resolve());return()=>B.then(()=>new Promise($=>{const me=G.get(In),We=G.get(Fo);_r(me,()=>{$(!0)}),G.get(vt).afterPreactivation=()=>($(!0),We.closed?(0,se.of)(void 0):We),me.initialNavigation()}))}}]).\u0275providers:[]]}const Xl=new C.nKC("")},6267:(Nn,Ct,R)=>{"use strict";R.d(Ct,{A:()=>C});var M=R(3628);function C(se,Fe,ve){if(void 0===ve&&(ve={}),!se)throw new Error("point is required");if(!Fe)throw new Error("polygon is required");var ee=(0,M.uG)(se),fe=(0,M.bg)(Fe),he=fe.type,ge=Fe.bbox,at=fe.coordinates;if(ge&&!1===function a(se,Fe){return Fe[0]<=se[0]&&Fe[1]<=se[1]&&Fe[2]>=se[0]&&Fe[3]>=se[1]}(ee,ge))return!1;"Polygon"===he&&(at=[at]);for(var mt=!1,$e=0;$e<at.length&&!mt;$e++)if(de(ee,at[$e][0],ve.ignoreBoundary)){for(var ze=!1,bt=1;bt<at[$e].length&&!ze;)de(ee,at[$e][bt],!ve.ignoreBoundary)&&(ze=!0),bt++;ze||(mt=!0)}return mt}function de(se,Fe,ve){var ee=!1;Fe[0][0]===Fe[Fe.length-1][0]&&Fe[0][1]===Fe[Fe.length-1][1]&&(Fe=Fe.slice(0,Fe.length-1));for(var fe=0,he=Fe.length-1;fe<Fe.length;he=fe++){var ge=Fe[fe][0],at=Fe[fe][1],mt=Fe[he][0],$e=Fe[he][1];if(se[1]*(ge-mt)+at*(mt-se[0])+$e*(se[0]-ge)==0&&(ge-se[0])*(mt-se[0])<=0&&(at-se[1])*($e-se[1])<=0)return!ve;at>se[1]!=$e>se[1]&&se[0]<(mt-ge)*(se[1]-at)/($e-at)+ge&&(ee=!ee)}return ee}},1354:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Gf:()=>Yt,Lr:()=>mt,N4:()=>se,NU:()=>$e,cJ:()=>sn,g5:()=>bt,n1:()=>fe,nv:()=>It,tR:()=>zt,wi:()=>ge,zX:()=>M,zb:()=>xt,zx:()=>ve});var M=6371008.8,C={centimeters:100*M,centimetres:100*M,degrees:M/111325,feet:3.28084*M,inches:39.37*M,kilometers:M/1e3,kilometres:M/1e3,meters:M,metres:M,miles:M/1609.344,millimeters:1e3*M,millimetres:1e3*M,nauticalmiles:M/1852,radians:1,yards:1.0936*M};function se(an,Un,nn){void 0===nn&&(nn={});var di={type:"Feature"};return(0===nn.id||nn.id)&&(di.id=nn.id),nn.bbox&&(di.bbox=nn.bbox),di.properties=Un||{},di.geometry=an,di}function ve(an,Un,nn){if(void 0===nn&&(nn={}),!an)throw new Error("coordinates is required");if(!Array.isArray(an))throw new Error("coordinates must be an Array");if(an.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ze(an[0])||!Ze(an[1]))throw new Error("coordinates must contain numbers");return se({type:"Point",coordinates:an},Un,nn)}function fe(an,Un,nn){void 0===nn&&(nn={});for(var di=0,Wn=an;di<Wn.length;di++){var $n=Wn[di];if($n.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var ki=0;ki<$n[$n.length-1].length;ki++)if($n[$n.length-1][ki]!==$n[0][ki])throw new Error("First and last Position are not equivalent.")}return se({type:"Polygon",coordinates:an},Un,nn)}function ge(an,Un,nn){if(void 0===nn&&(nn={}),an.length<2)throw new Error("coordinates must be an array of two or more positions");return se({type:"LineString",coordinates:an},Un,nn)}function mt(an,Un){void 0===Un&&(Un={});var nn={type:"FeatureCollection"};return Un.id&&(nn.id=Un.id),Un.bbox&&(nn.bbox=Un.bbox),nn.features=an,nn}function $e(an,Un,nn){return void 0===nn&&(nn={}),se({type:"MultiLineString",coordinates:an},Un,nn)}function bt(an,Un,nn){return void 0===nn&&(nn={}),se({type:"MultiPolygon",coordinates:an},Un,nn)}function xt(an,Un,nn){return void 0===nn&&(nn={}),se({type:"GeometryCollection",geometries:an},Un,nn)}function sn(an,Un){void 0===Un&&(Un="kilometers");var nn=C[Un];if(!nn)throw new Error(Un+" units is invalid");return an*nn}function Yt(an,Un){void 0===Un&&(Un="kilometers");var nn=C[Un];if(!nn)throw new Error(Un+" units is invalid");return an/nn}function It(an){return an%(2*Math.PI)*180/Math.PI}function zt(an){return an%360*Math.PI/180}function Ze(an){return!isNaN(an)&&null!==an&&!Array.isArray(an)}},3628:(Nn,Ct,R)=>{"use strict";function C(he){if(!he)throw new Error("coord is required");if(!Array.isArray(he)){if("Feature"===he.type&&null!==he.geometry&&"Point"===he.geometry.type)return he.geometry.coordinates;if("Point"===he.type)return he.coordinates}if(Array.isArray(he)&&he.length>=2&&!Array.isArray(he[0])&&!Array.isArray(he[1]))return he;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ee(he){return"Feature"===he.type?he.geometry:he}R.d(Ct,{bg:()=>ee,uG:()=>C}),R(1354)},513:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Zw:()=>Ut,aO:()=>sn,dn:()=>Yt});var M=R(1635),C=R(4438),de=R(1413),a=R(3726),se=R(6977),Fe=R(9172),ve=R(5964),ee=R(6035),fe=R(317),he=R(8799),ge=R(8203),at=R(177),mt=R(6389),$e=R(5930);const ze=["nz-button",""],bt=["*"];function xt(et,It){1&et&&C.nrm(0,"span",1)}let sn=(()=>{class et{insertSpan(zt,je){zt.forEach(At=>{if("#text"===At.nodeName){const Ze=je.createElement("span"),St=je.parentNode(At);je.insertBefore(St,Ze,At),je.appendChild(Ze,At)}})}get iconOnly(){const zt=Array.from(this.elementRef?.nativeElement?.childNodes||[]),je=zt.every(St=>"#text"!==St.nodeName),At=0==zt.filter(St=>!("#comment"===St.nodeName||St?.attributes?.getNamedItem("nz-icon"))).length;return!!this.nzIconDirectiveElement&&At&&je}constructor(zt,je,At,Ze,St,wn){this.ngZone=zt,this.elementRef=je,this.cdr=At,this.renderer=Ze,this.nzConfigService=St,this.directionality=wn,this._nzModuleName="button",this.nzBlock=!1,this.nzGhost=!1,this.nzSearch=!1,this.nzLoading=!1,this.nzDanger=!1,this.disabled=!1,this.tabIndex=null,this.nzType=null,this.nzShape=null,this.nzSize="default",this.dir="ltr",this.destroy$=new de.B,this.loading$=new de.B,this.nzConfigService.getConfigChangeEventForComponent("button").pipe((0,se.Q)(this.destroy$)).subscribe(()=>{this.cdr.markForCheck()})}ngOnInit(){this.directionality.change?.pipe((0,se.Q)(this.destroy$)).subscribe(zt=>{this.dir=zt,this.cdr.detectChanges()}),this.dir=this.directionality.value,this.ngZone.runOutsideAngular(()=>{(0,a.R)(this.elementRef.nativeElement,"click",{capture:!0}).pipe((0,se.Q)(this.destroy$)).subscribe(zt=>{(this.disabled&&"A"===zt.target?.tagName||this.nzLoading)&&(zt.preventDefault(),zt.stopImmediatePropagation())})})}ngOnChanges(zt){const{nzLoading:je}=zt;je&&this.loading$.next(this.nzLoading)}ngAfterViewInit(){this.insertSpan(this.elementRef.nativeElement.childNodes,this.renderer)}ngAfterContentInit(){this.loading$.pipe((0,Fe.Z)(this.nzLoading),(0,ve.p)(()=>!!this.nzIconDirectiveElement),(0,se.Q)(this.destroy$)).subscribe(zt=>{const je=this.nzIconDirectiveElement.nativeElement;zt?this.renderer.setStyle(je,"display","none"):this.renderer.removeStyle(je,"display")})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(je){return new(je||et)(C.rXU(C.SKi),C.rXU(C.aKT),C.rXU(C.gRc),C.rXU(C.sFG),C.rXU(ee.yx),C.rXU(ge.dS,8))}}static{this.\u0275cmp=C.VBU({type:et,selectors:[["button","nz-button",""],["a","nz-button",""]],contentQueries:function(je,At,Ze){if(1&je&&C.wni(Ze,he.Dn,5,C.aKT),2&je){let St;C.mGM(St=C.lsd())&&(At.nzIconDirectiveElement=St.first)}},hostAttrs:[1,"ant-btn"],hostVars:32,hostBindings:function(je,At){2&je&&(C.BMQ("tabindex",At.disabled?-1:null===At.tabIndex?null:At.tabIndex)("disabled",At.disabled||null),C.AVh("ant-btn-primary","primary"===At.nzType)("ant-btn-dashed","dashed"===At.nzType)("ant-btn-link","link"===At.nzType)("ant-btn-text","text"===At.nzType)("ant-btn-circle","circle"===At.nzShape)("ant-btn-round","round"===At.nzShape)("ant-btn-lg","large"===At.nzSize)("ant-btn-sm","small"===At.nzSize)("ant-btn-dangerous",At.nzDanger)("ant-btn-loading",At.nzLoading)("ant-btn-background-ghost",At.nzGhost)("ant-btn-block",At.nzBlock)("ant-input-search-button",At.nzSearch)("ant-btn-rtl","rtl"===At.dir)("ant-btn-icon-only",At.iconOnly))},inputs:{nzBlock:"nzBlock",nzGhost:"nzGhost",nzSearch:"nzSearch",nzLoading:"nzLoading",nzDanger:"nzDanger",disabled:"disabled",tabIndex:"tabIndex",nzType:"nzType",nzShape:"nzShape",nzSize:"nzSize"},exportAs:["nzButton"],features:[C.OA$],attrs:ze,ngContentSelectors:bt,decls:2,vars:1,consts:[["nz-icon","","nzType","loading",4,"ngIf"],["nz-icon","","nzType","loading"]],template:function(je,At){1&je&&(C.NAR(),C.DNE(0,xt,1,0,"span",0),C.SdG(1)),2&je&&C.Y8G("ngIf",At.nzLoading)},dependencies:[at.bT,he.Dn,mt.c],encapsulation:2,changeDetection:0})}}return(0,M.Cg)([(0,fe.H3)()],et.prototype,"nzBlock",void 0),(0,M.Cg)([(0,fe.H3)()],et.prototype,"nzGhost",void 0),(0,M.Cg)([(0,fe.H3)()],et.prototype,"nzSearch",void 0),(0,M.Cg)([(0,fe.H3)()],et.prototype,"nzLoading",void 0),(0,M.Cg)([(0,fe.H3)()],et.prototype,"nzDanger",void 0),(0,M.Cg)([(0,fe.H3)()],et.prototype,"disabled",void 0),(0,M.Cg)([(0,ee.H4)()],et.prototype,"nzSize",void 0),et})(),Yt=(()=>{class et{constructor(zt){this.directionality=zt,this.nzSize="default",this.dir="ltr",this.destroy$=new de.B}ngOnInit(){this.dir=this.directionality.value,this.directionality.change?.pipe((0,se.Q)(this.destroy$)).subscribe(zt=>{this.dir=zt})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(je){return new(je||et)(C.rXU(ge.dS,8))}}static{this.\u0275cmp=C.VBU({type:et,selectors:[["nz-button-group"]],hostAttrs:[1,"ant-btn-group"],hostVars:6,hostBindings:function(je,At){2&je&&C.AVh("ant-btn-group-lg","large"===At.nzSize)("ant-btn-group-sm","small"===At.nzSize)("ant-btn-group-rtl","rtl"===At.dir)},inputs:{nzSize:"nzSize"},exportAs:["nzButtonGroup"],ngContentSelectors:bt,decls:1,vars:0,template:function(je,At){1&je&&(C.NAR(),C.SdG(0))},encapsulation:2,changeDetection:0})}}return et})(),Ut=(()=>{class et{static{this.\u0275fac=function(je){return new(je||et)}}static{this.\u0275mod=C.$C({type:et})}static{this.\u0275inj=C.G2t({imports:[ge.jI,at.MD,$e.o7,he.Y3,mt.p,mt.p,$e.o7]})}}return et})()},713:(Nn,Ct,R)=>{"use strict";R.d(Ct,{GE:()=>a,Sn:()=>mt,U1:()=>at,W4:()=>ve,bS:()=>ze,j:()=>ee,uX:()=>$e});var M=R(9969);let C=(()=>{class xt{static{this.SLOW="0.3s"}static{this.BASE="0.2s"}static{this.FAST="0.1s"}}return xt})(),de=(()=>{class xt{static{this.EASE_BASE_OUT="cubic-bezier(0.7, 0.3, 0.1, 1)"}static{this.EASE_BASE_IN="cubic-bezier(0.9, 0, 0.3, 0.7)"}static{this.EASE_OUT="cubic-bezier(0.215, 0.61, 0.355, 1)"}static{this.EASE_IN="cubic-bezier(0.55, 0.055, 0.675, 0.19)"}static{this.EASE_IN_OUT="cubic-bezier(0.645, 0.045, 0.355, 1)"}static{this.EASE_OUT_BACK="cubic-bezier(0.12, 0.4, 0.29, 1.46)"}static{this.EASE_IN_BACK="cubic-bezier(0.71, -0.46, 0.88, 0.6)"}static{this.EASE_IN_OUT_BACK="cubic-bezier(0.71, -0.46, 0.29, 1.46)"}static{this.EASE_OUT_CIRC="cubic-bezier(0.08, 0.82, 0.17, 1)"}static{this.EASE_IN_CIRC="cubic-bezier(0.6, 0.04, 0.98, 0.34)"}static{this.EASE_IN_OUT_CIRC="cubic-bezier(0.78, 0.14, 0.15, 0.86)"}static{this.EASE_OUT_QUINT="cubic-bezier(0.23, 1, 0.32, 1)"}static{this.EASE_IN_QUINT="cubic-bezier(0.755, 0.05, 0.855, 0.06)"}static{this.EASE_IN_OUT_QUINT="cubic-bezier(0.86, 0, 0.07, 1)"}}return xt})();const a=(0,M.hZ)("collapseMotion",[(0,M.wk)("expanded",(0,M.iF)({height:"*"})),(0,M.wk)("collapsed",(0,M.iF)({height:0,overflow:"hidden"})),(0,M.wk)("hidden",(0,M.iF)({height:0,overflow:"hidden",borderTopWidth:"0"})),(0,M.kY)("expanded => collapsed",(0,M.i0)(`150ms ${de.EASE_IN_OUT}`)),(0,M.kY)("expanded => hidden",(0,M.i0)(`150ms ${de.EASE_IN_OUT}`)),(0,M.kY)("collapsed => expanded",(0,M.i0)(`150ms ${de.EASE_IN_OUT}`)),(0,M.kY)("hidden => expanded",(0,M.i0)(`150ms ${de.EASE_IN_OUT}`))]),ve=((0,M.hZ)("treeCollapseMotion",[(0,M.kY)("* => *",[(0,M.P)("nz-tree-node:leave,nz-tree-builtin-node:leave",[(0,M.iF)({overflow:"hidden"}),(0,M.yc)(0,[(0,M.i0)(`150ms ${de.EASE_IN_OUT}`,(0,M.iF)({height:0,opacity:0,"padding-bottom":0}))])],{optional:!0}),(0,M.P)("nz-tree-node:enter,nz-tree-builtin-node:enter",[(0,M.iF)({overflow:"hidden",height:0,opacity:0,"padding-bottom":0}),(0,M.yc)(0,[(0,M.i0)(`150ms ${de.EASE_IN_OUT}`,(0,M.iF)({overflow:"hidden",height:"*",opacity:"*","padding-bottom":"*"}))])],{optional:!0})])]),(0,M.hZ)("fadeMotion",[(0,M.kY)(":enter",[(0,M.iF)({opacity:0}),(0,M.i0)(`${C.BASE}`,(0,M.iF)({opacity:1}))]),(0,M.kY)(":leave",[(0,M.iF)({opacity:1}),(0,M.i0)(`${C.BASE}`,(0,M.iF)({opacity:0}))])]),(0,M.hZ)("helpMotion",[(0,M.kY)(":enter",[(0,M.iF)({opacity:0,transform:"translateY(-5px)"}),(0,M.i0)(`${C.SLOW} ${de.EASE_IN_OUT}`,(0,M.iF)({opacity:1,transform:"translateY(0)"}))]),(0,M.kY)(":leave",[(0,M.iF)({opacity:1,transform:"translateY(0)"}),(0,M.i0)(`${C.SLOW} ${de.EASE_IN_OUT}`,(0,M.iF)({opacity:0,transform:"translateY(-5px)"}))])])),ee=(0,M.hZ)("moveUpMotion",[(0,M.kY)("* => enter",[(0,M.iF)({transformOrigin:"0 0",transform:"translateY(-100%)",opacity:0}),(0,M.i0)(`${C.BASE}`,(0,M.iF)({transformOrigin:"0 0",transform:"translateY(0%)",opacity:1}))]),(0,M.kY)("* => leave",[(0,M.iF)({transformOrigin:"0 0",transform:"translateY(0%)",opacity:1}),(0,M.i0)(`${C.BASE}`,(0,M.iF)({transformOrigin:"0 0",transform:"translateY(-100%)",opacity:0}))])]),he=((0,M.hZ)("notificationMotion",[(0,M.wk)("enterRight",(0,M.iF)({opacity:1,transform:"translateX(0)"})),(0,M.kY)("* => enterRight",[(0,M.iF)({opacity:0,transform:"translateX(5%)"}),(0,M.i0)("100ms linear")]),(0,M.wk)("enterLeft",(0,M.iF)({opacity:1,transform:"translateX(0)"})),(0,M.kY)("* => enterLeft",[(0,M.iF)({opacity:0,transform:"translateX(-5%)"}),(0,M.i0)("100ms linear")]),(0,M.wk)("enterTop",(0,M.iF)({opacity:1,transform:"translateY(0)"})),(0,M.kY)("* => enterTop",[(0,M.iF)({opacity:0,transform:"translateY(-5%)"}),(0,M.i0)("100ms linear")]),(0,M.wk)("enterBottom",(0,M.iF)({opacity:1,transform:"translateY(0)"})),(0,M.kY)("* => enterBottom",[(0,M.iF)({opacity:0,transform:"translateY(5%)"}),(0,M.i0)("100ms linear")]),(0,M.wk)("leave",(0,M.iF)({opacity:0,transform:"scaleY(0.8)",transformOrigin:"0% 0%"})),(0,M.kY)("* => leave",[(0,M.iF)({opacity:1,transform:"scaleY(1)",transformOrigin:"0% 0%"}),(0,M.i0)("100ms linear")])]),`${C.BASE} ${de.EASE_OUT_QUINT}`),ge=`${C.BASE} ${de.EASE_IN_QUINT}`,at=(0,M.hZ)("slideMotion",[(0,M.wk)("void",(0,M.iF)({opacity:0,transform:"scaleY(0.8)"})),(0,M.wk)("enter",(0,M.iF)({opacity:1,transform:"scaleY(1)"})),(0,M.kY)("void => *",[(0,M.i0)(he)]),(0,M.kY)("* => void",[(0,M.i0)(ge)])]),mt=(0,M.hZ)("slideAlertMotion",[(0,M.kY)(":leave",[(0,M.iF)({opacity:1,transform:"scaleY(1)",transformOrigin:"0% 0%"}),(0,M.i0)(`${C.SLOW} ${de.EASE_IN_OUT_CIRC}`,(0,M.iF)({opacity:0,transform:"scaleY(0)",transformOrigin:"0% 0%"}))])]),$e=(0,M.hZ)("zoomBigMotion",[(0,M.kY)("void => active",[(0,M.iF)({opacity:0,transform:"scale(0.8)"}),(0,M.i0)(`${C.BASE} ${de.EASE_OUT_CIRC}`,(0,M.iF)({opacity:1,transform:"scale(1)"}))]),(0,M.kY)("active => void",[(0,M.iF)({opacity:1,transform:"scale(1)"}),(0,M.i0)(`${C.BASE} ${de.EASE_IN_OUT_CIRC}`,(0,M.iF)({opacity:0,transform:"scale(0.8)"}))])]),ze=(0,M.hZ)("zoomBadgeMotion",[(0,M.kY)(":enter",[(0,M.iF)({opacity:0,transform:"scale(0) translate(50%, -50%)"}),(0,M.i0)(`${C.SLOW} ${de.EASE_OUT_BACK}`,(0,M.iF)({opacity:1,transform:"scale(1) translate(50%, -50%)"}))]),(0,M.kY)(":leave",[(0,M.iF)({opacity:1,transform:"scale(1) translate(50%, -50%)"}),(0,M.i0)(`${C.SLOW} ${de.EASE_IN_BACK}`,(0,M.iF)({opacity:0,transform:"scale(0) translate(50%, -50%)"}))])]);(0,M.hZ)("thumbMotion",[(0,M.wk)("from",(0,M.iF)({transform:"translateX({{ transform }}px)",width:"{{ width }}px"}),{params:{transform:0,width:0}}),(0,M.wk)("to",(0,M.iF)({transform:"translateX({{ transform }}px)",width:"{{ width }}px"}),{params:{transform:100,width:0}}),(0,M.kY)("from => to",(0,M.i0)(`300ms ${de.EASE_IN_OUT}`))])},6006:(Nn,Ct,R)=>{"use strict";R.d(Ct,{cM:()=>Ut,nP:()=>se});var M=R(4709),C=R(4215);const a=["pink","red","yellow","orange","cyan","green","blue","purple","geekblue","magenta","volcano","gold","lime"];function se(et){return-1!==a.indexOf(et)}const ve=2,ee=.16,fe=.05,he=.05,ge=.15,at=5,mt=4,$e=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function ze({r:et,g:It,b:zt}){const je=(0,M.wE)(et,It,zt);return{h:360*je.h,s:je.s,v:je.v}}function bt({r:et,g:It,b:zt}){return`#${(0,M.Ob)(et,It,zt,!1)}`}function Qt(et,It,zt){let je;return je=Math.round(et.h)>=60&&Math.round(et.h)<=240?zt?Math.round(et.h)-ve*It:Math.round(et.h)+ve*It:zt?Math.round(et.h)+ve*It:Math.round(et.h)-ve*It,je<0?je+=360:je>=360&&(je-=360),je}function sn(et,It,zt){if(0===et.h&&0===et.s)return et.s;let je;return je=zt?et.s-ee*It:It===mt?et.s+ee:et.s+fe*It,je>1&&(je=1),zt&&It===at&&je>.1&&(je=.1),je<.06&&(je=.06),Number(je.toFixed(2))}function Yt(et,It,zt){let je;return je=zt?et.v+he*It:et.v-ge*It,je>1&&(je=1),Number(je.toFixed(2))}function Ut(et,It={}){const zt=[],je=(0,C.RO)(et);for(let At=at;At>0;At-=1){const Ze=ze(je),St=bt((0,C.RO)({h:Qt(Ze,At,!0),s:sn(Ze,At,!0),v:Yt(Ze,At,!0)}));zt.push(St)}zt.push(bt(je));for(let At=1;At<=mt;At+=1){const Ze=ze(je),St=bt((0,C.RO)({h:Qt(Ze,At),s:sn(Ze,At),v:Yt(Ze,At)}));zt.push(St)}return"dark"===It.theme?$e.map(({index:At,opacity:Ze})=>bt(function xt(et,It,zt){const je=zt/100;return{r:(It.r-et.r)*je+et.r,g:(It.g-et.g)*je+et.g,b:(It.b-et.b)*je+et.b}}((0,C.RO)(It.backgroundColor||"#141414"),(0,C.RO)(zt[At]),100*Ze))):zt}},6035:(Nn,Ct,R)=>{"use strict";R.d(Ct,{H4:()=>xt,yx:()=>bt});var M=R(4438),C=R(1413),de=R(5964),a=R(3703),se=R(4369),Fe=R(6006),ve=R(1265),ee=R(317);const fe=new M.nKC("nz-config"),ge=`-ant-${Date.now()}-${Math.random()}`;function mt(Qt,sn,Yt){const Ut=function at(Qt,sn){const Yt={},Ut=(zt,je)=>{let At=zt.clone();return At=je?.(At)||At,At.toRgbString()},et=(zt,je)=>{const At=new se.q(zt),Ze=(0,Fe.cM)(At.toRgbString());Yt[`${je}-color`]=Ut(At),Yt[`${je}-color-disabled`]=Ze[1],Yt[`${je}-color-hover`]=Ze[4],Yt[`${je}-color-active`]=Ze[7],Yt[`${je}-color-outline`]=At.clone().setAlpha(.2).toRgbString(),Yt[`${je}-color-deprecated-bg`]=Ze[1],Yt[`${je}-color-deprecated-border`]=Ze[3]};if(sn.primaryColor){et(sn.primaryColor,"primary");const zt=new se.q(sn.primaryColor),je=(0,Fe.cM)(zt.toRgbString());je.forEach((Ze,St)=>{Yt[`primary-${St+1}`]=Ze}),Yt["primary-color-deprecated-l-35"]=Ut(zt,Ze=>Ze.lighten(35)),Yt["primary-color-deprecated-l-20"]=Ut(zt,Ze=>Ze.lighten(20)),Yt["primary-color-deprecated-t-20"]=Ut(zt,Ze=>Ze.tint(20)),Yt["primary-color-deprecated-t-50"]=Ut(zt,Ze=>Ze.tint(50)),Yt["primary-color-deprecated-f-12"]=Ut(zt,Ze=>Ze.setAlpha(.12*Ze.getAlpha()));const At=new se.q(je[0]);Yt["primary-color-active-deprecated-f-30"]=Ut(At,Ze=>Ze.setAlpha(.3*Ze.getAlpha())),Yt["primary-color-active-deprecated-d-02"]=Ut(At,Ze=>Ze.darken(2))}return sn.successColor&&et(sn.successColor,"success"),sn.warningColor&&et(sn.warningColor,"warning"),sn.errorColor&&et(sn.errorColor,"error"),sn.infoColor&&et(sn.infoColor,"info"),`\n  :root {\n    ${Object.keys(Yt).map(zt=>`--${Qt}-${zt}: ${Yt[zt]};`).join("\n")}\n  }\n  `.trim()}(Qt,sn);(0,ee.OC)()?(0,ee.BD)(Ut,`${ge}-dynamic-theme`,{cspNonce:Yt}):(0,ve.R8)("NzConfigService: SSR do not support dynamic theme with css variables.")}const $e=function(Qt){return void 0!==Qt};let bt=(()=>{class Qt{constructor(Yt,Ut){this.configUpdated$=new C.B,this.config=Yt||{},this.cspNonce=Ut,this.config.theme&&mt(this.getConfig().prefixCls?.prefixCls||"ant",this.config.theme,Ut)}getConfig(){return this.config}getConfigForComponent(Yt){return this.config[Yt]}getConfigChangeEventForComponent(Yt){return this.configUpdated$.pipe((0,de.p)(Ut=>Ut===Yt),(0,a.u)(void 0))}set(Yt,Ut){this.config[Yt]={...this.config[Yt],...Ut},"theme"===Yt&&this.config.theme&&mt(this.getConfig().prefixCls?.prefixCls||"ant",this.config.theme,this.cspNonce),this.configUpdated$.next(Yt)}static{this.\u0275fac=function(Ut){return new(Ut||Qt)(M.KVO(fe,8),M.KVO(M.BIS,8))}}static{this.\u0275prov=M.jDH({token:Qt,factory:Qt.\u0275fac,providedIn:"root"})}}return Qt})();function xt(){return function(sn,Yt,Ut){const et=`$$__zorroConfigDecorator__${Yt}`;return Object.defineProperty(sn,et,{configurable:!0,writable:!0,enumerable:!1}),{get(){const It=Ut?.get?Ut.get.bind(this)():this[et],zt=(this.propertyAssignCounter?.[Yt]||0)>1,je=this.nzConfigService.getConfigForComponent(this._nzModuleName)?.[Yt];return zt&&$e(It)?It:$e(je)?je:It},set(It){this.propertyAssignCounter=this.propertyAssignCounter||{},this.propertyAssignCounter[Yt]=(this.propertyAssignCounter[Yt]||0)+1,Ut?.set?Ut.set.bind(this)(It):this[et]=It},configurable:!0,enumerable:!0}}}},1167:(Nn,Ct,R)=>{"use strict";R.d(Ct,{c:()=>M});const M={isTestMode:!1}},1265:(Nn,Ct,R)=>{"use strict";R.d(Ct,{H3:()=>a,R8:()=>ve});var M=R(4438),C=R(1167);const de={},a="[NG-ZORRO]:";const ve=(...he)=>function Fe(he,...ge){(C.c.isTestMode||(0,M.naY)()&&function se(...he){const ge=he.reduce((at,mt)=>at+mt.toString(),"");return!de[ge]&&(de[ge]=!0,!0)}(...ge))&&he(...ge)}((...ge)=>console.warn(a,...ge),...he)},6841:(Nn,Ct,R)=>{"use strict";R.d(Ct,{y:()=>ee,z:()=>ve});var M=R(177),C=R(4438),de=R(1635),a=R(4085),se=R(317);const Fe="nz-animate-disabled";let ve=(()=>{class fe{constructor(ge,at,mt){this.element=ge,this.renderer=at,this.animationType=mt,this.nzNoAnimation=!1}ngOnChanges(){this.updateClass()}ngAfterViewInit(){this.updateClass()}updateClass(){const ge=(0,a.i8)(this.element);ge&&(this.nzNoAnimation||"NoopAnimations"===this.animationType?this.renderer.addClass(ge,Fe):this.renderer.removeClass(ge,Fe))}static{this.\u0275fac=function(at){return new(at||fe)(C.rXU(C.aKT),C.rXU(C.sFG),C.rXU(C.bc$,8))}}static{this.\u0275dir=C.FsC({type:fe,selectors:[["","nzNoAnimation",""]],inputs:{nzNoAnimation:"nzNoAnimation"},exportAs:["nzNoAnimation"],features:[C.OA$]})}}return(0,de.Cg)([(0,se.H3)()],fe.prototype,"nzNoAnimation",void 0),fe})(),ee=(()=>{class fe{static{this.\u0275fac=function(at){return new(at||fe)}}static{this.\u0275mod=C.$C({type:fe})}static{this.\u0275inj=C.G2t({imports:[M.MD]})}}return fe})()},7806:(Nn,Ct,R)=>{"use strict";R.d(Ct,{C:()=>se,m:()=>de});var M=R(177),C=R(4438);let de=(()=>{class Fe{static ngTemplateContextGuard(ee,fe){return!0}recreateView(){this.viewContainer.clear();const ee=this.nzStringTemplateOutlet instanceof C.C4Q;this.embeddedViewRef=this.viewContainer.createEmbeddedView(ee?this.nzStringTemplateOutlet:this.templateRef,ee?this.nzStringTemplateOutletContext:this.context)}updateContext(){const fe=this.nzStringTemplateOutlet instanceof C.C4Q?this.nzStringTemplateOutletContext:this.context,he=this.embeddedViewRef.context;if(fe)for(const ge of Object.keys(fe))he[ge]=fe[ge]}constructor(ee,fe){this.viewContainer=ee,this.templateRef=fe,this.embeddedViewRef=null,this.context=new a,this.nzStringTemplateOutletContext=null,this.nzStringTemplateOutlet=null}ngOnChanges(ee){const{nzStringTemplateOutletContext:fe,nzStringTemplateOutlet:he}=ee;he&&(this.context.$implicit=he.currentValue),(()=>{let mt=!1;return he&&(mt=!!he.firstChange||(he.previousValue instanceof C.C4Q||he.currentValue instanceof C.C4Q)),fe&&(bt=>{const xt=Object.keys(bt.previousValue||{}),Qt=Object.keys(bt.currentValue||{});if(xt.length===Qt.length){for(const sn of Qt)if(-1===xt.indexOf(sn))return!0;return!1}return!0})(fe)||mt})()?this.recreateView():this.updateContext()}static{this.\u0275fac=function(fe){return new(fe||Fe)(C.rXU(C.c1b),C.rXU(C.C4Q))}}static{this.\u0275dir=C.FsC({type:Fe,selectors:[["","nzStringTemplateOutlet",""]],inputs:{nzStringTemplateOutletContext:"nzStringTemplateOutletContext",nzStringTemplateOutlet:"nzStringTemplateOutlet"},exportAs:["nzStringTemplateOutlet"],features:[C.OA$]})}}return Fe})();class a{}let se=(()=>{class Fe{static{this.\u0275fac=function(fe){return new(fe||Fe)}}static{this.\u0275mod=C.$C({type:Fe})}static{this.\u0275inj=C.G2t({imports:[M.MD]})}}return Fe})()},4500:(Nn,Ct,R)=>{"use strict";R.d(Ct,{F:()=>a,j:()=>se});const M=["moz","ms","webkit"];function a(Fe){if(typeof window>"u")return null;if(window.cancelAnimationFrame)return window.cancelAnimationFrame(Fe);const ve=M.filter(ee=>`${ee}CancelAnimationFrame`in window||`${ee}CancelRequestAnimationFrame`in window)[0];return ve?(window[`${ve}CancelAnimationFrame`]||window[`${ve}CancelRequestAnimationFrame`]).call(this,Fe):clearTimeout(Fe)}const se=function de(){if(typeof window>"u")return()=>0;if(window.requestAnimationFrame)return window.requestAnimationFrame.bind(window);const Fe=M.filter(ve=>`${ve}RequestAnimationFrame`in window)[0];return Fe?window[`${Fe}RequestAnimationFrame`]:function C(){let Fe=0;return function(ve){const ee=(new Date).getTime(),fe=Math.max(0,16-(ee-Fe)),he=setTimeout(()=>{ve(ee+fe)},fe);return Fe=ee+fe,he}}()}()},1025:(Nn,Ct,R)=>{"use strict";R.d(Ct,{HL:()=>$e,cB:()=>at,fe:()=>Yt,jp:()=>et,pt:()=>sn,y4:()=>It,yY:()=>Ut});var M=R(4438),C=R(1413),de=R(3798),a=R(980),se=R(6977),Fe=R(6354),ve=R(9172),ee=R(3294),fe=R(1167),he=R(1708);const ge=()=>{};let at=(()=>{class je{constructor(Ze,St){this.ngZone=Ze,this.rendererFactory2=St,this.resizeSource$=new C.B,this.listeners=0,this.disposeHandle=ge,this.handler=()=>{this.ngZone.run(()=>{this.resizeSource$.next()})},this.renderer=this.rendererFactory2.createRenderer(null,null)}ngOnDestroy(){this.handler=ge}subscribe(){return this.registerListener(),this.resizeSource$.pipe((0,de.Z)(16),(0,a.j)(()=>this.unregisterListener()))}unsubscribe(){this.unregisterListener()}registerListener(){0===this.listeners&&this.ngZone.runOutsideAngular(()=>{this.disposeHandle=this.renderer.listen("window","resize",this.handler)}),this.listeners+=1}unregisterListener(){this.listeners-=1,0===this.listeners&&(this.disposeHandle(),this.disposeHandle=ge)}static{this.\u0275fac=function(St){return new(St||je)(M.KVO(M.SKi),M.KVO(M._9s))}}static{this.\u0275prov=M.jDH({token:je,factory:je.\u0275fac,providedIn:"root"})}}return je})();const mt=new Map;let $e=(()=>{class je{constructor(){this._singletonRegistry=new Map}get singletonRegistry(){return fe.c.isTestMode?mt:this._singletonRegistry}registerSingletonWithKey(Ze,St){const wn=this.singletonRegistry.has(Ze),Rn=wn?this.singletonRegistry.get(Ze):this.withNewTarget(St);wn||this.singletonRegistry.set(Ze,Rn)}unregisterSingletonWithKey(Ze){this.singletonRegistry.has(Ze)&&this.singletonRegistry.delete(Ze)}getSingletonWithKey(Ze){return this.singletonRegistry.has(Ze)?this.singletonRegistry.get(Ze).target:null}withNewTarget(Ze){return{target:Ze}}static{this.\u0275fac=function(St){return new(St||je)}}static{this.\u0275prov=M.jDH({token:je,factory:je.\u0275fac,providedIn:"root"})}}return je})();var sn=function(je){return je.xxl="xxl",je.xl="xl",je.lg="lg",je.md="md",je.sm="sm",je.xs="xs",je}(sn||{});const Yt={xs:"(max-width: 575px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)",xxl:"(min-width: 1600px)"},Ut={xs:"(max-width: 479.98px)",sm:"(max-width: 575.98px)",md:"(max-width: 767.98px)",lg:"(max-width: 991.98px)",xl:"(max-width: 1199.98px)",xxl:"(max-width: 1599.98px)"};let et=(()=>{class je{constructor(Ze,St){this.resizeService=Ze,this.mediaMatcher=St,this.destroy$=new C.B,this.resizeService.subscribe().pipe((0,se.Q)(this.destroy$)).subscribe(()=>{})}ngOnDestroy(){this.destroy$.next()}subscribe(Ze,St){if(St){const wn=()=>this.matchMedia(Ze,!0);return this.resizeService.subscribe().pipe((0,Fe.T)(wn),(0,ve.Z)(wn()),(0,ee.F)((Rn,an)=>Rn[0]===an[0]),(0,Fe.T)(Rn=>Rn[1]))}{const wn=()=>this.matchMedia(Ze);return this.resizeService.subscribe().pipe((0,Fe.T)(wn),(0,ve.Z)(wn()),(0,ee.F)())}}matchMedia(Ze,St){let wn=sn.md;const Rn={};return Object.keys(Ze).map(an=>{const Un=an,nn=this.mediaMatcher.matchMedia(Yt[Un]).matches;Rn[an]=nn,nn&&(wn=Un)}),St?[wn,Rn]:wn}static{this.\u0275fac=function(St){return new(St||je)(M.KVO(at),M.KVO(he.DY))}}static{this.\u0275prov=M.jDH({token:je,factory:je.\u0275fac,providedIn:"root"})}}return je})(),It=(()=>{class je extends C.B{ngOnDestroy(){this.next(),this.complete()}static{this.\u0275fac=(()=>{let Ze;return function(wn){return(Ze||(Ze=M.xGo(je)))(wn||je)}})()}static{this.\u0275prov=M.jDH({token:je,factory:je.\u0275fac})}}return je})()},4608:(Nn,Ct,R)=>{"use strict";R.d(Ct,{KV:()=>Mi,ad:()=>Si,aV:()=>Gi,yZ:()=>ar,Tb:()=>ji});var M=R(6190),C=R(628),de=R(738),se=R(179);function ve(Ln,Bt){(0,de.A)(2,arguments);var jt=(0,C.A)(Ln),Dn=(0,se.A)(Bt);if(isNaN(Dn))return new Date(NaN);if(!Dn)return jt;var Ai=jt.getDate(),Sn=new Date(jt.getTime());return Sn.setMonth(jt.getMonth()+Dn+1,0),Ai>=Sn.getDate()?Sn:(jt.setFullYear(Sn.getFullYear(),Sn.getMonth(),Ai),jt)}var at=R(4319);function $e(Ln,Bt){(0,de.A)(2,arguments);var jt=(0,C.A)(Ln),Dn=(0,C.A)(Bt);return jt.getFullYear()===Dn.getFullYear()}function ze(Ln,Bt){(0,de.A)(2,arguments);var jt=(0,C.A)(Ln),Dn=(0,C.A)(Bt);return jt.getFullYear()===Dn.getFullYear()&&jt.getMonth()===Dn.getMonth()}function bt(Ln){(0,de.A)(1,arguments);var Bt=(0,C.A)(Ln);return Bt.setHours(0,0,0,0),Bt}function xt(Ln,Bt){(0,de.A)(2,arguments);var jt=bt(Ln),Dn=bt(Bt);return jt.getTime()===Dn.getTime()}function Qt(Ln){(0,de.A)(1,arguments);var Bt=(0,C.A)(Ln);return Bt.setMinutes(0,0,0),Bt}function sn(Ln,Bt){(0,de.A)(2,arguments);var jt=Qt(Ln),Dn=Qt(Bt);return jt.getTime()===Dn.getTime()}function Yt(Ln){(0,de.A)(1,arguments);var Bt=(0,C.A)(Ln);return Bt.setSeconds(0,0),Bt}function Ut(Ln,Bt){(0,de.A)(2,arguments);var jt=Yt(Ln),Dn=Yt(Bt);return jt.getTime()===Dn.getTime()}function et(Ln){(0,de.A)(1,arguments);var Bt=(0,C.A)(Ln);return Bt.setMilliseconds(0),Bt}function It(Ln,Bt){(0,de.A)(2,arguments);var jt=et(Ln),Dn=et(Bt);return jt.getTime()===Dn.getTime()}function zt(Ln,Bt){(0,de.A)(2,arguments);var jt=(0,C.A)(Ln),Dn=(0,C.A)(Bt);return jt.getFullYear()-Dn.getFullYear()}function je(Ln,Bt){(0,de.A)(2,arguments);var jt=(0,C.A)(Ln),Dn=(0,C.A)(Bt);return 12*(jt.getFullYear()-Dn.getFullYear())+(jt.getMonth()-Dn.getMonth())}var At=R(3511);function St(Ln,Bt){(0,de.A)(2,arguments);var jt=bt(Ln),Dn=bt(Bt),Ai=jt.getTime()-(0,At.A)(jt),Sn=Dn.getTime()-(0,At.A)(Dn);return Math.round((Ai-Sn)/864e5)}var wn=R(6746);function Rn(Ln,Bt){return(0,de.A)(2,arguments),(0,C.A)(Ln).getTime()-(0,C.A)(Bt).getTime()}var an={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(Bt){return Bt<0?Math.ceil(Bt):Math.floor(Bt)}},Un="trunc";function nn(Ln){return Ln?an[Ln]:an[Un]}function di(Ln,Bt,jt){(0,de.A)(2,arguments);var Dn=Rn(Ln,Bt)/wn.s0;return nn(jt?.roundingMethod)(Dn)}function Wn(Ln,Bt,jt){(0,de.A)(2,arguments);var Dn=Rn(Ln,Bt)/wn.Cg;return nn(jt?.roundingMethod)(Dn)}function $n(Ln,Bt,jt){(0,de.A)(2,arguments);var Dn=Rn(Ln,Bt)/1e3;return nn(jt?.roundingMethod)(Dn)}var Jt=R(2764);var Yn=R(1265),zn=R(177),qn=R(317);function ar(Ln){const[Bt,jt]=Ln;return!!Bt&&!!jt&&jt.isBeforeDay(Bt)}function Gi(Ln,Bt,jt="month",Dn="left"){const[Ai,Sn]=Ln;let On=Ai||new Mi,st=Sn||(Bt?On:On.add(1,jt));return Ai&&!Sn?(On=Ai,st=Bt?Ai:Ai.add(1,jt)):!Ai&&Sn?(On=Bt?Sn:Sn.add(-1,jt),st=Sn):Ai&&Sn&&!Bt&&(Ai.isSame(Sn,jt)||"left"===Dn?st=On.add(1,jt):On=st.add(-1,jt)),[On,st]}function Si(Ln){return Array.isArray(Ln)?Ln.map(Bt=>Bt instanceof Mi?Bt.clone():null):Ln instanceof Mi?Ln.clone():null}class Mi{constructor(Bt){if(Bt)if(Bt instanceof Date)this.nativeDate=Bt;else{if("string"!=typeof Bt&&"number"!=typeof Bt)throw new Error('The input date type is not supported ("Date" is now recommended)');(0,Yn.R8)('The string type is not recommended for date-picker, use "Date" type'),this.nativeDate=new Date(Bt)}else this.nativeDate=new Date}calendarStart(Bt){return new Mi((0,M.A)(function a(Ln){(0,de.A)(1,arguments);var Bt=(0,C.A)(Ln);return Bt.setDate(1),Bt.setHours(0,0,0,0),Bt}(this.nativeDate),Bt))}getYear(){return this.nativeDate.getFullYear()}getMonth(){return this.nativeDate.getMonth()}getDay(){return this.nativeDate.getDay()}getTime(){return this.nativeDate.getTime()}getDate(){return this.nativeDate.getDate()}getHours(){return this.nativeDate.getHours()}getMinutes(){return this.nativeDate.getMinutes()}getSeconds(){return this.nativeDate.getSeconds()}getMilliseconds(){return this.nativeDate.getMilliseconds()}clone(){return new Mi(new Date(this.nativeDate))}setHms(Bt,jt,Dn){const Ai=new Date(this.nativeDate.setHours(Bt,jt,Dn));return new Mi(Ai)}setYear(Bt){return new Mi(function Fe(Ln,Bt){(0,de.A)(2,arguments);var jt=(0,C.A)(Ln),Dn=(0,se.A)(Bt);return isNaN(jt.getTime())?new Date(NaN):(jt.setFullYear(Dn),jt)}(this.nativeDate,Bt))}addYears(Bt){return new Mi(function ee(Ln,Bt){return(0,de.A)(2,arguments),ve(Ln,12*(0,se.A)(Bt))}(this.nativeDate,Bt))}setMonth(Bt){return new Mi(function he(Ln,Bt){(0,de.A)(2,arguments);var jt=(0,C.A)(Ln),Dn=(0,se.A)(Bt),Ai=jt.getFullYear(),Sn=jt.getDate(),On=new Date(0);On.setFullYear(Ai,Dn,15),On.setHours(0,0,0,0);var st=function fe(Ln){(0,de.A)(1,arguments);var Bt=(0,C.A)(Ln),jt=Bt.getFullYear(),Dn=Bt.getMonth(),Ai=new Date(0);return Ai.setFullYear(jt,Dn+1,0),Ai.setHours(0,0,0,0),Ai.getDate()}(On);return jt.setMonth(Dn,Math.min(Sn,st)),jt}(this.nativeDate,Bt))}addMonths(Bt){return new Mi(ve(this.nativeDate,Bt))}setDay(Bt,jt){return new Mi(function mt(Ln,Bt,jt){var Dn,Ai,Sn,On,st,Xe,ye,Ve;(0,de.A)(2,arguments);var gt=(0,at.q)(),wt=(0,se.A)(null!==(Dn=null!==(Ai=null!==(Sn=null!==(On=jt?.weekStartsOn)&&void 0!==On?On:null==jt||null===(st=jt.locale)||void 0===st||null===(Xe=st.options)||void 0===Xe?void 0:Xe.weekStartsOn)&&void 0!==Sn?Sn:gt.weekStartsOn)&&void 0!==Ai?Ai:null===(ye=gt.locale)||void 0===ye||null===(Ve=ye.options)||void 0===Ve?void 0:Ve.weekStartsOn)&&void 0!==Dn?Dn:0);if(!(wt>=0&&wt<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var en=(0,C.A)(Ln),hn=(0,se.A)(Bt),si=en.getDay(),bi=7-wt;return function ge(Ln,Bt){(0,de.A)(2,arguments);var jt=(0,C.A)(Ln),Dn=(0,se.A)(Bt);return isNaN(Dn)?new Date(NaN):(Dn&&jt.setDate(jt.getDate()+Dn),jt)}(en,hn<0||hn>6?hn-(si+bi)%7:((hn%7+7)%7+bi)%7-(si+bi)%7)}(this.nativeDate,Bt,jt))}setDate(Bt){const jt=new Date(this.nativeDate);return jt.setDate(Bt),new Mi(jt)}addDays(Bt){return this.setDate(this.getDate()+Bt)}add(Bt,jt){switch(jt){case"decade":return this.addYears(10*Bt);case"year":return this.addYears(Bt);default:return this.addMonths(Bt)}}isSame(Bt,jt="day"){let Dn;switch(jt){case"decade":Dn=(Ai,Sn)=>Math.abs(Ai.getFullYear()-Sn.getFullYear())<11;break;case"year":Dn=$e;break;case"month":Dn=ze;break;case"day":default:Dn=xt;break;case"hour":Dn=sn;break;case"minute":Dn=Ut;break;case"second":Dn=It}return Dn(this.nativeDate,this.toNativeDate(Bt))}isSameYear(Bt){return this.isSame(Bt,"year")}isSameMonth(Bt){return this.isSame(Bt,"month")}isSameDay(Bt){return this.isSame(Bt,"day")}isSameHour(Bt){return this.isSame(Bt,"hour")}isSameMinute(Bt){return this.isSame(Bt,"minute")}isSameSecond(Bt){return this.isSame(Bt,"second")}isBefore(Bt,jt="day"){if(null===Bt)return!1;let Dn;switch(jt){case"year":Dn=zt;break;case"month":Dn=je;break;case"day":default:Dn=St;break;case"hour":Dn=di;break;case"minute":Dn=Wn;break;case"second":Dn=$n}return Dn(this.nativeDate,this.toNativeDate(Bt))<0}isBeforeYear(Bt){return this.isBefore(Bt,"year")}isBeforeMonth(Bt){return this.isBefore(Bt,"month")}isBeforeDay(Bt){return this.isBefore(Bt,"day")}isToday(){return function ki(Ln){return(0,de.A)(1,arguments),xt(Ln,Date.now())}(this.nativeDate)}isValid(){return(0,Jt.A)(this.nativeDate)}isFirstDayOfMonth(){return function un(Ln){return(0,de.A)(1,arguments),1===(0,C.A)(Ln).getDate()}(this.nativeDate)}isLastDayOfMonth(){return function jn(Ln){(0,de.A)(1,arguments);var Bt=(0,C.A)(Ln);return function pn(Ln){(0,de.A)(1,arguments);var Bt=(0,C.A)(Ln);return Bt.setHours(23,59,59,999),Bt}(Bt).getTime()===function dn(Ln){(0,de.A)(1,arguments);var Bt=(0,C.A)(Ln),jt=Bt.getMonth();return Bt.setFullYear(Bt.getFullYear(),jt+1,0),Bt.setHours(23,59,59,999),Bt}(Bt).getTime()}(this.nativeDate)}toNativeDate(Bt){return Bt instanceof Mi?Bt.nativeDate:Bt}}class ji{constructor(Bt,jt){this.format=Bt,this.localeId=jt,this.regex=null,this.matchMap={hour:null,minute:null,second:null,periodNarrow:null,periodWide:null,periodAbbreviated:null},this.genRegexp()}toDate(Bt){const jt=this.getTimeResult(Bt),Dn=new Date;return(0,qn.n9)(jt?.hour)&&Dn.setHours(jt.hour),(0,qn.n9)(jt?.minute)&&Dn.setMinutes(jt.minute),(0,qn.n9)(jt?.second)&&Dn.setSeconds(jt.second),1===jt?.period&&Dn.getHours()<12&&Dn.setHours(Dn.getHours()+12),Dn}getTimeResult(Bt){const jt=this.regex.exec(Bt);let Dn=null;return jt?((0,qn.n9)(this.matchMap.periodNarrow)&&(Dn=(0,zn.rd)(this.localeId,zn.oV.Format,zn.cH.Narrow).indexOf(jt[this.matchMap.periodNarrow+1])),(0,qn.n9)(this.matchMap.periodWide)&&(Dn=(0,zn.rd)(this.localeId,zn.oV.Format,zn.cH.Wide).indexOf(jt[this.matchMap.periodWide+1])),(0,qn.n9)(this.matchMap.periodAbbreviated)&&(Dn=(0,zn.rd)(this.localeId,zn.oV.Format,zn.cH.Abbreviated).indexOf(jt[this.matchMap.periodAbbreviated+1])),{hour:(0,qn.n9)(this.matchMap.hour)?Number.parseInt(jt[this.matchMap.hour+1],10):null,minute:(0,qn.n9)(this.matchMap.minute)?Number.parseInt(jt[this.matchMap.minute+1],10):null,second:(0,qn.n9)(this.matchMap.second)?Number.parseInt(jt[this.matchMap.second+1],10):null,period:Dn}):null}genRegexp(){let Bt=this.format.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$&");const jt=/h{1,2}/i,Dn=/m{1,2}/,Ai=/s{1,2}/,Sn=/aaaaa/,On=/aaaa/,st=/a{1,3}/,Xe=jt.exec(this.format),ye=Dn.exec(this.format),Ve=Ai.exec(this.format),gt=Sn.exec(this.format);let wt=null,en=null;gt||(wt=On.exec(this.format)),!wt&&!gt&&(en=st.exec(this.format)),[Xe,ye,Ve,gt,wt,en].filter(si=>!!si).sort((si,Hi)=>si.index-Hi.index).forEach((si,Hi)=>{switch(si){case Xe:this.matchMap.hour=Hi,Bt=Bt.replace(jt,"(\\d{1,2})");break;case ye:this.matchMap.minute=Hi,Bt=Bt.replace(Dn,"(\\d{1,2})");break;case Ve:this.matchMap.second=Hi,Bt=Bt.replace(Ai,"(\\d{1,2})");break;case gt:this.matchMap.periodNarrow=Hi;const ti=(0,zn.rd)(this.localeId,zn.oV.Format,zn.cH.Narrow).join("|");Bt=Bt.replace(Sn,`(${ti})`);break;case wt:this.matchMap.periodWide=Hi;const bi=(0,zn.rd)(this.localeId,zn.oV.Format,zn.cH.Wide).join("|");Bt=Bt.replace(On,`(${bi})`);break;case en:this.matchMap.periodAbbreviated=Hi;const gi=(0,zn.rd)(this.localeId,zn.oV.Format,zn.cH.Abbreviated).join("|");Bt=Bt.replace(st,`(${gi})`)}}),this.regex=new RegExp(Bt)}}},6389:(Nn,Ct,R)=>{"use strict";R.d(Ct,{c:()=>de,p:()=>a});var M=R(6860),C=R(4438);let de=(()=>{class se{setHiddenAttribute(){this.hidden?this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","string"==typeof this.hidden?this.hidden:""):this.renderer.removeAttribute(this.elementRef.nativeElement,"hidden")}constructor(ve,ee){this.elementRef=ve,this.renderer=ee,this.hidden=null,this.renderer.setAttribute(this.elementRef.nativeElement,"hidden","")}ngOnChanges(){this.setHiddenAttribute()}ngAfterViewInit(){this.setHiddenAttribute()}static{this.\u0275fac=function(ee){return new(ee||se)(C.rXU(C.aKT),C.rXU(C.sFG))}}static{this.\u0275dir=C.FsC({type:se,selectors:[["","nz-button",""],["nz-button-group"],["","nz-icon",""],["","nz-menu-item",""],["","nz-submenu",""],["nz-select-top-control"],["nz-select-placeholder"],["nz-input-group"]],inputs:{hidden:"hidden"},features:[C.OA$]})}}return se})(),a=(()=>{class se{static{this.\u0275fac=function(ee){return new(ee||se)}}static{this.\u0275mod=C.$C({type:se})}static{this.\u0275inj=C.G2t({imports:[M.IK]})}}return se})()},317:(Nn,Ct,R)=>{"use strict";R.d(Ct,{BD:()=>Se,BV:()=>Jt,G4:()=>xt,Gd:()=>ki,H3:()=>et,LP:()=>dt,Mk:()=>At,OC:()=>hn,Os:()=>Wn,Ro:()=>Qt,XQ:()=>Yt,XV:()=>$n,YI:()=>zt,cG:()=>en,cz:()=>pn,gD:()=>mt,ij:()=>wt,j3:()=>sn,my:()=>bt,n9:()=>at,nI:()=>un,nS:()=>Ve,r1:()=>he,uI:()=>ze,yL:()=>di,yc:()=>je});var M=R(4438),C=R(4085),de=R(1265),a=R(1413),se=R(4402),Fe=R(6648),ve=R(7673),ee=R(6697);function he(Oe,Ke){if(!Oe||!Ke||Oe.length!==Ke.length)return!1;const Et=Oe.length;for(let Ie=0;Ie<Et;Ie++)if(Oe[Ie]!==Ke[Ie])return!1;return!0}function at(Oe){return typeof Oe<"u"&&null!==Oe}function mt(Oe){return typeof Oe>"u"||null===Oe}function ze(Oe){return"string"==typeof Oe&&""!==Oe}function bt(Oe){return Oe instanceof M.C4Q}function xt(Oe){return(0,C.he)(Oe)}function Qt(Oe,Ke=0){return(0,C.o1)(Oe)?Number(Oe):Ke}function sn(Oe){return(0,C.a1)(Oe)}function Yt(Oe,...Ke){return"function"==typeof Oe?Oe(...Ke):Oe}function Ut(Oe,Ke){return function Et(Ie,ae,Z){const Y=`$$__zorroPropDecorator__${ae}`;return Object.prototype.hasOwnProperty.call(Ie,Y)&&(0,de.R8)(`The prop "${Y}" is already exist, it will be overrided by ${Oe} decorator.`),Object.defineProperty(Ie,Y,{configurable:!0,writable:!0}),{get(){return Z&&Z.get?Z.get.bind(this)():this[Y]},set(_e){Z&&Z.set&&Z.set.bind(this)(Ke(_e)),this[Y]=Ke(_e)}}}}function et(){return Ut("InputBoolean",xt)}function zt(Oe){return Ut("InputNumber",Ke=>Qt(Ke,Oe))}function je(Oe){Oe.stopPropagation(),Oe.preventDefault()}function At(Oe){if(!Oe.getClientRects().length)return{top:0,left:0};const Ke=Oe.getBoundingClientRect(),Et=Oe.ownerDocument.defaultView;return{top:Ke.top+Et.pageYOffset,left:Ke.left+Et.pageXOffset}}function di(Oe){return!!Oe&&"function"==typeof Oe.then&&"function"==typeof Oe.catch}function Wn(Oe,Ke,Et){return(Et-Oe)/(Ke-Oe)*100}function $n(Oe){const Ke=Oe.toString(),Et=Ke.indexOf(".");return Et>=0?Ke.length-Et-1:0}function ki(Oe,Ke,Et){return isNaN(Oe)||Oe<Ke?Ke:Oe>Et?Et:Oe}function Jt(Oe){return"number"==typeof Oe&&isFinite(Oe)}function un(Oe,Ke){return Math.round(Oe*Math.pow(10,Ke))/Math.pow(10,Ke)}function pn(Oe,Ke=0){return Oe.reduce((Et,Ie)=>Et+Ie,Ke)}let st,Xe;typeof window<"u"&&window;const ye={position:"absolute",top:"-9999px",width:"50px",height:"50px"};function Ve(Oe="vertical",Ke="ant"){if(typeof document>"u"||typeof window>"u")return 0;const Et="vertical"===Oe;if(Et&&st)return st;if(!Et&&Xe)return Xe;const Ie=document.createElement("div");Object.keys(ye).forEach(Z=>{Ie.style[Z]=ye[Z]}),Ie.className=`${Ke}-hide-scrollbar scroll-div-append-to-body`,Et?Ie.style.overflowY="scroll":Ie.style.overflowX="scroll",document.body.appendChild(Ie);let ae=0;return Et?(ae=Ie.offsetWidth-Ie.clientWidth,st=ae):(ae=Ie.offsetHeight-Ie.clientHeight,Xe=ae),document.body.removeChild(Ie),ae}function wt(){const Oe=new a.B;return Promise.resolve().then(()=>Oe.next()),Oe.pipe((0,ee.s)(1))}function en(Oe){return(0,se.A)(Oe)?Oe:di(Oe)?(0,Fe.H)(Promise.resolve(Oe)):(0,ve.of)(Oe)}function hn(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}const si="rc-util-key";function Hi({mark:Oe}={}){return Oe?Oe.startsWith("data-")?Oe:`data-${Oe}`:si}function ti(Oe){return Oe.attachTo?Oe.attachTo:document.querySelector("head")||document.body}function bi(Oe,Ke={}){if(!hn())return null;const Et=document.createElement("style");Ke.cspNonce&&(Et.nonce=Ke.cspNonce),Et.innerHTML=Oe;const Ie=ti(Ke),{firstChild:ae}=Ie;return Ke.prepend&&Ie.prepend?Ie.prepend(Et):Ke.prepend&&ae?Ie.insertBefore(Et,ae):Ie.appendChild(Et),Et}const gi=new Map;function Se(Oe,Ke,Et={}){const Ie=ti(Et);if(!gi.has(Ie)){const Y=bi("",Et),{parentNode:_e}=Y;gi.set(Ie,_e),_e.removeChild(Y)}const ae=function lt(Oe,Ke={}){const Et=ti(Ke);return Array.from(gi.get(Et)?.children||[]).find(Ie=>"STYLE"===Ie.tagName&&Ie.getAttribute(Hi(Ke))===Oe)}(Ke,Et);if(ae)return Et.cspNonce&&ae.nonce!==Et.cspNonce&&(ae.nonce=Et.cspNonce),ae.innerHTML!==Oe&&(ae.innerHTML=Oe),ae;const Z=bi(Oe,Et);return Z?.setAttribute(Hi(Et),Ke),Z}function dt(Oe,Ke,Et){return{[`${Oe}-status-success`]:"success"===Ke,[`${Oe}-status-warning`]:"warning"===Ke,[`${Oe}-status-error`]:"error"===Ke,[`${Oe}-status-validating`]:"validating"===Ke,[`${Oe}-has-feedback`]:Et}}},5930:(Nn,Ct,R)=>{"use strict";R.d(Ct,{o7:()=>ee,p:()=>ve});var M=R(6860),C=R(4438);class de{get waveAttributeName(){return this.insertExtraNode?"ant-click-animating":"ant-click-animating-without-extra-node"}constructor(he,ge,at,mt,$e){this.triggerElement=he,this.ngZone=ge,this.insertExtraNode=at,this.platformId=mt,this.cspNonce=$e,this.waveTransitionDuration=400,this.styleForPseudo=null,this.extraNode=null,this.lastTime=0,this.onClick=ze=>{!this.triggerElement||!this.triggerElement.getAttribute||this.triggerElement.getAttribute("disabled")||"INPUT"===ze.target.tagName||this.triggerElement.className.indexOf("disabled")>=0||this.fadeOutWave()},this.platform=new M.OD(this.platformId),this.clickHandler=this.onClick.bind(this),this.bindTriggerEvent()}bindTriggerEvent(){this.platform.isBrowser&&this.ngZone.runOutsideAngular(()=>{this.removeTriggerEvent(),this.triggerElement&&this.triggerElement.addEventListener("click",this.clickHandler,!0)})}removeTriggerEvent(){this.triggerElement&&this.triggerElement.removeEventListener("click",this.clickHandler,!0)}removeStyleAndExtraNode(){this.styleForPseudo&&document.body.contains(this.styleForPseudo)&&(document.body.removeChild(this.styleForPseudo),this.styleForPseudo=null),this.insertExtraNode&&this.triggerElement.contains(this.extraNode)&&this.triggerElement.removeChild(this.extraNode)}destroy(){this.removeTriggerEvent(),this.removeStyleAndExtraNode()}fadeOutWave(){const he=this.triggerElement,ge=this.getWaveColor(he);he.setAttribute(this.waveAttributeName,"true"),!(Date.now()<this.lastTime+this.waveTransitionDuration)&&(this.isValidColor(ge)&&(this.styleForPseudo||(this.styleForPseudo=document.createElement("style"),this.cspNonce&&(this.styleForPseudo.nonce=this.cspNonce)),this.styleForPseudo.innerHTML=`\n      [ant-click-animating-without-extra-node='true']::after, .ant-click-animating-node {\n        --antd-wave-shadow-color: ${ge};\n      }`,document.body.appendChild(this.styleForPseudo)),this.insertExtraNode&&(this.extraNode||(this.extraNode=document.createElement("div")),this.extraNode.className="ant-click-animating-node",he.appendChild(this.extraNode)),this.lastTime=Date.now(),this.runTimeoutOutsideZone(()=>{he.removeAttribute(this.waveAttributeName),this.removeStyleAndExtraNode()},this.waveTransitionDuration))}isValidColor(he){return!!he&&"#ffffff"!==he&&"rgb(255, 255, 255)"!==he&&this.isNotGrey(he)&&!/rgba\(\d*, \d*, \d*, 0\)/.test(he)&&"transparent"!==he}isNotGrey(he){const ge=he.match(/rgba?\((\d*), (\d*), (\d*)(, [\.\d]*)?\)/);return!(ge&&ge[1]&&ge[2]&&ge[3]&&ge[1]===ge[2]&&ge[2]===ge[3])}getWaveColor(he){const ge=getComputedStyle(he);return ge.getPropertyValue("border-top-color")||ge.getPropertyValue("border-color")||ge.getPropertyValue("background-color")}runTimeoutOutsideZone(he,ge){this.ngZone.runOutsideAngular(()=>setTimeout(he,ge))}}const a={disabled:!1},se=new C.nKC("nz-wave-global-options");function Fe(fe){return(0,C.EmA)([{provide:se,useValue:fe}])}let ve=(()=>{class fe{get disabled(){return this.waveDisabled}get rendererRef(){return this.waveRenderer}constructor(ge,at,mt,$e,ze,bt){this.ngZone=ge,this.elementRef=at,this.config=mt,this.animationType=$e,this.platformId=ze,this.cspNonce=bt,this.nzWaveExtraNode=!1,this.waveDisabled=!1,this.waveDisabled=this.isConfigDisabled()}isConfigDisabled(){let ge=!1;return this.config&&"boolean"==typeof this.config.disabled&&(ge=this.config.disabled),"NoopAnimations"===this.animationType&&(ge=!0),ge}ngOnDestroy(){this.waveRenderer&&this.waveRenderer.destroy()}ngOnInit(){this.renderWaveIfEnabled()}renderWaveIfEnabled(){!this.waveDisabled&&this.elementRef.nativeElement&&(this.waveRenderer=new de(this.elementRef.nativeElement,this.ngZone,this.nzWaveExtraNode,this.platformId,this.cspNonce))}disable(){this.waveDisabled=!0,this.waveRenderer&&(this.waveRenderer.removeTriggerEvent(),this.waveRenderer.removeStyleAndExtraNode())}enable(){this.waveDisabled=this.isConfigDisabled()||!1,this.waveRenderer&&this.waveRenderer.bindTriggerEvent()}static{this.\u0275fac=function(at){return new(at||fe)(C.rXU(C.SKi),C.rXU(C.aKT),C.rXU(se,8),C.rXU(C.bc$,8),C.rXU(C.Agw),C.rXU(C.BIS,8))}}static{this.\u0275dir=C.FsC({type:fe,selectors:[["","nz-wave",""],["button","nz-button","",3,"nzType","link",3,"nzType","text"]],inputs:{nzWaveExtraNode:"nzWaveExtraNode"},exportAs:["nzWave"]})}}return fe})(),ee=(()=>{class fe{static{this.\u0275fac=function(at){return new(at||fe)}}static{this.\u0275mod=C.$C({type:fe})}static{this.\u0275inj=C.G2t({providers:[Fe(a)],imports:[M.IK]})}}return fe})()},3341:(Nn,Ct,R)=>{"use strict";R.d(Ct,{cr:()=>Hs,_N:()=>ks,bP:()=>Kr,Vc:()=>Eo,Og:()=>hs,Bh:()=>Na});var M=R(4438),C=R(4412),de=R(1265),a=R(177),se=R(628),Fe=R(6190),ve=R(738);function ee(Ue){return(0,ve.A)(1,arguments),(0,Fe.A)(Ue,{weekStartsOn:1})}var mt=R(2764),$e=R(179);function bt(Ue,De){return(0,ve.A)(2,arguments),function ze(Ue,De){(0,ve.A)(2,arguments);var ie=(0,se.A)(Ue).getTime(),le=(0,$e.A)(De);return new Date(ie+le)}(Ue,-(0,$e.A)(De))}function sn(Ue){(0,ve.A)(1,arguments);var ie=(0,se.A)(Ue),le=ie.getUTCDay(),W=(le<1?7:0)+le-1;return ie.setUTCDate(ie.getUTCDate()-W),ie.setUTCHours(0,0,0,0),ie}function Yt(Ue){(0,ve.A)(1,arguments);var De=(0,se.A)(Ue),ie=De.getUTCFullYear(),le=new Date(0);le.setUTCFullYear(ie+1,0,4),le.setUTCHours(0,0,0,0);var W=sn(le),Ce=new Date(0);Ce.setUTCFullYear(ie,0,4),Ce.setUTCHours(0,0,0,0);var xe=sn(Ce);return De.getTime()>=W.getTime()?ie+1:De.getTime()>=xe.getTime()?ie:ie-1}function It(Ue){(0,ve.A)(1,arguments);var De=(0,se.A)(Ue),ie=sn(De).getTime()-function Ut(Ue){(0,ve.A)(1,arguments);var De=Yt(Ue),ie=new Date(0);return ie.setUTCFullYear(De,0,4),ie.setUTCHours(0,0,0,0),sn(ie)}(De).getTime();return Math.round(ie/6048e5)+1}var zt=R(4319);function je(Ue,De){var ie,le,W,Ce,xe,ei,L,Me;(0,ve.A)(1,arguments);var X=(0,zt.q)(),pe=(0,$e.A)(null!==(ie=null!==(le=null!==(W=null!==(Ce=De?.weekStartsOn)&&void 0!==Ce?Ce:null==De||null===(xe=De.locale)||void 0===xe||null===(ei=xe.options)||void 0===ei?void 0:ei.weekStartsOn)&&void 0!==W?W:X.weekStartsOn)&&void 0!==le?le:null===(L=X.locale)||void 0===L||null===(Me=L.options)||void 0===Me?void 0:Me.weekStartsOn)&&void 0!==ie?ie:0);if(!(pe>=0&&pe<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var vt=(0,se.A)(Ue),Nt=vt.getUTCDay(),tn=(Nt<pe?7:0)+Nt-pe;return vt.setUTCDate(vt.getUTCDate()-tn),vt.setUTCHours(0,0,0,0),vt}function At(Ue,De){var ie,le,W,Ce,xe,ei,L,Me;(0,ve.A)(1,arguments);var X=(0,se.A)(Ue),pe=X.getUTCFullYear(),vt=(0,zt.q)(),Nt=(0,$e.A)(null!==(ie=null!==(le=null!==(W=null!==(Ce=De?.firstWeekContainsDate)&&void 0!==Ce?Ce:null==De||null===(xe=De.locale)||void 0===xe||null===(ei=xe.options)||void 0===ei?void 0:ei.firstWeekContainsDate)&&void 0!==W?W:vt.firstWeekContainsDate)&&void 0!==le?le:null===(L=vt.locale)||void 0===L||null===(Me=L.options)||void 0===Me?void 0:Me.firstWeekContainsDate)&&void 0!==ie?ie:1);if(!(Nt>=1&&Nt<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var tn=new Date(0);tn.setUTCFullYear(pe+1,0,Nt),tn.setUTCHours(0,0,0,0);var Xt=je(tn,De),zi=new Date(0);zi.setUTCFullYear(pe,0,Nt),zi.setUTCHours(0,0,0,0);var pr=je(zi,De);return X.getTime()>=Xt.getTime()?pe+1:X.getTime()>=pr.getTime()?pe:pe-1}function wn(Ue,De){(0,ve.A)(1,arguments);var ie=(0,se.A)(Ue),le=je(ie,De).getTime()-function Ze(Ue,De){var ie,le,W,Ce,xe,ei,L,Me;(0,ve.A)(1,arguments);var X=(0,zt.q)(),pe=(0,$e.A)(null!==(ie=null!==(le=null!==(W=null!==(Ce=De?.firstWeekContainsDate)&&void 0!==Ce?Ce:null==De||null===(xe=De.locale)||void 0===xe||null===(ei=xe.options)||void 0===ei?void 0:ei.firstWeekContainsDate)&&void 0!==W?W:X.firstWeekContainsDate)&&void 0!==le?le:null===(L=X.locale)||void 0===L||null===(Me=L.options)||void 0===Me?void 0:Me.firstWeekContainsDate)&&void 0!==ie?ie:1),vt=At(Ue,De),Nt=new Date(0);return Nt.setUTCFullYear(vt,0,pe),Nt.setUTCHours(0,0,0,0),je(Nt,De)}(ie,De).getTime();return Math.round(le/6048e5)+1}function Rn(Ue,De){for(var ie=Ue<0?"-":"",le=Math.abs(Ue).toString();le.length<De;)le="0"+le;return ie+le}const Un_y=function(De,ie){var le=De.getUTCFullYear(),W=le>0?le:1-le;return Rn("yy"===ie?W%100:W,ie.length)},Un_M=function(De,ie){var le=De.getUTCMonth();return"M"===ie?String(le+1):Rn(le+1,2)},Un_d=function(De,ie){return Rn(De.getUTCDate(),ie.length)},Un_h=function(De,ie){return Rn(De.getUTCHours()%12||12,ie.length)},Un_H=function(De,ie){return Rn(De.getUTCHours(),ie.length)},Un_m=function(De,ie){return Rn(De.getUTCMinutes(),ie.length)},Un_s=function(De,ie){return Rn(De.getUTCSeconds(),ie.length)},Un_S=function(De,ie){var le=ie.length,W=De.getUTCMilliseconds();return Rn(Math.floor(W*Math.pow(10,le-3)),ie.length)};function Wn(Ue,De){var ie=Ue>0?"-":"+",le=Math.abs(Ue),W=Math.floor(le/60),Ce=le%60;if(0===Ce)return ie+String(W);var xe=De||"";return ie+String(W)+xe+Rn(Ce,2)}function $n(Ue,De){return Ue%60==0?(Ue>0?"-":"+")+Rn(Math.abs(Ue)/60,2):ki(Ue,De)}function ki(Ue,De){var ie=De||"",le=Ue>0?"-":"+",W=Math.abs(Ue);return le+Rn(Math.floor(W/60),2)+ie+Rn(W%60,2)}const Jt={G:function(De,ie,le){var W=De.getUTCFullYear()>0?1:0;switch(ie){case"G":case"GG":case"GGG":return le.era(W,{width:"abbreviated"});case"GGGGG":return le.era(W,{width:"narrow"});default:return le.era(W,{width:"wide"})}},y:function(De,ie,le){if("yo"===ie){var W=De.getUTCFullYear();return le.ordinalNumber(W>0?W:1-W,{unit:"year"})}return Un_y(De,ie)},Y:function(De,ie,le,W){var Ce=At(De,W),xe=Ce>0?Ce:1-Ce;return"YY"===ie?Rn(xe%100,2):"Yo"===ie?le.ordinalNumber(xe,{unit:"year"}):Rn(xe,ie.length)},R:function(De,ie){return Rn(Yt(De),ie.length)},u:function(De,ie){return Rn(De.getUTCFullYear(),ie.length)},Q:function(De,ie,le){var W=Math.ceil((De.getUTCMonth()+1)/3);switch(ie){case"Q":return String(W);case"QQ":return Rn(W,2);case"Qo":return le.ordinalNumber(W,{unit:"quarter"});case"QQQ":return le.quarter(W,{width:"abbreviated",context:"formatting"});case"QQQQQ":return le.quarter(W,{width:"narrow",context:"formatting"});default:return le.quarter(W,{width:"wide",context:"formatting"})}},q:function(De,ie,le){var W=Math.ceil((De.getUTCMonth()+1)/3);switch(ie){case"q":return String(W);case"qq":return Rn(W,2);case"qo":return le.ordinalNumber(W,{unit:"quarter"});case"qqq":return le.quarter(W,{width:"abbreviated",context:"standalone"});case"qqqqq":return le.quarter(W,{width:"narrow",context:"standalone"});default:return le.quarter(W,{width:"wide",context:"standalone"})}},M:function(De,ie,le){var W=De.getUTCMonth();switch(ie){case"M":case"MM":return Un_M(De,ie);case"Mo":return le.ordinalNumber(W+1,{unit:"month"});case"MMM":return le.month(W,{width:"abbreviated",context:"formatting"});case"MMMMM":return le.month(W,{width:"narrow",context:"formatting"});default:return le.month(W,{width:"wide",context:"formatting"})}},L:function(De,ie,le){var W=De.getUTCMonth();switch(ie){case"L":return String(W+1);case"LL":return Rn(W+1,2);case"Lo":return le.ordinalNumber(W+1,{unit:"month"});case"LLL":return le.month(W,{width:"abbreviated",context:"standalone"});case"LLLLL":return le.month(W,{width:"narrow",context:"standalone"});default:return le.month(W,{width:"wide",context:"standalone"})}},w:function(De,ie,le,W){var Ce=wn(De,W);return"wo"===ie?le.ordinalNumber(Ce,{unit:"week"}):Rn(Ce,ie.length)},I:function(De,ie,le){var W=It(De);return"Io"===ie?le.ordinalNumber(W,{unit:"week"}):Rn(W,ie.length)},d:function(De,ie,le){return"do"===ie?le.ordinalNumber(De.getUTCDate(),{unit:"date"}):Un_d(De,ie)},D:function(De,ie,le){var W=function Qt(Ue){(0,ve.A)(1,arguments);var De=(0,se.A)(Ue),ie=De.getTime();De.setUTCMonth(0,1),De.setUTCHours(0,0,0,0);var le=De.getTime();return Math.floor((ie-le)/864e5)+1}(De);return"Do"===ie?le.ordinalNumber(W,{unit:"dayOfYear"}):Rn(W,ie.length)},E:function(De,ie,le){var W=De.getUTCDay();switch(ie){case"E":case"EE":case"EEE":return le.day(W,{width:"abbreviated",context:"formatting"});case"EEEEE":return le.day(W,{width:"narrow",context:"formatting"});case"EEEEEE":return le.day(W,{width:"short",context:"formatting"});default:return le.day(W,{width:"wide",context:"formatting"})}},e:function(De,ie,le,W){var Ce=De.getUTCDay(),xe=(Ce-W.weekStartsOn+8)%7||7;switch(ie){case"e":return String(xe);case"ee":return Rn(xe,2);case"eo":return le.ordinalNumber(xe,{unit:"day"});case"eee":return le.day(Ce,{width:"abbreviated",context:"formatting"});case"eeeee":return le.day(Ce,{width:"narrow",context:"formatting"});case"eeeeee":return le.day(Ce,{width:"short",context:"formatting"});default:return le.day(Ce,{width:"wide",context:"formatting"})}},c:function(De,ie,le,W){var Ce=De.getUTCDay(),xe=(Ce-W.weekStartsOn+8)%7||7;switch(ie){case"c":return String(xe);case"cc":return Rn(xe,ie.length);case"co":return le.ordinalNumber(xe,{unit:"day"});case"ccc":return le.day(Ce,{width:"abbreviated",context:"standalone"});case"ccccc":return le.day(Ce,{width:"narrow",context:"standalone"});case"cccccc":return le.day(Ce,{width:"short",context:"standalone"});default:return le.day(Ce,{width:"wide",context:"standalone"})}},i:function(De,ie,le){var W=De.getUTCDay(),Ce=0===W?7:W;switch(ie){case"i":return String(Ce);case"ii":return Rn(Ce,ie.length);case"io":return le.ordinalNumber(Ce,{unit:"day"});case"iii":return le.day(W,{width:"abbreviated",context:"formatting"});case"iiiii":return le.day(W,{width:"narrow",context:"formatting"});case"iiiiii":return le.day(W,{width:"short",context:"formatting"});default:return le.day(W,{width:"wide",context:"formatting"})}},a:function(De,ie,le){var Ce=De.getUTCHours()/12>=1?"pm":"am";switch(ie){case"a":case"aa":return le.dayPeriod(Ce,{width:"abbreviated",context:"formatting"});case"aaa":return le.dayPeriod(Ce,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return le.dayPeriod(Ce,{width:"narrow",context:"formatting"});default:return le.dayPeriod(Ce,{width:"wide",context:"formatting"})}},b:function(De,ie,le){var Ce,W=De.getUTCHours();switch(Ce=12===W?"noon":0===W?"midnight":W/12>=1?"pm":"am",ie){case"b":case"bb":return le.dayPeriod(Ce,{width:"abbreviated",context:"formatting"});case"bbb":return le.dayPeriod(Ce,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return le.dayPeriod(Ce,{width:"narrow",context:"formatting"});default:return le.dayPeriod(Ce,{width:"wide",context:"formatting"})}},B:function(De,ie,le){var Ce,W=De.getUTCHours();switch(Ce=W>=17?"evening":W>=12?"afternoon":W>=4?"morning":"night",ie){case"B":case"BB":case"BBB":return le.dayPeriod(Ce,{width:"abbreviated",context:"formatting"});case"BBBBB":return le.dayPeriod(Ce,{width:"narrow",context:"formatting"});default:return le.dayPeriod(Ce,{width:"wide",context:"formatting"})}},h:function(De,ie,le){if("ho"===ie){var W=De.getUTCHours()%12;return 0===W&&(W=12),le.ordinalNumber(W,{unit:"hour"})}return Un_h(De,ie)},H:function(De,ie,le){return"Ho"===ie?le.ordinalNumber(De.getUTCHours(),{unit:"hour"}):Un_H(De,ie)},K:function(De,ie,le){var W=De.getUTCHours()%12;return"Ko"===ie?le.ordinalNumber(W,{unit:"hour"}):Rn(W,ie.length)},k:function(De,ie,le){var W=De.getUTCHours();return 0===W&&(W=24),"ko"===ie?le.ordinalNumber(W,{unit:"hour"}):Rn(W,ie.length)},m:function(De,ie,le){return"mo"===ie?le.ordinalNumber(De.getUTCMinutes(),{unit:"minute"}):Un_m(De,ie)},s:function(De,ie,le){return"so"===ie?le.ordinalNumber(De.getUTCSeconds(),{unit:"second"}):Un_s(De,ie)},S:function(De,ie){return Un_S(De,ie)},X:function(De,ie,le,W){var xe=(W._originalDate||De).getTimezoneOffset();if(0===xe)return"Z";switch(ie){case"X":return $n(xe);case"XXXX":case"XX":return ki(xe);default:return ki(xe,":")}},x:function(De,ie,le,W){var xe=(W._originalDate||De).getTimezoneOffset();switch(ie){case"x":return $n(xe);case"xxxx":case"xx":return ki(xe);default:return ki(xe,":")}},O:function(De,ie,le,W){var xe=(W._originalDate||De).getTimezoneOffset();switch(ie){case"O":case"OO":case"OOO":return"GMT"+Wn(xe,":");default:return"GMT"+ki(xe,":")}},z:function(De,ie,le,W){var xe=(W._originalDate||De).getTimezoneOffset();switch(ie){case"z":case"zz":case"zzz":return"GMT"+Wn(xe,":");default:return"GMT"+ki(xe,":")}},t:function(De,ie,le,W){return Rn(Math.floor((W._originalDate||De).getTime()/1e3),ie.length)},T:function(De,ie,le,W){return Rn((W._originalDate||De).getTime(),ie.length)}};var un=function(De,ie){switch(De){case"P":return ie.date({width:"short"});case"PP":return ie.date({width:"medium"});case"PPP":return ie.date({width:"long"});default:return ie.date({width:"full"})}},pn=function(De,ie){switch(De){case"p":return ie.time({width:"short"});case"pp":return ie.time({width:"medium"});case"ppp":return ie.time({width:"long"});default:return ie.time({width:"full"})}};const Yn={p:pn,P:function(De,ie){var xe,le=De.match(/(P+)(p+)?/)||[],W=le[1],Ce=le[2];if(!Ce)return un(De,ie);switch(W){case"P":xe=ie.dateTime({width:"short"});break;case"PP":xe=ie.dateTime({width:"medium"});break;case"PPP":xe=ie.dateTime({width:"long"});break;default:xe=ie.dateTime({width:"full"})}return xe.replace("{{date}}",un(W,ie)).replace("{{time}}",pn(Ce,ie))}};var zn=R(3511),qn=["D","DD"],ar=["YY","YYYY"];function Gi(Ue){return-1!==qn.indexOf(Ue)}function Si(Ue){return-1!==ar.indexOf(Ue)}function Mi(Ue,De,ie){if("YYYY"===Ue)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(De,"`) for formatting years to the input `").concat(ie,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===Ue)throw new RangeError("Use `yy` instead of `YY` (in `".concat(De,"`) for formatting years to the input `").concat(ie,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===Ue)throw new RangeError("Use `d` instead of `D` (in `".concat(De,"`) for formatting days of the month to the input `").concat(ie,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===Ue)throw new RangeError("Use `dd` instead of `DD` (in `".concat(De,"`) for formatting days of the month to the input `").concat(ie,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var Br={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function Bt(Ue){return function(){var De=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},ie=De.width?String(De.width):Ue.defaultWidth;return Ue.formats[ie]||Ue.formats[Ue.defaultWidth]}}var Sn={date:Bt({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:Bt({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:Bt({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},st={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Ve(Ue){return function(De,ie){var W;if("formatting"===(null!=ie&&ie.context?String(ie.context):"standalone")&&Ue.formattingValues){var Ce=Ue.defaultFormattingWidth||Ue.defaultWidth,xe=null!=ie&&ie.width?String(ie.width):Ce;W=Ue.formattingValues[xe]||Ue.formattingValues[Ce]}else{var ei=Ue.defaultWidth,L=null!=ie&&ie.width?String(ie.width):Ue.defaultWidth;W=Ue.values[L]||Ue.values[ei]}return W[Ue.argumentCallback?Ue.argumentCallback(De):De]}}function lt(Ue){return function(De){var ie=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},le=ie.width,Ce=De.match(le&&Ue.matchPatterns[le]||Ue.matchPatterns[Ue.defaultMatchWidth]);if(!Ce)return null;var Me,xe=Ce[0],ei=le&&Ue.parsePatterns[le]||Ue.parsePatterns[Ue.defaultParseWidth],L=Array.isArray(ei)?function Se(Ue,De){for(var ie=0;ie<Ue.length;ie++)if(De(Ue[ie]))return ie}(ei,function(pe){return pe.test(xe)}):function Pe(Ue,De){for(var ie in Ue)if(Ue.hasOwnProperty(ie)&&De(Ue[ie]))return ie}(ei,function(pe){return pe.test(xe)});return Me=Ue.valueCallback?Ue.valueCallback(L):L,{value:Me=ie.valueCallback?ie.valueCallback(Me):Me,rest:De.slice(xe.length)}}}const Jr={code:"en-US",formatDistance:function(De,ie,le){var W,Ce=Br[De];return W="string"==typeof Ce?Ce:1===ie?Ce.one:Ce.other.replace("{{count}}",ie.toString()),null!=le&&le.addSuffix?le.comparison&&le.comparison>0?"in "+W:W+" ago":W},formatLong:Sn,formatRelative:function(De,ie,le,W){return st[De]},localize:{ordinalNumber:function(De,ie){var le=Number(De),W=le%100;if(W>20||W<10)switch(W%10){case 1:return le+"st";case 2:return le+"nd";case 3:return le+"rd"}return le+"th"},era:Ve({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Ve({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(De){return De-1}}),month:Ve({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Ve({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Ve({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:function dt(Ue){return function(De){var ie=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},le=De.match(Ue.matchPattern);if(!le)return null;var W=le[0],Ce=De.match(Ue.parsePattern);if(!Ce)return null;var xe=Ue.valueCallback?Ue.valueCallback(Ce[0]):Ce[0];return{value:xe=ie.valueCallback?ie.valueCallback(xe):xe,rest:De.slice(W.length)}}}({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(De){return parseInt(De,10)}}),era:lt({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:lt({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(De){return De+1}}),month:lt({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:lt({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:lt({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};var eo=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Lr=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ci=/^'([^]*?)'?$/,Do=/''/g,Or=/[a-zA-Z]/;var fr=R(2284);function Xi(Ue,De){(null==De||De>Ue.length)&&(De=Ue.length);for(var ie=0,le=new Array(De);ie<De;ie++)le[ie]=Ue[ie];return le}function oo(Ue,De){var ie=typeof Symbol<"u"&&Ue[Symbol.iterator]||Ue["@@iterator"];if(!ie){if(Array.isArray(Ue)||(ie=function fo(Ue,De){if(Ue){if("string"==typeof Ue)return Xi(Ue,De);var ie=Object.prototype.toString.call(Ue).slice(8,-1);if("Object"===ie&&Ue.constructor&&(ie=Ue.constructor.name),"Map"===ie||"Set"===ie)return Array.from(Ue);if("Arguments"===ie||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ie))return Xi(Ue,De)}}(Ue))||De&&Ue&&"number"==typeof Ue.length){ie&&(Ue=ie);var le=0,W=function(){};return{s:W,n:function(){return le>=Ue.length?{done:!0}:{done:!1,value:Ue[le++]}},e:function(Me){throw Me},f:W}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var ei,Ce=!0,xe=!1;return{s:function(){ie=ie.call(Ue)},n:function(){var Me=ie.next();return Ce=Me.done,Me},e:function(Me){xe=!0,ei=Me},f:function(){try{!Ce&&null!=ie.return&&ie.return()}finally{if(xe)throw ei}}}}function so(Ue,De){if(null==Ue)throw new TypeError("assign requires that input parameter not be null or undefined");for(var ie in De)Object.prototype.hasOwnProperty.call(De,ie)&&(Ue[ie]=De[ie]);return Ue}function ci(Ue){if(void 0===Ue)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ue}function mo(Ue,De){return(mo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(le,W){return le.__proto__=W,le})(Ue,De)}function yr(Ue,De){if("function"!=typeof De&&null!==De)throw new TypeError("Super expression must either be null or a function");Ue.prototype=Object.create(De&&De.prototype,{constructor:{value:Ue,writable:!0,configurable:!0}}),Object.defineProperty(Ue,"prototype",{writable:!1}),De&&mo(Ue,De)}function Uo(Ue){return(Uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ie){return ie.__proto__||Object.getPrototypeOf(ie)})(Ue)}function nt(){try{var Ue=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nt=function(){return!!Ue})()}function Tt(Ue){var De=nt();return function(){var W,le=Uo(Ue);if(De){var Ce=Uo(this).constructor;W=Reflect.construct(le,arguments,Ce)}else W=le.apply(this,arguments);return function Ft(Ue,De){if(De&&("object"===(0,fr.A)(De)||"function"==typeof De))return De;if(void 0!==De)throw new TypeError("Derived constructors may only return object or undefined");return ci(Ue)}(this,W)}}function ht(Ue,De){if(!(Ue instanceof De))throw new TypeError("Cannot call a class as a function")}function Xn(Ue){var De=function xn(Ue,De){if("object"!=(0,fr.A)(Ue)||!Ue)return Ue;var ie=Ue[Symbol.toPrimitive];if(void 0!==ie){var le=ie.call(Ue,De||"default");if("object"!=(0,fr.A)(le))return le;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===De?String:Number)(Ue)}(Ue,"string");return"symbol"==(0,fr.A)(De)?De:String(De)}function Zn(Ue,De){for(var ie=0;ie<De.length;ie++){var le=De[ie];le.enumerable=le.enumerable||!1,le.configurable=!0,"value"in le&&(le.writable=!0),Object.defineProperty(Ue,Xn(le.key),le)}}function Ei(Ue,De,ie){return De&&Zn(Ue.prototype,De),ie&&Zn(Ue,ie),Object.defineProperty(Ue,"prototype",{writable:!1}),Ue}function An(Ue,De,ie){return(De=Xn(De))in Ue?Object.defineProperty(Ue,De,{value:ie,enumerable:!0,configurable:!0,writable:!0}):Ue[De]=ie,Ue}var lr=function(){function Ue(){ht(this,Ue),An(this,"priority",void 0),An(this,"subPriority",0)}return Ei(Ue,[{key:"validate",value:function(ie,le){return!0}}]),Ue}(),Mr=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(le,W,Ce,xe,ei){var L;return ht(this,ie),(L=De.call(this)).value=le,L.validateValue=W,L.setValue=Ce,L.priority=xe,ei&&(L.subPriority=ei),L}return Ei(ie,[{key:"validate",value:function(W,Ce){return this.validateValue(W,this.value,Ce)}},{key:"set",value:function(W,Ce,xe){return this.setValue(W,Ce,this.value,xe)}}]),ie}(lr),ii=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",10),An(ci(le),"subPriority",-1),le}return Ei(ie,[{key:"set",value:function(W,Ce){if(Ce.timestampIsSet)return W;var xe=new Date(0);return xe.setFullYear(W.getUTCFullYear(),W.getUTCMonth(),W.getUTCDate()),xe.setHours(W.getUTCHours(),W.getUTCMinutes(),W.getUTCSeconds(),W.getUTCMilliseconds()),xe}}]),ie}(lr),vi=function(){function Ue(){ht(this,Ue),An(this,"incompatibleTokens",void 0),An(this,"priority",void 0),An(this,"subPriority",void 0)}return Ei(Ue,[{key:"run",value:function(ie,le,W,Ce){var xe=this.parse(ie,le,W,Ce);return xe?{setter:new Mr(xe.value,this.validate,this.set,this.priority,this.subPriority),rest:xe.rest}:null}},{key:"validate",value:function(ie,le,W){return!0}}]),Ue}(),Ui=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",140),An(ci(le),"incompatibleTokens",["R","u","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"G":case"GG":case"GGG":return xe.era(W,{width:"abbreviated"})||xe.era(W,{width:"narrow"});case"GGGGG":return xe.era(W,{width:"narrow"});default:return xe.era(W,{width:"wide"})||xe.era(W,{width:"abbreviated"})||xe.era(W,{width:"narrow"})}}},{key:"set",value:function(W,Ce,xe){return Ce.era=xe,W.setUTCFullYear(xe,0,1),W.setUTCHours(0,0,0,0),W}}]),ie}(vi),ur=R(6746),Ri_month=/^(1[0-2]|0?\d)/,Ri_date=/^(3[0-1]|[0-2]?\d)/,Ri_dayOfYear=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,Ri_week=/^(5[0-3]|[0-4]?\d)/,Ri_hour23h=/^(2[0-3]|[0-1]?\d)/,Ri_hour24h=/^(2[0-4]|[0-1]?\d)/,Ri_hour11h=/^(1[0-1]|0?\d)/,Ri_hour12h=/^(1[0-2]|0?\d)/,Ri_minute=/^[0-5]?\d/,Ri_second=/^[0-5]?\d/,Ri_singleDigit=/^\d/,Ri_twoDigits=/^\d{1,2}/,Ri_threeDigits=/^\d{1,3}/,Ri_fourDigits=/^\d{1,4}/,Ri_anyDigitsSigned=/^-?\d+/,Ri_singleDigitSigned=/^-?\d/,Ri_twoDigitsSigned=/^-?\d{1,2}/,Ri_threeDigitsSigned=/^-?\d{1,3}/,Ri_fourDigitsSigned=/^-?\d{1,4}/,Oi_basicOptionalMinutes=/^([+-])(\d{2})(\d{2})?|Z/,Oi_basic=/^([+-])(\d{2})(\d{2})|Z/,Oi_basicOptionalSeconds=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,Oi_extended=/^([+-])(\d{2}):(\d{2})|Z/,Oi_extendedOptionalSeconds=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function nr(Ue,De){return Ue&&{value:De(Ue.value),rest:Ue.rest}}function mr(Ue,De){var ie=De.match(Ue);return ie?{value:parseInt(ie[0],10),rest:De.slice(ie[0].length)}:null}function io(Ue,De){var ie=De.match(Ue);if(!ie)return null;if("Z"===ie[0])return{value:0,rest:De.slice(1)};var le="+"===ie[1]?1:-1,W=ie[2]?parseInt(ie[2],10):0,Ce=ie[3]?parseInt(ie[3],10):0,xe=ie[5]?parseInt(ie[5],10):0;return{value:le*(W*ur.s0+Ce*ur.Cg+xe*ur._m),rest:De.slice(ie[0].length)}}function yo(Ue){return mr(Ri_anyDigitsSigned,Ue)}function Ji(Ue,De){switch(Ue){case 1:return mr(Ri_singleDigit,De);case 2:return mr(Ri_twoDigits,De);case 3:return mr(Ri_threeDigits,De);case 4:return mr(Ri_fourDigits,De);default:return mr(new RegExp("^\\d{1,"+Ue+"}"),De)}}function Zi(Ue,De){switch(Ue){case 1:return mr(Ri_singleDigitSigned,De);case 2:return mr(Ri_twoDigitsSigned,De);case 3:return mr(Ri_threeDigitsSigned,De);case 4:return mr(Ri_fourDigitsSigned,De);default:return mr(new RegExp("^-?\\d{1,"+Ue+"}"),De)}}function hr(Ue){switch(Ue){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function oa(Ue,De){var W,ie=De>0,le=ie?De:1-De;if(le<=50)W=Ue||100;else{var Ce=le+50;W=Ue+100*Math.floor(Ce/100)-(Ue>=Ce%100?100:0)}return ie?W:1-W}function jo(Ue){return Ue%400==0||Ue%4==0&&Ue%100!=0}var gl=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",130),An(ci(le),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){var ei=function(Me){return{year:Me,isTwoDigitYear:"yy"===Ce}};switch(Ce){case"y":return nr(Ji(4,W),ei);case"yo":return nr(xe.ordinalNumber(W,{unit:"year"}),ei);default:return nr(Ji(Ce.length,W),ei)}}},{key:"validate",value:function(W,Ce){return Ce.isTwoDigitYear||Ce.year>0}},{key:"set",value:function(W,Ce,xe){var ei=W.getUTCFullYear();if(xe.isTwoDigitYear){var L=oa(xe.year,ei);return W.setUTCFullYear(L,0,1),W.setUTCHours(0,0,0,0),W}return W.setUTCFullYear("era"in Ce&&1!==Ce.era?1-xe.year:xe.year,0,1),W.setUTCHours(0,0,0,0),W}}]),ie}(vi),ol=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",130),An(ci(le),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){var ei=function(Me){return{year:Me,isTwoDigitYear:"YY"===Ce}};switch(Ce){case"Y":return nr(Ji(4,W),ei);case"Yo":return nr(xe.ordinalNumber(W,{unit:"year"}),ei);default:return nr(Ji(Ce.length,W),ei)}}},{key:"validate",value:function(W,Ce){return Ce.isTwoDigitYear||Ce.year>0}},{key:"set",value:function(W,Ce,xe,ei){var L=At(W,ei);if(xe.isTwoDigitYear){var Me=oa(xe.year,L);return W.setUTCFullYear(Me,0,ei.firstWeekContainsDate),W.setUTCHours(0,0,0,0),je(W,ei)}return W.setUTCFullYear("era"in Ce&&1!==Ce.era?1-xe.year:xe.year,0,ei.firstWeekContainsDate),W.setUTCHours(0,0,0,0),je(W,ei)}}]),ie}(vi),Ga=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",130),An(ci(le),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce){return Zi("R"===Ce?4:Ce.length,W)}},{key:"set",value:function(W,Ce,xe){var ei=new Date(0);return ei.setUTCFullYear(xe,0,4),ei.setUTCHours(0,0,0,0),sn(ei)}}]),ie}(vi),qs=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",130),An(ci(le),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce){return Zi("u"===Ce?4:Ce.length,W)}},{key:"set",value:function(W,Ce,xe){return W.setUTCFullYear(xe,0,1),W.setUTCHours(0,0,0,0),W}}]),ie}(vi),Dr=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",120),An(ci(le),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"Q":case"QQ":return Ji(Ce.length,W);case"Qo":return xe.ordinalNumber(W,{unit:"quarter"});case"QQQ":return xe.quarter(W,{width:"abbreviated",context:"formatting"})||xe.quarter(W,{width:"narrow",context:"formatting"});case"QQQQQ":return xe.quarter(W,{width:"narrow",context:"formatting"});default:return xe.quarter(W,{width:"wide",context:"formatting"})||xe.quarter(W,{width:"abbreviated",context:"formatting"})||xe.quarter(W,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(W,Ce){return Ce>=1&&Ce<=4}},{key:"set",value:function(W,Ce,xe){return W.setUTCMonth(3*(xe-1),1),W.setUTCHours(0,0,0,0),W}}]),ie}(vi),Ps=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",120),An(ci(le),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"q":case"qq":return Ji(Ce.length,W);case"qo":return xe.ordinalNumber(W,{unit:"quarter"});case"qqq":return xe.quarter(W,{width:"abbreviated",context:"standalone"})||xe.quarter(W,{width:"narrow",context:"standalone"});case"qqqqq":return xe.quarter(W,{width:"narrow",context:"standalone"});default:return xe.quarter(W,{width:"wide",context:"standalone"})||xe.quarter(W,{width:"abbreviated",context:"standalone"})||xe.quarter(W,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(W,Ce){return Ce>=1&&Ce<=4}},{key:"set",value:function(W,Ce,xe){return W.setUTCMonth(3*(xe-1),1),W.setUTCHours(0,0,0,0),W}}]),ie}(vi),Yo=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),An(ci(le),"priority",110),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){var ei=function(Me){return Me-1};switch(Ce){case"M":return nr(mr(Ri_month,W),ei);case"MM":return nr(Ji(2,W),ei);case"Mo":return nr(xe.ordinalNumber(W,{unit:"month"}),ei);case"MMM":return xe.month(W,{width:"abbreviated",context:"formatting"})||xe.month(W,{width:"narrow",context:"formatting"});case"MMMMM":return xe.month(W,{width:"narrow",context:"formatting"});default:return xe.month(W,{width:"wide",context:"formatting"})||xe.month(W,{width:"abbreviated",context:"formatting"})||xe.month(W,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(W,Ce){return Ce>=0&&Ce<=11}},{key:"set",value:function(W,Ce,xe){return W.setUTCMonth(xe,1),W.setUTCHours(0,0,0,0),W}}]),ie}(vi),Rr=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",110),An(ci(le),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){var ei=function(Me){return Me-1};switch(Ce){case"L":return nr(mr(Ri_month,W),ei);case"LL":return nr(Ji(2,W),ei);case"Lo":return nr(xe.ordinalNumber(W,{unit:"month"}),ei);case"LLL":return xe.month(W,{width:"abbreviated",context:"standalone"})||xe.month(W,{width:"narrow",context:"standalone"});case"LLLLL":return xe.month(W,{width:"narrow",context:"standalone"});default:return xe.month(W,{width:"wide",context:"standalone"})||xe.month(W,{width:"abbreviated",context:"standalone"})||xe.month(W,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(W,Ce){return Ce>=0&&Ce<=11}},{key:"set",value:function(W,Ce,xe){return W.setUTCMonth(xe,1),W.setUTCHours(0,0,0,0),W}}]),ie}(vi),Wa=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",100),An(ci(le),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"w":return mr(Ri_week,W);case"wo":return xe.ordinalNumber(W,{unit:"week"});default:return Ji(Ce.length,W)}}},{key:"validate",value:function(W,Ce){return Ce>=1&&Ce<=53}},{key:"set",value:function(W,Ce,xe,ei){return je(function Zs(Ue,De,ie){(0,ve.A)(2,arguments);var le=(0,se.A)(Ue),W=(0,$e.A)(De),Ce=wn(le,ie)-W;return le.setUTCDate(le.getUTCDate()-7*Ce),le}(W,xe,ei),ei)}}]),ie}(vi),$o=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",100),An(ci(le),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"I":return mr(Ri_week,W);case"Io":return xe.ordinalNumber(W,{unit:"week"});default:return Ji(Ce.length,W)}}},{key:"validate",value:function(W,Ce){return Ce>=1&&Ce<=53}},{key:"set",value:function(W,Ce,xe){return sn(function gs(Ue,De){(0,ve.A)(2,arguments);var ie=(0,se.A)(Ue),le=(0,$e.A)(De),W=It(ie)-le;return ie.setUTCDate(ie.getUTCDate()-7*W),ie}(W,xe))}}]),ie}(vi),vs=[31,28,31,30,31,30,31,31,30,31,30,31],_s=[31,29,31,30,31,30,31,31,30,31,30,31],xo=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",90),An(ci(le),"subPriority",1),An(ci(le),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"d":return mr(Ri_date,W);case"do":return xe.ordinalNumber(W,{unit:"date"});default:return Ji(Ce.length,W)}}},{key:"validate",value:function(W,Ce){var ei=jo(W.getUTCFullYear()),L=W.getUTCMonth();return ei?Ce>=1&&Ce<=_s[L]:Ce>=1&&Ce<=vs[L]}},{key:"set",value:function(W,Ce,xe){return W.setUTCDate(xe),W.setUTCHours(0,0,0,0),W}}]),ie}(vi),ga=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",90),An(ci(le),"subpriority",1),An(ci(le),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"D":case"DD":return mr(Ri_dayOfYear,W);case"Do":return xe.ordinalNumber(W,{unit:"date"});default:return Ji(Ce.length,W)}}},{key:"validate",value:function(W,Ce){return jo(W.getUTCFullYear())?Ce>=1&&Ce<=366:Ce>=1&&Ce<=365}},{key:"set",value:function(W,Ce,xe){return W.setUTCMonth(0,xe),W.setUTCHours(0,0,0,0),W}}]),ie}(vi);function Da(Ue,De,ie){var le,W,Ce,xe,ei,L,Me,X;(0,ve.A)(2,arguments);var pe=(0,zt.q)(),vt=(0,$e.A)(null!==(le=null!==(W=null!==(Ce=null!==(xe=ie?.weekStartsOn)&&void 0!==xe?xe:null==ie||null===(ei=ie.locale)||void 0===ei||null===(L=ei.options)||void 0===L?void 0:L.weekStartsOn)&&void 0!==Ce?Ce:pe.weekStartsOn)&&void 0!==W?W:null===(Me=pe.locale)||void 0===Me||null===(X=Me.options)||void 0===X?void 0:X.weekStartsOn)&&void 0!==le?le:0);if(!(vt>=0&&vt<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var Nt=(0,se.A)(Ue),tn=(0,$e.A)(De),Pr=((tn%7+7)%7<vt?7:0)+tn-Nt.getUTCDay();return Nt.setUTCDate(Nt.getUTCDate()+Pr),Nt}var Io=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",90),An(ci(le),"incompatibleTokens",["D","i","e","c","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"E":case"EE":case"EEE":return xe.day(W,{width:"abbreviated",context:"formatting"})||xe.day(W,{width:"short",context:"formatting"})||xe.day(W,{width:"narrow",context:"formatting"});case"EEEEE":return xe.day(W,{width:"narrow",context:"formatting"});case"EEEEEE":return xe.day(W,{width:"short",context:"formatting"})||xe.day(W,{width:"narrow",context:"formatting"});default:return xe.day(W,{width:"wide",context:"formatting"})||xe.day(W,{width:"abbreviated",context:"formatting"})||xe.day(W,{width:"short",context:"formatting"})||xe.day(W,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(W,Ce){return Ce>=0&&Ce<=6}},{key:"set",value:function(W,Ce,xe,ei){return(W=Da(W,xe,ei)).setUTCHours(0,0,0,0),W}}]),ie}(vi),po=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",90),An(ci(le),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe,ei){var L=function(X){var pe=7*Math.floor((X-1)/7);return(X+ei.weekStartsOn+6)%7+pe};switch(Ce){case"e":case"ee":return nr(Ji(Ce.length,W),L);case"eo":return nr(xe.ordinalNumber(W,{unit:"day"}),L);case"eee":return xe.day(W,{width:"abbreviated",context:"formatting"})||xe.day(W,{width:"short",context:"formatting"})||xe.day(W,{width:"narrow",context:"formatting"});case"eeeee":return xe.day(W,{width:"narrow",context:"formatting"});case"eeeeee":return xe.day(W,{width:"short",context:"formatting"})||xe.day(W,{width:"narrow",context:"formatting"});default:return xe.day(W,{width:"wide",context:"formatting"})||xe.day(W,{width:"abbreviated",context:"formatting"})||xe.day(W,{width:"short",context:"formatting"})||xe.day(W,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(W,Ce){return Ce>=0&&Ce<=6}},{key:"set",value:function(W,Ce,xe,ei){return(W=Da(W,xe,ei)).setUTCHours(0,0,0,0),W}}]),ie}(vi),sa=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",90),An(ci(le),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe,ei){var L=function(X){var pe=7*Math.floor((X-1)/7);return(X+ei.weekStartsOn+6)%7+pe};switch(Ce){case"c":case"cc":return nr(Ji(Ce.length,W),L);case"co":return nr(xe.ordinalNumber(W,{unit:"day"}),L);case"ccc":return xe.day(W,{width:"abbreviated",context:"standalone"})||xe.day(W,{width:"short",context:"standalone"})||xe.day(W,{width:"narrow",context:"standalone"});case"ccccc":return xe.day(W,{width:"narrow",context:"standalone"});case"cccccc":return xe.day(W,{width:"short",context:"standalone"})||xe.day(W,{width:"narrow",context:"standalone"});default:return xe.day(W,{width:"wide",context:"standalone"})||xe.day(W,{width:"abbreviated",context:"standalone"})||xe.day(W,{width:"short",context:"standalone"})||xe.day(W,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(W,Ce){return Ce>=0&&Ce<=6}},{key:"set",value:function(W,Ce,xe,ei){return(W=Da(W,xe,ei)).setUTCHours(0,0,0,0),W}}]),ie}(vi),Cs=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",90),An(ci(le),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){var ei=function(Me){return 0===Me?7:Me};switch(Ce){case"i":case"ii":return Ji(Ce.length,W);case"io":return xe.ordinalNumber(W,{unit:"day"});case"iii":return nr(xe.day(W,{width:"abbreviated",context:"formatting"})||xe.day(W,{width:"short",context:"formatting"})||xe.day(W,{width:"narrow",context:"formatting"}),ei);case"iiiii":return nr(xe.day(W,{width:"narrow",context:"formatting"}),ei);case"iiiiii":return nr(xe.day(W,{width:"short",context:"formatting"})||xe.day(W,{width:"narrow",context:"formatting"}),ei);default:return nr(xe.day(W,{width:"wide",context:"formatting"})||xe.day(W,{width:"abbreviated",context:"formatting"})||xe.day(W,{width:"short",context:"formatting"})||xe.day(W,{width:"narrow",context:"formatting"}),ei)}}},{key:"validate",value:function(W,Ce){return Ce>=1&&Ce<=7}},{key:"set",value:function(W,Ce,xe){return W=function Ms(Ue,De){(0,ve.A)(2,arguments);var ie=(0,$e.A)(De);ie%7==0&&(ie-=7);var W=(0,se.A)(Ue),L=((ie%7+7)%7<1?7:0)+ie-W.getUTCDay();return W.setUTCDate(W.getUTCDate()+L),W}(W,xe),W.setUTCHours(0,0,0,0),W}}]),ie}(vi),vo=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",80),An(ci(le),"incompatibleTokens",["b","B","H","k","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"a":case"aa":case"aaa":return xe.dayPeriod(W,{width:"abbreviated",context:"formatting"})||xe.dayPeriod(W,{width:"narrow",context:"formatting"});case"aaaaa":return xe.dayPeriod(W,{width:"narrow",context:"formatting"});default:return xe.dayPeriod(W,{width:"wide",context:"formatting"})||xe.dayPeriod(W,{width:"abbreviated",context:"formatting"})||xe.dayPeriod(W,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(W,Ce,xe){return W.setUTCHours(hr(xe),0,0,0),W}}]),ie}(vi),zs=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",80),An(ci(le),"incompatibleTokens",["a","B","H","k","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"b":case"bb":case"bbb":return xe.dayPeriod(W,{width:"abbreviated",context:"formatting"})||xe.dayPeriod(W,{width:"narrow",context:"formatting"});case"bbbbb":return xe.dayPeriod(W,{width:"narrow",context:"formatting"});default:return xe.dayPeriod(W,{width:"wide",context:"formatting"})||xe.dayPeriod(W,{width:"abbreviated",context:"formatting"})||xe.dayPeriod(W,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(W,Ce,xe){return W.setUTCHours(hr(xe),0,0,0),W}}]),ie}(vi),xr=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",80),An(ci(le),"incompatibleTokens",["a","b","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"B":case"BB":case"BBB":return xe.dayPeriod(W,{width:"abbreviated",context:"formatting"})||xe.dayPeriod(W,{width:"narrow",context:"formatting"});case"BBBBB":return xe.dayPeriod(W,{width:"narrow",context:"formatting"});default:return xe.dayPeriod(W,{width:"wide",context:"formatting"})||xe.dayPeriod(W,{width:"abbreviated",context:"formatting"})||xe.dayPeriod(W,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(W,Ce,xe){return W.setUTCHours(hr(xe),0,0,0),W}}]),ie}(vi),aa=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",70),An(ci(le),"incompatibleTokens",["H","K","k","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"h":return mr(Ri_hour12h,W);case"ho":return xe.ordinalNumber(W,{unit:"hour"});default:return Ji(Ce.length,W)}}},{key:"validate",value:function(W,Ce){return Ce>=1&&Ce<=12}},{key:"set",value:function(W,Ce,xe){var ei=W.getUTCHours()>=12;return W.setUTCHours(ei&&xe<12?xe+12:ei||12!==xe?xe:0,0,0,0),W}}]),ie}(vi),va=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",70),An(ci(le),"incompatibleTokens",["a","b","h","K","k","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"H":return mr(Ri_hour23h,W);case"Ho":return xe.ordinalNumber(W,{unit:"hour"});default:return Ji(Ce.length,W)}}},{key:"validate",value:function(W,Ce){return Ce>=0&&Ce<=23}},{key:"set",value:function(W,Ce,xe){return W.setUTCHours(xe,0,0,0),W}}]),ie}(vi),ls=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",70),An(ci(le),"incompatibleTokens",["h","H","k","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"K":return mr(Ri_hour11h,W);case"Ko":return xe.ordinalNumber(W,{unit:"hour"});default:return Ji(Ce.length,W)}}},{key:"validate",value:function(W,Ce){return Ce>=0&&Ce<=11}},{key:"set",value:function(W,Ce,xe){var ei=W.getUTCHours()>=12;return W.setUTCHours(ei&&xe<12?xe+12:xe,0,0,0),W}}]),ie}(vi),_a=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",70),An(ci(le),"incompatibleTokens",["a","b","h","H","K","t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"k":return mr(Ri_hour24h,W);case"ko":return xe.ordinalNumber(W,{unit:"hour"});default:return Ji(Ce.length,W)}}},{key:"validate",value:function(W,Ce){return Ce>=1&&Ce<=24}},{key:"set",value:function(W,Ce,xe){return W.setUTCHours(xe<=24?xe%24:xe,0,0,0),W}}]),ie}(vi),Xs=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",60),An(ci(le),"incompatibleTokens",["t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"m":return mr(Ri_minute,W);case"mo":return xe.ordinalNumber(W,{unit:"minute"});default:return Ji(Ce.length,W)}}},{key:"validate",value:function(W,Ce){return Ce>=0&&Ce<=59}},{key:"set",value:function(W,Ce,xe){return W.setUTCMinutes(xe,0,0),W}}]),ie}(vi),la=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",50),An(ci(le),"incompatibleTokens",["t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce,xe){switch(Ce){case"s":return mr(Ri_second,W);case"so":return xe.ordinalNumber(W,{unit:"second"});default:return Ji(Ce.length,W)}}},{key:"validate",value:function(W,Ce){return Ce>=0&&Ce<=59}},{key:"set",value:function(W,Ce,xe){return W.setUTCSeconds(xe,0),W}}]),ie}(vi),Is=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",30),An(ci(le),"incompatibleTokens",["t","T"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce){return nr(Ji(Ce.length,W),function(L){return Math.floor(L*Math.pow(10,3-Ce.length))})}},{key:"set",value:function(W,Ce,xe){return W.setUTCMilliseconds(xe),W}}]),ie}(vi),Xo=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",10),An(ci(le),"incompatibleTokens",["t","T","x"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce){switch(Ce){case"X":return io(Oi_basicOptionalMinutes,W);case"XX":return io(Oi_basic,W);case"XXXX":return io(Oi_basicOptionalSeconds,W);case"XXXXX":return io(Oi_extendedOptionalSeconds,W);default:return io(Oi_extended,W)}}},{key:"set",value:function(W,Ce,xe){return Ce.timestampIsSet?W:new Date(W.getTime()-xe)}}]),ie}(vi),Ka=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",10),An(ci(le),"incompatibleTokens",["t","T","X"]),le}return Ei(ie,[{key:"parse",value:function(W,Ce){switch(Ce){case"x":return io(Oi_basicOptionalMinutes,W);case"xx":return io(Oi_basic,W);case"xxxx":return io(Oi_basicOptionalSeconds,W);case"xxxxx":return io(Oi_extendedOptionalSeconds,W);default:return io(Oi_extended,W)}}},{key:"set",value:function(W,Ce,xe){return Ce.timestampIsSet?W:new Date(W.getTime()-xe)}}]),ie}(vi),Qs=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",40),An(ci(le),"incompatibleTokens","*"),le}return Ei(ie,[{key:"parse",value:function(W){return yo(W)}},{key:"set",value:function(W,Ce,xe){return[new Date(1e3*xe),{timestampIsSet:!0}]}}]),ie}(vi),Sa=function(Ue){yr(ie,Ue);var De=Tt(ie);function ie(){var le;ht(this,ie);for(var W=arguments.length,Ce=new Array(W),xe=0;xe<W;xe++)Ce[xe]=arguments[xe];return An(ci(le=De.call.apply(De,[this].concat(Ce))),"priority",20),An(ci(le),"incompatibleTokens","*"),le}return Ei(ie,[{key:"parse",value:function(W){return yo(W)}},{key:"set",value:function(W,Ce,xe){return[new Date(xe),{timestampIsSet:!0}]}}]),ie}(vi),ca={G:new Ui,y:new gl,Y:new ol,R:new Ga,u:new qs,Q:new Dr,q:new Ps,M:new Yo,L:new Rr,w:new Wa,I:new $o,d:new xo,D:new ga,E:new Io,e:new po,c:new sa,i:new Cs,a:new vo,b:new zs,B:new xr,h:new aa,H:new va,K:new ls,k:new _a,m:new Xs,s:new la,S:new Is,X:new Xo,x:new Ka,t:new Qs,T:new Sa},qa=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Go=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,rs=/^'([^]*?)'?$/,ya=/''/g,br=/\S/,Fa=/[a-zA-Z]/;var Ts=R(4608),Na={locale:"en",Pagination:{items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},DatePicker:{lang:{placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"],locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},timePickerLocale:{placeholder:"Select time",rangePlaceholder:["Start time","End time"]}},TimePicker:{placeholder:"Select time",rangePlaceholder:["Start time","End time"]},Calendar:{lang:{placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"],locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"Ok",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"},timePickerLocale:{placeholder:"Select time",rangePlaceholder:["Start time","End time"]}},global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",selectNone:"Clear all data"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No Data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Image:{preview:"Preview"},CronExpression:{cronError:"Invalid cron expression",second:"second",minute:"minute",hour:"hour",day:"day",month:"month",week:"week"},QRCode:{expired:"QR code expired",refresh:"Refresh"}},Lo={locale:"zh-cn",Pagination:{items_per_page:"\u6761/\u9875",jump_to:"\u8df3\u81f3",jump_to_confirm:"\u786e\u5b9a",page:"\u9875",prev_page:"\u4e0a\u4e00\u9875",next_page:"\u4e0b\u4e00\u9875",prev_5:"\u5411\u524d 5 \u9875",next_5:"\u5411\u540e 5 \u9875",prev_3:"\u5411\u524d 3 \u9875",next_3:"\u5411\u540e 3 \u9875",page_size:"\u9875\u7801"},DatePicker:{lang:{placeholder:"\u8bf7\u9009\u62e9\u65e5\u671f",yearPlaceholder:"\u8bf7\u9009\u62e9\u5e74\u4efd",quarterPlaceholder:"\u8bf7\u9009\u62e9\u5b63\u5ea6",monthPlaceholder:"\u8bf7\u9009\u62e9\u6708\u4efd",weekPlaceholder:"\u8bf7\u9009\u62e9\u5468",rangePlaceholder:["\u5f00\u59cb\u65e5\u671f","\u7ed3\u675f\u65e5\u671f"],rangeYearPlaceholder:["\u5f00\u59cb\u5e74\u4efd","\u7ed3\u675f\u5e74\u4efd"],rangeMonthPlaceholder:["\u5f00\u59cb\u6708\u4efd","\u7ed3\u675f\u6708\u4efd"],rangeWeekPlaceholder:["\u5f00\u59cb\u5468","\u7ed3\u675f\u5468"],locale:"zh_CN",today:"\u4eca\u5929",now:"\u6b64\u523b",backToToday:"\u8fd4\u56de\u4eca\u5929",ok:"\u786e\u5b9a",timeSelect:"\u9009\u62e9\u65f6\u95f4",dateSelect:"\u9009\u62e9\u65e5\u671f",weekSelect:"\u9009\u62e9\u5468",clear:"\u6e05\u9664",month:"\u6708",year:"\u5e74",previousMonth:"\u4e0a\u4e2a\u6708 (\u7ffb\u9875\u4e0a\u952e)",nextMonth:"\u4e0b\u4e2a\u6708 (\u7ffb\u9875\u4e0b\u952e)",monthSelect:"\u9009\u62e9\u6708\u4efd",yearSelect:"\u9009\u62e9\u5e74\u4efd",decadeSelect:"\u9009\u62e9\u5e74\u4ee3",yearFormat:"YYYY\u5e74",dayFormat:"D\u65e5",dateFormat:"YYYY\u5e74M\u6708D\u65e5",dateTimeFormat:"YYYY\u5e74M\u6708D\u65e5 HH\u65f6mm\u5206ss\u79d2",previousYear:"\u4e0a\u4e00\u5e74 (Control\u952e\u52a0\u5de6\u65b9\u5411\u952e)",nextYear:"\u4e0b\u4e00\u5e74 (Control\u952e\u52a0\u53f3\u65b9\u5411\u952e)",previousDecade:"\u4e0a\u4e00\u5e74\u4ee3",nextDecade:"\u4e0b\u4e00\u5e74\u4ee3",previousCentury:"\u4e0a\u4e00\u4e16\u7eaa",nextCentury:"\u4e0b\u4e00\u4e16\u7eaa"},timePickerLocale:{placeholder:"\u8bf7\u9009\u62e9\u65f6\u95f4",rangePlaceholder:["\u5f00\u59cb\u65f6\u95f4","\u7ed3\u675f\u65f6\u95f4"]}},TimePicker:{placeholder:"\u8bf7\u9009\u62e9\u65f6\u95f4",rangePlaceholder:["\u5f00\u59cb\u65f6\u95f4","\u7ed3\u675f\u65f6\u95f4"]},Calendar:{lang:{placeholder:"\u8bf7\u9009\u62e9\u65e5\u671f",yearPlaceholder:"\u8bf7\u9009\u62e9\u5e74\u4efd",quarterPlaceholder:"\u8bf7\u9009\u62e9\u5b63\u5ea6",monthPlaceholder:"\u8bf7\u9009\u62e9\u6708\u4efd",weekPlaceholder:"\u8bf7\u9009\u62e9\u5468",rangePlaceholder:["\u5f00\u59cb\u65e5\u671f","\u7ed3\u675f\u65e5\u671f"],rangeYearPlaceholder:["\u5f00\u59cb\u5e74\u4efd","\u7ed3\u675f\u5e74\u4efd"],rangeMonthPlaceholder:["\u5f00\u59cb\u6708\u4efd","\u7ed3\u675f\u6708\u4efd"],rangeWeekPlaceholder:["\u5f00\u59cb\u5468","\u7ed3\u675f\u5468"],locale:"zh_CN",today:"\u4eca\u5929",now:"\u6b64\u523b",backToToday:"\u8fd4\u56de\u4eca\u5929",ok:"\u786e\u5b9a",timeSelect:"\u9009\u62e9\u65f6\u95f4",dateSelect:"\u9009\u62e9\u65e5\u671f",weekSelect:"\u9009\u62e9\u5468",clear:"\u6e05\u9664",month:"\u6708",year:"\u5e74",previousMonth:"\u4e0a\u4e2a\u6708 (\u7ffb\u9875\u4e0a\u952e)",nextMonth:"\u4e0b\u4e2a\u6708 (\u7ffb\u9875\u4e0b\u952e)",monthSelect:"\u9009\u62e9\u6708\u4efd",yearSelect:"\u9009\u62e9\u5e74\u4efd",decadeSelect:"\u9009\u62e9\u5e74\u4ee3",yearFormat:"YYYY\u5e74",dayFormat:"D\u65e5",dateFormat:"YYYY\u5e74M\u6708D\u65e5",dateTimeFormat:"YYYY\u5e74M\u6708D\u65e5 HH\u65f6mm\u5206ss\u79d2",previousYear:"\u4e0a\u4e00\u5e74 (Control\u952e\u52a0\u5de6\u65b9\u5411\u952e)",nextYear:"\u4e0b\u4e00\u5e74 (Control\u952e\u52a0\u53f3\u65b9\u5411\u952e)",previousDecade:"\u4e0a\u4e00\u5e74\u4ee3",nextDecade:"\u4e0b\u4e00\u5e74\u4ee3",previousCentury:"\u4e0a\u4e00\u4e16\u7eaa",nextCentury:"\u4e0b\u4e00\u4e16\u7eaa"},timePickerLocale:{placeholder:"\u8bf7\u9009\u62e9\u65f6\u95f4",rangePlaceholder:["\u5f00\u59cb\u65f6\u95f4","\u7ed3\u675f\u65f6\u95f4"]}},global:{placeholder:"\u8bf7\u9009\u62e9"},Table:{filterTitle:"\u7b5b\u9009",filterConfirm:"\u786e\u5b9a",filterReset:"\u91cd\u7f6e",filterEmptyText:"\u65e0\u7b5b\u9009\u9879",selectAll:"\u5168\u9009\u5f53\u9875",selectInvert:"\u53cd\u9009\u5f53\u9875",selectionAll:"\u5168\u9009\u6240\u6709",sortTitle:"\u6392\u5e8f",expand:"\u5c55\u5f00\u884c",collapse:"\u5173\u95ed\u884c",triggerDesc:"\u70b9\u51fb\u964d\u5e8f",triggerAsc:"\u70b9\u51fb\u5347\u5e8f",cancelSort:"\u53d6\u6d88\u6392\u5e8f",filterCheckall:"\u5168\u9009",filterSearchPlaceholder:"\u5728\u7b5b\u9009\u9879\u4e2d\u641c\u7d22",selectNone:"\u6e05\u7a7a\u6240\u6709"},Modal:{okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",justOkText:"\u77e5\u9053\u4e86"},Popconfirm:{cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a"},Transfer:{searchPlaceholder:"\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9",itemUnit:"\u9879",itemsUnit:"\u9879",remove:"\u5220\u9664",selectCurrent:"\u5168\u9009\u5f53\u9875",removeCurrent:"\u5220\u9664\u5f53\u9875",selectAll:"\u5168\u9009\u6240\u6709",removeAll:"\u5220\u9664\u5168\u90e8",selectInvert:"\u53cd\u9009\u5f53\u9875"},Upload:{uploading:"\u6587\u4ef6\u4e0a\u4f20\u4e2d",removeFile:"\u5220\u9664\u6587\u4ef6",uploadError:"\u4e0a\u4f20\u9519\u8bef",previewFile:"\u9884\u89c8\u6587\u4ef6",downloadFile:"\u4e0b\u8f7d\u6587\u4ef6"},Empty:{description:"\u6682\u65e0\u6570\u636e"},Icon:{icon:"\u56fe\u6807"},Text:{edit:"\u7f16\u8f91",copy:"\u590d\u5236",copied:"\u590d\u5236\u6210\u529f",expand:"\u5c55\u5f00"},PageHeader:{back:"\u8fd4\u56de"},Image:{preview:"\u9884\u89c8"},CronExpression:{cronError:"cron \u8868\u8fbe\u5f0f\u4e0d\u5408\u6cd5",second:"\u79d2",minute:"\u5206\u949f",hour:"\u5c0f\u65f6",day:"\u65e5",month:"\u6708",week:"\u5468"},QRCode:{expired:"\u4e8c\u7ef4\u7801\u8fc7\u671f",refresh:"\u70b9\u51fb\u5237\u65b0"}};const ks=new M.nKC("nz-i18n"),xs=new M.nKC("nz-date-locale");let hs=(()=>{class Ue{get localeChange(){return this._change.asObservable()}constructor(ie,le){this._change=new C.t(this._locale),this.setLocale(ie||Lo),this.setDateLocale(le||null)}translate(ie,le){let W=this._getObjectPath(this._locale,ie);return"string"==typeof W?(le&&Object.keys(le).forEach(Ce=>W=W.replace(new RegExp(`%${Ce}%`,"g"),le[Ce])),W):ie}setLocale(ie){this._locale&&this._locale.locale===ie.locale||(this._locale=ie,this._change.next(ie))}getLocale(){return this._locale}getLocaleId(){return this._locale?this._locale.locale:""}setDateLocale(ie){this.dateLocale=ie}getDateLocale(){return this.dateLocale}getLocaleData(ie,le){const W=ie?this._getObjectPath(this._locale,ie):this._locale;return!W&&!le&&(0,de.R8)(`Missing translations for "${ie}" in language "${this._locale.locale}".\nYou can use "NzI18nService.setLocale" as a temporary fix.\nWelcome to submit a pull request to help us optimize the translations!\nhttps://github.com/NG-ZORRO/ng-zorro-antd/blob/master/CONTRIBUTING.md`),W||le||this._getObjectPath(Na,ie)||{}}_getObjectPath(ie,le){let W=ie;const Ce=le.split("."),xe=Ce.length;let ei=0;for(;W&&ei<xe;)W=W[Ce[ei++]];return ei===xe?W:null}static{this.\u0275fac=function(le){return new(le||Ue)(M.KVO(ks,8),M.KVO(xs,8))}}static{this.\u0275prov=M.jDH({token:Ue,factory:Ue.\u0275fac,providedIn:"root"})}}return Ue})(),Eo=(()=>{class Ue{constructor(ie){this._locale=ie}transform(ie,le){return this._locale.translate(ie,le)}static{this.\u0275fac=function(le){return new(le||Ue)(M.rXU(hs,16))}}static{this.\u0275pipe=M.EJ8({name:"nzI18n",type:Ue,pure:!0})}}return Ue})(),Kr=(()=>{class Ue{static{this.\u0275fac=function(le){return new(le||Ue)}}static{this.\u0275mod=M.$C({type:Ue})}static{this.\u0275inj=M.G2t({})}}return Ue})();const Bs=new M.nKC("date-config"),Aa={firstDayOfWeek:void 0};let Hs=(()=>{class Ue{constructor(ie,le){this.i18n=ie,this.config=function Va(Ue){return{...Aa,...Ue}}(le)}static{this.\u0275fac=function(le){return new(le||Ue)(M.KVO(hs),M.KVO(Bs,8))}}static{this.\u0275prov=M.jDH({token:Ue,factory:()=>function Js(){const Ue=(0,M.WQX)(hs),De=(0,M.WQX)(Bs,{optional:!0});return Ue.getDateLocale()?new ko(Ue,De):new Wo(Ue,De)}(),providedIn:"root"})}}return Ue})();class ko extends Hs{getISOWeek(De){return function at(Ue){(0,ve.A)(1,arguments);var De=(0,se.A)(Ue),ie=ee(De).getTime()-function he(Ue){(0,ve.A)(1,arguments);var De=function fe(Ue){(0,ve.A)(1,arguments);var De=(0,se.A)(Ue),ie=De.getFullYear(),le=new Date(0);le.setFullYear(ie+1,0,4),le.setHours(0,0,0,0);var W=ee(le),Ce=new Date(0);Ce.setFullYear(ie,0,4),Ce.setHours(0,0,0,0);var xe=ee(Ce);return De.getTime()>=W.getTime()?ie+1:De.getTime()>=xe.getTime()?ie:ie-1}(Ue),ie=new Date(0);return ie.setFullYear(De,0,4),ie.setHours(0,0,0,0),ee(ie)}(De).getTime();return Math.round(ie/6048e5)+1}(De)}getFirstDayOfWeek(){let De;try{De=this.i18n.getDateLocale().options.weekStartsOn}catch{De=1}return null==this.config.firstDayOfWeek?De:this.config.firstDayOfWeek}format(De,ie){return De?function ms(Ue,De,ie){var le,W,Ce,xe,ei,L,Me,X,pe,vt,Nt,tn,Xt,zi,pr,Pr,er,_r;(0,ve.A)(2,arguments);var rr=String(De),qr=(0,zt.q)(),Fr=null!==(le=null!==(W=ie?.locale)&&void 0!==W?W:qr.locale)&&void 0!==le?le:Jr,In=(0,$e.A)(null!==(Ce=null!==(xe=null!==(ei=null!==(L=ie?.firstWeekContainsDate)&&void 0!==L?L:null==ie||null===(Me=ie.locale)||void 0===Me||null===(X=Me.options)||void 0===X?void 0:X.firstWeekContainsDate)&&void 0!==ei?ei:qr.firstWeekContainsDate)&&void 0!==xe?xe:null===(pe=qr.locale)||void 0===pe||null===(vt=pe.options)||void 0===vt?void 0:vt.firstWeekContainsDate)&&void 0!==Ce?Ce:1);if(!(In>=1&&In<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var Ni=(0,$e.A)(null!==(Nt=null!==(tn=null!==(Xt=null!==(zi=ie?.weekStartsOn)&&void 0!==zi?zi:null==ie||null===(pr=ie.locale)||void 0===pr||null===(Pr=pr.options)||void 0===Pr?void 0:Pr.weekStartsOn)&&void 0!==Xt?Xt:qr.weekStartsOn)&&void 0!==tn?tn:null===(er=qr.locale)||void 0===er||null===(_r=er.options)||void 0===_r?void 0:_r.weekStartsOn)&&void 0!==Nt?Nt:0);if(!(Ni>=0&&Ni<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!Fr.localize)throw new RangeError("locale must contain localize property");if(!Fr.formatLong)throw new RangeError("locale must contain formatLong property");var Tr=(0,se.A)(Ue);if(!(0,mt.A)(Tr))throw new RangeError("Invalid time value");var ho=bt(Tr,(0,zn.A)(Tr)),ss={firstWeekContainsDate:In,weekStartsOn:Ni,locale:Fr,_originalDate:Tr},ba=rr.match(Lr).map(function(Nr){var _o=Nr[0];return"p"===_o||"P"===_o?(0,Yn[_o])(Nr,Fr.formatLong):Nr}).join("").match(eo).map(function(Nr){if("''"===Nr)return"'";var _o=Nr[0];if("'"===_o)return function as(Ue){var De=Ue.match(Ci);return De?De[1].replace(Do,"'"):Ue}(Nr);var Ds=Jt[_o];if(Ds)return!(null!=ie&&ie.useAdditionalWeekYearTokens)&&Si(Nr)&&Mi(Nr,De,String(Ue)),!(null!=ie&&ie.useAdditionalDayOfYearTokens)&&Gi(Nr)&&Mi(Nr,De,String(Ue)),Ds(ho,Nr,Fr.localize,ss);if(_o.match(Or))throw new RangeError("Format string contains an unescaped latin alphabet character `"+_o+"`");return Nr}).join("");return ba}(De,ie,{locale:this.i18n.getDateLocale()}):""}parseDate(De,ie){return function Za(Ue,De,ie,le){var W,Ce,xe,ei,L,Me,X,pe,vt,Nt,tn,Xt,zi,pr,Pr,er,_r,rr;(0,ve.A)(3,arguments);var qr=String(Ue),Fr=String(De),In=(0,zt.q)(),Ni=null!==(W=null!==(Ce=le?.locale)&&void 0!==Ce?Ce:In.locale)&&void 0!==W?W:Jr;if(!Ni.match)throw new RangeError("locale must contain match property");var Tr=(0,$e.A)(null!==(xe=null!==(ei=null!==(L=null!==(Me=le?.firstWeekContainsDate)&&void 0!==Me?Me:null==le||null===(X=le.locale)||void 0===X||null===(pe=X.options)||void 0===pe?void 0:pe.firstWeekContainsDate)&&void 0!==L?L:In.firstWeekContainsDate)&&void 0!==ei?ei:null===(vt=In.locale)||void 0===vt||null===(Nt=vt.options)||void 0===Nt?void 0:Nt.firstWeekContainsDate)&&void 0!==xe?xe:1);if(!(Tr>=1&&Tr<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var uo=(0,$e.A)(null!==(tn=null!==(Xt=null!==(zi=null!==(pr=le?.weekStartsOn)&&void 0!==pr?pr:null==le||null===(Pr=le.locale)||void 0===Pr||null===(er=Pr.options)||void 0===er?void 0:er.weekStartsOn)&&void 0!==zi?zi:In.weekStartsOn)&&void 0!==Xt?Xt:null===(_r=In.locale)||void 0===_r||null===(rr=_r.options)||void 0===rr?void 0:rr.weekStartsOn)&&void 0!==tn?tn:0);if(!(uo>=0&&uo<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===Fr)return""===qr?(0,se.A)(ie):new Date(NaN);var Ds,ho={firstWeekContainsDate:Tr,weekStartsOn:uo,locale:Ni},ss=[new ii],ba=Fr.match(Go).map(function(Fo){var wo=Fo[0];return wo in Yn?(0,Yn[wo])(Fo,Ni.formatLong):Fo}).join("").match(qa),Nr=[],_o=oo(ba);try{var Ir=function(){var wo=Ds.value;!(null!=le&&le.useAdditionalWeekYearTokens)&&Si(wo)&&Mi(wo,Fr,Ue),(null==le||!le.useAdditionalDayOfYearTokens)&&Gi(wo)&&Mi(wo,Fr,Ue);var Ss=wo[0],kr=ca[Ss];if(kr){var dc=kr.incompatibleTokens;if(Array.isArray(dc)){var xl=Nr.find(function(fc){return dc.includes(fc.token)||fc.token===Ss});if(xl)throw new RangeError("The format string mustn't contain `".concat(xl.fullToken,"` and `").concat(wo,"` at the same time"))}else if("*"===kr.incompatibleTokens&&Nr.length>0)throw new RangeError("The format string mustn't contain `".concat(wo,"` and any other token at the same time"));Nr.push({token:Ss,fullToken:wo});var No=kr.run(qr,wo,Ni.match,ho);if(!No)return{v:new Date(NaN)};ss.push(No.setter),qr=No.rest}else{if(Ss.match(Fa))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Ss+"`");if("''"===wo?wo="'":"'"===Ss&&(wo=function Xa(Ue){return Ue.match(rs)[1].replace(ya,"'")}(wo)),0!==qr.indexOf(wo))return{v:new Date(NaN)};qr=qr.slice(wo.length)}};for(_o.s();!(Ds=_o.n()).done;){var ll=Ir();if("object"===(0,fr.A)(ll))return ll.v}}catch(Fo){_o.e(Fo)}finally{_o.f()}if(qr.length>0&&br.test(qr))return new Date(NaN);var ic=ss.map(function(Fo){return Fo.priority}).sort(function(Fo,wo){return wo-Fo}).filter(function(Fo,wo,Ss){return Ss.indexOf(Fo)===wo}).map(function(Fo){return ss.filter(function(wo){return wo.priority===Fo}).sort(function(wo,Ss){return Ss.subPriority-wo.subPriority})}).map(function(Fo){return Fo[0]}),ka=(0,se.A)(ie);if(isNaN(ka.getTime()))return new Date(NaN);var ul,ao=bt(ka,(0,zn.A)(ka)),jl={},cl=oo(ic);try{for(cl.s();!(ul=cl.n()).done;){var Ua=ul.value;if(!Ua.validate(ao,ho))return new Date(NaN);var Yl=Ua.set(ao,jl,ho);Array.isArray(Yl)?(ao=Yl[0],so(jl,Yl[1])):ao=Yl}}catch(Fo){cl.e(Fo)}finally{cl.f()}return ao}(De,ie,new Date,{locale:this.i18n.getDateLocale(),weekStartsOn:this.getFirstDayOfWeek()})}parseTime(De,ie){return this.parseDate(De,ie)}}class Wo extends Hs{getISOWeek(De){return+this.format(De,"w")}getFirstDayOfWeek(){if(void 0===this.config.firstDayOfWeek){const De=this.i18n.getLocaleId();return De&&["zh-cn","zh-tw"].indexOf(De.toLowerCase())>-1?1:0}return this.config.firstDayOfWeek}format(De,ie){return De?(0,a.Yq)(De,ie,this.i18n.getLocaleId()):""}parseDate(De){return new Date(De)}parseTime(De,ie){return new Ts.Tb(ie,this.i18n.getLocaleId()).toDate(De)}}},8799:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Dn:()=>w,Y3:()=>T});var M=R(6860),C=R(4438),de=R(1635),a=R(1413),se=R(6648),Fe=R(6977);function ve(P){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(O){return typeof O}:function(O){return O&&"function"==typeof Symbol&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O})(P)}function he(P,O,k){return(O=function fe(P){var O=function ee(P,O){if("object"!=ve(P)||!P)return P;var k=P[Symbol.toPrimitive];if(void 0!==k){var j=k.call(P,O||"default");if("object"!=ve(j))return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===O?String:Number)(P)}(P,"string");return"symbol"==ve(O)?O:O+""}(O))in P?Object.defineProperty(P,O,{value:k,enumerable:!0,configurable:!0,writable:!0}):P[O]=k,P}const ge=Math.round;function at(P,O){const k=P.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],j=k.map(q=>parseFloat(q));for(let q=0;q<3;q+=1)j[q]=O(j[q]||0,k[q]||"",q);return j[3]=k[3]?k[3].includes("%")?j[3]/100:j[3]:1,j}const mt=(P,O,k)=>0===k?P:P/100;function $e(P,O){const k=O||255;return P>k?k:P<0?0:P}class ze{constructor(O){function k(j){return j[0]in O&&j[1]in O&&j[2]in O}if(he(this,"isValid",!0),he(this,"r",0),he(this,"g",0),he(this,"b",0),he(this,"a",1),he(this,"_h",void 0),he(this,"_s",void 0),he(this,"_l",void 0),he(this,"_v",void 0),he(this,"_max",void 0),he(this,"_min",void 0),he(this,"_brightness",void 0),O)if("string"==typeof O){let q=function(ue){return j.startsWith(ue)};const j=O.trim();/^#?[A-F\d]{3,8}$/i.test(j)?this.fromHexString(j):q("rgb")?this.fromRgbString(j):q("hsl")?this.fromHslString(j):(q("hsv")||q("hsb"))&&this.fromHsvString(j)}else if(O instanceof ze)this.r=O.r,this.g=O.g,this.b=O.b,this.a=O.a,this._h=O._h,this._s=O._s,this._l=O._l,this._v=O._v;else if(k("rgb"))this.r=$e(O.r),this.g=$e(O.g),this.b=$e(O.b),this.a="number"==typeof O.a?$e(O.a,1):1;else if(k("hsl"))this.fromHsl(O);else{if(!k("hsv"))throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(O));this.fromHsv(O)}}setR(O){return this._sc("r",O)}setG(O){return this._sc("g",O)}setB(O){return this._sc("b",O)}setA(O){return this._sc("a",O,1)}setHue(O){const k=this.toHsv();return k.h=O,this._c(k)}getLuminance(){function O(ue){const Be=ue/255;return Be<=.03928?Be/12.92:Math.pow((Be+.055)/1.055,2.4)}return.2126*O(this.r)+.7152*O(this.g)+.0722*O(this.b)}getHue(){if(typeof this._h>"u"){const O=this.getMax()-this.getMin();this._h=0===O?0:ge(60*(this.r===this.getMax()?(this.g-this.b)/O+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/O+2:(this.r-this.g)/O+4))}return this._h}getSaturation(){if(typeof this._s>"u"){const O=this.getMax()-this.getMin();this._s=0===O?0:O/this.getMax()}return this._s}getLightness(){return typeof this._l>"u"&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return typeof this._v>"u"&&(this._v=this.getMax()/255),this._v}getBrightness(){return typeof this._brightness>"u"&&(this._brightness=(299*this.r+587*this.g+114*this.b)/1e3),this._brightness}darken(O=10){const k=this.getHue(),j=this.getSaturation();let q=this.getLightness()-O/100;return q<0&&(q=0),this._c({h:k,s:j,l:q,a:this.a})}lighten(O=10){const k=this.getHue(),j=this.getSaturation();let q=this.getLightness()+O/100;return q>1&&(q=1),this._c({h:k,s:j,l:q,a:this.a})}mix(O,k=50){const j=this._c(O),q=k/100,ue=tt=>(j[tt]-this[tt])*q+this[tt],Be={r:ge(ue("r")),g:ge(ue("g")),b:ge(ue("b")),a:ge(100*ue("a"))/100};return this._c(Be)}tint(O=10){return this.mix({r:255,g:255,b:255,a:1},O)}shade(O=10){return this.mix({r:0,g:0,b:0,a:1},O)}onBackground(O){const k=this._c(O),j=this.a+k.a*(1-this.a),q=ue=>ge((this[ue]*this.a+k[ue]*k.a*(1-this.a))/j);return this._c({r:q("r"),g:q("g"),b:q("b"),a:j})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(O){return this.r===O.r&&this.g===O.g&&this.b===O.b&&this.a===O.a}clone(){return this._c(this)}toHexString(){let O="#";const k=(this.r||0).toString(16);O+=2===k.length?k:"0"+k;const j=(this.g||0).toString(16);O+=2===j.length?j:"0"+j;const q=(this.b||0).toString(16);if(O+=2===q.length?q:"0"+q,"number"==typeof this.a&&this.a>=0&&this.a<1){const ue=ge(255*this.a).toString(16);O+=2===ue.length?ue:"0"+ue}return O}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const O=this.getHue(),k=ge(100*this.getSaturation()),j=ge(100*this.getLightness());return 1!==this.a?`hsla(${O},${k}%,${j}%,${this.a})`:`hsl(${O},${k}%,${j}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return 1!==this.a?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(O,k,j){const q=this.clone();return q[O]=$e(k,j),q}_c(O){return new this.constructor(O)}getMax(){return typeof this._max>"u"&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return typeof this._min>"u"&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(O){const k=O.replace("#","");function j(q,ue){return parseInt(k[q]+k[ue||q],16)}k.length<6?(this.r=j(0),this.g=j(1),this.b=j(2),this.a=k[3]?j(3)/255:1):(this.r=j(0,1),this.g=j(2,3),this.b=j(4,5),this.a=k[6]?j(6,7)/255:1)}fromHsl({h:O,s:k,l:j,a:q}){if(this._h=O%360,this._s=k,this._l=j,this.a="number"==typeof q?q:1,k<=0){const Vt=ge(255*j);this.r=Vt,this.g=Vt,this.b=Vt}let ue=0,Be=0,tt=0;const _t=O/60,rt=(1-Math.abs(2*j-1))*k,Dt=rt*(1-Math.abs(_t%2-1));_t>=0&&_t<1?(ue=rt,Be=Dt):_t>=1&&_t<2?(ue=Dt,Be=rt):_t>=2&&_t<3?(Be=rt,tt=Dt):_t>=3&&_t<4?(Be=Dt,tt=rt):_t>=4&&_t<5?(ue=Dt,tt=rt):_t>=5&&_t<6&&(ue=rt,tt=Dt);const Rt=j-rt/2;this.r=ge(255*(ue+Rt)),this.g=ge(255*(Be+Rt)),this.b=ge(255*(tt+Rt))}fromHsv({h:O,s:k,v:j,a:q}){this._h=O%360,this._s=k,this._v=j,this.a="number"==typeof q?q:1;const ue=ge(255*j);if(this.r=ue,this.g=ue,this.b=ue,k<=0)return;const Be=O/60,tt=Math.floor(Be),_t=Be-tt,rt=ge(j*(1-k)*255),Dt=ge(j*(1-k*_t)*255),Rt=ge(j*(1-k*(1-_t))*255);switch(tt){case 0:this.g=Rt,this.b=rt;break;case 1:this.r=Dt,this.b=rt;break;case 2:this.r=rt,this.b=Rt;break;case 3:this.r=rt,this.g=Dt;break;case 4:this.r=Rt,this.g=rt;break;default:this.g=rt,this.b=Dt}}fromHsvString(O){const k=at(O,mt);this.fromHsv({h:k[0],s:k[1],v:k[2],a:k[3]})}fromHslString(O){const k=at(O,mt);this.fromHsl({h:k[0],s:k[1],l:k[2],a:k[3]})}fromRgbString(O){const k=at(O,(j,q)=>q.includes("%")?ge(j/100*255):j);this.r=k[0],this.g=k[1],this.b=k[2],this.a=k[3]}}var bt=2,xt=.16,Qt=.05,sn=.05,Yt=.15,Ut=5,et=4,It=[{index:7,amount:15},{index:6,amount:25},{index:5,amount:30},{index:5,amount:45},{index:5,amount:65},{index:5,amount:85},{index:4,amount:90},{index:3,amount:95},{index:2,amount:97},{index:1,amount:98}];function zt(P,O,k){var j;return(j=Math.round(P.h)>=60&&Math.round(P.h)<=240?k?Math.round(P.h)-bt*O:Math.round(P.h)+bt*O:k?Math.round(P.h)+bt*O:Math.round(P.h)-bt*O)<0?j+=360:j>=360&&(j-=360),j}function je(P,O,k){return 0===P.h&&0===P.s?P.s:((j=k?P.s-xt*O:O===et?P.s+xt:P.s+Qt*O)>1&&(j=1),k&&O===Ut&&j>.1&&(j=.1),j<.06&&(j=.06),Math.round(100*j)/100);var j}function At(P,O,k){var j;return j=k?P.v+sn*O:P.v-Yt*O,j=Math.max(0,Math.min(1,j)),Math.round(100*j)/100}var wn=["#fff1f0","#ffccc7","#ffa39e","#ff7875","#ff4d4f","#f5222d","#cf1322","#a8071a","#820014","#5c0011"];wn.primary=wn[5];var Rn=["#fff2e8","#ffd8bf","#ffbb96","#ff9c6e","#ff7a45","#fa541c","#d4380d","#ad2102","#871400","#610b00"];Rn.primary=Rn[5];var an=["#fff7e6","#ffe7ba","#ffd591","#ffc069","#ffa940","#fa8c16","#d46b08","#ad4e00","#873800","#612500"];an.primary=an[5];var Un=["#fffbe6","#fff1b8","#ffe58f","#ffd666","#ffc53d","#faad14","#d48806","#ad6800","#874d00","#613400"];Un.primary=Un[5];var nn=["#feffe6","#ffffb8","#fffb8f","#fff566","#ffec3d","#fadb14","#d4b106","#ad8b00","#876800","#614700"];nn.primary=nn[5];var di=["#fcffe6","#f4ffb8","#eaff8f","#d3f261","#bae637","#a0d911","#7cb305","#5b8c00","#3f6600","#254000"];di.primary=di[5];var Wn=["#f6ffed","#d9f7be","#b7eb8f","#95de64","#73d13d","#52c41a","#389e0d","#237804","#135200","#092b00"];Wn.primary=Wn[5];var $n=["#e6fffb","#b5f5ec","#87e8de","#5cdbd3","#36cfc9","#13c2c2","#08979c","#006d75","#00474f","#002329"];$n.primary=$n[5];var ki=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];ki.primary=ki[5];var Jt=["#f0f5ff","#d6e4ff","#adc6ff","#85a5ff","#597ef7","#2f54eb","#1d39c4","#10239e","#061178","#030852"];Jt.primary=Jt[5];var un=["#f9f0ff","#efdbff","#d3adf7","#b37feb","#9254de","#722ed1","#531dab","#391085","#22075e","#120338"];un.primary=un[5];var pn=["#fff0f6","#ffd6e7","#ffadd2","#ff85c0","#f759ab","#eb2f96","#c41d7f","#9e1068","#780650","#520339"];pn.primary=pn[5];var dn=["#a6a6a6","#999999","#8c8c8c","#808080","#737373","#666666","#404040","#1a1a1a","#000000","#000000"];dn.primary=dn[5];var zn=["#2a1215","#431418","#58181c","#791a1f","#a61d24","#d32029","#e84749","#f37370","#f89f9a","#fac8c3"];zn.primary=zn[5];var qn=["#2b1611","#441d12","#592716","#7c3118","#aa3e19","#d84a1b","#e87040","#f3956a","#f8b692","#fad4bc"];qn.primary=qn[5];var ar=["#2b1d11","#442a11","#593815","#7c4a15","#aa6215","#d87a16","#e89a3c","#f3b765","#f8cf8d","#fae3b7"];ar.primary=ar[5];var Gi=["#2b2111","#443111","#594214","#7c5914","#aa7714","#d89614","#e8b339","#f3cc62","#f8df8b","#faedb5"];Gi.primary=Gi[5];var Si=["#2b2611","#443b11","#595014","#7c6e14","#aa9514","#d8bd14","#e8d639","#f3ea62","#f8f48b","#fafab5"];Si.primary=Si[5];var Mi=["#1f2611","#2e3c10","#3e4f13","#536d13","#6f9412","#8bbb11","#a9d134","#c9e75d","#e4f88b","#f0fab5"];Mi.primary=Mi[5];var Br=["#162312","#1d3712","#274916","#306317","#3c8618","#49aa19","#6abe39","#8fd460","#b2e58b","#d5f2bb"];Br.primary=Br[5];var ji=["#112123","#113536","#144848","#146262","#138585","#13a8a8","#33bcb7","#58d1c9","#84e2d8","#b2f1e8"];ji.primary=ji[5];var Ln=["#111a2c","#112545","#15325b","#15417e","#1554ad","#1668dc","#3c89e8","#65a9f3","#8dc5f8","#b7dcfa"];Ln.primary=Ln[5];var Bt=["#131629","#161d40","#1c2755","#203175","#263ea0","#2b4acb","#5273e0","#7f9ef3","#a8c1f8","#d2e0fa"];Bt.primary=Bt[5];var jt=["#1a1325","#24163a","#301c4d","#3e2069","#51258f","#642ab5","#854eca","#ab7ae0","#cda8f0","#ebd7fa"];jt.primary=jt[5];var Dn=["#291321","#40162f","#551c3b","#75204f","#a02669","#cb2b83","#e0529c","#f37fb7","#f8a8cc","#fad2e3"];Dn.primary=Dn[5];var Ai=["#151515","#1f1f1f","#2d2d2d","#393939","#494949","#5a5a5a","#6a6a6a","#7b7b7b","#888888","#969696"];Ai.primary=Ai[5];var On=R(177),st=R(1626),Xe=R(7673),ye=R(1985),Ve=R(6354),gt=R(8141),wt=R(980),en=R(9437),hn=R(7647),si=R(5964),Hi=R(6697),ti=R(345);const bi="[@ant-design/icons-angular]:";function lt(P){(0,C.naY)()&&console.warn(`${bi} ${P}.`)}function Pe(P){return function Ze(P){for(var O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},k=[],j=new ze(P),q=j.toHsv(),ue=Ut;ue>0;ue-=1){var Be=new ze({h:zt(q,ue,!0),s:je(q,ue,!0),v:At(q,ue,!0)});k.push(Be)}k.push(j);for(var tt=1;tt<=et;tt+=1){var _t=new ze({h:zt(q,tt),s:je(q,tt),v:At(q,tt)});k.push(_t)}return"dark"===O.theme?It.map(function(rt){var Dt=rt.index,Rt=rt.amount;return new ze(O.backgroundColor||"#141414").mix(k[Dt],Rt).toHexString()}):k.map(function(rt){return rt.toHexString()})}(P)[0]}function Se(P,O){switch(O){case"fill":return`${P}-fill`;case"outline":return`${P}-o`;case"twotone":return`${P}-twotone`;case void 0:return P;default:throw new Error(`${bi}Theme "${O}" is not a recognized theme!`)}}function Et(P){return"object"==typeof P&&"string"==typeof P.name&&("string"==typeof P.theme||void 0===P.theme)&&"string"==typeof P.icon}function Y(P){const O=P.split(":");switch(O.length){case 1:return[P,""];case 2:return[O[1],O[0]];default:throw new Error(`${bi}The icon type ${P} is not valid!`)}}function Je(P){return new Error(`${bi}the icon ${P} does not exist or is not registered.`)}function ni(){return new Error(`${bi}<svg> tag not found.`)}const Cr=new C.nKC("ant_icons");let Jr=(()=>{class P{set twoToneColor({primaryColor:k,secondaryColor:j}){this._twoToneColorPalette.primaryColor=k,this._twoToneColorPalette.secondaryColor=j||Pe(k)}get twoToneColor(){return{...this._twoToneColorPalette}}get _disableDynamicLoading(){return!1}constructor(k,j,q,ue,Be){this._rendererFactory=k,this._handler=j,this._document=q,this.sanitizer=ue,this._antIcons=Be,this.defaultTheme="outline",this._svgDefinitions=new Map,this._svgRenderedDefinitions=new Map,this._inProgressFetches=new Map,this._assetsUrlRoot="",this._twoToneColorPalette={primaryColor:"#333333",secondaryColor:"#E6E6E6"},this._enableJsonpLoading=!1,this._jsonpIconLoad$=new a.B,this._renderer=this._rendererFactory.createRenderer(null,null),this._handler&&(this._http=new st.Qq(this._handler)),this._antIcons&&this.addIcon(...this._antIcons)}useJsonpLoading(){this._enableJsonpLoading?lt("You are already using jsonp loading."):(this._enableJsonpLoading=!0,window.__ant_icon_load=k=>{this._jsonpIconLoad$.next(k)})}changeAssetsSource(k){this._assetsUrlRoot=k.endsWith("/")?k:k+"/"}addIcon(...k){k.forEach(j=>{this._svgDefinitions.set(Se(j.name,j.theme),j)})}addIconLiteral(k,j){const[q,ue]=Y(k);if(!ue)throw function re(){return new Error(`${bi}Type should have a namespace. Try "namespace:${name}".`)}();this.addIcon({name:k,icon:j})}clear(){this._svgDefinitions.clear(),this._svgRenderedDefinitions.clear()}getRenderedContent(k,j){const q=Et(k)?k:this._svgDefinitions.get(k)||null;if(!q&&this._disableDynamicLoading)throw Je(k);return(q?(0,Xe.of)(q):this._loadIconDynamically(k)).pipe((0,Ve.T)(Be=>{if(!Be)throw Je(k);return this._loadSVGFromCacheOrCreateNew(Be,j)}))}getCachedIcons(){return this._svgDefinitions}_loadIconDynamically(k){if(!this._http&&!this._enableJsonpLoading)return(0,Xe.of)(function Pt(){return function gi(P){console.error(`${bi} ${P}.`)}('you need to import "HttpClientModule" to use dynamic importing.'),null}());let j=this._inProgressFetches.get(k);if(!j){const[q,ue]=Y(k),Be=ue?{name:k,icon:""}:function Ie(P){const O=P.split("-"),k=function Oe(P){return"o"===P?"outline":P}(O.splice(O.length-1,1)[0]);return{name:O.join("-"),theme:k,icon:""}}(q),_t=(ue?`${this._assetsUrlRoot}assets/${ue}/${q}`:`${this._assetsUrlRoot}assets/${Be.theme}/${Be.name}`)+(this._enableJsonpLoading?".js":".svg"),rt=this.sanitizer.sanitize(C.WPN.URL,_t);if(!rt)throw function Cn(P){return new Error(`${bi}The url "${P}" is unsafe.`)}(_t);j=(this._enableJsonpLoading?this._loadIconDynamicallyWithJsonp(Be,rt):this._http.get(rt,{responseType:"text"}).pipe((0,Ve.T)(Rt=>({...Be,icon:Rt})))).pipe((0,gt.M)(Rt=>this.addIcon(Rt)),(0,wt.j)(()=>this._inProgressFetches.delete(k)),(0,en.W)(()=>(0,Xe.of)(null)),(0,hn.u)()),this._inProgressFetches.set(k,j)}return j}_loadIconDynamicallyWithJsonp(k,j){return new ye.c(q=>{const ue=this._document.createElement("script"),Be=setTimeout(()=>{tt(),q.error(function xi(){return new Error(`${bi}Importing timeout error.`)}())},6e3);function tt(){ue.parentNode.removeChild(ue),clearTimeout(Be)}ue.src=j,this._document.body.appendChild(ue),this._jsonpIconLoad$.pipe((0,si.p)(_t=>_t.name===k.name&&_t.theme===k.theme),(0,Hi.s)(1)).subscribe(_t=>{q.next(_t),tt()})})}_loadSVGFromCacheOrCreateNew(k,j){let q;const ue=j||this._twoToneColorPalette.primaryColor,Be=Pe(ue)||this._twoToneColorPalette.secondaryColor,tt="twotone"===k.theme?function dt(P,O,k,j){return`${Se(P,O)}-${k}-${j}`}(k.name,k.theme,ue,Be):void 0===k.theme?k.name:Se(k.name,k.theme),_t=this._svgRenderedDefinitions.get(tt);return _t?q=_t.icon:(q=this._setSVGAttribute(this._colorizeSVGIcon(this._createSVGElementFromString(function _e(P){return""!==Y(P)[1]}(k.name)?k.icon:function Z(P){return P.replace(/['"]#333['"]/g,'"primaryColor"').replace(/['"]#E6E6E6['"]/g,'"secondaryColor"').replace(/['"]#D9D9D9['"]/g,'"secondaryColor"').replace(/['"]#D8D8D8['"]/g,'"secondaryColor"')}(k.icon)),"twotone"===k.theme,ue,Be)),this._svgRenderedDefinitions.set(tt,{...k,icon:q})),function ae(P){return P.cloneNode(!0)}(q)}_createSVGElementFromString(k){const j=this._document.createElement("div");j.innerHTML=k;const q=j.querySelector("svg");if(!q)throw ni;return q}_setSVGAttribute(k){return this._renderer.setAttribute(k,"width","1em"),this._renderer.setAttribute(k,"height","1em"),k}_colorizeSVGIcon(k,j,q,ue){if(j){const Be=k.childNodes,tt=Be.length;for(let _t=0;_t<tt;_t++){const rt=Be[_t];"secondaryColor"===rt.getAttribute("fill")?this._renderer.setAttribute(rt,"fill",ue):this._renderer.setAttribute(rt,"fill",q)}}return this._renderer.setAttribute(k,"fill","currentColor"),k}static{this.\u0275fac=function(j){return new(j||P)(C.KVO(C._9s),C.KVO(st.JV,8),C.KVO(On.qQ,8),C.KVO(ti.up),C.KVO(Cr,8))}}static{this.\u0275prov=C.jDH({token:P,factory:P.\u0275fac})}}return P})(),Lr=(()=>{class P{constructor(k,j,q){this._iconService=k,this._elementRef=j,this._renderer=q}ngOnChanges(k){(k.type||k.theme||k.twoToneColor)&&this._changeIcon()}_changeIcon(){return new Promise(k=>{if(!this.type)return this._clearSVGElement(),void k(null);const j=this._getSelfRenderMeta();this._iconService.getRenderedContent(this._parseIconType(this.type,this.theme),this.twoToneColor).subscribe(q=>{const ue=this._getSelfRenderMeta();!function eo(P,O){return P.type===O.type&&P.theme===O.theme&&P.twoToneColor===O.twoToneColor}(j,ue)?k(null):(this._setSVGElement(q),k(q))})})}_getSelfRenderMeta(){return{type:this.type,theme:this.theme,twoToneColor:this.twoToneColor}}_parseIconType(k,j){if(Et(k))return k;{const[q,ue]=Y(k);return ue?k:function Ke(P){return P.endsWith("-fill")||P.endsWith("-o")||P.endsWith("-twotone")}(q)?(j&&lt(`'type' ${q} already gets a theme inside so 'theme' ${j} would be ignored`),q):Se(q,j||this._iconService.defaultTheme)}}_setSVGElement(k){this._clearSVGElement(),this._renderer.appendChild(this._elementRef.nativeElement,k)}_clearSVGElement(){const k=this._elementRef.nativeElement,j=k.childNodes;for(let ue=j.length-1;ue>=0;ue--){const Be=j[ue];"svg"===Be.tagName?.toLowerCase()&&this._renderer.removeChild(k,Be)}}static{this.\u0275fac=function(j){return new(j||P)(C.rXU(Jr),C.rXU(C.aKT),C.rXU(C.sFG))}}static{this.\u0275dir=C.FsC({type:P,selectors:[["","antIcon",""]],inputs:{type:"type",theme:"theme",twoToneColor:"twoToneColor"},features:[C.OA$]})}}return P})();var Or=R(1265),ms=R(317);const su={name:"star",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z" /></svg>'};var i=R(6035);const e=[{name:"bars",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z" /></svg>'},{name:"calendar",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z" /></svg>'},{name:"caret-up",theme:"fill",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M858.9 689L530.5 308.2c-9.4-10.9-27.5-10.9-37 0L165.1 689c-12.2 14.2-1.2 35 18.5 35h656.8c19.7 0 30.7-20.8 18.5-35z" /></svg>'},{name:"caret-up",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M858.9 689L530.5 308.2c-9.4-10.9-27.5-10.9-37 0L165.1 689c-12.2 14.2-1.2 35 18.5 35h656.8c19.7 0 30.7-20.8 18.5-35z" /></svg>'},{name:"caret-down",theme:"fill",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z" /></svg>'},{name:"caret-down",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z" /></svg>'},{name:"check-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z" /></svg>'},{name:"check-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z" /><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /></svg>'},{name:"check",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z" /></svg>'},{name:"clock-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z" /></svg>'},{name:"close-circle",theme:"outline",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z" /></svg>'},{name:"close-circle",theme:"fill",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z" /></svg>'},{name:"close",theme:"outline",icon:'<svg fill-rule="evenodd" viewBox="64 64 896 896" focusable="false"><path d="M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z" /></svg>'},{name:"copy",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z" /></svg>'},{name:"delete",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z" /></svg>'},{name:"double-left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M272.9 512l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512zm304 0l265.4-339.1c4.1-5.2.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3a31.99 31.99 0 000 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z" /></svg>'},{name:"double-right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1A7.98 7.98 0 00188 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5zm304 0L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1A7.98 7.98 0 00492 864h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z" /></svg>'},{name:"down",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z" /></svg>'},{name:"edit",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z" /></svg>'},{name:"ellipsis",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z" /></svg>'},{name:"exclamation-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z" /></svg>'},{name:"exclamation-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z" /></svg>'},{name:"eye",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z" /></svg>'},{name:"file",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M854.6 288.7c6 6 9.4 14.1 9.4 22.6V928c0 17.7-14.3 32-32 32H192c-17.7 0-32-14.3-32-32V96c0-17.7 14.3-32 32-32h424.7c8.5 0 16.7 3.4 22.7 9.4l215.2 215.3zM790.2 326L602 137.8V326h188.2z" /></svg>'},{name:"file",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z" /></svg>'},{name:"filter",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M349 838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V642H349v196zm531.1-684H143.9c-24.5 0-39.8 26.7-27.5 48l221.3 376h348.8l221.3-376c12.1-21.3-3.2-48-27.7-48z" /></svg>'},{name:"info-circle",theme:"fill",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z" /></svg>'},{name:"info-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z" /></svg>'},{name:"left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z" /></svg>'},{name:"loading",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z" /></svg>'},{name:"paper-clip",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z" /></svg>'},{name:"question-circle",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" /><path d="M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z" /></svg>'},{name:"right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z" /></svg>'},{name:"rotate-right",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><defs><style /></defs><path d="M480.5 251.2c13-1.6 25.9-2.4 38.8-2.5v63.9c0 6.5 7.5 10.1 12.6 6.1L660 217.6c4-3.2 4-9.2 0-12.3l-128-101c-5.1-4-12.6-.4-12.6 6.1l-.2 64c-118.6.5-235.8 53.4-314.6 154.2A399.75 399.75 0 00123.5 631h74.9c-.9-5.3-1.7-10.7-2.4-16.1-5.1-42.1-2.1-84.1 8.9-124.8 11.4-42.2 31-81.1 58.1-115.8 27.2-34.7 60.3-63.2 98.4-84.3 37-20.6 76.9-33.6 119.1-38.8z" /><path d="M880 418H352c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H396V494h440v326z" /></svg>'},{name:"rotate-left",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><defs><style /></defs><path d="M672 418H144c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H188V494h440v326z" /><path d="M819.3 328.5c-78.8-100.7-196-153.6-314.6-154.2l-.2-64c0-6.5-7.6-10.1-12.6-6.1l-128 101c-4 3.1-3.9 9.1 0 12.3L492 318.6c5.1 4 12.7.4 12.6-6.1v-63.9c12.9.1 25.9.9 38.8 2.5 42.1 5.2 82.1 18.2 119 38.7 38.1 21.2 71.2 49.7 98.4 84.3 27.1 34.7 46.7 73.7 58.1 115.8a325.95 325.95 0 016.5 140.9h74.9c14.8-103.6-11.3-213-81-302.3z" /></svg>'},su,{name:"search",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z" /></svg>'},su,{name:"upload",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z" /></svg>'},{name:"vertical-align-top",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z" /></svg>'},{name:"up",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z" /></svg>'},{name:"swap-right",theme:"outline",icon:'<svg viewBox="0 0 1024 1024" focusable="false"><path d="M873.1 596.2l-164-208A32 32 0 00684 376h-64.8c-6.7 0-10.4 7.7-6.3 13l144.3 183H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h695.9c26.8 0 41.7-30.8 25.2-51.8z" /></svg>'},{name:"zoom-in",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z" /></svg>'},{name:"zoom-out",theme:"outline",icon:'<svg viewBox="64 64 896 896" focusable="false"><path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z" /></svg>'}],o=new C.nKC("nz_icons"),h=(new C.nKC("nz_icon_default_twotone_color"),"#1890ff");let p=(()=>{class P extends Jr{get _disableDynamicLoading(){return!this.platform.isBrowser}ngOnDestroy(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}normalizeSvgElement(k){k.getAttribute("viewBox")||this._renderer.setAttribute(k,"viewBox","0 0 1024 1024"),(!k.getAttribute("width")||!k.getAttribute("height"))&&(this._renderer.setAttribute(k,"width","1em"),this._renderer.setAttribute(k,"height","1em")),k.getAttribute("fill")||this._renderer.setAttribute(k,"fill","currentColor")}fetchFromIconfont(k){const{scriptUrl:j}=k;if(this._document&&!this.iconfontCache.has(j)){const q=this._renderer.createElement("script");this._renderer.setAttribute(q,"src",j),this._renderer.setAttribute(q,"data-namespace",j.replace(/^(https?|http):/g,"")),this._renderer.appendChild(this._document.body,q),this.iconfontCache.add(j)}}createIconfontIcon(k){return this._createSVGElementFromString(`<svg><use xlink:href="${k}"></svg>`)}constructor(k,j,q,ue,Be,tt,_t){super(k,Be,tt,j,[...e,..._t||[]]),this.nzConfigService=q,this.platform=ue,this.configUpdated$=new a.B,this.iconfontCache=new Set,this.subscription=null,this.onConfigChange(),this.configDefaultTwotoneColor(),this.configDefaultTheme()}onConfigChange(){this.subscription=this.nzConfigService.getConfigChangeEventForComponent("icon").subscribe(()=>{this.configDefaultTwotoneColor(),this.configDefaultTheme(),this.configUpdated$.next()})}configDefaultTheme(){const k=this.getConfig();this.defaultTheme=k.nzTheme||"outline"}configDefaultTwotoneColor(){const j=this.getConfig().nzTwotoneColor||h;let q=h;j&&(j.startsWith("#")?q=j:(0,Or.R8)("Twotone color must be a hex color!")),this.twoToneColor={primaryColor:q}}getConfig(){return this.nzConfigService.getConfigForComponent("icon")||{}}static{this.\u0275fac=function(j){return new(j||P)(C.KVO(C._9s),C.KVO(ti.up),C.KVO(i.yx),C.KVO(M.OD),C.KVO(st.JV,8),C.KVO(On.qQ,8),C.KVO(o,8))}}static{this.\u0275prov=C.jDH({token:P,factory:P.\u0275fac,providedIn:"root"})}}return P})();const g=new C.nKC("nz_icons_patch");let x=(()=>{class P{constructor(k,j){this.extraIcons=k,this.rootIconService=j,this.patched=!1}doPatch(){this.patched||(this.extraIcons.forEach(k=>this.rootIconService.addIcon(k)),this.patched=!0)}static{this.\u0275fac=function(j){return new(j||P)(C.KVO(g,2),C.KVO(p))}}static{this.\u0275prov=C.jDH({token:P,factory:P.\u0275fac})}}return P})(),w=(()=>{class P extends Lr{set nzSpin(k){this.spin=k}set nzType(k){this.type=k}set nzTheme(k){this.theme=k}set nzTwotoneColor(k){this.twoToneColor=k}set nzIconfont(k){this.iconfont=k}constructor(k,j,q,ue,Be,tt){super(ue,q,Be),this.ngZone=k,this.changeDetectorRef=j,this.iconService=ue,this.renderer=Be,this.cacheClassName=null,this.nzRotate=0,this.spin=!1,this.destroy$=new a.B,tt&&tt.doPatch(),this.el=q.nativeElement}ngOnChanges(k){const{nzType:j,nzTwotoneColor:q,nzSpin:ue,nzTheme:Be,nzRotate:tt}=k;j||q||ue||Be?this.changeIcon2():tt?this.handleRotate(this.el.firstChild):this._setSVGElement(this.iconService.createIconfontIcon(`#${this.iconfont}`))}ngOnInit(){this.renderer.setAttribute(this.el,"class",`anticon ${this.el.className}`.trim())}ngAfterContentChecked(){if(!this.type){const k=this.el.children;let j=k.length;if(!this.type&&k.length)for(;j--;){const q=k[j];"svg"===q.tagName.toLowerCase()&&this.iconService.normalizeSvgElement(q)}}}ngOnDestroy(){this.destroy$.next()}changeIcon2(){this.setClassName(),this.ngZone.runOutsideAngular(()=>{(0,se.H)(this._changeIcon()).pipe((0,Fe.Q)(this.destroy$)).subscribe({next:k=>{this.ngZone.run(()=>{this.changeDetectorRef.detectChanges(),k&&(this.setSVGData(k),this.handleSpin(k),this.handleRotate(k))})},error:Or.R8})})}handleSpin(k){this.spin||"loading"===this.type?this.renderer.addClass(k,"anticon-spin"):this.renderer.removeClass(k,"anticon-spin")}handleRotate(k){this.nzRotate?this.renderer.setAttribute(k,"style",`transform: rotate(${this.nzRotate}deg)`):this.renderer.removeAttribute(k,"style")}setClassName(){this.cacheClassName&&this.renderer.removeClass(this.el,this.cacheClassName),this.cacheClassName=`anticon-${this.type}`,this.renderer.addClass(this.el,this.cacheClassName)}setSVGData(k){this.renderer.setAttribute(k,"data-icon",this.type),this.renderer.setAttribute(k,"aria-hidden","true")}static{this.\u0275fac=function(j){return new(j||P)(C.rXU(C.SKi),C.rXU(C.gRc),C.rXU(C.aKT),C.rXU(p),C.rXU(C.sFG),C.rXU(x,8))}}static{this.\u0275dir=C.FsC({type:P,selectors:[["","nz-icon",""]],hostVars:2,hostBindings:function(j,q){2&j&&C.AVh("anticon",!0)},inputs:{nzSpin:"nzSpin",nzRotate:"nzRotate",nzType:"nzType",nzTheme:"nzTheme",nzTwotoneColor:"nzTwotoneColor",nzIconfont:"nzIconfont"},exportAs:["nzIcon"],features:[C.Vt3,C.OA$]})}}return(0,de.Cg)([(0,ms.H3)()],P.prototype,"nzSpin",null),P})(),T=(()=>{class P{static forRoot(k){return{ngModule:P,providers:[{provide:o,useValue:k}]}}static forChild(k){return{ngModule:P,providers:[x,{provide:g,useValue:k}]}}static{this.\u0275fac=function(j){return new(j||P)}}static{this.\u0275mod=C.$C({type:P})}static{this.\u0275inj=C.G2t({imports:[M.IK]})}}return P})()},7094:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Sg:()=>an,xh:()=>Un});var M=R(6939),C=R(4438),de=R(1413),a=R(5964),se=R(6697),Fe=R(6977),ve=R(6035),ee=R(317),fe=R(177),he=R(713),ge=R(8799),at=R(7806),mt=R(8203),$e=R(6969),ze=R(1025);function bt(nn,di){1&nn&&C.nrm(0,"span",10)}function xt(nn,di){1&nn&&C.nrm(0,"span",11)}function Qt(nn,di){1&nn&&C.nrm(0,"span",12)}function sn(nn,di){1&nn&&C.nrm(0,"span",13)}function Yt(nn,di){1&nn&&C.nrm(0,"span",14)}function Ut(nn,di){if(1&nn&&(C.qex(0),C.nrm(1,"span",15),C.bVm()),2&nn){const Wn=C.XpG();C.R7$(),C.Y8G("innerHTML",Wn.instance.content,C.npT)}}function et(nn,di){if(1&nn){const Wn=C.RV6();C.j41(0,"nz-message",2),C.bIt("destroyed",function(ki){C.eBV(Wn);const Jt=C.XpG();return C.Njj(Jt.remove(ki.id,ki.userAction))}),C.k0s()}2&nn&&C.Y8G("instance",di.$implicit)}let It=0;class zt{constructor(di,Wn,$n){this.nzSingletonService=di,this.overlay=Wn,this.injector=$n}remove(di){this.container&&(di?this.container.remove(di):this.container.removeAll())}getInstanceId(){return`${this.componentPrefix}-${It++}`}withContainer(di){let Wn=this.nzSingletonService.getSingletonWithKey(this.componentPrefix);if(Wn)return Wn;const $n=this.overlay.create({hasBackdrop:!1,scrollStrategy:this.overlay.scrollStrategies.noop(),positionStrategy:this.overlay.position().global()}),ki=new M.A8(di,null,this.injector),Jt=$n.attach(ki);return $n.hostElement.style.zIndex="1010",Wn||(this.container=Wn=Jt.instance,this.nzSingletonService.registerSingletonWithKey(this.componentPrefix,Wn),this.container.afterAllInstancesRemoved.subscribe(()=>{this.container=void 0,this.nzSingletonService.unregisterSingletonWithKey(this.componentPrefix),$n.dispose()})),Wn}}let je=(()=>{class nn{constructor(Wn,$n){this.cdr=Wn,this.nzConfigService=$n,this.instances=[],this._afterAllInstancesRemoved=new de.B,this.afterAllInstancesRemoved=this._afterAllInstancesRemoved.asObservable(),this.destroy$=new de.B,this.updateConfig()}ngOnInit(){this.subscribeConfigChange()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}create(Wn){const $n=this.onCreate(Wn);return this.instances.length>=this.config.nzMaxStack&&(this.instances=this.instances.slice(1)),this.instances=[...this.instances,$n],this.readyInstances(),$n}remove(Wn,$n=!1){this.instances.map((ki,Jt)=>({index:Jt,instance:ki})).filter(({instance:ki})=>ki.messageId===Wn).forEach(({index:ki,instance:Jt})=>{this.instances.splice(ki,1),this.instances=[...this.instances],this.onRemove(Jt,$n),this.readyInstances()}),this.instances.length||this.onAllInstancesRemoved()}removeAll(){this.instances.forEach(Wn=>this.onRemove(Wn,!1)),this.instances=[],this.readyInstances(),this.onAllInstancesRemoved()}onCreate(Wn){return Wn.options=this.mergeOptions(Wn.options),Wn.onClose=new de.B,Wn}onRemove(Wn,$n){Wn.onClose.next($n),Wn.onClose.complete()}onAllInstancesRemoved(){this._afterAllInstancesRemoved.next(),this._afterAllInstancesRemoved.complete()}readyInstances(){this.cdr.detectChanges()}mergeOptions(Wn){const{nzDuration:$n,nzAnimate:ki,nzPauseOnHover:Jt}=this.config;return{nzDuration:$n,nzAnimate:ki,nzPauseOnHover:Jt,...Wn}}static{this.\u0275fac=function($n){return new($n||nn)(C.rXU(C.gRc),C.rXU(ve.yx))}}static{this.\u0275dir=C.FsC({type:nn})}}return nn})(),At=(()=>{class nn{constructor(Wn){this.cdr=Wn,this.destroyed=new C.bkB,this.animationStateChanged=new de.B,this.userAction=!1,this.eraseTimer=null}ngOnInit(){this.options=this.instance.options,this.options.nzAnimate&&(this.instance.state="enter",this.animationStateChanged.pipe((0,a.p)(Wn=>"done"===Wn.phaseName&&"leave"===Wn.toState),(0,se.s)(1)).subscribe(()=>{clearTimeout(this.closeTimer),this.destroyed.next({id:this.instance.messageId,userAction:this.userAction})})),this.autoClose=this.options.nzDuration>0,this.autoClose&&(this.initErase(),this.startEraseTimeout())}ngOnDestroy(){this.autoClose&&this.clearEraseTimeout(),this.animationStateChanged.complete()}onEnter(){this.autoClose&&this.options.nzPauseOnHover&&(this.clearEraseTimeout(),this.updateTTL())}onLeave(){this.autoClose&&this.options.nzPauseOnHover&&this.startEraseTimeout()}destroy(Wn=!1){this.userAction=Wn,this.options.nzAnimate?(this.instance.state="leave",this.cdr.detectChanges(),this.closeTimer=setTimeout(()=>{this.closeTimer=void 0,this.destroyed.next({id:this.instance.messageId,userAction:Wn})},200)):this.destroyed.next({id:this.instance.messageId,userAction:Wn})}initErase(){this.eraseTTL=this.options.nzDuration,this.eraseTimingStart=Date.now()}updateTTL(){this.autoClose&&(this.eraseTTL-=Date.now()-this.eraseTimingStart)}startEraseTimeout(){this.eraseTTL>0?(this.clearEraseTimeout(),this.eraseTimer=setTimeout(()=>this.destroy(),this.eraseTTL),this.eraseTimingStart=Date.now()):this.destroy()}clearEraseTimeout(){null!==this.eraseTimer&&(clearTimeout(this.eraseTimer),this.eraseTimer=null)}static{this.\u0275fac=function($n){return new($n||nn)(C.rXU(C.gRc))}}static{this.\u0275dir=C.FsC({type:nn})}}return nn})(),Ze=(()=>{class nn extends At{constructor(Wn){super(Wn),this.destroyed=new C.bkB}static{this.\u0275fac=function($n){return new($n||nn)(C.rXU(C.gRc))}}static{this.\u0275cmp=C.VBU({type:nn,selectors:[["nz-message"]],inputs:{instance:"instance"},outputs:{destroyed:"destroyed"},exportAs:["nzMessage"],features:[C.Vt3],decls:10,vars:9,consts:[[1,"ant-message-notice",3,"mouseenter","mouseleave"],[1,"ant-message-notice-content"],[1,"ant-message-custom-content",3,"ngClass"],[3,"ngSwitch"],["nz-icon","","nzType","check-circle",4,"ngSwitchCase"],["nz-icon","","nzType","info-circle",4,"ngSwitchCase"],["nz-icon","","nzType","exclamation-circle",4,"ngSwitchCase"],["nz-icon","","nzType","close-circle",4,"ngSwitchCase"],["nz-icon","","nzType","loading",4,"ngSwitchCase"],[4,"nzStringTemplateOutlet"],["nz-icon","","nzType","check-circle"],["nz-icon","","nzType","info-circle"],["nz-icon","","nzType","exclamation-circle"],["nz-icon","","nzType","close-circle"],["nz-icon","","nzType","loading"],[3,"innerHTML"]],template:function($n,ki){1&$n&&(C.j41(0,"div",0),C.bIt("@moveUpMotion.done",function(un){return ki.animationStateChanged.next(un)})("mouseenter",function(){return ki.onEnter()})("mouseleave",function(){return ki.onLeave()}),C.j41(1,"div",1)(2,"div",2),C.qex(3,3),C.DNE(4,bt,1,0,"span",4)(5,xt,1,0,"span",5)(6,Qt,1,0,"span",6)(7,sn,1,0,"span",7)(8,Yt,1,0,"span",8),C.bVm(),C.DNE(9,Ut,2,1,"ng-container",9),C.k0s()()()),2&$n&&(C.Y8G("@moveUpMotion",ki.instance.state),C.R7$(2),C.Y8G("ngClass","ant-message-"+ki.instance.type),C.R7$(),C.Y8G("ngSwitch",ki.instance.type),C.R7$(),C.Y8G("ngSwitchCase","success"),C.R7$(),C.Y8G("ngSwitchCase","info"),C.R7$(),C.Y8G("ngSwitchCase","warning"),C.R7$(),C.Y8G("ngSwitchCase","error"),C.R7$(),C.Y8G("ngSwitchCase","loading"),C.R7$(),C.Y8G("nzStringTemplateOutlet",ki.instance.content))},dependencies:[fe.YU,fe.ux,fe.e1,ge.Dn,at.m],encapsulation:2,data:{animation:[he.j]},changeDetection:0})}}return nn})();const St="message",wn={nzAnimate:!0,nzDuration:3e3,nzMaxStack:7,nzPauseOnHover:!0,nzTop:24,nzDirection:"ltr"};let Rn=(()=>{class nn extends je{constructor(Wn,$n){super(Wn,$n),this.dir="ltr";const ki=this.nzConfigService.getConfigForComponent(St);this.dir=ki?.nzDirection||"ltr"}subscribeConfigChange(){this.nzConfigService.getConfigChangeEventForComponent(St).pipe((0,Fe.Q)(this.destroy$)).subscribe(()=>{this.updateConfig();const Wn=this.nzConfigService.getConfigForComponent(St);if(Wn){const{nzDirection:$n}=Wn;this.dir=$n||this.dir}})}updateConfig(){this.config={...wn,...this.config,...this.nzConfigService.getConfigForComponent(St)},this.top=(0,ee.j3)(this.config.nzTop),this.cdr.markForCheck()}static{this.\u0275fac=function($n){return new($n||nn)(C.rXU(C.gRc),C.rXU(ve.yx))}}static{this.\u0275cmp=C.VBU({type:nn,selectors:[["nz-message-container"]],exportAs:["nzMessageContainer"],features:[C.Vt3],decls:2,vars:5,consts:[[1,"ant-message"],[3,"instance","destroyed",4,"ngFor","ngForOf"],[3,"destroyed","instance"]],template:function($n,ki){1&$n&&(C.j41(0,"div",0),C.DNE(1,et,1,1,"nz-message",1),C.k0s()),2&$n&&(C.xc7("top",ki.top),C.AVh("ant-message-rtl","rtl"===ki.dir),C.R7$(),C.Y8G("ngForOf",ki.instances))},dependencies:[fe.Sq,Ze],encapsulation:2,changeDetection:0})}}return nn})(),an=(()=>{class nn{static{this.\u0275fac=function($n){return new($n||nn)}}static{this.\u0275mod=C.$C({type:nn})}static{this.\u0275inj=C.G2t({imports:[mt.jI,fe.MD,$e.z_,ge.Y3,at.C]})}}return nn})(),Un=(()=>{class nn extends zt{constructor(Wn,$n,ki){super(Wn,$n,ki),this.componentPrefix="message-"}success(Wn,$n){return this.createInstance({type:"success",content:Wn},$n)}error(Wn,$n){return this.createInstance({type:"error",content:Wn},$n)}info(Wn,$n){return this.createInstance({type:"info",content:Wn},$n)}warning(Wn,$n){return this.createInstance({type:"warning",content:Wn},$n)}loading(Wn,$n){return this.createInstance({type:"loading",content:Wn},$n)}create(Wn,$n,ki){return this.createInstance({type:Wn,content:$n},ki)}createInstance(Wn,$n){return this.container=this.withContainer(Rn),this.container.create({...Wn,createdAt:new Date,messageId:this.getInstanceId(),options:$n})}static{this.\u0275fac=function($n){return new($n||nn)(C.KVO(ze.HL),C.KVO($e.hJ),C.KVO(C.zZn))}}static{this.\u0275prov=C.jDH({token:nn,factory:nn.\u0275fac,providedIn:"root"})}}return nn})()},2096:(Nn,Ct,R)=>{"use strict";R.d(Ct,{J9:()=>Se,N_:()=>dt,U6:()=>ae,or:()=>ye});var M=R(467),C=R(6969),de=R(6939),a=R(4438),se=R(1413),Fe=R(3726),ve=R(9030),ee=R(6977),fe=R(5964),he=R(6697),ge=R(9172),at=R(1265),mt=R(317),$e=R(177),ze=R(9969),bt=R(4500),xt=R(8617),Qt=R(6035),sn=R(3341),Yt=R(7806),Ut=R(513),et=R(6389),It=R(5930),zt=R(8799),je=R(3384),At=R(7336),Ze=R(8203),St=R(6841);const wn=["nz-modal-close",""];function Rn(Y,_e){if(1&Y&&(a.qex(0),a.nrm(1,"span",2),a.bVm()),2&Y){const re=_e.$implicit;a.R7$(),a.Y8G("nzType",re)}}const an=["modalElement"];function Un(Y,_e){if(1&Y){const re=a.RV6();a.j41(0,"button",16),a.bIt("click",function(){a.eBV(re);const Pt=a.XpG();return a.Njj(Pt.onCloseClick())}),a.k0s()}}function nn(Y,_e){if(1&Y&&(a.qex(0),a.nrm(1,"span",17),a.bVm()),2&Y){const re=a.XpG();a.R7$(),a.Y8G("innerHTML",re.config.nzTitle,a.npT)}}function di(Y,_e){}function Wn(Y,_e){if(1&Y&&a.nrm(0,"div",17),2&Y){const re=a.XpG();a.Y8G("innerHTML",re.config.nzContent,a.npT)}}function $n(Y,_e){if(1&Y){const re=a.RV6();a.j41(0,"button",18),a.bIt("click",function(){a.eBV(re);const Pt=a.XpG();return a.Njj(Pt.onCancel())}),a.EFF(1),a.k0s()}if(2&Y){const re=a.XpG();a.Y8G("nzLoading",!!re.config.nzCancelLoading)("disabled",re.config.nzCancelDisabled),a.BMQ("cdkFocusInitial","cancel"===re.config.nzAutofocus||null),a.R7$(),a.SpI(" ",re.config.nzCancelText||re.locale.cancelText," ")}}function ki(Y,_e){if(1&Y){const re=a.RV6();a.j41(0,"button",19),a.bIt("click",function(){a.eBV(re);const Pt=a.XpG();return a.Njj(Pt.onOk())}),a.EFF(1),a.k0s()}if(2&Y){const re=a.XpG();a.Y8G("nzType",re.config.nzOkType)("nzLoading",!!re.config.nzOkLoading)("disabled",re.config.nzOkDisabled)("nzDanger",re.config.nzOkDanger),a.BMQ("cdkFocusInitial","ok"===re.config.nzAutofocus||null),a.R7$(),a.SpI(" ",re.config.nzOkText||re.locale.okText," ")}}const Jt=["nz-modal-footer",""],un=(Y,_e)=>({$implicit:Y,modalRef:_e});function pn(Y,_e){if(1&Y&&a.nrm(0,"div",5),2&Y){const re=a.XpG(3);a.Y8G("innerHTML",re.config.nzFooter,a.npT)}}function dn(Y,_e){if(1&Y){const re=a.RV6();a.j41(0,"button",7),a.bIt("click",function(){const Pt=a.eBV(re).$implicit,Cn=a.XpG(4);return a.Njj(Cn.onButtonClick(Pt))}),a.EFF(1),a.k0s()}if(2&Y){const re=_e.$implicit,Je=a.XpG(4);a.Y8G("hidden",!Je.getButtonCallableProp(re,"show"))("nzLoading",Je.getButtonCallableProp(re,"loading"))("disabled",Je.getButtonCallableProp(re,"disabled"))("nzType",re.type)("nzDanger",re.danger)("nzShape",re.shape)("nzSize",re.size)("nzGhost",re.ghost),a.R7$(),a.SpI(" ",re.label," ")}}function jn(Y,_e){if(1&Y&&(a.qex(0),a.DNE(1,dn,2,9,"button",6),a.bVm()),2&Y){const re=a.XpG(3);a.R7$(),a.Y8G("ngForOf",re.buttons)}}function Yn(Y,_e){if(1&Y&&(a.qex(0),a.DNE(1,pn,1,1,"div",3)(2,jn,2,1,"ng-container",4),a.bVm()),2&Y){const re=a.XpG(2);a.R7$(),a.Y8G("ngIf",!re.buttonsFooter),a.R7$(),a.Y8G("ngIf",re.buttonsFooter)}}function zn(Y,_e){if(1&Y&&(a.qex(0),a.DNE(1,Yn,3,2,"ng-container",2),a.bVm()),2&Y){const re=a.XpG();a.R7$(),a.Y8G("nzStringTemplateOutlet",re.config.nzFooter)("nzStringTemplateOutletContext",a.l_i(2,un,re.config.nzData,re.modalRef))}}function qn(Y,_e){if(1&Y){const re=a.RV6();a.j41(0,"button",10),a.bIt("click",function(){a.eBV(re);const Pt=a.XpG(2);return a.Njj(Pt.onCancel())}),a.EFF(1),a.k0s()}if(2&Y){const re=a.XpG(2);a.Y8G("nzLoading",!!re.config.nzCancelLoading)("disabled",re.config.nzCancelDisabled),a.BMQ("cdkFocusInitial","cancel"===re.config.nzAutofocus||null),a.R7$(),a.SpI(" ",re.config.nzCancelText||re.locale.cancelText," ")}}function ar(Y,_e){if(1&Y){const re=a.RV6();a.j41(0,"button",11),a.bIt("click",function(){a.eBV(re);const Pt=a.XpG(2);return a.Njj(Pt.onOk())}),a.EFF(1),a.k0s()}if(2&Y){const re=a.XpG(2);a.Y8G("nzType",re.config.nzOkType)("nzDanger",re.config.nzOkDanger)("nzLoading",!!re.config.nzOkLoading)("disabled",re.config.nzOkDisabled),a.BMQ("cdkFocusInitial","ok"===re.config.nzAutofocus||null),a.R7$(),a.SpI(" ",re.config.nzOkText||re.locale.okText," ")}}function Gi(Y,_e){if(1&Y&&a.DNE(0,qn,2,4,"button",8)(1,ar,2,6,"button",9),2&Y){const re=a.XpG();a.Y8G("ngIf",null!==re.config.nzCancelText),a.R7$(),a.Y8G("ngIf",null!==re.config.nzOkText)}}const Si=["nz-modal-title",""];function Mi(Y,_e){if(1&Y&&(a.qex(0),a.nrm(1,"div",2),a.bVm()),2&Y){const re=a.XpG();a.R7$(),a.Y8G("innerHTML",re.config.nzTitle,a.npT)}}function Br(Y,_e){if(1&Y){const re=a.RV6();a.j41(0,"button",9),a.bIt("click",function(){a.eBV(re);const Pt=a.XpG();return a.Njj(Pt.onCloseClick())}),a.k0s()}}function ji(Y,_e){1&Y&&a.nrm(0,"div",10)}function Ln(Y,_e){}function Bt(Y,_e){if(1&Y&&a.nrm(0,"div",11),2&Y){const re=a.XpG();a.Y8G("innerHTML",re.config.nzContent,a.npT)}}function jt(Y,_e){if(1&Y){const re=a.RV6();a.j41(0,"div",12),a.bIt("cancelTriggered",function(){a.eBV(re);const Pt=a.XpG();return a.Njj(Pt.onCloseClick())})("okTriggered",function(){a.eBV(re);const Pt=a.XpG();return a.Njj(Pt.onOkClick())}),a.k0s()}if(2&Y){const re=a.XpG();a.Y8G("modalRef",re.modalRef)}}const Dn=()=>{};class Ai{constructor(){this.nzCentered=!1,this.nzClosable=!0,this.nzOkLoading=!1,this.nzOkDisabled=!1,this.nzCancelDisabled=!1,this.nzCancelLoading=!1,this.nzNoAnimation=!1,this.nzAutofocus="auto",this.nzKeyboard=!0,this.nzZIndex=1e3,this.nzWidth=520,this.nzCloseIcon="close",this.nzOkType="primary",this.nzOkDanger=!1,this.nzModalType="default",this.nzOnCancel=Dn,this.nzOnOk=Dn,this.nzIconType="question-circle"}}const st="ant-modal-mask",Xe="modal",ye=new a.nKC("NZ_MODAL_DATA"),Ve={modalContainer:(0,ze.hZ)("modalContainer",[(0,ze.wk)("void, exit",(0,ze.iF)({})),(0,ze.wk)("enter",(0,ze.iF)({})),(0,ze.kY)("* => enter",(0,ze.i0)(".24s",(0,ze.iF)({}))),(0,ze.kY)("* => void, * => exit",(0,ze.i0)(".2s",(0,ze.iF)({})))])};function wt(Y,_e,re){return typeof Y>"u"?typeof _e>"u"?re:_e:Y}function hn(){throw Error("Attempting to attach modal content after content is already attached")}let si=(()=>{class Y extends de.lb{get showMask(){const re=this.nzConfigService.getConfigForComponent(Xe)||{};return!!wt(this.config.nzMask,re.nzMask,!0)}get maskClosable(){const re=this.nzConfigService.getConfigForComponent(Xe)||{};return!!wt(this.config.nzMaskClosable,re.nzMaskClosable,!0)}constructor(re,Je,Pt,Cn,ni,xi,sr,Cr,Jr,eo){super(),this.ngZone=re,this.host=Je,this.focusTrapFactory=Pt,this.cdr=Cn,this.render=ni,this.overlayRef=xi,this.nzConfigService=sr,this.config=Cr,this.animationType=eo,this.animationStateChanged=new a.bkB,this.containerClick=new a.bkB,this.cancelTriggered=new a.bkB,this.okTriggered=new a.bkB,this.state="enter",this.isStringContent=!1,this.dir="ltr",this.elementFocusedBeforeModalWasOpened=null,this.mouseDown=!1,this.oldMaskStyle=null,this.destroy$=new se.B,this.document=Jr,this.dir=xi.getDirection(),this.isStringContent="string"==typeof Cr.nzContent,this.nzConfigService.getConfigChangeEventForComponent(Xe).pipe((0,ee.Q)(this.destroy$)).subscribe(()=>{this.updateMaskClassname()})}onContainerClick(re){re.target===re.currentTarget&&!this.mouseDown&&this.showMask&&this.maskClosable&&this.containerClick.emit()}onCloseClick(){this.cancelTriggered.emit()}onOkClick(){this.okTriggered.emit()}attachComponentPortal(re){return this.portalOutlet.hasAttached()&&hn(),this.savePreviouslyFocusedElement(),this.setZIndexForBackdrop(),this.portalOutlet.attachComponentPortal(re)}attachTemplatePortal(re){return this.portalOutlet.hasAttached()&&hn(),this.savePreviouslyFocusedElement(),this.setZIndexForBackdrop(),this.portalOutlet.attachTemplatePortal(re)}attachStringContent(){this.savePreviouslyFocusedElement(),this.setZIndexForBackdrop()}getNativeElement(){return this.host.nativeElement}animationDisabled(){return this.config.nzNoAnimation||"NoopAnimations"===this.animationType}setModalTransformOrigin(){const re=this.modalElementRef.nativeElement;if(this.elementFocusedBeforeModalWasOpened){const Je=this.elementFocusedBeforeModalWasOpened.getBoundingClientRect(),Pt=(0,mt.Mk)(this.elementFocusedBeforeModalWasOpened);this.render.setStyle(re,"transform-origin",`${Pt.left+Je.width/2-re.offsetLeft}px ${Pt.top+Je.height/2-re.offsetTop}px 0px`)}}savePreviouslyFocusedElement(){this.focusTrap||(this.focusTrap=this.focusTrapFactory.create(this.host.nativeElement)),this.document&&(this.elementFocusedBeforeModalWasOpened=this.document.activeElement,this.host.nativeElement.focus&&this.ngZone.runOutsideAngular(()=>(0,bt.j)(()=>this.host.nativeElement.focus())))}trapFocus(){const re=this.host.nativeElement;if(this.config.nzAutofocus)this.focusTrap.focusInitialElementWhenReady();else{const Je=this.document.activeElement;Je!==re&&!re.contains(Je)&&re.focus()}}restoreFocus(){const re=this.elementFocusedBeforeModalWasOpened;if(re&&"function"==typeof re.focus){const Je=this.document.activeElement,Pt=this.host.nativeElement;(!Je||Je===this.document.body||Je===Pt||Pt.contains(Je))&&re.focus()}this.focusTrap&&this.focusTrap.destroy()}setEnterAnimationClass(){if(this.animationDisabled())return;this.setModalTransformOrigin();const re=this.modalElementRef.nativeElement,Je=this.overlayRef.backdropElement;re.classList.add("ant-zoom-enter"),re.classList.add("ant-zoom-enter-active"),Je&&(Je.classList.add("ant-fade-enter"),Je.classList.add("ant-fade-enter-active"))}setExitAnimationClass(){const re=this.modalElementRef.nativeElement;re.classList.add("ant-zoom-leave"),re.classList.add("ant-zoom-leave-active"),this.setMaskExitAnimationClass()}setMaskExitAnimationClass(re=!1){const Je=this.overlayRef.backdropElement;if(Je){if(this.animationDisabled()||re)return void Je.classList.remove(st);Je.classList.add("ant-fade-leave"),Je.classList.add("ant-fade-leave-active")}}cleanAnimationClass(){if(this.animationDisabled())return;const re=this.overlayRef.backdropElement,Je=this.modalElementRef.nativeElement;re&&(re.classList.remove("ant-fade-enter"),re.classList.remove("ant-fade-enter-active")),Je.classList.remove("ant-zoom-enter"),Je.classList.remove("ant-zoom-enter-active"),Je.classList.remove("ant-zoom-leave"),Je.classList.remove("ant-zoom-leave-active")}setZIndexForBackdrop(){const re=this.overlayRef.backdropElement;re&&(0,mt.n9)(this.config.nzZIndex)&&this.render.setStyle(re,"z-index",this.config.nzZIndex)}bindBackdropStyle(){const re=this.overlayRef.backdropElement;if(re&&(this.oldMaskStyle&&(Object.keys(this.oldMaskStyle).forEach(Pt=>{this.render.removeStyle(re,Pt)}),this.oldMaskStyle=null),this.setZIndexForBackdrop(),"object"==typeof this.config.nzMaskStyle&&Object.keys(this.config.nzMaskStyle).length)){const Je={...this.config.nzMaskStyle};Object.keys(Je).forEach(Pt=>{this.render.setStyle(re,Pt,Je[Pt])}),this.oldMaskStyle=Je}}updateMaskClassname(){const re=this.overlayRef.backdropElement;re&&(this.showMask?re.classList.add(st):re.classList.remove(st))}onAnimationDone(re){"enter"===re.toState?this.trapFocus():"exit"===re.toState&&this.restoreFocus(),this.cleanAnimationClass(),this.animationStateChanged.emit(re)}onAnimationStart(re){"enter"===re.toState?(this.setEnterAnimationClass(),this.bindBackdropStyle()):"exit"===re.toState&&this.setExitAnimationClass(),this.animationStateChanged.emit(re)}startExitAnimation(){this.state="exit",this.cdr.markForCheck()}ngOnDestroy(){this.setMaskExitAnimationClass(!0),this.destroy$.next(!0),this.destroy$.complete()}setupMouseListeners(re){this.ngZone.runOutsideAngular(()=>{(0,Fe.R)(this.host.nativeElement,"mouseup").pipe((0,ee.Q)(this.destroy$)).subscribe(()=>{this.mouseDown&&setTimeout(()=>{this.mouseDown=!1})}),(0,Fe.R)(re.nativeElement,"mousedown").pipe((0,ee.Q)(this.destroy$)).subscribe(()=>{this.mouseDown=!0})})}static{this.\u0275fac=function(Je){a.QTQ()}}static{this.\u0275dir=a.FsC({type:Y,features:[a.Vt3]})}}return Y})(),Hi=(()=>{class Y{constructor(re){this.config=re}static{this.\u0275fac=function(Je){return new(Je||Y)(a.rXU(Ai))}}static{this.\u0275cmp=a.VBU({type:Y,selectors:[["button","nz-modal-close",""]],hostAttrs:["aria-label","Close",1,"ant-modal-close"],exportAs:["NzModalCloseBuiltin"],attrs:wn,decls:2,vars:1,consts:[[1,"ant-modal-close-x"],[4,"nzStringTemplateOutlet"],["nz-icon","",1,"ant-modal-close-icon",3,"nzType"]],template:function(Je,Pt){1&Je&&(a.j41(0,"span",0),a.DNE(1,Rn,2,1,"ng-container",1),a.k0s()),2&Je&&(a.R7$(),a.Y8G("nzStringTemplateOutlet",Pt.config.nzCloseIcon))},dependencies:[Yt.m,et.c,zt.Dn],encapsulation:2,changeDetection:0})}}return Y})(),ti=(()=>{class Y extends si{constructor(re,Je,Pt,Cn,ni,xi,sr,Cr,Jr,eo,Lr){super(re,Pt,Cn,ni,xi,sr,Cr,Jr,eo,Lr),this.i18n=Je,this.config=Jr,this.cancelTriggered=new a.bkB,this.okTriggered=new a.bkB,this.i18n.localeChange.pipe((0,ee.Q)(this.destroy$)).subscribe(()=>{this.locale=this.i18n.getLocaleData("Modal")})}ngOnInit(){this.setupMouseListeners(this.modalElementRef)}onCancel(){this.cancelTriggered.emit()}onOk(){this.okTriggered.emit()}static{this.\u0275fac=function(Je){return new(Je||Y)(a.rXU(a.SKi),a.rXU(sn.Og),a.rXU(a.aKT),a.rXU(xt.GX),a.rXU(a.gRc),a.rXU(a.sFG),a.rXU(C.yY),a.rXU(Qt.yx),a.rXU(Ai),a.rXU($e.qQ,8),a.rXU(a.bc$,8))}}static{this.\u0275cmp=a.VBU({type:Y,selectors:[["nz-modal-confirm-container"]],viewQuery:function(Je,Pt){if(1&Je&&(a.GBs(de.I3,7),a.GBs(an,7)),2&Je){let Cn;a.mGM(Cn=a.lsd())&&(Pt.portalOutlet=Cn.first),a.mGM(Cn=a.lsd())&&(Pt.modalElementRef=Cn.first)}},hostAttrs:["tabindex","-1","role","dialog"],hostVars:10,hostBindings:function(Je,Pt){1&Je&&(a.Kam("@modalContainer.start",function(ni){return Pt.onAnimationStart(ni)})("@modalContainer.done",function(ni){return Pt.onAnimationDone(ni)}),a.bIt("click",function(ni){return Pt.onContainerClick(ni)})),2&Je&&(a.zvX("@.disabled",Pt.config.nzNoAnimation)("@modalContainer",Pt.state),a.HbH(Pt.config.nzWrapClassName?"ant-modal-wrap "+Pt.config.nzWrapClassName:"ant-modal-wrap"),a.xc7("z-index",Pt.config.nzZIndex),a.AVh("ant-modal-wrap-rtl","rtl"===Pt.dir)("ant-modal-centered",Pt.config.nzCentered))},outputs:{cancelTriggered:"cancelTriggered",okTriggered:"okTriggered"},exportAs:["nzModalConfirmContainer"],features:[a.Vt3],decls:17,vars:13,consts:[["modalElement",""],["role","document",1,"ant-modal",3,"ngClass","ngStyle"],[1,"ant-modal-content"],["nz-modal-close","",3,"click",4,"ngIf"],[1,"ant-modal-body",3,"ngStyle"],[1,"ant-modal-confirm-body-wrapper"],[1,"ant-modal-confirm-body"],["nz-icon","",3,"nzType"],[1,"ant-modal-confirm-title"],[4,"nzStringTemplateOutlet"],[1,"ant-modal-confirm-content"],["cdkPortalOutlet",""],[3,"innerHTML",4,"ngIf"],[1,"ant-modal-confirm-btns"],["nz-button","",3,"nzLoading","disabled","click",4,"ngIf"],["nz-button","",3,"nzType","nzLoading","disabled","nzDanger","click",4,"ngIf"],["nz-modal-close","",3,"click"],[3,"innerHTML"],["nz-button","",3,"click","nzLoading","disabled"],["nz-button","",3,"click","nzType","nzLoading","disabled","nzDanger"]],template:function(Je,Pt){1&Je&&(a.j41(0,"div",1,0),a.nI1(2,"nzToCssUnit"),a.j41(3,"div",2),a.DNE(4,Un,1,0,"button",3),a.j41(5,"div",4)(6,"div",5)(7,"div",6),a.nrm(8,"span",7),a.j41(9,"span",8),a.DNE(10,nn,2,1,"ng-container",9),a.k0s(),a.j41(11,"div",10),a.DNE(12,di,0,0,"ng-template",11)(13,Wn,1,1,"div",12),a.k0s()(),a.j41(14,"div",13),a.DNE(15,$n,2,4,"button",14)(16,ki,2,6,"button",15),a.k0s()()()()()),2&Je&&(a.xc7("width",a.bMT(2,11,null==Pt.config?null:Pt.config.nzWidth)),a.Y8G("ngClass",Pt.config.nzClassName)("ngStyle",Pt.config.nzStyle),a.R7$(4),a.Y8G("ngIf",Pt.config.nzClosable),a.R7$(),a.Y8G("ngStyle",Pt.config.nzBodyStyle),a.R7$(3),a.Y8G("nzType",Pt.config.nzIconType),a.R7$(2),a.Y8G("nzStringTemplateOutlet",Pt.config.nzTitle),a.R7$(3),a.Y8G("ngIf",Pt.isStringContent),a.R7$(2),a.Y8G("ngIf",null!==Pt.config.nzCancelText),a.R7$(),a.Y8G("ngIf",null!==Pt.config.nzOkText))},dependencies:[$e.YU,$e.bT,$e.B3,Yt.m,de.I3,Ut.aO,et.c,It.p,zt.Dn,Hi,je.Zu],encapsulation:2,data:{animation:[Ve.modalContainer]}})}}return Y})(),bi=(()=>{class Y{constructor(re,Je){this.i18n=re,this.config=Je,this.buttonsFooter=!1,this.buttons=[],this.cancelTriggered=new a.bkB,this.okTriggered=new a.bkB,this.destroy$=new se.B,Array.isArray(Je.nzFooter)&&(this.buttonsFooter=!0,this.buttons=Je.nzFooter.map(gi)),this.i18n.localeChange.pipe((0,ee.Q)(this.destroy$)).subscribe(()=>{this.locale=this.i18n.getLocaleData("Modal")})}onCancel(){this.cancelTriggered.emit()}onOk(){this.okTriggered.emit()}getButtonCallableProp(re,Je){const Pt=re[Je],Cn=this.modalRef.getContentComponent();return"function"==typeof Pt?Pt.apply(re,Cn&&[Cn]):Pt}onButtonClick(re){if(!this.getButtonCallableProp(re,"loading")){const Pt=this.getButtonCallableProp(re,"onClick");re.autoLoading&&(0,mt.yL)(Pt)&&(re.loading=!0,Pt.then(()=>re.loading=!1).catch(Cn=>{throw re.loading=!1,Cn}))}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(Je){return new(Je||Y)(a.rXU(sn.Og),a.rXU(Ai))}}static{this.\u0275cmp=a.VBU({type:Y,selectors:[["div","nz-modal-footer",""]],hostAttrs:[1,"ant-modal-footer"],inputs:{modalRef:"modalRef"},outputs:{cancelTriggered:"cancelTriggered",okTriggered:"okTriggered"},exportAs:["NzModalFooterBuiltin"],attrs:Jt,decls:3,vars:2,consts:[["defaultFooterButtons",""],[4,"ngIf","ngIfElse"],[4,"nzStringTemplateOutlet","nzStringTemplateOutletContext"],[3,"innerHTML",4,"ngIf"],[4,"ngIf"],[3,"innerHTML"],["nz-button","",3,"hidden","nzLoading","disabled","nzType","nzDanger","nzShape","nzSize","nzGhost","click",4,"ngFor","ngForOf"],["nz-button","",3,"click","hidden","nzLoading","disabled","nzType","nzDanger","nzShape","nzSize","nzGhost"],["nz-button","",3,"nzLoading","disabled","click",4,"ngIf"],["nz-button","",3,"nzType","nzDanger","nzLoading","disabled","click",4,"ngIf"],["nz-button","",3,"click","nzLoading","disabled"],["nz-button","",3,"click","nzType","nzDanger","nzLoading","disabled"]],template:function(Je,Pt){if(1&Je&&a.DNE(0,zn,2,5,"ng-container",1)(1,Gi,2,2,"ng-template",null,0,a.C5r),2&Je){const Cn=a.sdS(2);a.Y8G("ngIf",Pt.config.nzFooter)("ngIfElse",Cn)}},dependencies:[$e.Sq,$e.bT,Yt.m,Ut.aO,et.c,It.p],encapsulation:2})}}return Y})();function gi(Y){return{type:null,size:"default",autoLoading:!0,show:!0,loading:!1,disabled:!1,...Y}}let lt=(()=>{class Y{constructor(re){this.config=re}static{this.\u0275fac=function(Je){return new(Je||Y)(a.rXU(Ai))}}static{this.\u0275cmp=a.VBU({type:Y,selectors:[["div","nz-modal-title",""]],hostAttrs:[1,"ant-modal-header"],exportAs:["NzModalTitleBuiltin"],attrs:Si,decls:2,vars:1,consts:[[1,"ant-modal-title"],[4,"nzStringTemplateOutlet"],[3,"innerHTML"]],template:function(Je,Pt){1&Je&&(a.j41(0,"div",0),a.DNE(1,Mi,2,1,"ng-container",1),a.k0s()),2&Je&&(a.R7$(),a.Y8G("nzStringTemplateOutlet",Pt.config.nzTitle))},dependencies:[Yt.m],encapsulation:2,changeDetection:0})}}return Y})(),Pe=(()=>{class Y extends si{constructor(re,Je,Pt,Cn,ni,xi,sr,Cr,Jr,eo){super(re,Je,Pt,Cn,ni,xi,sr,Cr,Jr,eo),this.config=Cr}ngOnInit(){this.setupMouseListeners(this.modalElementRef)}static{this.\u0275fac=function(Je){return new(Je||Y)(a.rXU(a.SKi),a.rXU(a.aKT),a.rXU(xt.GX),a.rXU(a.gRc),a.rXU(a.sFG),a.rXU(C.yY),a.rXU(Qt.yx),a.rXU(Ai),a.rXU($e.qQ,8),a.rXU(a.bc$,8))}}static{this.\u0275cmp=a.VBU({type:Y,selectors:[["nz-modal-container"]],viewQuery:function(Je,Pt){if(1&Je&&(a.GBs(de.I3,7),a.GBs(an,7)),2&Je){let Cn;a.mGM(Cn=a.lsd())&&(Pt.portalOutlet=Cn.first),a.mGM(Cn=a.lsd())&&(Pt.modalElementRef=Cn.first)}},hostAttrs:["tabindex","-1","role","dialog"],hostVars:10,hostBindings:function(Je,Pt){1&Je&&(a.Kam("@modalContainer.start",function(ni){return Pt.onAnimationStart(ni)})("@modalContainer.done",function(ni){return Pt.onAnimationDone(ni)}),a.bIt("click",function(ni){return Pt.onContainerClick(ni)})),2&Je&&(a.zvX("@.disabled",Pt.config.nzNoAnimation)("@modalContainer",Pt.state),a.HbH(Pt.config.nzWrapClassName?"ant-modal-wrap "+Pt.config.nzWrapClassName:"ant-modal-wrap"),a.xc7("z-index",Pt.config.nzZIndex),a.AVh("ant-modal-wrap-rtl","rtl"===Pt.dir)("ant-modal-centered",Pt.config.nzCentered))},exportAs:["nzModalContainer"],features:[a.Vt3],decls:10,vars:11,consts:[["modalElement",""],["role","document",1,"ant-modal",3,"ngClass","ngStyle"],[1,"ant-modal-content"],["nz-modal-close","",3,"click",4,"ngIf"],["nz-modal-title","",4,"ngIf"],[1,"ant-modal-body",3,"ngStyle"],["cdkPortalOutlet",""],[3,"innerHTML",4,"ngIf"],["nz-modal-footer","",3,"modalRef","cancelTriggered","okTriggered",4,"ngIf"],["nz-modal-close","",3,"click"],["nz-modal-title",""],[3,"innerHTML"],["nz-modal-footer","",3,"cancelTriggered","okTriggered","modalRef"]],template:function(Je,Pt){1&Je&&(a.j41(0,"div",1,0),a.nI1(2,"nzToCssUnit"),a.j41(3,"div",2),a.DNE(4,Br,1,0,"button",3)(5,ji,1,0,"div",4),a.j41(6,"div",5),a.DNE(7,Ln,0,0,"ng-template",6)(8,Bt,1,1,"div",7),a.k0s(),a.DNE(9,jt,1,1,"div",8),a.k0s()()),2&Je&&(a.xc7("width",a.bMT(2,9,null==Pt.config?null:Pt.config.nzWidth)),a.Y8G("ngClass",Pt.config.nzClassName)("ngStyle",Pt.config.nzStyle),a.R7$(4),a.Y8G("ngIf",Pt.config.nzClosable),a.R7$(),a.Y8G("ngIf",Pt.config.nzTitle),a.R7$(),a.Y8G("ngStyle",Pt.config.nzBodyStyle),a.R7$(2),a.Y8G("ngIf",Pt.isStringContent),a.R7$(),a.Y8G("ngIf",null!==Pt.config.nzFooter))},dependencies:[$e.YU,$e.bT,$e.B3,de.I3,Hi,bi,lt,je.Zu],encapsulation:2,data:{animation:[Ve.modalContainer]}})}}return Y})();class Se{constructor(_e,re,Je){this.overlayRef=_e,this.config=re,this.containerInstance=Je,this.componentInstance=null,this.state=0,this.afterClose=new se.B,this.afterOpen=new se.B,this.destroy$=new se.B,Je.animationStateChanged.pipe((0,fe.p)(Pt=>"done"===Pt.phaseName&&"enter"===Pt.toState),(0,he.s)(1)).subscribe(()=>{this.afterOpen.next(),this.afterOpen.complete(),re.nzAfterOpen instanceof a.bkB&&re.nzAfterOpen.emit()}),Je.animationStateChanged.pipe((0,fe.p)(Pt=>"done"===Pt.phaseName&&"exit"===Pt.toState),(0,he.s)(1)).subscribe(()=>{clearTimeout(this.closeTimeout),this._finishDialogClose()}),Je.containerClick.pipe((0,he.s)(1),(0,ee.Q)(this.destroy$)).subscribe(()=>{!this.config.nzCancelLoading&&!this.config.nzOkLoading&&this.trigger("cancel")}),_e.keydownEvents().pipe((0,fe.p)(Pt=>this.config.nzKeyboard&&!this.config.nzCancelLoading&&!this.config.nzOkLoading&&Pt.keyCode===At._f&&!(0,At.rp)(Pt))).subscribe(Pt=>{Pt.preventDefault(),this.trigger("cancel")}),Je.cancelTriggered.pipe((0,ee.Q)(this.destroy$)).subscribe(()=>this.trigger("cancel")),Je.okTriggered.pipe((0,ee.Q)(this.destroy$)).subscribe(()=>this.trigger("ok")),_e.detachments().subscribe(()=>{this.afterClose.next(this.result),this.afterClose.complete(),re.nzAfterClose instanceof a.bkB&&re.nzAfterClose.emit(this.result),this.componentInstance=null,this.overlayRef.dispose()})}getContentComponent(){return this.componentInstance}getElement(){return this.containerInstance.getNativeElement()}destroy(_e){this.close(_e)}triggerOk(){return this.trigger("ok")}triggerCancel(){return this.trigger("cancel")}close(_e){0===this.state&&(this.result=_e,this.containerInstance.animationStateChanged.pipe((0,fe.p)(re=>"start"===re.phaseName),(0,he.s)(1)).subscribe(re=>{this.overlayRef.detachBackdrop(),this.closeTimeout=setTimeout(()=>{this._finishDialogClose()},re.totalTime+100)}),this.containerInstance.startExitAnimation(),this.state=1)}updateConfig(_e){Object.assign(this.config,_e),this.containerInstance.bindBackdropStyle(),this.containerInstance.cdr.markForCheck()}getState(){return this.state}getConfig(){return this.config}getBackdropElement(){return this.overlayRef.backdropElement}trigger(_e){var re=this;return(0,M.A)(function*(){if(1===re.state)return;const Je={ok:re.config.nzOnOk,cancel:re.config.nzOnCancel}[_e],Pt={ok:"nzOkLoading",cancel:"nzCancelLoading"}[_e];if(!re.config[Pt])if(Je instanceof a.bkB)Je.emit(re.getContentComponent());else if("function"==typeof Je){const ni=Je(re.getContentComponent());if((0,mt.yL)(ni)){re.config[Pt]=!0;let xi=!1;try{xi=yield ni}finally{re.config[Pt]=!1,re.closeWhitResult(xi)}}else re.closeWhitResult(ni)}})()}closeWhitResult(_e){!1!==_e&&this.close(_e)}_finishDialogClose(){this.state=2,this.overlayRef.dispose(),this.destroy$.next()}}let dt=(()=>{class Y{get openModals(){return this.parentModal?this.parentModal.openModals:this.openModalsAtThisLevel}get _afterAllClosed(){const re=this.parentModal;return re?re._afterAllClosed:this.afterAllClosedAtThisLevel}constructor(re,Je,Pt,Cn,ni){this.overlay=re,this.injector=Je,this.nzConfigService=Pt,this.parentModal=Cn,this.directionality=ni,this.openModalsAtThisLevel=[],this.afterAllClosedAtThisLevel=new se.B,this.afterAllClose=(0,ve.v)(()=>this.openModals.length?this._afterAllClosed:this._afterAllClosed.pipe((0,ge.Z)(void 0)))}create(re){return this.open(re.nzContent,re)}closeAll(){this.closeModals(this.openModals)}confirm(re={},Je="confirm"){return"nzFooter"in re&&(0,at.R8)('The Confirm-Modal doesn\'t support "nzFooter", this property will be ignored.'),"nzWidth"in re||(re.nzWidth=416),"nzMaskClosable"in re||(re.nzMaskClosable=!1),re.nzModalType="confirm",re.nzClassName=`ant-modal-confirm ant-modal-confirm-${Je} ${re.nzClassName||""}`,this.create(re)}info(re={}){return this.confirmFactory(re,"info")}success(re={}){return this.confirmFactory(re,"success")}error(re={}){return this.confirmFactory(re,"error")}warning(re={}){return this.confirmFactory(re,"warning")}open(re,Je){const Pt=function gt(Y,_e){return{..._e,...Y}}(Je||{},new Ai),Cn=this.createOverlay(Pt),ni=this.attachModalContainer(Cn,Pt),xi=this.attachModalContent(re,ni,Cn,Pt);return ni.modalRef=xi,this.openModals.push(xi),xi.afterClose.subscribe(()=>this.removeOpenModal(xi)),xi}removeOpenModal(re){const Je=this.openModals.indexOf(re);Je>-1&&(this.openModals.splice(Je,1),this.openModals.length||this._afterAllClosed.next())}closeModals(re){let Je=re.length;for(;Je--;)re[Je].close(),this.openModals.length||this._afterAllClosed.next()}createOverlay(re){const Je=this.nzConfigService.getConfigForComponent(Xe)||{},Pt=new C.rR({hasBackdrop:!0,scrollStrategy:this.overlay.scrollStrategies.block(),positionStrategy:this.overlay.position().global(),disposeOnNavigation:wt(re.nzCloseOnNavigation,Je.nzCloseOnNavigation,!0),direction:wt(re.nzDirection,Je.nzDirection,this.directionality.value)});return wt(re.nzMask,Je.nzMask,!0)&&(Pt.backdropClass=st),this.overlay.create(Pt)}attachModalContainer(re,Je){const Cn=a.zZn.create({parent:Je&&Je.nzViewContainerRef&&Je.nzViewContainerRef.injector||this.injector,providers:[{provide:C.yY,useValue:re},{provide:Ai,useValue:Je}]}),xi=new de.A8("confirm"===Je.nzModalType?ti:Pe,Je.nzViewContainerRef,Cn);return re.attach(xi).instance}attachModalContent(re,Je,Pt,Cn){const ni=new Se(Pt,Cn,Je);if(re instanceof a.C4Q)Je.attachTemplatePortal(new de.VA(re,null,{$implicit:Cn.nzData,modalRef:ni}));else if((0,mt.n9)(re)&&"string"!=typeof re){const xi=this.createInjector(ni,Cn),sr=Je.attachComponentPortal(new de.A8(re,Cn.nzViewContainerRef,xi));ni.componentInstance=sr.instance}else Je.attachStringContent();return ni}createInjector(re,Je){return a.zZn.create({parent:Je&&Je.nzViewContainerRef&&Je.nzViewContainerRef.injector||this.injector,providers:[{provide:Se,useValue:re},{provide:ye,useValue:Je.nzData}]})}confirmFactory(re={},Je){return"nzIconType"in re||(re.nzIconType={info:"info-circle",success:"check-circle",error:"close-circle",warning:"exclamation-circle"}[Je]),"nzCancelText"in re||(re.nzCancelText=null),this.confirm(re,Je)}ngOnDestroy(){this.closeModals(this.openModalsAtThisLevel),this.afterAllClosedAtThisLevel.complete()}static{this.\u0275fac=function(Je){return new(Je||Y)(a.KVO(C.hJ),a.KVO(a.zZn),a.KVO(Qt.yx),a.KVO(Y,12),a.KVO(Ze.dS,8))}}static{this.\u0275prov=a.jDH({token:Y,factory:Y.\u0275fac})}}return Y})(),ae=(()=>{class Y{static{this.\u0275fac=function(Je){return new(Je||Y)}}static{this.\u0275mod=a.$C({type:Y})}static{this.\u0275inj=a.G2t({providers:[dt],imports:[$e.MD,Ze.jI,C.z_,Yt.C,de.jc,sn.bP,Ut.Zw,zt.Y3,je.Qe,St.y,je.Qe]})}}return Y})()},3384:(Nn,Ct,R)=>{"use strict";R.d(Ct,{Qe:()=>mt,Zu:()=>ve,qQ:()=>Fe});var M=R(177),C=R(4438),de=R(317);R(345);class Fe{static{this.formats={B:{max:1024},kB:{max:Math.pow(1024,2),prev:"B"},KB:{max:Math.pow(1024,2),prev:"B"},MB:{max:Math.pow(1024,3),prev:"kB"},GB:{max:Math.pow(1024,4),prev:"MB"},TB:{max:Number.MAX_SAFE_INTEGER,prev:"GB"}}}transform(ze,bt=0,xt="B",Qt){if(!((0,de.BV)(ze)&&(0,de.BV)(bt)&&bt%1==0&&bt>=0))return ze;let sn=ze,Yt=xt;for(;"B"!==Yt;)sn*=1024,Yt=Fe.formats[Yt].prev;if(Qt){const et=(0,de.nI)(Fe.calculateResult(Fe.formats[Qt],sn),bt);return Fe.formatResult(et,Qt)}for(const Ut in Fe.formats)if(Fe.formats.hasOwnProperty(Ut)){const et=Fe.formats[Ut];if(sn<et.max){const It=(0,de.nI)(Fe.calculateResult(et,sn),bt);return Fe.formatResult(It,Ut)}}}static formatResult(ze,bt){return`${ze} ${bt}`}static calculateResult(ze,bt){const xt=ze.prev?Fe.formats[ze.prev]:void 0;return xt?bt/xt.max:bt}static{this.\u0275fac=function(bt){return new(bt||Fe)}}static{this.\u0275pipe=C.EJ8({name:"nzBytes",type:Fe,pure:!0})}}let ve=(()=>{class $e{transform(bt,xt="px"){let et="px";return["cm","mm","Q","in","pc","pt","px","em","ex","ch","rem","1h","vw","vh","vmin","vmax","%"].some(It=>It===xt)&&(et=xt),"number"==typeof bt?`${bt}${et}`:`${bt}`}static{this.\u0275fac=function(xt){return new(xt||$e)}}static{this.\u0275pipe=C.EJ8({name:"nzToCssUnit",type:$e,pure:!0})}}return $e})(),mt=(()=>{class $e{static{this.\u0275fac=function(xt){return new(xt||$e)}}static{this.\u0275mod=C.$C({type:$e})}static{this.\u0275inj=C.G2t({imports:[M.MD]})}}return $e})()},2490:(Nn,Ct,R)=>{"use strict";R.d(Ct,{O:()=>de});var M=R(4438),C=R(177);let de=(()=>{class a{constructor(Fe,ve){this.document=Fe,this.platformId=ve,this.documentIsAccessible=(0,C.UE)(this.platformId)}static getCookieRegExp(Fe){const ve=Fe.replace(/([\[\]{}()|=;+?,.*^$])/gi,"\\$1");return new RegExp("(?:^"+ve+"|;\\s*"+ve+")=(.*?)(?:;|$)","g")}static safeDecodeURIComponent(Fe){try{return decodeURIComponent(Fe)}catch{return Fe}}check(Fe){return!!this.documentIsAccessible&&(Fe=encodeURIComponent(Fe),a.getCookieRegExp(Fe).test(this.document.cookie))}get(Fe){if(this.documentIsAccessible&&this.check(Fe)){Fe=encodeURIComponent(Fe);const ee=a.getCookieRegExp(Fe).exec(this.document.cookie);return ee[1]?a.safeDecodeURIComponent(ee[1]):""}return""}getAll(){if(!this.documentIsAccessible)return{};const Fe={},ve=this.document;return ve.cookie&&""!==ve.cookie&&ve.cookie.split(";").forEach(ee=>{const[fe,he]=ee.split("=");Fe[a.safeDecodeURIComponent(fe.replace(/^ /,""))]=a.safeDecodeURIComponent(he)}),Fe}set(Fe,ve,ee,fe,he,ge,at){if(!this.documentIsAccessible)return;if("number"==typeof ee||ee instanceof Date||fe||he||ge||at)return void this.set(Fe,ve,{expires:ee,path:fe,domain:he,secure:ge,sameSite:at||"Lax"});let mt=encodeURIComponent(Fe)+"="+encodeURIComponent(ve)+";";const $e=ee||{};$e.expires&&(mt+="number"==typeof $e.expires?"expires="+new Date((new Date).getTime()+1e3*$e.expires*60*60*24).toUTCString()+";":"expires="+$e.expires.toUTCString()+";"),$e.path&&(mt+="path="+$e.path+";"),$e.domain&&(mt+="domain="+$e.domain+";"),!1===$e.secure&&"None"===$e.sameSite&&($e.secure=!0,console.warn(`[ngx-cookie-service] Cookie ${Fe} was forced with secure flag because sameSite=None.More details : https://github.com/stevermeister/ngx-cookie-service/issues/86#issuecomment-597720130`)),$e.secure&&(mt+="secure;"),$e.sameSite||($e.sameSite="Lax"),mt+="sameSite="+$e.sameSite+";",this.document.cookie=mt}delete(Fe,ve,ee,fe,he="Lax"){this.documentIsAccessible&&this.set(Fe,"",{expires:new Date("Thu, 01 Jan 1970 00:00:01 GMT"),path:ve,domain:ee,secure:fe,sameSite:he})}deleteAll(Fe,ve,ee,fe="Lax"){if(!this.documentIsAccessible)return;const he=this.getAll();for(const ge in he)he.hasOwnProperty(ge)&&this.delete(ge,Fe,ve,ee,fe)}static{this.\u0275fac=function(ve){return new(ve||a)(M.KVO(C.qQ),M.KVO(M.Agw))}}static{this.\u0275prov=M.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})()},467:(Nn,Ct,R)=>{"use strict";function M(de,a,se,Fe,ve,ee,fe){try{var he=de[ee](fe),ge=he.value}catch(at){return void se(at)}he.done?a(ge):Promise.resolve(ge).then(Fe,ve)}function C(de){return function(){var a=this,se=arguments;return new Promise(function(Fe,ve){var ee=de.apply(a,se);function fe(ge){M(ee,Fe,ve,fe,he,"next",ge)}function he(ge){M(ee,Fe,ve,fe,he,"throw",ge)}fe(void 0)})}}R.d(Ct,{A:()=>C})},2284:(Nn,Ct,R)=>{"use strict";function M(C){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(de){return typeof de}:function(de){return de&&"function"==typeof Symbol&&de.constructor===Symbol&&de!==Symbol.prototype?"symbol":typeof de})(C)}R.d(Ct,{A:()=>M})},1635:(Nn,Ct,R)=>{"use strict";function se(Jt,un,pn,dn){var zn,jn=arguments.length,Yn=jn<3?un:null===dn?dn=Object.getOwnPropertyDescriptor(un,pn):dn;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Yn=Reflect.decorate(Jt,un,pn,dn);else for(var qn=Jt.length-1;qn>=0;qn--)(zn=Jt[qn])&&(Yn=(jn<3?zn(Yn):jn>3?zn(un,pn,Yn):zn(un,pn))||Yn);return jn>3&&Yn&&Object.defineProperty(un,pn,Yn),Yn}function at(Jt,un,pn,dn){return new(pn||(pn=Promise))(function(Yn,zn){function qn(Si){try{Gi(dn.next(Si))}catch(Mi){zn(Mi)}}function ar(Si){try{Gi(dn.throw(Si))}catch(Mi){zn(Mi)}}function Gi(Si){Si.done?Yn(Si.value):function jn(Yn){return Yn instanceof pn?Yn:new pn(function(zn){zn(Yn)})}(Si.value).then(qn,ar)}Gi((dn=dn.apply(Jt,un||[])).next())})}function Ut(Jt){return this instanceof Ut?(this.v=Jt,this):new Ut(Jt)}function et(Jt,un,pn){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var jn,dn=pn.apply(Jt,un||[]),Yn=[];return jn=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),qn("next"),qn("throw"),qn("return",function zn(ji){return function(Ln){return Promise.resolve(Ln).then(ji,Mi)}}),jn[Symbol.asyncIterator]=function(){return this},jn;function qn(ji,Ln){dn[ji]&&(jn[ji]=function(Bt){return new Promise(function(jt,Dn){Yn.push([ji,Bt,jt,Dn])>1||ar(ji,Bt)})},Ln&&(jn[ji]=Ln(jn[ji])))}function ar(ji,Ln){try{!function Gi(ji){ji.value instanceof Ut?Promise.resolve(ji.value.v).then(Si,Mi):Br(Yn[0][2],ji)}(dn[ji](Ln))}catch(Bt){Br(Yn[0][3],Bt)}}function Si(ji){ar("next",ji)}function Mi(ji){ar("throw",ji)}function Br(ji,Ln){ji(Ln),Yn.shift(),Yn.length&&ar(Yn[0][0],Yn[0][1])}}function zt(Jt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var pn,un=Jt[Symbol.asyncIterator];return un?un.call(Jt):(Jt=function bt(Jt){var un="function"==typeof Symbol&&Symbol.iterator,pn=un&&Jt[un],dn=0;if(pn)return pn.call(Jt);if(Jt&&"number"==typeof Jt.length)return{next:function(){return Jt&&dn>=Jt.length&&(Jt=void 0),{value:Jt&&Jt[dn++],done:!Jt}}};throw new TypeError(un?"Object is not iterable.":"Symbol.iterator is not defined.")}(Jt),pn={},dn("next"),dn("throw"),dn("return"),pn[Symbol.asyncIterator]=function(){return this},pn);function dn(Yn){pn[Yn]=Jt[Yn]&&function(zn){return new Promise(function(qn,ar){!function jn(Yn,zn,qn,ar){Promise.resolve(ar).then(function(Gi){Yn({value:Gi,done:qn})},zn)}(qn,ar,(zn=Jt[Yn](zn)).done,zn.value)})}}}R.d(Ct,{AQ:()=>et,Cg:()=>se,N3:()=>Ut,sH:()=>at,xN:()=>zt}),"function"==typeof SuppressedError&&SuppressedError}},Nn=>{Nn(Nn.s=7891)}]);